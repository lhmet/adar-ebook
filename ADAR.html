<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Análise de Dados Ambientais com R</title>
  <meta name="description" content="Livro baseado nas notas de aula da disciplina FSC1104 do curso de graduação em Meteorologia da UFSM." />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Análise de Dados Ambientais com R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/TB1.jpg" />
  <meta property="og:description" content="Livro baseado nas notas de aula da disciplina FSC1104 do curso de graduação em Meteorologia da UFSM." />
  <meta name="github-repo" content="lhmet/adar-ebook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Análise de Dados Ambientais com R" />
  
  <meta name="twitter:description" content="Livro baseado nas notas de aula da disciplina FSC1104 do curso de graduação em Meteorologia da UFSM." />
  <meta name="twitter:image" content="images/TB1.jpg" />

<meta name="author" content="Jônatan Tatsch" />


<meta name="date" content="2020-05-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Análise de Dados Ambientais com R</h1>
<p class="author"><em>Jônatan Tatsch</em></p>
<p class="date"><em>2020-05-30</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#apresentação">Apresentação</a></li>
<li><a href="#part-introdução">(PART) Introdução</a></li>
<li><a href="#intro"><span class="toc-section-number">1</span> Motivação</a><ul>
<li><a href="#análise-de-dados-meteorológicos"><span class="toc-section-number">1.1</span> Análise de dados meteorológicos</a></li>
<li><a href="#ciência-de-dados"><span class="toc-section-number">1.2</span> Ciência de dados</a></li>
<li><a href="#etapas-para-abordagem-de-um-problema"><span class="toc-section-number">1.3</span> Etapas para abordagem de um problema</a></li>
<li><a href="#programação-computacional"><span class="toc-section-number">1.4</span> Programação computacional</a></li>
<li><a href="#r"><span class="toc-section-number">1.5</span> R</a></li>
<li><a href="#por-que-o-r"><span class="toc-section-number">1.6</span> Por que o R?</a></li>
<li><a href="#pacotes-da-comunidade-do-r"><span class="toc-section-number">1.7</span> Pacotes da comunidade do R</a></li>
<li><a href="#r-não-é-perfeito"><span class="toc-section-number">1.8</span> R não é perfeito!</a></li>
<li><a href="#no-final-deste-curso"><span class="toc-section-number">1.9</span> No final deste curso …</a></li>
<li><a href="#para-saber-mais-sobre-o-r"><span class="toc-section-number">1.10</span> Para saber mais sobre o R</a></li>
</ul></li>
<li><a href="#part-configuração-do-sistema">(PART) Configuração do Sistema</a></li>
<li><a href="#pré-requisitos"><span class="toc-section-number">2</span> Pré-requisitos</a><ul>
<li><a href="#install"><span class="toc-section-number">2.1</span> Instalação do R e RStudio</a><ul>
<li><a href="#instalando-o-r"><span class="toc-section-number">2.1.1</span> Instalando o R</a></li>
</ul></li>
<li><a href="#install-pck"><span class="toc-section-number">2.2</span> Instalação de Pacotes</a><ul>
<li><a href="#da-internet"><span class="toc-section-number">2.2.1</span> Da internet</a></li>
<li><a href="#atualização-de-pacotes"><span class="toc-section-number">2.2.2</span> Atualização de pacotes</a></li>
</ul></li>
<li><a href="#pacotes-necessários-e-dependências"><span class="toc-section-number">2.3</span> Pacotes necessários e dependências</a></li>
<li><a href="#install-rstudio"><span class="toc-section-number">2.4</span> RStudio no Ubuntu</a></li>
<li><a href="#git-e-github"><span class="toc-section-number">2.5</span> Git e Github</a><ul>
<li><a href="#instalação-do-git"><span class="toc-section-number">2.5.1</span> Instalação do <strong><code>git</code></strong></a></li>
</ul></li>
</ul></li>
<li><a href="#part-interação">(PART) Interação</a></li>
<li><a href="#iu"><span class="toc-section-number">3</span> Interface do Usuário</a><ul>
<li><a href="#r-no-modo-interativo"><span class="toc-section-number">3.1</span> R no modo interativo</a><ul>
<li><a href="#expressInSeq"><span class="toc-section-number">3.1.1</span> Expressões em sequência</a></li>
<li><a href="#navegação-entre-as-expressões-já-avaliadas"><span class="toc-section-number">3.1.2</span> Navegação entre as expressões já avaliadas</a></li>
<li><a href="#comentarios"><span class="toc-section-number">3.1.3</span> Comentários</a></li>
<li><a href="#auto-preenchimento-de-funções"><span class="toc-section-number">3.1.4</span> Auto preenchimento de funções</a></li>
<li><a href="#primeiro-script"><span class="toc-section-number">3.1.5</span> Primeiro <em>script</em></a></li>
</ul></li>
<li><a href="#r-no-modo-de-processamento-em-lote"><span class="toc-section-number">3.2</span> R no modo de processamento em lote</a></li>
</ul></li>
<li><a href="#rstudio"><span class="toc-section-number">4</span> RStudio</a><ul>
<li><a href="#visão-geral-do-rstudio"><span class="toc-section-number">4.1</span> Visão geral do RStudio</a></li>
<li><a href="#verificação-ortográfica"><span class="toc-section-number">4.2</span> Verificação ortográfica</a></li>
</ul></li>
<li><a href="#part-fundamentos-do-r">(PART) Fundamentos do R</a></li>
<li><a href="#operbasic"><span class="toc-section-number">5</span> Operações básicas</a><ul>
<li><a href="#convenção"><span class="toc-section-number">5.1</span> Convenção</a></li>
<li><a href="#calculadora"><span class="toc-section-number">5.2</span> Calculadora</a><ul>
<li><a href="#aritmética-básica"><span class="toc-section-number">5.2.1</span> Aritmética básica</a></li>
<li><a href="#nans"><span class="toc-section-number">5.2.2</span> Cálculos problemáticos</a></li>
<li><a href="#NAs"><span class="toc-section-number">5.2.3</span> Dados faltantes</a></li>
<li><a href="#matfuns"><span class="toc-section-number">5.2.4</span> Funções matemáticas</a></li>
</ul></li>
<li><a href="#variaveis"><span class="toc-section-number">5.3</span> Variáveis</a><ul>
<li><a href="#removendo-variáveis"><span class="toc-section-number">5.3.1</span> Removendo variáveis</a></li>
</ul></li>
<li><a href="#erros-comuns"><span class="toc-section-number">5.4</span> Erros comuns</a></li>
<li><a href="#boas-práticas-para-códigos-de-boa-qualidade"><span class="toc-section-number">5.5</span> Boas práticas para códigos de boa qualidade</a><ul>
<li><a href="#nomes-de-variáveis"><span class="toc-section-number">5.5.1</span> Nomes de variáveis</a></li>
</ul></li>
<li><a href="#exercícios"><span class="toc-section-number">5.6</span> Exercícios</a></li>
</ul></li>
<li><a href="#datatype"><span class="toc-section-number">6</span> Tipos básicos de dados</a><ul>
<li><a href="#tipos-dados"><span class="toc-section-number">6.1</span> Vetores e tipos de dados</a><ul>
<li><a href="#build-vectors"><span class="toc-section-number">6.1.1</span> Construindo vetores</a></li>
<li><a href="#números"><span class="toc-section-number">6.1.2</span> Números</a></li>
<li><a href="#caractere"><span class="toc-section-number">6.1.3</span> Caractere</a></li>
<li><a href="#logico"><span class="toc-section-number">6.1.4</span> Lógico</a></li>
</ul></li>
<li><a href="#testes-sobre-tipos-de-dados"><span class="toc-section-number">6.2</span> Testes sobre tipos de dados</a></li>
<li><a href="#conversão-entre-tipos-de-dados"><span class="toc-section-number">6.3</span> Conversão entre tipos de dados</a></li>
<li><a href="#outros-tipos-de-dados-derivados"><span class="toc-section-number">6.4</span> Outros tipos de dados derivados</a><ul>
<li><a href="#fator"><span class="toc-section-number">6.4.1</span> Fator</a></li>
<li><a href="#datas-e-horários"><span class="toc-section-number">6.4.2</span> Datas e horários</a></li>
</ul></li>
</ul></li>
<li><a href="#manip-vectors"><span class="toc-section-number">7</span> Manipulação de Vetores</a><ul>
<li><a href="#propriedades"><span class="toc-section-number">7.1</span> Propriedades</a><ul>
<li><a href="#nomeando-vetores"><span class="toc-section-number">7.1.1</span> Nomeando vetores</a></li>
</ul></li>
<li><a href="#atributos"><span class="toc-section-number">7.2</span> Atributos</a></li>
<li><a href="#oper-vect"><span class="toc-section-number">7.3</span> Operações com vetores</a><ul>
<li><a href="#comparações"><span class="toc-section-number">7.3.1</span> Comparações</a></li>
<li><a href="#funções-any-e-all"><span class="toc-section-number">7.3.2</span> Funções <code>any</code> e <code>all</code></a></li>
</ul></li>
<li><a href="#sequências"><span class="toc-section-number">7.4</span> Sequências</a><ul>
<li><a href="#sequências-de-números-inteiros"><span class="toc-section-number">7.4.1</span> Sequências de números inteiros</a></li>
<li><a href="#sequências-de-números-reais"><span class="toc-section-number">7.4.2</span> Sequências de números reais</a></li>
<li><a href="#repetições"><span class="toc-section-number">7.4.3</span> Repetições</a></li>
</ul></li>
<li><a href="#index-vetores"><span class="toc-section-number">7.5</span> Indexação de vetores</a><ul>
<li><a href="#indexação-por-vetores-numéricos"><span class="toc-section-number">7.5.1</span> Indexação por vetores numéricos</a></li>
<li><a href="#indexação-por-nomes"><span class="toc-section-number">7.5.2</span> Indexação por nomes</a></li>
<li><a href="#indexação-por-vetores-lógicos"><span class="toc-section-number">7.5.3</span> Indexação por vetores lógicos</a></li>
</ul></li>
<li><a href="#replace-vect"><span class="toc-section-number">7.6</span> Substituição de elementos de um vetor</a></li>
<li><a href="#lidando-com-dados-faltantes"><span class="toc-section-number">7.7</span> Lidando com dados faltantes</a><ul>
<li><a href="#identificação-e-remoção-de-nas"><span class="toc-section-number">7.7.1</span> Identificação e remoção de <code>NA</code>s</a></li>
<li><a href="#indexação-com-nas"><span class="toc-section-number">7.7.2</span> Indexação com <code>NA</code>s</a></li>
<li><a href="#efeito-de-nas-em-funções"><span class="toc-section-number">7.7.3</span> Efeito de <code>NAs</code> em funções</a></li>
</ul></li>
<li><a href="#dados-nulos"><span class="toc-section-number">7.8</span> Dados Nulos (<code>NULL</code>)</a></li>
<li><a href="#dados-duplicados"><span class="toc-section-number">7.9</span> Dados duplicados</a></li>
<li><a href="#dados-ordenados"><span class="toc-section-number">7.10</span> Dados ordenados</a></li>
<li><a href="#funções-móveis-úteis"><span class="toc-section-number">7.11</span> Funções móveis úteis</a></li>
<li><a href="#identificação-de-eventos-discretos"><span class="toc-section-number">7.12</span> Identificação de eventos discretos</a></li>
<li><a href="#exercícios-1"><span class="toc-section-number">7.13</span> Exercícios</a></li>
</ul></li>
<li><a href="#estrutura-dados"><span class="toc-section-number">8</span> Estrutura de dados</a><ul>
<li><a href="#matriz"><span class="toc-section-number">8.1</span> Matriz</a><ul>
<li><a href="#criação-de-matrizes"><span class="toc-section-number">8.1.1</span> Criação de matrizes</a></li>
<li><a href="#nomes-lin-col-mat"><span class="toc-section-number">8.1.2</span> Nomes das linhas e colunas de uma matriz</a></li>
<li><a href="#indexação-de-matrizes"><span class="toc-section-number">8.1.3</span> Indexação de matrizes</a></li>
<li><a href="#número-de-linhas-e-colunas-de-uma-matriz"><span class="toc-section-number">8.1.4</span> Número de linhas e colunas de uma matriz</a></li>
<li><a href="#adição-de-linhas-e-colunas-a-uma-matriz"><span class="toc-section-number">8.1.5</span> Adição de linhas e colunas a uma matriz</a></li>
<li><a href="#matriz-transposta-e-diagonal"><span class="toc-section-number">8.1.6</span> Matriz transposta e diagonal</a></li>
<li><a href="#conversão-de-matriz-para-vetor"><span class="toc-section-number">8.1.7</span> Conversão de matriz para vetor</a></li>
</ul></li>
<li><a href="#arranjo"><span class="toc-section-number">8.2</span> Arranjo</a><ul>
<li><a href="#criação"><span class="toc-section-number">8.2.1</span> Criação</a></li>
<li><a href="#indexação"><span class="toc-section-number">8.2.2</span> Indexação</a></li>
</ul></li>
<li><a href="#listas"><span class="toc-section-number">8.3</span> Lista</a><ul>
<li><a href="#criação-1"><span class="toc-section-number">8.3.1</span> Criação</a></li>
<li><a href="#indexação-1"><span class="toc-section-number">8.3.2</span> Indexação</a></li>
<li><a href="#conversão-de-lista-para-vetor-e-vice-versa."><span class="toc-section-number">8.3.3</span> Conversão de lista para vetor e vice-versa.</a></li>
<li><a href="#conversão-de-list-para-data.frame"><span class="toc-section-number">8.3.4</span> Conversão de <code>list</code> para <code>data.frame</code></a></li>
</ul></li>
<li><a href="#dataframe"><span class="toc-section-number">8.4</span> Dataframe</a><ul>
<li><a href="#criação-2"><span class="toc-section-number">8.4.1</span> Criação</a></li>
<li><a href="#atributos-de-um-dataframe"><span class="toc-section-number">8.4.2</span> Atributos de um <em>dataframe</em></a></li>
<li><a href="#acesso-as-variáveis-de-um-dataframe"><span class="toc-section-number">8.4.3</span> Acesso as variáveis de um <em>dataframe</em></a></li>
<li><a href="#indexação-seleção-e-substituição"><span class="toc-section-number">8.4.4</span> Indexação, seleção e substituição</a></li>
<li><a href="#combinando-dataframes"><span class="toc-section-number">8.4.5</span> Combinando <em>dataframes</em></a></li>
<li><a href="#teste-e-coerção"><span class="toc-section-number">8.4.6</span> Teste e Coerção</a></li>
</ul></li>
<li><a href="#exercícios-2"><span class="toc-section-number">8.5</span> Exercícios</a></li>
</ul></li>
<li><a href="#io"><span class="toc-section-number">9</span> Entrada e saída de dados</a><ul>
<li><a href="#pré-requisitos-1"><span class="toc-section-number">9.1</span> Pré-requisitos</a></li>
<li><a href="#diretório-de-trabalho"><span class="toc-section-number">9.2</span> Diretório de trabalho</a></li>
<li><a href="#boas-práticas-para-importação-e-exportação-de-dados"><span class="toc-section-number">9.3</span> Boas práticas para importação e exportação de dados</a></li>
<li><a href="#arquivos-texto"><span class="toc-section-number">9.4</span> Arquivos texto</a><ul>
<li><a href="#Rio"><span class="toc-section-number">9.4.1</span> <strong>rio</strong></a></li>
<li><a href="#arquivos-texto-não-estruturados"><span class="toc-section-number">9.4.2</span> Arquivos texto não estruturados</a></li>
</ul></li>
<li><a href="#arquivos-binários"><span class="toc-section-number">9.5</span> Arquivos binários</a><ul>
<li><a href="#formatos-binários-nativos-do-r"><span class="toc-section-number">9.5.1</span> Formatos binários nativos do R</a></li>
<li><a href="#netcdf-network-common-data-form"><span class="toc-section-number">9.5.2</span> NetCDF (Network Common Data Form)</a></li>
</ul></li>
<li><a href="#arquivos-excel"><span class="toc-section-number">9.6</span> Arquivos Excel</a><ul>
<li><a href="#como-usar-1"><span class="toc-section-number">9.6.1</span> Como usar</a></li>
<li><a href="#export-xls"><span class="toc-section-number">9.6.2</span> Escrita de arquivos excel no formato <code>.xls</code></a></li>
<li><a href="#escrita-de-arquivos-excel-no-formato-.xlsx"><span class="toc-section-number">9.6.3</span> Escrita de arquivos excel no formato <code>.xlsx</code></a></li>
<li><a href="#estrutura-de-dados-não-tabulares"><span class="toc-section-number">9.6.4</span> Estrutura de dados não tabulares</a></li>
</ul></li>
<li><a href="#para-saber-mais"><span class="toc-section-number">9.7</span> Para saber mais</a></li>
<li><a href="#exercícios-3"><span class="toc-section-number">9.8</span> Exercícios</a></li>
</ul></li>
<li><a href="#part-ferramentas-modernas-do-r">(PART) Ferramentas modernas do R</a></li>
<li><a href="#data-wrangle"><span class="toc-section-number">10</span> Processamento de dados</a><ul>
<li><a href="#pré-requisitos-3"><span class="toc-section-number">10.1</span> Pré-requisitos</a><ul>
<li><a href="#dados"><span class="toc-section-number">10.1.1</span> Dados</a></li>
</ul></li>
<li><a href="#tibble-um-data-frame-aperfeiçoado"><span class="toc-section-number">10.2</span> <em>tibble</em>: um <em>data frame</em> aperfeiçoado</a><ul>
<li><a href="#funcionalidades-do-tibble"><span class="toc-section-number">10.2.1</span> Funcionalidades do <em>tibble</em></a></li>
</ul></li>
<li><a href="#restruturação-de-dados-retangulares"><span class="toc-section-number">10.3</span> Restruturação de dados retangulares</a><ul>
<li><a href="#dados-arrumados"><span class="toc-section-number">10.3.1</span> Dados arrumados</a></li>
<li><a href="#formatos-de-dados-mais-comuns"><span class="toc-section-number">10.3.2</span> Formatos de dados mais comuns</a></li>
<li><a href="#funções-adicionais-do-tidyr"><span class="toc-section-number">10.3.3</span> Funções adicionais do <strong>tidyr</strong></a></li>
</ul></li>
<li><a href="#manipulação-de-dados"><span class="toc-section-number">10.4</span> Manipulação de dados</a><ul>
<li><a href="#códigos-como-fluxogramas"><span class="toc-section-number">10.4.1</span> Códigos como fluxogramas</a></li>
<li><a href="#seleção-de-variáveis"><span class="toc-section-number">10.4.2</span> Seleção de variáveis</a></li>
<li><a href="#seleção-de-observações"><span class="toc-section-number">10.4.3</span> Seleção de observações</a></li>
<li><a href="#reordenando-dados"><span class="toc-section-number">10.4.4</span> Reordenando dados</a></li>
<li><a href="#criando-e-renomeando-variáveis"><span class="toc-section-number">10.4.5</span> Criando e renomeando variáveis</a></li>
<li><a href="#agregando-observações"><span class="toc-section-number">10.4.6</span> Agregando observações</a></li>
<li><a href="#agrupando-observações"><span class="toc-section-number">10.4.7</span> Agrupando observações</a></li>
<li><a href="#combinação-de-dados"><span class="toc-section-number">10.4.8</span> Combinação de dados</a></li>
</ul></li>
<li><a href="#exercícios-4"><span class="toc-section-number">10.5</span> Exercícios</a></li>
</ul></li>
<li><a href="#data-vis"><span class="toc-section-number">11</span> Visualização de dados</a><ul>
<li><a href="#pré-requisitos-4"><span class="toc-section-number">11.1</span> Pré-requisitos</a><ul>
<li><a href="#dados-1"><span class="toc-section-number">11.1.1</span> Dados</a></li>
</ul></li>
<li><a href="#ggplot2"><span class="toc-section-number">11.2</span> <em>ggplot2</em></a></li>
</ul></li>
<li><a href="#referências"><span class="toc-section-number">12</span> Referências</a></li>
<li><a href="#appendix-appendix">(APPENDIX) Appendix</a></li>
<li><a href="#oper-mat"><span class="toc-section-number">13</span> Operações adicionais com matrizes</a><ul>
<li><a href="#função-dim"><span class="toc-section-number">13.1</span> Função <code>dim()</code></a></li>
<li><a href="#atribuição-por-indexação"><span class="toc-section-number">13.2</span> Atribuição por indexação</a></li>
<li><a href="#operações-matriciais"><span class="toc-section-number">13.3</span> Operações matriciais</a><ul>
<li><a href="#multiplicação-matricial"><span class="toc-section-number">13.3.1</span> Multiplicação matricial</a></li>
<li><a href="#adição-matricial"><span class="toc-section-number">13.3.2</span> Adição matricial</a></li>
<li><a href="#produto-escalar"><span class="toc-section-number">13.3.3</span> Produto escalar</a></li>
<li><a href="#determinante"><span class="toc-section-number">13.3.4</span> Determinante</a></li>
<li><a href="#solução-de-sistemas-lineares"><span class="toc-section-number">13.3.5</span> Solução de sistemas lineares</a></li>
<li><a href="#produto-cartesiano"><span class="toc-section-number">13.3.6</span> Produto cartesiano</a></li>
</ul></li>
</ul></li>
<li><a href="#funções-nativas-do-r-para-importar-e-exportar-dados"><span class="toc-section-number">14</span> Funções nativas do R para importar e exportar dados</a><ul>
<li><a href="#amostras-pequenas-de-dados"><span class="toc-section-number">14.1</span> Amostras pequenas de dados</a><ul>
<li><a href="#scan"><span class="toc-section-number">14.1.1</span> scan()</a></li>
<li><a href="#readline"><span class="toc-section-number">14.1.2</span> readline()</a></li>
<li><a href="#impressão-na-tela"><span class="toc-section-number">14.1.3</span> Impressão na tela</a></li>
<li><a href="#textconnection"><span class="toc-section-number">14.1.4</span> textConnection()</a></li>
</ul></li>
<li><a href="#exportando-e-recuperando-objetos-do-r-no-formato-textual"><span class="toc-section-number">14.2</span> Exportando e recuperando objetos do R no formato textual</a><ul>
<li><a href="#dput-dget-dump-e-source."><span class="toc-section-number">14.2.1</span> <code>dput()</code>, <code>dget</code>, <code>dump</code> e <code>source</code>.</a></li>
</ul></li>
<li><a href="#dados-de-pacotes-do-r"><span class="toc-section-number">14.3</span> Dados de pacotes do R</a></li>
<li><a href="#readtable"><span class="toc-section-number">14.4</span> Leitura de arquivos texto com funções da base do R</a><ul>
<li><a href="#dados-hidrometeorológicos-brasileiros"><span class="toc-section-number">14.4.1</span> Dados hidrometeorológicos brasileiros</a></li>
<li><a href="#arquivos-formatados-com-largura-fixa"><span class="toc-section-number">14.4.2</span> Arquivos formatados com largura fixa</a></li>
</ul></li>
</ul></li>
<li><a href="#r-markdown"><span class="toc-section-number">15</span> R Markdown</a><ul>
<li><a href="#como-usar-o-r-markdown"><span class="toc-section-number">15.1</span> Como usar o <em>R Markdown</em></a><ul>
<li><a href="#opções-do-chunk"><span class="toc-section-number">15.1.1</span> Opções do <strong>chunk</strong></a></li>
<li><a href="#saídas-dos-chunks"><span class="toc-section-number">15.1.2</span> Saídas dos <strong>chunks</strong></a></li>
<li><a href="#códigos-r-dentro-de-linhas"><span class="toc-section-number">15.1.3</span> Códigos R dentro de linhas</a></li>
</ul></li>
<li><a href="#markdown"><span class="toc-section-number">15.2</span> Markdown</a><ul>
<li><a href="#cabeçalhos"><span class="toc-section-number">15.2.1</span> Cabeçalhos</a></li>
<li><a href="#parágrafos"><span class="toc-section-number">15.2.2</span> Parágrafos</a></li>
<li><a href="#listas-1"><span class="toc-section-number">15.2.3</span> Listas</a></li>
<li><a href="#linhas-horizontais"><span class="toc-section-number">15.2.4</span> Linhas horizontais</a></li>
<li><a href="#citações-diretas"><span class="toc-section-number">15.2.5</span> Citações diretas</a></li>
<li><a href="#tabelas"><span class="toc-section-number">15.2.6</span> Tabelas</a></li>
<li><a href="#ênfase-de-texto"><span class="toc-section-number">15.2.7</span> Ênfase de texto</a></li>
<li><a href="#hyperlinks"><span class="toc-section-number">15.2.8</span> Hyperlinks</a></li>
<li><a href="#figuras"><span class="toc-section-number">15.2.9</span> Figuras</a></li>
<li><a href="#expressões-matemáticas"><span class="toc-section-number">15.2.10</span> Expressões matemáticas</a></li>
</ul></li>
<li><a href="#aparência"><span class="toc-section-number">15.3</span> Aparência</a></li>
<li><a href="#referências-para-aprender-mais-sobre-o-r-markdown"><span class="toc-section-number">15.4</span> Referências para aprender mais sobre o R Markdown</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análise de Dados Ambientais com R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="apresentação" class="section level1 unnumbered">
<h1>Apresentação</h1>
<p><img src="images/TB1.jpg" width="549px" class="cover" style="display: block; margin: auto;" /></p>
<p style="font-size: 11px; font-style: italic; background: whitesmoke; text-align="right"; color: gray; line-height: 12px;width: 650px;">Ilustração: The Project Twins</p>
<!---
<img src="images/TB1.jpg" width="90%" style="display: block; margin: auto;" />
--->
<!-- <img src="images/TB1.jpg" style="position:absolute;top:200px;height:300px;align:center;" /> -->
<p>Este livro é uma composição das notas de aula da disciplina
<strong>Análise de Dados Ambientais com <img src="images/logo_r.png" width="20"></strong> do curso de Graduação em <a href="http://w3.ufsm.br/meteorologia/"><span class="smallcaps">meteorologia</span></a> que eu ofereço no Departamento de Física da Universidade Federal de Santa Maria (<a href="http://site.ufsm.br/">UFSM</a>).</p>
<p>O livro pode ser útil para qualquer um com interesse em aprender o <img src="images/logo_r.png" width="20"> e que quer alavancar a etapa de processamento de dados ambientais no seu projeto. O objetivo é prover uma material para ensinar os conceitos básicos de programação necessários para o processamento, a visualização e a análise de dados ambientais com o sistema computacional <img src="images/logo_r.png" width="20">. Estes procedimentos são potencializados com o uso do software RStudio, uma interface de desenvolvimento integrado (IDE) específica para o <img src="images/logo_r.png" width="20">.</p>
<p>Neste livro o leitor aprenderá a sintaxe básica da linguagem <img src="images/logo_r.png" width="20">, a importação e exportação de dados, a criação de gráficos, funções, a padronização e organização de conjunto de dados ambientais; e finalmente, a confecção de relatórios dinâmicos e reproduzíveis.</p>
<p>O material do livro inclui o uso de dados ambientais de diferentes áreas (meteorologia, climatologia, hidrologia, sensoriamento remoto) em exemplos práticos e em exercícios, para estimular a prática da programação.</p>
<p>O texto é intercalado com trechos de códigos que podem ser reproduzidos e os resultados visualizados no computador do leitor.</p>
<p>Após a introdução ao <img src="images/logo_r.png" width="20"> apresenta-se as capacidades específicas do <img src="images/logo_r.png" width="20"> para manipulação de dados. Baseado na experiência do autor são empregados os pacotes mais adequados para cada finalidade, como <strong>dplyr</strong> e <strong>tidyr</strong> para o processamento de dados e o <strong>ggplot2</strong> para visualização de dados.</p>
<p>A intenção do livro é que após a leitura, o leitor tenha o conhecimento suficiente para desenvolver códigos que automatizem tarefas repetitivas, assim reduzindo o tempo gasto na etapa de preparação de dados. Esta programação mais efetiva permitirá focar mais na análise de dados e na comunicação dos resultados, seja ela na forma de documentos acadêmicos, ou relatórios técnicos em empresas públicas e privadas.</p>
<p>O texto está em formato <a href="https://pt.wikipedia.org/wiki/HTML">html</a> para tirar o melhor proveito de recursos de multimídia, da capacidade de busca de texto e links para websites.</p>
<p>O texto é organizado em 7 capítulos:</p>
<ul>
<li><p>@ref(intro) Introdução</p></li>
<li><p>@ref(install) Instalação do <img src="images/logo_r.png" width="20"> e RStudio</p></li>
<li><p>@ref(iu) Interface do Usuário</p></li>
<li><p>@ref(rstudio) Rstudio</p></li>
<li><p>@ref(operbasic) Operações Básicas</p></li>
<li><p>@ref(datatype) Tipos de dados</p></li>
<li><p>@ref(estrutura-dados) Estruturas de dados</p></li>
<li><p>@ref(io) Entrada de dados</p></li>
<li><p>@ref(data-wrangle) Processamento de dados</p></li>
</ul>
<!-- 
# estrutura de conteúdo de livro ideal
# para balancear R básico e tidyverse
https://dzchilds.github.io/eda-for-bio/
https://github.com/lhmet-forks/eda-for-bio
https://tavareshugo.github.io/r-eda-gapminder/
-->
<!-- 
https://github.com/ELToulemonde/dataPreparation
https://cran.r-project.org/web/packages/dlookr/vignettes/diagonosis.html
-->
<!--
- Para um futuro capítulo de EDA
 https://www.udemy.com/course/automating-data-exploration-with-r/
 
 # top demais!
 https://github.com/mstaniak/autoEDA-resources
 
  https://boxuancui.github.io/DataExplorer/
 
-->
<!-- - AUTOMAÇÂO COM R 
https://datacarpentry.org/rr-automation/ 

# The Automation of GitHub Processes in RStudio
https://rpubs.com/chrimaho/GitHubAutomation

https://towardsdatascience.com/automate-your-repetitive-reports-5ee60a53bda2

https://stackoverflow.com/questions/10204483/i-want-to-run-a-r-code-at-a-specific-time

https://stat545.com/automation-overview.html

https://towardsdatascience.com/how-to-build-an-automated-trading-system-using-r-34892b6d3320

https://nextjournal.com/eda/automated-eda

https://www.r-bloggers.com/how-to-create-automated-analysis-using-r/


https://medium.com/airbnb-engineering/using-googlesheets-and-mailr-packages-in-r-to-automate-reporting-c09579e0377f
-->
<p><br/>
<br/></p>
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Licença Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />A versão on-line deste livro está licenciada com uma Licença <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons - Atribuição-NãoComercial-CompartilhaIgual 4.0 Internacional</a>.</p>
<!--chapter:end:index.Rmd-->
</div>
<div id="part-introdução" class="section level1 unnumbered">
<h1>(PART) Introdução</h1>
</div>
<div id="intro" class="section level1">
<h1><span class="header-section-number">1</span> Motivação</h1>
<!-- #dados meteorológicos 
#Importância e valor da informação meteorológica
 aquisição de dados
 preparação de dados
 controle de qualidade
 interpolação 
 visualização
-->
<!--

- pesquisa reproduzível, transparência

-->
<p><img src="images/HeHeartlandPark2601underconstructionbar9.gif" /></p>
<div id="análise-de-dados-meteorológicos" class="section level2">
<h2><span class="header-section-number">1.1</span> Análise de dados meteorológicos</h2>
<blockquote>
<p>Processo pelo qual adquire-se conhecimento, compreensão e percepção dos fenômenos meteorológicos a partir de observações (dados) qualitativas e quantitativas.</p>
</blockquote>
</style>
<div class="midcenter" style="margin-left:50px; margin-top:50px;">
<p><img src="images/TB1.jpg" height="300px" width="400px" /></p>
</div>
</div>
<div id="ciência-de-dados" class="section level2">
<h2><span class="header-section-number">1.2</span> Ciência de dados</h2>
</style>
<div class="midcenter" style="margin-left:50px; margin-top:50px;">
<p><img src="images/datascience.png" height="400px" width="500px" /></p>
</div>
<!-- 
Definitivamente pensando em 
(1) 'Ciência de dados meteorológicos' 
ou 
(2) 'processamento de dados meteorológicos'


Mas vem aí discussão sobre (1) Ciência de dados (dadoslogia), Estatística, Ciência da computação. 
(ver a Introdução do Beginning Dara Science with R)



O objetivo da ciência de dados não é coletar dados e criar bons gráficos, é tomar melhores decisões e melhorar processos através dos dados.
-->
</div>
<div id="etapas-para-abordagem-de-um-problema" class="section level2">
<h2><span class="header-section-number">1.3</span> Etapas para abordagem de um problema</h2>
<ol style="list-style-type: decimal">
<li><strong>Questão científica/problema</strong>
<br/></li>
<li><strong>Obtenção de dados:</strong> coleta/medida do(as) estado/condições da atmosfera
<ul>
<li>Instrumentos e sensores
<br/></li>
</ul></li>
<li><strong>Processamento de dados:</strong>
<em>download</em> —&gt; limpeza —&gt; formatação —&gt; <br/>
transformação —&gt; controle de qualidade
<ul>
<li>ferramenta/software
<ul>
<li><span style="color: red">conhecimento em programação</span></li>
</ul></li>
</ul></li>
<li><strong>Análise de dados</strong>
<ul>
<li>ferramenta/software
<ul>
<li><span style="color: red">conhecimento em programação</span></li>
</ul></li>
</ul></li>
<li><strong>Solução para o problema</strong>
<ul>
<li>Proposta de um modelo
<ul>
<li>estatístico, empírico, ou fisicamente baseado</li>
</ul></li>
<li><span style="color: red">conhecimento em programação</span>
<br/></li>
</ul></li>
<li><strong>Apresentação/divulgação/publicação</strong></li>
</ol>
</div>
<div id="programação-computacional" class="section level2">
<h2><span class="header-section-number">1.4</span> Programação computacional</h2>
</style>
<div class="midcenter" style="margin-left:10px; margin-top:10px;">
<p><img src="images/mas_escolhas.jpg" height="300px" width="600px" /></p>
</div>
</style>
<div class="midcenter" style="margin-left:10px; margin-top:0px;">
<p><img src="images/errando_aprende.png" height="50px" width="550px" /></p>
</div>
</div>
<div id="r" class="section level2">
<h2><span class="header-section-number">1.5</span> R</h2>
<!-- 
https://datacarpentry.org/R-ecology-lesson/00-before-we-start.html 

-->
<ul>
<li><p><a href="https://www.r-project.org/">R</a> é o termo usado para se referir a linguagem de programação e ao software que interpreta os scripts escritos usando esta linguagem.</p></li>
<li><p>Comunidade fantástica</p>
<ul>
<li><p><a href="https://www.r-project.org/contributors.html">Contribuidores</a> (<span class="citation">R Core Team (<a href="#ref-R-base" role="doc-biblioref">2020</a>)</span>)</p></li>
<li><p>milhares de pessoas usam o R diariamente e ajudam outras pessoas</p></li>
</ul></li>
<li><p><strong>Software Livre</strong> (GPL), <a href="https://github.com/wch/r-source">Código aberto</a> e multiplataforma
<br/></p></li>
<li><p>Ambiente para Análise de dados interativa</p></li>
</ul>
</div>
<div id="por-que-o-r" class="section level2">
<h2><span class="header-section-number">1.6</span> Por que o R?</h2>
<!-- 
https://simplystatistics.org/2018/07/12/use-r-keynote-2018/

http://www.sthda.com/english/wiki/what-is-r-and-why-learning-r-programming

https://datacarpentry.org/R-ecology-lesson/00-before-we-start.html
-->
<ul>
<li><p><a href="https://www.r-project.org/">R</a> não é uma GUI (Interface gráfica do usuário) e isso é bom</p>
<ul>
<li><p>há uma natural resistência e dificuldade ao uso de códigos e scripts</p></li>
<li><p>scripts favorecem a <strong>automatização</strong> e <strong>reprodutibilidade</strong></p></li>
</ul></li>
</ul>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/s3JldKoA0zw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</center>
<pre><code>- força você a ter um conhecimneto mais aprofundado do que está fazendo</code></pre>
<ul>
<li><p><a href="https://pt.wikipedia.org/wiki/Reprodutibilidade">Reprodutibilidade</a></p>
<ul>
<li><p>qualquer pessoa (inclusive você mesmo no futuro) pode obter os mesmos resultados do mesmo conjunto de dados</p></li>
<li><p>R é integrado com <a href="https://cran.r-project.org/web/views/ReproducibleResearch.html">outras ferramentas</a> de que permitem atualizar seus resultados, figuras e análises automaticamente</p></li>
<li><p><a href="https://rmarkdown.rstudio.com/articles_intro.html">Relatório dinâmicos</a> e <a href="http://shiny.rstudio.com/">interativos</a></p></li>
</ul></li>
<li><p>Acesso ao estado da arte da ciência de dados (<em>Big Data</em>, <em>Data Mining</em>, <em>Machine Learning</em>)</p></li>
<li><p>é um software livre, de código fonte aberto e funciona em diversos sistemas operacionais (Linux, Windows e MacOS).</p></li>
<li><p>Interface com Fortran, C, C++, Python</p></li>
<li><p><a href="https://cran.r-project.org/web/views/Graphics.html">Visualização de dados</a></p>
<ul>
<li>R produz <a href="https://timogrossenbacher.ch/2016/12/beautiful-thematic-maps-with-ggplot2-only/">gráficos de alta qualidade</a></li>
</ul></li>
<li><p>R trabalha com dados de todas formas e tamanhos</p></li>
<li><p>Extensões para <a href="http://blog.rstudio.org/2014/07/22/introducing-tidyr/">Manipulação de dados</a></p></li>
</ul>
</div>
<div id="pacotes-da-comunidade-do-r" class="section level2">
<h2><span class="header-section-number">1.7</span> Pacotes da comunidade do R</h2>
Evolução do nº de pacotes disponíveis no <a href="http://cran.r-project.org/mirrors.html">CRAN</a>
</style>
<div class="midcenter" style="margin-left:10px; margin-top:10px;">
<p><img src="images/number-of-submitted-packages-to-CRAN.png" height="350px" width="400px" /></p>
</div>
<!--
A meteorologia é 4D: 

```r
meteorologia <- function(x, y, z, t){
  ...muita coisa para caber em um slide...
}
```

Logo, requer ferramentas específicas para:
 
* manipulação de dados espacias
 
* análise de séries temporais
 
* importação e ferramentas de [SIG](https://pt.wikipedia.org/wiki/Sistema_de_informa%C3%A7%C3%A3o_geogr%C3%A1fica)

* leitura de dados em formatos específicos ([netcdf](https://en.wikipedia.org/wiki/NetCDF), [binários](https://en.wikipedia.org/wiki/Binary_file), [grib2](https://en.wikipedia.org/wiki/GRIB), ...)

-->
</div>
<div id="r-não-é-perfeito" class="section level2">
<h2><span class="header-section-number">1.8</span> R não é perfeito!</h2>
<ul>
<li><p>Muitos códigos em R são escritos para resolver um problema;</p>
<ul>
<li>foco nos resultados e não no processo</li>
<li>usuários não são programadores</li>
<li>códigos deselegantes, lentos e difíceis de entender</li>
</ul></li>
<li><p>Como o nosso idioma, há muitas exceções para serem lembradas</p></li>
<li><p>R não é muito rápido e códigos mal escritos serão lentos</p></li>
<li><p>São apenas ~20 anos de evolução</p></li>
<li><p>Há muito o que melhorar</p></li>
</ul>
</div>
<div id="no-final-deste-curso" class="section level2">
<h2><span class="header-section-number">1.9</span> No final deste curso …</h2>
<div class="figure" style="text-align: center">
<img src="images/practical_dev_both.png" alt="Livros para maestria em programação." width="100%" />
<p class="caption">
(#fig:books-joke)Livros para maestria em programação.
</p>
</div>
</div>
<div id="para-saber-mais-sobre-o-r" class="section level2">
<h2><span class="header-section-number">1.10</span> Para saber mais sobre o R</h2>
<p><a href="http://cran.r-project.org/manuals.html"><strong>Documentação oficial</strong></a>
- <a href="https://cran.r-project.org/other-docs.html">Manuais do R traduzidos</a></p>
<p><a href="http://www.r-project.org/doc/bib/R-books.html"><strong>Lista de Livros relacionados ao R</strong></a></p>
<ul>
<li><a href="https://github.com/vhf/free-programming-books/blob/master/free-programming-books.md#r">Livros gratuitos</a> (em inglês)</li>
</ul>
<!-- 
https://simplystatistics.org/2018/07/12/use-r-keynote-2018/ 
-->
<p><strong>Fóruns:</strong></p>
<ul>
<li><p>lista Brasileira de discussão do programa R: <a href="https://listas.inf.ufpr.br/cgi-bin/mailman/listinfo/r-br"><strong>R-br</strong></a></p></li>
<li><p><a href="http://stackoverflow.com/questions/tagged/r">stackoverflow</a>
<br/></p></li>
</ul>
<!--chapter:end:01-introducao.Rmd-->
</div>
</div>
<div id="part-configuração-do-sistema" class="section level1 unnumbered">
<h1>(PART) Configuração do Sistema</h1>
</div>
<div id="pré-requisitos" class="section level1">
<h1><span class="header-section-number">2</span> Pré-requisitos</h1>
<!-- 
-->
<!-- 
# TOP formato de curso
https://uomresearchit.github.io/r-tidyverse-intro/
https://github.com/UoMResearchIT/r-tidyverse-intro


http://ohi-science.org/data-science-training/
https://github.com/lhmet-forks/data-science-training
https://github.com/NCEAS/oss-lessons
http://ohi-science.org/toolbox-training/index.html
https://github.com/ohi-science/toolbox-training



# Reproducible Analysis With R
https://github.com/NCEAS/sasap-training/tree/master/materials/reproducible-analysis-in-r 
https://datacarpentry.org/rr-workshop/

https://ropensci.org/blog/2019/07/11/commcall-jul2019/


https://github.com/lhmet-forks/r-eda-gapminder 
https://github.com/cambiotraining/r-intro/tree/master 
https://datacarpentry.org/R-ecology-lesson/00-before-we-start.html
-->
<p>Para tirar melhor proveito deste livro, você precisará:</p>
<ol style="list-style-type: decimal">
<li><p>Das <strong>versões atualizadas</strong> do</p>
<ul>
<li><p><img src="images/logo_r.png" width="20">: <a href="https://cloud.r-project.org" class="uri">https://cloud.r-project.org</a></p>
<ul>
<li>se estiver em SO Windows também precisará do programa
<a href="https://cran.r-project.org/bin/windows/Rtools/index.html">Rtools</a>.</li>
</ul></li>
<li><p>RStudio: <a href="https://rstudio.com/download" class="uri">https://rstudio.com/download</a></p></li>
<li><p>Git: <a href="https://git-scm.com/downloads" class="uri">https://git-scm.com/downloads</a><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p></li>
</ul></li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>Criar uma conta GitHub: <a href="https://github.com" class="uri">https://github.com</a>.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></li>
</ol>
<ol start="3" style="list-style-type: decimal">
<li>Criar uma conta no <a href="https://rstudio.cloud" class="uri">https://rstudio.cloud</a>.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></li>
</ol>
<div id="install" class="section level2">
<h2><span class="header-section-number">2.1</span> Instalação do R e RStudio</h2>
<p>A interação do usuário com o <img src="images/logo_r.png" width="20"> é por meio da linha de comando. A
interface da linha de comando tem suas vantagens, mas você será mais produtivo
com o uso de uma Interface de Desenvolvimento Integrado (IDE) como o RStudio <em>Desktop</em>.</p>
<p>A seguir veremos como:</p>
<ul>
<li><p>instalar o <img src="images/logo_r.png" width="20"> nos SO Windows e Linux Ubuntu</p></li>
<li><p>manter o <img src="images/logo_r.png" width="20"> sempre atualizado no Linux Ubuntu</p></li>
<li><p>configurar um diretório para armazenar os pacotes do R instalados</p></li>
<li><p>instalar pacotes</p></li>
<li><p>instalar o RStudio <em>Desktop</em></p></li>
</ul>
<p>Neste livro, o maior foco na instalação do <img src="images/logo_r.png" width="20"> é dada para o SO Linux <a href="https://pt.wikipedia.org/wiki/Ubuntu">Ubuntu</a>, pelo fato de assim como o R,
ser um software livre e de código aberto. Como o Linux Ubuntu é baseado no <a href="https://pt.wikipedia.org/wiki/Debian">Debian</a> o procedimento de instalação
também se estende a essa distribuição Linux e as <a href="https://pt.wikipedia.org/wiki/Ubuntu#Projetos_derivados">versões derivadas do Ubuntu</a> oficialmente reconhecidas.</p>
<p>A instalação no SO Windows é igual a instalação de qualquer outro <em>software</em> e
pode ser facilmente encontrada na internet. Por esta razão, somente indicou-se
o caminho de instalação.</p>
<div id="instalando-o-r" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Instalando o R</h3>
<p>O <img src="images/logo_r.png" width="20"> pode ser instalado a partir dos <a href="https://cran.r-project.org/bin/">binários pré-compilados</a> ou do <a href="https://cran.r-project.org/sources.html">código fonte</a>. Nós veremos a instalação do <img src="images/logo_r.png" width="20"> a partir dos arquivos binários.</p>
<div id="windows" class="section level4">
<h4><span class="header-section-number">2.1.1.1</span> Windows</h4>
<p>O binário executável do <img src="images/logo_r.png" width="20"> para o Windows está disponível na <strong>Rede Abrangente de Arquivos do <img src="images/logo_r.png" width="20"></strong> (<a href="https://cran.r-project.org/">CRAN</a>) e
pode ser baixado <a href="http://cran.r-project.org/bin/windows/base/">aqui</a>.</p>
<p>Abra o executável e siga instruções de instalação mantendo todas as opções
padrões.</p>
<p>No Windows a instalação do <img src="images/logo_r.png" width="20"> inclui uma Interface Gráfica do Usuário
(GUI) acessível pelo executável <code>RGui.exe</code> (Figura @ref(fig:r-gui)). Um atalho para esse executável é gerado por <em>default</em> na área de trabalho com o símbolo
do <img src="images/logo_r.png" width="20">.</p>
<div class="figure">
<img src="images/rgui-windows.png" alt="Interface gráfica do usuário no R para Windows." width="100%" />
<p class="caption">
(#fig:r-gui)Interface gráfica do usuário no R para Windows.
</p>
</div>
<p>Para instalar pacotes de plataformas diferentes da CRAN (veja seção @ref(install-github)) é necessário instalar o programa <a href="https://cran.r-project.org/bin/windows/Rtools/index.html">Rtools</a>,
selecionando a versão adequada para sua versão do <img src="images/logo_r.png" width="20">.</p>
<div id="atualização-do-r-no-windows" class="section level5">
<h5><span class="header-section-number">2.1.1.1.1</span> Atualização do R no Windows</h5>
<p>Novas versões do R são disponibilizadas em geral com frequência de 5 vezes
por ano. Recomenda-se manter o R atualizado, pois as novas versões incluem <a href="https://cran.r-project.org/bin/windows/base/NEWS.R-4.0.0.html">aperfeiçoamentos e a correção de <em>bugs</em></a>.</p>
<p>As novas versões do <img src="images/logo_r.png" width="20"> vem com os <a href="https://cran.r-project.org/doc/manuals/R-FAQ.html#Which-add_002don-packages-exist-for-R_003f">pacotes padrões do R</a>. Os demais pacotes instalados pelo usuário na versão anterior precisam ser reinstalados.</p>
<p>Para atualizar o <img src="images/logo_r.png" width="20"> no Windows, ao invés de baixar o executável a
cada nova versão e repetir o processo da seção anterior, você pode utilizar o pacote <a href="https://cran.r-project.org/web/packages/installr/index.html"><strong>installr</strong></a>. A instalação de pacotes no <img src="images/logo_r.png" width="20"> será vista na seção @ref(install-pck).</p>
</div>
</div>
<div id="linux" class="section level4">
<h4><span class="header-section-number">2.1.1.2</span> Linux</h4>
<div id="ubuntu" class="section level5">
<h5><span class="header-section-number">2.1.1.2.1</span> Ubuntu</h5>
<!-- 
#install the automatically tuned Atlas or the multi-threaded OpenBlas library in order to get higher performance for linear algebra operations
sudo apt-get install libatlas3-base libopenblas-base

link da cran sobre instalação do R no ubuntu
https://cran.rstudio.com/bin/linux/ubuntu/README.html 

# PPA
https://rubuntu.netlify.app/post/2018-05-25-announcing-c2d4u3-5/

# problemas com rjava
https://askubuntu.com/questions/1053726/r-cannot-install-rjava-what-is-r-api-3-4

sudo add-apt-repository ppa:marutter/c2d4u3.5
sudo apt update
sudo apt install r-cran-rjava

-->
<p>Há várias formas de instalar o <img src="images/logo_r.png" width="20"> no Ubuntu. Mas primeiro, caso você
tenha alguma versão antiga do R, desinstale-a com:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1">$ <span class="fu">sudo</span> apt-get remove r-base-core</a></code></pre></div>
<p>A forma mais fácil de instalar o <img src="images/logo_r.png" width="20"> é usar a versão compilada no
repositório <em>default</em> do Ubuntu.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1">$ <span class="fu">sudo</span> apt-get install r-base</a></code></pre></div>
<p>Entretanto, como o R é um projeto de evolução rápida, a versão estável mais recente<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> não está disponível nos repositórios do Ubuntu. Dessa forma, não conseguimos usufruir dos pacotes mais recentes
(ou em desenvolvimento), que geralmente incluem o estado da arte da ciência de dados. Por esta razão, vamos instalar a última versão do <img src="images/logo_r.png" width="20"> e de forma
que seja atualizado automaticamente pelo sistema. Isto pode ser feito com os comandos a seguir.</p>
<ol style="list-style-type: decimal">
<li>Incluímos o endereço do repositório externo mantido pelo CRAN<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>
à lista de repositórios do sistema.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1">$ <span class="fu">sudo</span> touch /etc/apt/sources.list.d/cran.list</a>
<a class="sourceLine" id="cb4-2" title="2">$ <span class="fu">sudo</span> sh -c <span class="st">&quot;echo &#39;deb https://cloud.r-project.org/bin/linux/ubuntu </span><span class="kw">`</span><span class="ex">lsb_release</span> -sc<span class="kw">`</span><span class="st">-cran35/&#39; &gt;&gt; /etc/apt/sources.list.d/cran.list&quot;</span> </a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Adicionamos a chave de autenticação<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> do repositório.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1">$ <span class="fu">sudo</span> apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9</a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Atualizamos a lista de repositórios do sistema.</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1"><span class="fu">sudo</span> apt-get update</a></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Instalamos o R</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1">$ <span class="fu">sudo</span> apt-get install -y r-base r-base-dev </a></code></pre></div>
<!-- 
##### R sempre atualizado 

Se você quer trabalhar sempre com a última versão estável do <img src="images/logo_r.png" width="20">, é possível configurar o Linux Ubuntu para atualizar automaticamente o <img src="images/logo_r.png" width="20">. O procedimento de instalação requer senha de superusuário do sistema ou de privilégios [sudo](https://en.wikipedia.org/wiki/Sudo). Caso não tenha, consulte o administrador do sistema.

Ao utilizar distribuições Linux Ubuntu é importante optar por versões estáveis[^versoesubuntu]. As versões de Suporte de Longo Prazo (LTS) mais recentes são:

- 14.04: `trusty` 
- 16.04: `xenial`
- 18.04: `bionic`

[^versoesubuntu]: Clique [aqui](https://wiki.ubuntu.com/Releases) para saber mais sobre as versões do Ubuntu.

 
A versão mais atual é a 4.0.0. Para que ele seja atualizado automaticamente no Ubuntu você precisa adicionar o endereço https://cloud.r-project.org/bin/linux/ubuntu que automaticamente redireciona para o espelho da CRAN mais próximo à lista de repositórios do Linux.

###### Incluindo repositório do <img src="images/logo_r.png" width="20"> na Lista de repositórios do Ubuntu

O primeiro passo é descobrir o nome da versão UBUNTU instalada. Para isso, você pode utilizar o seguinte comando[^ubuntuname] :



```
$ lsb_release -sc
```
```
bionic
```

[^ubuntuname]: Se o comando `lsb_release` não funcionar você precisa instalar o pacote `lsb-release` no sistema. Para isso, digite no terminal Linux `sudo apt-get install lsb-release`.

O endereço do espelho da CRAN e algumas configurações do sistema podem ser inseridas num arquivo em `/etc/apt/sources.list.d/cran.list`. Essa tarefa requer privilégios de [superusuário](https://pt.wikipedia.org/wiki/Superusu%C3%A1rio). Vamos trocar do seu usuário para o superusuário.

    $ sudo su

Após o comando, informe a senha de superusuário e então vamos criar o arquivo `/etc/apt/sources.list.d/cran.list`.

    # touch /etc/apt/sources.list.d/cran.list

Vamos definir no terminal uma variável chamada `repos` que será composta pelo endereço do espelho[^cran-mirrors], o nome da versão do Ubuntu e o sufixo `-cran35`. Este sufixo é para obter a última versão do pacote R 3.6 para Ubuntu. 

    # repos="deb https://cloud.r-project.org/bin/linux/ubuntu `lsb_release -sc`-cran35/"
    
[^cran-mirrors]: Usando https://cloud.r-project.org automaticamente redireciona para o espelho da CRAN mais próximo. A lista de espelhos atual encontra-se em https://cran.r-project.org/mirrors.html.

O valor da variável `repos` é mostrado pelo comando: `echo $repos`. Certifique-se de que a última palavra corresponde ao nome da sua versão Ubuntu.


Adicionamos o conteúdo da `repos` ao arquivo cran.list usando o comando:

    # echo $repos >> /etc/apt/sources.list.d/cran.list

Assim o gerenciador de pacotes 
[apt](http://pt.wikipedia.org/wiki/Advanced_Packaging_Tool)[^wikiped-apt] fará a atualização do <img src="images/logo_r.png" width="20"> quando uma nova versão estiver disponível. Ou seja, você estará utilizando sempre versão mais atual do <img src="images/logo_r.png" width="20">.

[^wikiped-apt]: o gerenciador de pacotes [apt](http://pt.wikipedia.org/wiki/Advanced_Packaging_Tool) é usado para instalação, atualização e remoção de pacotes em distribuições Debian GNU/Linux.


Feito isso, você podemos retornar a sessão de usuário comum:

    # exit


###### [APT protegido](https://cran.r-project.org/bin/linux/ubuntu/README.html#secure-apt) 

Os arquivos binários do <img src="images/logo_r.png" width="20"> para Ubuntu na [CRAN](http://cran.r-project.org) são assinados com uma chave pública [^pub-key]. Para adicionar essa chave ao seu sistema digite os seguintes comandos:

    $ gpg --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9

    $ gpg -a --export E298A3A825C0D65DFD57CBB651716619E084DAB9 | sudo apt-key add -

[^pub-key]: Chave pública de autenticação é um meio alternativo de se logar em um servidor ao invés de digitar uma senha. É uma forma mais segura e flexível, mas mais difícil de ser configurada. Esse meio alternativo de fazer login é importante se o computador está visível na internet. Para saber mais veja [aqui](http://the.earth.li/~sgtatham/putty/0.55/htmldoc/Chapter8.html).

Se aparecer uma mensagem **OK** a chave foi adicionada com sucesso e os comandos a seguir podem ignorados. Porém, se aparecer uma mensagem do tipo *keyserver error*, utilize o seguinte comando:

    $ sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9

Caso seja impresso alguma mensagem de erro, outra alternativa pode ser usada para obter a chave, via os comandos:

    $ gpg --keyserver keyserver.ubuntu.com --recv-key E298A3A825C0D65DFD57CBB651716619E084DAB9
    
    $ gpg -a --export E298A3A825C0D65DFD57CBB651716619E084DAB9 | sudo apt-key add -


###### Atualização da lista de repositórios do Ubuntu e instalação do <img src="images/logo_r.png" width="20">

Após fazer as configurações da lista de repositórios e adicionar a chave é necessário fazer a atualização dessa lista (requer poderes de super usuário):

    $ sudo apt-get update
    
Finalmente, instalamos o binário do R, a coleção de pacotes recomendados e ferramentas de desenvolvimento:

    $ sudo apt-get -y install r-base r-base-dev
-->
<!---
referências

https://www.digitalocean.com/community/tutorials/how-to-install-r-on-ubuntu-18-04

https://askubuntu.com/questions/218708/installing-latest-version-of-r-base

 https://stackoverflow.com/questions/46704247/upgrade-r-in-ubuntu-xenial
 https://gist.github.com/mGalarnyk/41c887e921e712baf86fecc507b3afc7
 https://askubuntu.com/questions/1162051/i-am-unable-to-install-latest-version-of-r 
 https://rtask.thinkr.fr/installation-of-r-3-5-on-ubuntu-18-04-lts-and-tips-for-spatial-packages/
 https://yiweiniu.github.io/blog/2019/07/Install-Update-R-and-R-packages/
 https://shiny.rstudio.com/articles/upgrade-R.html

# for r dev packages
sudo add-apt-repository ppa:marutter/rrutter3.5
sudo add-apt-repository ppa:marutter/c2d4u
sudo apt-get update
sudo apt-get -y install r-base-core r-recommended r-base-dev

# run apt-get update and then check via apt-cache policy r-base-core
apt-cache policy r-base-core

sudo apt install r-cran-rgl r-cran-rjags r-cran-snow r-cran-ggplot2 r-cran-igraph r-cran-lme4 r-cran-rjava r-cran-devtools r-cran-roxygen2 r-cran-rjava r-cran-xlsx

# pacotes mais usados
c("tidyverse", 
  "data.table",
  "knitr",
  "rstudioapi",
  
  )

rlang > Rcpp > backports > vctrs > glue > tibble > tidyselect> dplyr > purrr
nlme > lattice > broom

‘broom’, ‘dbplyr’, ‘haven’, ‘hms’, ‘modelr’, ‘reprex’, ‘rvest’, ‘tidyr’
--->
<p>Para iniciar o <img src="images/logo_r.png" width="20"> no Linux, digite <code>R</code> no cursor do terminal:</p>
<pre><code>$ R</code></pre>
<p>A partir desse momento já começamos uma sessão no <img src="images/logo_r.png" width="20">. Vamos gerar uma sequência numérica de 1 a 10 e plotá-la.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb9-2" title="2"> [<span class="dv">1</span>]  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">6</span>  <span class="dv">7</span>  <span class="dv">8</span>  <span class="dv">9</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="images/Chunck4-1.png" alt="Gráfico da sequência de 10 números." width="672" />
<p class="caption">
(#fig:Chunck4)Gráfico da sequência de 10 números.
</p>
</div>
<p>Após este teste, podemos sair do <img src="images/logo_r.png" width="20">, sem salvar os dados da seção, com a expressão abaixo:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw">q</span>(<span class="dt">save =</span> <span class="st">&quot;no&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="diretório-para-pacotes-instalados-pelo-usuário" class="section level4">
<h4><span class="header-section-number">2.1.1.3</span> Diretório para pacotes instalados pelo usuário</h4>
<p>Os pacotes que vem com os pacotes <em>r-base</em> e <em>r-recommended</em> são instalados no diretório <code>/usr/lib/R/library</code>. Estes pacotes são atualizados pelo sistema<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> ou usando <code>sudo apt-get update &amp;&amp; sudo apt-get upgrade</code>.</p>
<p>Uma boa prática para os pacotes R instalados pelo usuário é definir um diretório específico. Isso lhe dá mais controle sobre os pacotes do <img src="images/logo_r.png" width="20"> instalados no sistema. Um local sugerido é o <code>/home/usuario/.R/libs</code>. O seu <code>home</code> ou <code>pasta pessoal</code> pode ser obtido com o comando <code>echo $HOME</code>. Para criar o diretório você pode digitar o comando abaixo:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" title="1">$ <span class="fu">mkdir</span> -p <span class="kw">`</span><span class="bu">echo</span> <span class="va">$HOME</span><span class="kw">`</span>/.R/libs/</a></code></pre></div>
<p>Para informar ao <img src="images/logo_r.png" width="20"> onde procurar os pacotes instalados, você precisa criar um arquivo chamado <code>.Renviron</code>, no diretório <code>$HOME</code>, contendo a expressão <code>R_LIBS=/home/usuario/.R/libs/</code>. Você pode fazer isso em um terminal com os comandos:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb12-1" title="1">$ <span class="va">R_LIBS=</span><span class="kw">`</span><span class="bu">echo</span> <span class="va">$HOME</span>/.R/libs/<span class="kw">`</span></a>
<a class="sourceLine" id="cb12-2" title="2">$ <span class="bu">echo</span> <span class="va">$R_LIBS</span> <span class="op">&gt;&gt;</span> <span class="kw">`</span><span class="bu">echo</span> <span class="va">$HOME</span>/.Renviron<span class="kw">`</span></a></code></pre></div>
<p>Esse caminho fica então visível ao <img src="images/logo_r.png" width="20">, o que pode ser verificado executando a função <code>.libPaths()</code> na linha de comando do <img src="images/logo_r.png" width="20">.</p>
<p>Abra o <img src="images/logo_r.png" width="20">:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" title="1">$ <span class="ex">R</span></a></code></pre></div>
<p>e ao digitar:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw">.libPaths</span>()</a>
<a class="sourceLine" id="cb14-2" title="2">[<span class="dv">1</span>] <span class="st">&quot;C:/Users/bitev/Documents/R/win-library/3.6&quot;</span></a>
<a class="sourceLine" id="cb14-3" title="3">[<span class="dv">2</span>] <span class="st">&quot;C:/Program Files/R/R-3.6.3/library&quot;</span>        </a></code></pre></div>
<p>o seu diretório <code>/home/usuario/.R/libs</code><a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a> deve aparecer em primeiro lugar. Indicando que este local tem prioridade para instalação dos pacotes. Caso o diretório deixe de existir os diretórios seguintes serão usados.</p>
</div>
</div>
</div>
<div id="install-pck" class="section level2">
<h2><span class="header-section-number">2.2</span> Instalação de Pacotes</h2>
<p>Um pacote do <img src="images/logo_r.png" width="20"> é uma coleção de funções, dados e documentação que estende as funcionalidades básicas do R, muito além do que se poderia imaginar. Os pacotes são desenvolvidos pela comunidade do <img src="images/logo_r.png" width="20"> formada por vários contribuidores.</p>
<!-- 
http://www.sthda.com/english/wiki/installing-and-using-r-packages 
https://www.datacamp.com/community/tutorials/r-packages-guide
-->
<div id="da-internet" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Da internet</h3>
<div id="install-cran" class="section level4">
<h4><span class="header-section-number">2.2.1.1</span> CRAN</h4>
<p>A forma mais fácil de instalar uma pacote do R é através da função <code>install.packages("nome_do_pacote")</code>.</p>
<p>Por <em>default</em> o pacote informado é instalado a partir do repositório oficial de distribuição de pacotes: a (<a href="https://cran.r-project.org/">CRAN</a>). A CRAN é uma rede de servidores e FTP distribuídas pelo mundo e mantida pela comunidade <img src="images/logo_r.png" width="20">. A <a href="https://www.r-project.org/foundation/">Fundação R</a> coordena a CRAN e estabelece diversos testes para assegurar que os pacotes publicados sigam as <a href="https://cran.r-project.org/web/packages/policies.html">políticas da CRAN</a>.</p>
<p>Agora veremos como instalar um pacote. Como exemplo instalaremos o pacote <a href="https://cran.r-project.org/web/packages/remotes/index.html">remotes</a> que dispõe de funções para instalar pacotes de repositórios remotos, como por exemplo do <a href="https://github.com/">GitHub</a>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;remotes&quot;</span>)</a></code></pre></div>
<!-- 
Package Installation from Remote Repositories, Including 'GitHub'
sudo apt-get libssl-dev 
see https://www.rstudio.com/products/rpackages/devtools/ 
  The OpenSSL library that is required to 
  build git2r was not found. 
  Please install: 
libssl-dev    (package on e.g. Debian and Ubuntu) 
openssl-devel (package on e.g. Fedora, CentOS) 
openssl       (Homebrew package on OS X) 
-->
<p>Para ter acesso as funções disponibilizadas com o pacote você precisa carregar o pacote:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">library</span>(remotes)</a></code></pre></div>
<p>Apesar de precisar só instalar uma vez um pacote, você precisará carregá-lo a cada nova sessão.</p>
<p>Para desinstalar um pacote você pode usar a função <code>remove.packages("nome_do_pacote")</code>.</p>
</div>
<div id="install-github" class="section level4">
<h4><span class="header-section-number">2.2.1.2</span> GitHub e R-forge</h4>
<p>Nem todos pacotes são disponíveis na CRAN. Muitos desenvolvedores disponibilizam seus pacotes em plataformas como o <a href="https://github.com/">GitHub</a> e <a href="https://r-forge.r-project.org/">R-forge</a>. As vezes um pacote pode estar em ambos CRAN e GitHub (ou R-forge), mas a última versão - a de desenvolvimento - é somente disponibilizada no GitHub (ou R-forge).</p>
<p>Para instalar um pacote de um repositório do GitHub usa-se a função <code>install_github()</code> do pacote <strong>remotes</strong>. Portanto, o pacote <strong>remotes</strong> precisa ser sido instalado primeiro (ver seção @ref(install-cran)).</p>
<!-- 
#Antes de instalar o pacote **devtools**, usuários Windows precisam instalar o programa [Rtools](https://cran.r-project.org/bin/windows/Rtools/index.html). 
-->
<p>A função para instalar um pacote do GitHub requer como argumento o <code>nome do usuário/nome do repositório</code>. Por exemplo, para instalar o pacote <code>inmetr</code> do repositório mantido pelo <a href="https://github.com/lhmet">lhmet</a>, usa-se:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">library</span>(remotes)</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co"># instala o pacote inmetr do repositório </span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co"># https://github.com/lhmet/inmetr </span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="kw">install_github</span>(<span class="st">&quot;lhmet/inmetr&quot;</span>)</a></code></pre></div>
<div class="rmdtip">
<p>
Você pode acessar uma função de um pacote instalado com a forma especial <code>pacote::funcao</code>. O trecho de código anterior poderia ser reduzido a:
</p>
<p>
<code>remotes::install_github(“lhmet/inmetr”)</code>
</p>
<p>
Essa forma deixa explícito que estamos usando a função <code>install_github()</code> do pacote <strong>remotes</strong>.
</p>
<p>
As vezes você pode estar com diversos pacotes carregados e eles podem ter funções de mesmo nome. Portanto, essa é a alternativa mais segura de avaliar funções afim de evitar conflitos.
</p>
</div>
<p>Para instalar um pacote num repositório do R-forge, por exemplo o repositório do pacote <a href="https://r-forge.r-project.org/projects/raster/">raster</a>, usa-se:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">install.packages</span>(</a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="st">&quot;raster&quot;</span>,  </a>
<a class="sourceLine" id="cb18-3" title="3">  <span class="dt">repos =</span> <span class="st">&quot;http://R-Forge.R-project.org&quot;</span></a>
<a class="sourceLine" id="cb18-4" title="4">)</a></code></pre></div>
</div>
<div id="arquivo-fonte-local" class="section level4">
<h4><span class="header-section-number">2.2.1.3</span> Arquivo fonte local</h4>
<p>Códigos fonte de pacotes do R são armazenados como arquivos com a extensão <code>.tar.gz</code>. Binários compilados são armazenados com a extensão <code>.zip</code>. Exemplo de arquivos como estes podem ser baixados manualmente da CRAN (veja a seção Downloads em por exemplo, <a href="https://cran.r-project.org/web/packages/remotes/index.html" class="uri">https://cran.r-project.org/web/packages/remotes/index.html</a>), no <a href="https://github.com/r-lib/remotes/releases">GitHub</a> ou R-forge.</p>
<p>Eventualmente um usuário pode instalar um pacote a partir desses arquivos localmente. Isto pode também ser feito com a função <code>install.packages()</code>, especificando o argumento <code>repos = NULL</code> e o argumento <code>pkgs</code> com o caminho do arquivo. Por exemplo:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;remotes_2.1.1.tar.gz&quot;</span>, <span class="dt">repos =</span> <span class="ot">NULL</span>)</a></code></pre></div>
</div>
</div>
<div id="atualização-de-pacotes" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Atualização de pacotes</h3>
<p>Se o seu <img src="images/logo_r.png" width="20"> foi atualizado, os pacotes da versão prévia do <img src="images/logo_r.png" width="20"> devem ser reinstalados para evitar problemas de compatibilidade. O comando abaixo atualiza todos pacotes para a última versão. A opção <code>checkbuild = TRUE</code> reinstala os pacotes que foram construídos uma versão mais antiga que a do <img src="images/logo_r.png" width="20"> atual.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">update.packages</span>(<span class="dt">checkBuilt=</span><span class="ot">TRUE</span>, <span class="dt">ask=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p>Se você usa muitos pacotes, este processo pode tornar-se trabalhoso e problemático, devido a cadeia de dependências de alguns pacotes. Por esta razão, há pacotes para facilitar este processo, como o <a href="https://github.com/GuangchuangYu/rvcheck">rvcheck</a>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;rvcheck&quot;</span>)</a></code></pre></div>
<p>Com o <a href="https://github.com/GuangchuangYu/rvcheck">rvcheck</a> podemos:</p>
<ul>
<li>checar a versão mais recente do R</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">library</span>(rvcheck)</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">check_r</span>()</a></code></pre></div>
<ul>
<li>checar a versão mais atual de um pacote na CRAN, no GitHub ou no Bioconductor</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">check_cran</span>(<span class="st">&#39;dplyr&#39;</span>)</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">check_github</span>(<span class="st">&#39;lhmet/inmetr&#39;</span>)</a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">check_bioc</span>(<span class="st">&#39;EBImage&#39;</span>)</a></code></pre></div>
<p>Por fim, para atualizar todos os pacotes:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">update_all</span>(<span class="dt">check_R =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="rmdtip">
<p>
Se você precisa manter a versão dos seus pacotes em uma nova versão do R, o pacote <a href="https://github.com/MangoTheCat/pkgsnap">pkgsnap</a> é uma solução. Esta opção é útil para evitar que mudanças nas versões dos pacotes possam fazer com que seu código se comporte de maneira diferente.
</p>
</div>
</div>
</div>
<div id="pacotes-necessários-e-dependências" class="section level2">
<h2><span class="header-section-number">2.3</span> Pacotes necessários e dependências</h2>
<p>Ao longo deste livro serão usados diversos pacotes para o processamento de dados ambientais. A maioria dos pacotes não vêm com o <img src="images/logo_r.png" width="20">.</p>
<p>Alguns pacotes dependenm de bibliotecas do Linux e precisamos instalá-las antes da instalação no <img src="images/logo_r.png" width="20">.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb25-1" title="1">$ <span class="fu">sudo</span> apt-get install libnetcdf-dev netcdf-bin libudunits2-dev libssl-dev</a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">pcks &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb26-2" title="2">  <span class="st">&quot;easypackages&quot;</span>,</a>
<a class="sourceLine" id="cb26-3" title="3">  <span class="st">&quot;rmarkdown&quot;</span>,</a>
<a class="sourceLine" id="cb26-4" title="4">  <span class="st">&quot;knitr&quot;</span>,</a>
<a class="sourceLine" id="cb26-5" title="5">  <span class="st">&quot;pander&quot;</span>, </a>
<a class="sourceLine" id="cb26-6" title="6">  <span class="st">&quot;htmlTable&quot;</span>,</a>
<a class="sourceLine" id="cb26-7" title="7">  <span class="st">&quot;styler&quot;</span>,</a>
<a class="sourceLine" id="cb26-8" title="8">  <span class="st">&quot;tidyverse&quot;</span>, </a>
<a class="sourceLine" id="cb26-9" title="9">  <span class="st">&quot;rio&quot;</span>,   <span class="co"># instala readxl, openlxlsx, data.table, foreign, haven, feather, </span></a>
<a class="sourceLine" id="cb26-10" title="10">           <span class="co"># readODS, jsonlite, rmatio</span></a>
<a class="sourceLine" id="cb26-11" title="11">  <span class="st">&quot;writexl&quot;</span>,</a>
<a class="sourceLine" id="cb26-12" title="12">  <span class="st">&quot;microbenchmark&quot;</span>,</a>
<a class="sourceLine" id="cb26-13" title="13">  <span class="st">&quot;ncdf4&quot;</span>,</a>
<a class="sourceLine" id="cb26-14" title="14">  <span class="st">&quot;raster&quot;</span>,</a>
<a class="sourceLine" id="cb26-15" title="15">  <span class="st">&quot;openair&quot;</span>,</a>
<a class="sourceLine" id="cb26-16" title="16">  <span class="st">&quot;lubridate&quot;</span>,</a>
<a class="sourceLine" id="cb26-17" title="17">  <span class="st">&quot;fields&quot;</span>,</a>
<a class="sourceLine" id="cb26-18" title="18">  <span class="st">&quot;viridis&quot;</span>,</a>
<a class="sourceLine" id="cb26-19" title="19">  <span class="st">&quot;WriteXLS&quot;</span>,</a>
<a class="sourceLine" id="cb26-20" title="20">  <span class="st">&quot;gcookbook&quot;</span></a>
<a class="sourceLine" id="cb26-21" title="21">  )</a>
<a class="sourceLine" id="cb26-22" title="22"></a>
<a class="sourceLine" id="cb26-23" title="23">pcks_dev &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb26-24" title="24">  <span class="st">&quot;vembedr&quot;</span>,</a>
<a class="sourceLine" id="cb26-25" title="25">  <span class="st">&quot;inmetr&quot;</span></a>
<a class="sourceLine" id="cb26-26" title="26">)</a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">install.packages</span>(pcks) </a></code></pre></div>
<!-- 
# rJava
https://github.com/hannarud/r-best-practices/wiki/Installing-RJava-(Ubuntu)
# java -version
# sudo R CMD javareconf
$ sudo add-apt-repository ppa:marutter/c2d4u3.5
$ sudo apt-get update
$ sudo apt-get upgrade
The following packages will be upgraded:
  binutils binutils-common binutils-x86-64-linux-gnu gnome-software gnome-software-common gnome-software-plugin-snap libbinutils
  libpulse-mainloop-glib0 libpulse0 libpulse0:i386 libpulsedsp openjdk-11-jdk openjdk-11-jdk-headless openjdk-11-jre
  openjdk-11-jre-headless pulseaudio pulseaudio-module-bluetooth pulseaudio-utils r-cran-boot r-cran-class r-cran-codetools
  r-cran-foreign r-cran-lattice r-cran-mass r-cran-matrix r-cran-mgcv r-cran-nlme r-cran-nnet r-cran-spatial r-cran-survival
  ubuntu-software
31 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
$ sudo apt-get install r-cran-rjava
-->
</div>
<div id="install-rstudio" class="section level2">
<h2><span class="header-section-number">2.4</span> RStudio no Ubuntu</h2>
<p>RStudio é uma empresa que desenvolve ferramentas gratuitas para o <img src="images/logo_r.png" width="20"> e <a href="https://www.rstudio.com/products/">produtos pagos</a> para empresas.</p>
<p>Uma de suas ferramentas gratuitas é o software RStudio <em>Desktop</em> que consiste em um ambiente integrado de desenvolvimento (<a href="http://en.wikipedia.org/wiki/Integrated_development_environment">IDE</a>) construído especificamente para o <img src="images/logo_r.png" width="20">. Ele funciona é multiplataforma (servidores inclusive) e fornece diversos recursos, como a integração com controle de versão e manejo de projetos.</p>
<p>Para instalação da versão do <a href="https://rstudio.com/products/rstudio/#rstudio-desktop">RStudio Desktop</a>, você precisa saber se seu SO é 64 ou 32-bit e a versão do Linux Ubuntu. Essas informações podem ser obtidas, respectivamente, pelos comandos:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb28-1" title="1">$ <span class="fu">arch</span></a></code></pre></div>
<pre><code>x86_64</code></pre>
<p>Se retornar <strong>x86_64</strong> sua máquina é 64-bit.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb30-1" title="1">$ <span class="ex">lsb_release</span> -sr</a></code></pre></div>
<pre><code>18.04</code></pre>
<p>Com essas informações, você pode selecionar o <a href="https://www.rstudio.com/products/rstudio/download/">RStudio</a> adequado para o seu sistema e baixá-lo (Figura @ref(fig:rstudio-download)).</p>
<div class="figure" style="text-align: center">
<img src="images/rstudio-download-with-peek.gif" alt="Opção para baixar o RStudio *Desktop*." width="90%" />
<p class="caption">
(#fig:rstudio-download)Opção para baixar o RStudio <em>Desktop</em>.
</p>
</div>
<p>Ao clicar sobre o arquivo baixado com o botão direito, há a opção de abrir com <em>Ubuntu Software Center</em> e então clicar em <code>instalar</code>. Se no seu sistema não houver esta opção, instale via <strong>terminal</strong><a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> com os seguintes comandos:</p>
<pre><code>$ cd /local/do/arquivo/baixado/rstudio-x.y.zzzz-amd64.deb
$ sudo dpkg -i rstudio-x.y.zzzz-amd64.deb
$ sudo apt-get install -f</code></pre>
<p>Abra o RStudio digitando no terminal:</p>
<pre><code>$ rstudio &amp;</code></pre>
<p>Agora você está pronto para começar a programar em <img src="images/logo_r.png" width="20"> aproveitando as facilidades que o <a href="http://www.rstudio.com/">RStudio</a> oferece.</p>
</div>
<div id="git-e-github" class="section level2">
<h2><span class="header-section-number">2.5</span> Git e Github</h2>
<!-- 
http://ohi-science.org/data-science-training/github.html 
https://www.hostinger.com.br/tutoriais/o-que-github/
-->
<p><a href="https://git-scm.com/book/pt-br/v2/Come%C3%A7ando-Sobre-Controle-de-Vers%C3%A3o">Git</a> é um sistema de controle de versão que permite você rastrear as mudanças feitas em arquivos. Estes arquivos podem ser de qualquer tipo (<code>.R</code>, <code>.Rmd</code>, <code>.doc</code>, <code>.pdf</code>, <code>.xls</code>), mas a visualização das diferenças em arquivos texto é mais fácil (<code>.txt</code>, <code>.csv</code>, <code>.md</code>). Na prática, você verá o <strong><code>git</code></strong> como um conjunto de comandos que você executa na shell.<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a></p>
<p>O <a href="https://github.com/">GitHub</a> é um dos maiores depósitos online de trabalho colaborativo do mundo. Ele é a rede social dos programadores. Nele você pode ver no que eles estão trabalhando, ler facilmente o código deles e fazer sugestões ou alterações. Isso só possível porque sua plataforma inclui um sistema de gerenciamento de projetos e de versões de códigos (<strong><code>git</code></strong>).</p>
<div id="instalação-do-git" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Instalação do <strong><code>git</code></strong></h3>
<p>Acesse <a href="https://git-scm.com/downloads" class="uri">https://git-scm.com/downloads</a> e selecione para baixar a opção do <strong><code>git</code></strong> adequada para seu SO.</p>
<div id="windows-1" class="section level4">
<h4><span class="header-section-number">2.5.1.1</span> Windows</h4>
<p>Para instalar o <strong><code>git</code></strong> proceda a instalação como a de qualquer outro programa, aceitando as opções padrão. Ao terminar, verifique a instalação abrindo o <strong><code>gitbash</code></strong> (acessível no menu iniciar) e digitando <code>git --version</code>.</p>
</div>
<div id="ubuntu-1" class="section level4">
<h4><span class="header-section-number">2.5.1.2</span> Ubuntu</h4>
<p>A instalação do git no Ubuntu pode ser feita com os comandos abaixo:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb34-1" title="1"><span class="co"># atualização da lista de repositórios ubuntu</span></a>
<a class="sourceLine" id="cb34-2" title="2">$ <span class="fu">sudo</span> apt-get update</a>
<a class="sourceLine" id="cb34-3" title="3"><span class="co"># instalação do Git</span></a>
<a class="sourceLine" id="cb34-4" title="4">$ <span class="fu">sudo</span> apt-get install git</a></code></pre></div>
<p>Ao terminar, verifique a instalação digitando num terminal o comando <code>git --version</code>. A versão disponível nos repositórios do Windows 10 x64 quando este livro foi escrito era a <code>gsub("git version ", "", system("git --version", intern = TRUE))</code>.</p>
</div>
<div id="git-no-rstudio" class="section level4">
<h4><span class="header-section-number">2.5.1.3</span> Git no RStudio</h4>
<p>Nesta seção vamos usar a funcionalidade do <strong><code>git</code></strong> através do RStudio. Um procedimento muito comum em um projeto com controle de versão é clonar um repositório do <strong><code>github</code></strong> (repositório remoto) para o seu computador (repositório local). Neste exemplo será usado o repositório remoto <code>lhmet/gittutor-adar</code>. Siga as instruções a seguir para reproduzir este processo.</p>
<p>Abra o RStudio, acesse <em><code>File ▶ New Project ▶ Version Control</code></em> .</p>
<ul>
<li><p>Em <em>Repository URL</em> insira <code>https://github.com/lhmet/gittutor-adar</code></p></li>
<li><p>Em <em>Create project as subdirectory of:</em>: navegue até a pasta onde deseja salvar o diretório que conterá o repositório.<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></p></li>
</ul>
<ul>
<li>Clique em <em>Create Project</em> e siga os passos indicados na Figura @ref(fig:git-proj-rstudio).</li>
</ul>
<div class="figure" style="text-align: center">
<img src="images/anim-setup-git-win.gif" alt="Procedimentos para clonar um repositório do github no seu computador." width="100%" />
<p class="caption">
(#fig:git-proj-rstudio)Procedimentos para clonar um repositório do github no seu computador.
</p>
</div>
<p>Após estes procedimentos você tem o <strong><code>git</code></strong> instalado e já sabe como clonar um repositório do <strong><code>github</code></strong> em um diretório do seu computador.</p>
<!--chapter:end:02-intall-r-rstudio.Rmd-->
</div>
</div>
</div>
</div>
<div id="part-interação" class="section level1 unnumbered">
<h1>(PART) Interação</h1>
</div>
<div id="iu" class="section level1">
<h1><span class="header-section-number">3</span> Interface do Usuário</h1>
<p>Na maior parte do tempo você provavelmente usará o <img src="images/logo_r.png" width="20"> no <strong>modo interativo</strong>: rodando comandos e vendo os resultados.</p>
<p>Eventualmente esse processo pode ser inconveniente. Por exemplo, no caso de uma análise com um código bem extenso e que precisa ser repetida com dados atualizados semanalmente. Nessa situação, recomenda-se a criação de um script, ou seja, um arquivo texto, com a extensão <code>.R</code>, contendo o código de sua análise.</p>
<p>Esse <em>script</em> pode ser executado pelo R no <strong>modo de processamento em lote</strong> (do termo em inglês <em>Batch Processing</em>) através de um terminal do SO Linux, ou via o <em>Prompt</em> de comando (<code>cmd.exe</code>) do SO Windows.</p>
<p>Nesta seção apresenta-se ao leitor estes dois modos de execução do <img src="images/logo_r.png" width="20">.</p>
<div id="r-no-modo-interativo" class="section level2">
<h2><span class="header-section-number">3.1</span> R no modo interativo</h2>
<p>No Linux o <img src="images/logo_r.png" width="20"> pode ser aberto simplesmente digitando em um terminal a letra <code>R</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb35-1" title="1">$ <span class="ex">R</span></a></code></pre></div>
<pre><code>R version 3.6.3 (2020-02-29) -- &quot;Holding the Windsock&quot;
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#39;license()&#39; or &#39;licence()&#39; for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type &#39;contributors()&#39; for more information and
&#39;citation()&#39; on how to cite R or R packages in publications.

Type &#39;demo()&#39; for some demos, &#39;help()&#39; for on-line help, or
&#39;help.start()&#39; for an HTML browser interface to help.
Type &#39;q()&#39; to quit R.

&gt;</code></pre>
<p>A janela com a linha de comando do <img src="images/logo_r.png" width="20"> apresenta o <em>prompt</em> do <img src="images/logo_r.png" width="20"> (<code>&gt;</code>). Após este símbolo digitamos os comandos, pressionamos a tecla <code>&lt;enter&gt;</code>, o <img src="images/logo_r.png" width="20"> interpreta o comando e retorna o resultado.</p>
<p>Os comandos digitados na linha de comando são chamados de expressões. Esse é o modo iterativo do <img src="images/logo_r.png" width="20">. Portanto, a linha de comando é a mais importante ferramenta do <img src="images/logo_r.png" width="20">, pois todas expressões são avaliadas através dela.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="dv">62</span> <span class="op">+</span><span class="st"> </span><span class="dv">38</span></a>
<a class="sourceLine" id="cb37-2" title="2">[<span class="dv">1</span>] <span class="dv">100</span></a></code></pre></div>
<p>A expressão é avaliada pelo <img src="images/logo_r.png" width="20">, o resultado é mostrado, mas o seu valor é perdido.</p>
<p>O número entre colchetes que aparece como resultado da operação (“[1]” no caso acima) indica o conteúdo resultante da operação iniciando na posição 1 desse objeto. O significado dessa informação torna-se mais óbvio quando trabalhamos com objetos maiores, como por exemplo com vetores. Observe os valores nos colchetes para uma sequência de 100 até 1.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span><span class="op">:</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb38-2" title="2">  [<span class="dv">1</span>] <span class="dv">100</span>  <span class="dv">99</span>  <span class="dv">98</span>  <span class="dv">97</span>  <span class="dv">96</span>  <span class="dv">95</span>  <span class="dv">94</span>  <span class="dv">93</span>  <span class="dv">92</span>  <span class="dv">91</span>  <span class="dv">90</span>  <span class="dv">89</span>  <span class="dv">88</span>  <span class="dv">87</span>  <span class="dv">86</span>  <span class="dv">85</span>  <span class="dv">84</span>  <span class="dv">83</span></a>
<a class="sourceLine" id="cb38-3" title="3"> [<span class="dv">19</span>]  <span class="dv">82</span>  <span class="dv">81</span>  <span class="dv">80</span>  <span class="dv">79</span>  <span class="dv">78</span>  <span class="dv">77</span>  <span class="dv">76</span>  <span class="dv">75</span>  <span class="dv">74</span>  <span class="dv">73</span>  <span class="dv">72</span>  <span class="dv">71</span>  <span class="dv">70</span>  <span class="dv">69</span>  <span class="dv">68</span>  <span class="dv">67</span>  <span class="dv">66</span>  <span class="dv">65</span></a>
<a class="sourceLine" id="cb38-4" title="4"> [<span class="dv">37</span>]  <span class="dv">64</span>  <span class="dv">63</span>  <span class="dv">62</span>  <span class="dv">61</span>  <span class="dv">60</span>  <span class="dv">59</span>  <span class="dv">58</span>  <span class="dv">57</span>  <span class="dv">56</span>  <span class="dv">55</span>  <span class="dv">54</span>  <span class="dv">53</span>  <span class="dv">52</span>  <span class="dv">51</span>  <span class="dv">50</span>  <span class="dv">49</span>  <span class="dv">48</span>  <span class="dv">47</span></a>
<a class="sourceLine" id="cb38-5" title="5"> [<span class="dv">55</span>]  <span class="dv">46</span>  <span class="dv">45</span>  <span class="dv">44</span>  <span class="dv">43</span>  <span class="dv">42</span>  <span class="dv">41</span>  <span class="dv">40</span>  <span class="dv">39</span>  <span class="dv">38</span>  <span class="dv">37</span>  <span class="dv">36</span>  <span class="dv">35</span>  <span class="dv">34</span>  <span class="dv">33</span>  <span class="dv">32</span>  <span class="dv">31</span>  <span class="dv">30</span>  <span class="dv">29</span></a>
<a class="sourceLine" id="cb38-6" title="6"> [<span class="dv">73</span>]  <span class="dv">28</span>  <span class="dv">27</span>  <span class="dv">26</span>  <span class="dv">25</span>  <span class="dv">24</span>  <span class="dv">23</span>  <span class="dv">22</span>  <span class="dv">21</span>  <span class="dv">20</span>  <span class="dv">19</span>  <span class="dv">18</span>  <span class="dv">17</span>  <span class="dv">16</span>  <span class="dv">15</span>  <span class="dv">14</span>  <span class="dv">13</span>  <span class="dv">12</span>  <span class="dv">11</span></a>
<a class="sourceLine" id="cb38-7" title="7"> [<span class="dv">91</span>]  <span class="dv">10</span>   <span class="dv">9</span>   <span class="dv">8</span>   <span class="dv">7</span>   <span class="dv">6</span>   <span class="dv">5</span>   <span class="dv">4</span>   <span class="dv">3</span>   <span class="dv">2</span>   <span class="dv">1</span></a></code></pre></div>
<p>O elemento <code>[18]</code> da sequência de 100 até 1 é o número <code>83</code>.</p>
<p>Pode ocorrer da expressão digitada na linha ser muito extensa e ir além de uma linha. Se a expressão estiver incompleta o <img src="images/logo_r.png" width="20"> mostra um sinal de <code>+</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span> <span class="op">*</span><span class="st"> </span><span class="dv">8</span> <span class="op">*</span><span class="st"> </span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb39-3" title="3">[<span class="dv">1</span>] <span class="dv">3628800</span></a></code></pre></div>
<p>Execute a expressão abaixo até o sinal de menos e tecle <code>&lt;enter&gt;</code>. Enquanto a instrução não estiver completa o sinal de <code>+</code> se repetirá. Você pode cancelar a execução digitando <code>Ctrl + c</code> ou <code>Esc</code>. No código abaixo isso acontecerá até que você digite o número que deseja subtrair de 4, no caso de o número 3.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">-</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="op">+</span><span class="st">   </span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="op">+</span><span class="st">   </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb40-4" title="4">[<span class="dv">1</span>] <span class="dv">1</span></a></code></pre></div>
<div id="expressInSeq" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Expressões em sequência</h3>
<p>Podemos executar todas expressões anteriores em apenas uma linha, usando o ponto e vírgula <code>;</code> para separar as expressões:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="dv">62</span> <span class="op">+</span><span class="st"> </span><span class="dv">38</span>; <span class="dv">100</span><span class="op">:</span><span class="dv">1</span>; <span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span> <span class="op">*</span><span class="st"> </span><span class="dv">8</span> <span class="op">*</span><span class="st"> </span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span>; <span class="dv">4</span> <span class="op">-</span><span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb41-2" title="2">[<span class="dv">1</span>] <span class="dv">100</span></a>
<a class="sourceLine" id="cb41-3" title="3">  [<span class="dv">1</span>] <span class="dv">100</span>  <span class="dv">99</span>  <span class="dv">98</span>  <span class="dv">97</span>  <span class="dv">96</span>  <span class="dv">95</span>  <span class="dv">94</span>  <span class="dv">93</span>  <span class="dv">92</span>  <span class="dv">91</span>  <span class="dv">90</span>  <span class="dv">89</span>  <span class="dv">88</span>  <span class="dv">87</span>  <span class="dv">86</span>  <span class="dv">85</span>  <span class="dv">84</span>  <span class="dv">83</span></a>
<a class="sourceLine" id="cb41-4" title="4"> [<span class="dv">19</span>]  <span class="dv">82</span>  <span class="dv">81</span>  <span class="dv">80</span>  <span class="dv">79</span>  <span class="dv">78</span>  <span class="dv">77</span>  <span class="dv">76</span>  <span class="dv">75</span>  <span class="dv">74</span>  <span class="dv">73</span>  <span class="dv">72</span>  <span class="dv">71</span>  <span class="dv">70</span>  <span class="dv">69</span>  <span class="dv">68</span>  <span class="dv">67</span>  <span class="dv">66</span>  <span class="dv">65</span></a>
<a class="sourceLine" id="cb41-5" title="5"> [<span class="dv">37</span>]  <span class="dv">64</span>  <span class="dv">63</span>  <span class="dv">62</span>  <span class="dv">61</span>  <span class="dv">60</span>  <span class="dv">59</span>  <span class="dv">58</span>  <span class="dv">57</span>  <span class="dv">56</span>  <span class="dv">55</span>  <span class="dv">54</span>  <span class="dv">53</span>  <span class="dv">52</span>  <span class="dv">51</span>  <span class="dv">50</span>  <span class="dv">49</span>  <span class="dv">48</span>  <span class="dv">47</span></a>
<a class="sourceLine" id="cb41-6" title="6"> [<span class="dv">55</span>]  <span class="dv">46</span>  <span class="dv">45</span>  <span class="dv">44</span>  <span class="dv">43</span>  <span class="dv">42</span>  <span class="dv">41</span>  <span class="dv">40</span>  <span class="dv">39</span>  <span class="dv">38</span>  <span class="dv">37</span>  <span class="dv">36</span>  <span class="dv">35</span>  <span class="dv">34</span>  <span class="dv">33</span>  <span class="dv">32</span>  <span class="dv">31</span>  <span class="dv">30</span>  <span class="dv">29</span></a>
<a class="sourceLine" id="cb41-7" title="7"> [<span class="dv">73</span>]  <span class="dv">28</span>  <span class="dv">27</span>  <span class="dv">26</span>  <span class="dv">25</span>  <span class="dv">24</span>  <span class="dv">23</span>  <span class="dv">22</span>  <span class="dv">21</span>  <span class="dv">20</span>  <span class="dv">19</span>  <span class="dv">18</span>  <span class="dv">17</span>  <span class="dv">16</span>  <span class="dv">15</span>  <span class="dv">14</span>  <span class="dv">13</span>  <span class="dv">12</span>  <span class="dv">11</span></a>
<a class="sourceLine" id="cb41-8" title="8"> [<span class="dv">91</span>]  <span class="dv">10</span>   <span class="dv">9</span>   <span class="dv">8</span>   <span class="dv">7</span>   <span class="dv">6</span>   <span class="dv">5</span>   <span class="dv">4</span>   <span class="dv">3</span>   <span class="dv">2</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb41-9" title="9">[<span class="dv">1</span>] <span class="dv">3628800</span></a>
<a class="sourceLine" id="cb41-10" title="10">[<span class="dv">1</span>] <span class="dv">1</span></a></code></pre></div>
</div>
<div id="navegação-entre-as-expressões-já-avaliadas" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Navegação entre as expressões já avaliadas</h3>
<p>Você pode usar as teclas ↑ e ↓ para navegar entre as expressões já avaliadas pelo <img src="images/logo_r.png" width="20">. O que é útil quando precisamos repetir um comando anterior com alguma mudança ou para corrigir um erro de digitação ou a omissão de um parênteses.</p>
<p>Quando a linha de comando é usada por muito tempo a sua tela pode ficar poluída com a saída das expressões anteriores. Para limpar a tela, tecle <kbd>Ctrl</kbd>+<kbd>l</kbd>. Assim o console aparece na parte superior do terminal.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb42-2" title="2">[<span class="dv">1</span>] <span class="dv">19</span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span><span class="op">:</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb42-4" title="4">  [<span class="dv">1</span>] <span class="dv">100</span>  <span class="dv">99</span>  <span class="dv">98</span>  <span class="dv">97</span>  <span class="dv">96</span>  <span class="dv">95</span>  <span class="dv">94</span>  <span class="dv">93</span>  <span class="dv">92</span>  <span class="dv">91</span>  <span class="dv">90</span>  <span class="dv">89</span>  <span class="dv">88</span>  <span class="dv">87</span>  <span class="dv">86</span>  <span class="dv">85</span>  <span class="dv">84</span>  <span class="dv">83</span></a>
<a class="sourceLine" id="cb42-5" title="5"> [<span class="dv">19</span>]  <span class="dv">82</span>  <span class="dv">81</span>  <span class="dv">80</span>  <span class="dv">79</span>  <span class="dv">78</span>  <span class="dv">77</span>  <span class="dv">76</span>  <span class="dv">75</span>  <span class="dv">74</span>  <span class="dv">73</span>  <span class="dv">72</span>  <span class="dv">71</span>  <span class="dv">70</span>  <span class="dv">69</span>  <span class="dv">68</span>  <span class="dv">67</span>  <span class="dv">66</span>  <span class="dv">65</span></a>
<a class="sourceLine" id="cb42-6" title="6"> [<span class="dv">37</span>]  <span class="dv">64</span>  <span class="dv">63</span>  <span class="dv">62</span>  <span class="dv">61</span>  <span class="dv">60</span>  <span class="dv">59</span>  <span class="dv">58</span>  <span class="dv">57</span>  <span class="dv">56</span>  <span class="dv">55</span>  <span class="dv">54</span>  <span class="dv">53</span>  <span class="dv">52</span>  <span class="dv">51</span>  <span class="dv">50</span>  <span class="dv">49</span>  <span class="dv">48</span>  <span class="dv">47</span></a>
<a class="sourceLine" id="cb42-7" title="7"> [<span class="dv">55</span>]  <span class="dv">46</span>  <span class="dv">45</span>  <span class="dv">44</span>  <span class="dv">43</span>  <span class="dv">42</span>  <span class="dv">41</span>  <span class="dv">40</span>  <span class="dv">39</span>  <span class="dv">38</span>  <span class="dv">37</span>  <span class="dv">36</span>  <span class="dv">35</span>  <span class="dv">34</span>  <span class="dv">33</span>  <span class="dv">32</span>  <span class="dv">31</span>  <span class="dv">30</span>  <span class="dv">29</span></a>
<a class="sourceLine" id="cb42-8" title="8"> [<span class="dv">73</span>]  <span class="dv">28</span>  <span class="dv">27</span>  <span class="dv">26</span>  <span class="dv">25</span>  <span class="dv">24</span>  <span class="dv">23</span>  <span class="dv">22</span>  <span class="dv">21</span>  <span class="dv">20</span>  <span class="dv">19</span>  <span class="dv">18</span>  <span class="dv">17</span>  <span class="dv">16</span>  <span class="dv">15</span>  <span class="dv">14</span>  <span class="dv">13</span>  <span class="dv">12</span>  <span class="dv">11</span></a>
<a class="sourceLine" id="cb42-9" title="9"> [<span class="dv">91</span>]  <span class="dv">10</span>   <span class="dv">9</span>   <span class="dv">8</span>   <span class="dv">7</span>   <span class="dv">6</span>   <span class="dv">5</span>   <span class="dv">4</span>   <span class="dv">3</span>   <span class="dv">2</span>   <span class="dv">1</span></a></code></pre></div>
<p>Para parar ou cancelar a execução de uma expressão utilize <kbd>Ctrl</kbd>+<kbd>c</kbd>.</p>
</div>
<div id="comentarios" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Comentários</h3>
<p>No <img src="images/logo_r.png" width="20">, a cerquilha <code>#</code> (hashtag) é um caractere especial. Qualquer coisa após esse caractere será ignorada pelo <img src="images/logo_r.png" width="20">. Somente as expressões antes da <code>#</code> são avaliadas. Com esse símbolo podemos fazer anotações e comentários no código sem atrapalhar a interpretação das expressões pelo <img src="images/logo_r.png" width="20">.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Comentários de novatos</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="er">&gt;</span><span class="st"> </span><span class="co"># o operador + adiociona o num. da esquerda ao da direita </span></a></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="dv">17</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="co"># como somar números</span></a>
<a class="sourceLine" id="cb44-2" title="2">[<span class="dv">1</span>] <span class="dv">20</span></a></code></pre></div>
<blockquote>
<p>Comentários que não desejo ver você fazendo após este curso:</p>
</blockquote>
<!-- 
https://medium.com/javascript-in-plain-english/part-2-the-most-hilarious-code-comments-ever-9586592e3bec 
-->
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># Não sei por que isso funciona, mas resolve o problema.</span></a>
<a class="sourceLine" id="cb45-2" title="2"></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="co"># rm(list = ls()) # Se esta linha for descomentada o programa explodirá</span></a>
<a class="sourceLine" id="cb45-4" title="4"></a>
<a class="sourceLine" id="cb45-5" title="5"><span class="co"># Este código é péssimo, você sabe e eu sei, mas são 3 horas da manhã e preciso que isso funcione.</span></a>
<a class="sourceLine" id="cb45-6" title="6"></a>
<a class="sourceLine" id="cb45-7" title="7"><span class="co"># Se, futuramente, ler isso, voltarei no tempo e me matarei.</span></a>
<a class="sourceLine" id="cb45-8" title="8"></a>
<a class="sourceLine" id="cb45-9" title="9"><span class="co"># Isto é magia negra de algum link do stackoverflow. Não brinque com magia, ela pode te arrancar pedaço.</span></a>
<a class="sourceLine" id="cb45-10" title="10"></a>
<a class="sourceLine" id="cb45-11" title="11"><span class="co"># Este código funcionou antes, mas meu gato decidiu fazer uma viagem pelo meu teclado ...</span></a>
<a class="sourceLine" id="cb45-12" title="12"></a>
<a class="sourceLine" id="cb45-13" title="13"><span class="co"># Se você está lendo isso, significa que você foi encarregado </span></a>
<a class="sourceLine" id="cb45-14" title="14"><span class="co"># do meu projeto anterior. Eu sinto muito por você. Boa Sorte </span></a>
<a class="sourceLine" id="cb45-15" title="15"><span class="co"># Vá com Deus.</span></a>
<a class="sourceLine" id="cb45-16" title="16"></a>
<a class="sourceLine" id="cb45-17" title="17"><span class="co"># Quando eu escrevi isso, somente Deus e eu entendemos o que estava fazendo. Agora, somente Deus sabe.</span></a>
<a class="sourceLine" id="cb45-18" title="18"></a>
<a class="sourceLine" id="cb45-19" title="19"><span class="co"># Haleluya eu posso ir para casa!</span></a>
<a class="sourceLine" id="cb45-20" title="20"></a>
<a class="sourceLine" id="cb45-21" title="21"><span class="co"># Traduzido e adaptado de</span></a>
<a class="sourceLine" id="cb45-22" title="22"><span class="co"># https://medium.com/javascript-in-plain-english/part-2-the-most-hilarious-code-comments-ever-9586592e3bec </span></a></code></pre></div>
</div>
<div id="auto-preenchimento-de-funções" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Auto preenchimento de funções</h3>
<p>O <img src="images/logo_r.png" width="20"> inclui o preenchimento automático de nomes de funções e arquivos por meio da tecla <code>&lt;tab&gt;</code>. Uma lista de possíveis funções que começam com as letras inicialmente digitadas aparecerão.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="op">&gt;</span><span class="st"> </span>read<span class="co">#&lt;tab&gt; pressione &lt;tab&gt; para ver as opções de comandos que iniciam com o termo read</span></a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="images/screenscast-autocomplete-r.gif" alt="Auto preenchimento de código na linha de comandos do R." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-4)Auto preenchimento de código na linha de comandos do R.
</p>
</div>
</div>
<div id="primeiro-script" class="section level3">
<h3><span class="header-section-number">3.1.5</span> Primeiro <em>script</em></h3>
<p>O trecho de código abaixo apresenta nas primeiras linhas algumas expressões do <img src="images/logo_r.png" width="20"> executadas anteriormente. Mas há também, na segunda parte, códigos para salvar um gráfico de pontos num arquivo <em>pdf</em>. Na última parte do trecho, define-se uma variável <code>x</code> que contém aquela mesma sequência numérica usada no gráfico.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co"># Primeiro script no R</span></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="co">#----------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="co"># cálculos básicos</span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="dv">15</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="dv">1</span><span class="op">:</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb47-6" title="6"><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span> <span class="op">*</span><span class="st"> </span><span class="dv">8</span> <span class="op">*</span><span class="st"> </span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb47-7" title="7"><span class="dv">4</span> <span class="op">-</span><span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb47-8" title="8"><span class="co">#----------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb47-9" title="9"><span class="co"># salvando um gráfico em um arquivo pdf</span></a>
<a class="sourceLine" id="cb47-10" title="10">arquivo_pdf &lt;-<span class="st"> &quot;plot-script1.pdf&quot;</span></a>
<a class="sourceLine" id="cb47-11" title="11"><span class="kw">pdf</span>(arquivo_pdf)        <span class="co"># cria e abre um arquivo pdf</span></a>
<a class="sourceLine" id="cb47-12" title="12"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)             <span class="co"># gera o gráfico</span></a>
<a class="sourceLine" id="cb47-13" title="13"><span class="kw">dev.off</span>()               <span class="co"># fecha o arquivo pdf</span></a>
<a class="sourceLine" id="cb47-14" title="14"><span class="co">#----------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb47-15" title="15"><span class="co"># definindo uma variável x</span></a>
<a class="sourceLine" id="cb47-16" title="16">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb47-17" title="17">x</a></code></pre></div>
<p>Este conjunto de linhas de código, quando inseridos em um arquivo texto<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> formam um primeiro <em>script</em> <img src="images/logo_r.png" width="20">. Este <em>script</em> pode ser executado pelo <img src="images/logo_r.png" width="20"> através da função <code>source()</code>, usando como argumento o caminho para o local do <em>script</em>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw">source</span>(<span class="st">&quot;/home/usuario/adar/script1.R&quot;</span>)</a></code></pre></div>
<p>Este <em>script</em> produzirá como saída o arquivo <code>/home/usuario/adar/plot-script1.pdf</code>. Você pode visualizar o arquivo para conferir o gráficos de pontos gerado.</p>
</div>
</div>
<div id="r-no-modo-de-processamento-em-lote" class="section level2">
<h2><span class="header-section-number">3.2</span> R no modo de processamento em lote</h2>
<p>Para rodar um <em>script</em> no modo de processamento em lote do <img src="images/logo_r.png" width="20"> através do seguinte comando no terminal Linux:</p>
<pre><code>$ R CMD BATCH opcoes arqentrada arqsaida</code></pre>
<p>Onde: <code>arqentrada</code>é o nome do script (arquivo com a extensão <code>.R</code>) a ser executado; <code>arqsaida</code> é o arquivo (com a extensão <code>.Rout</code>) com as saídas dos comandos executados no R; <code>opcoes</code> é a lista de opções que controlam a execução.</p>
<p>Vamos rodar como exemplo, o <code>script1.R</code> da seção @ref(primeiro-script).</p>
<pre><code>$ R CMD BATCH /home/usuario/adar/script1.R</code></pre>
<p>O comando acima, produzirá dois arquivos de saída:</p>
<ol style="list-style-type: decimal">
<li><code>script1.Rout</code><a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a> criado por <em>default</em> quando o <code>arqsaida</code> não é especificado, e;</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>arquivo "plot-script1.pdf".</li>
</ol>
<p>Você pode especificar o nome do <code>arqsaida</code> como desejar. No exemplo abaixo, mostra-se como salvar o arquivo de saída incluindo a data em que ele foi gerado, <code>script1-saida-adatadehoje.log</code>.</p>
<pre><code>$ R CMD BATCH script1.R script1-saida-`date &quot;+%Y%m%d&quot;`.log</code></pre>
<p>Após a execução do último comando, os mesmos arquivos resultantes do comando anterior serão gerados, exceto pelo primeiro (<code>.Rout</code>), que será nomeado <code>script1-saida-20200530.Rout</code>.</p>
<p>Para mais opções do comando <code>R CMD BATCH</code> digite no terminal do Linux <code>R --help</code>.</p>
<!--chapter:end:03-interface-usuario.Rmd-->
</div>
</div>
<div id="rstudio" class="section level1">
<h1><span class="header-section-number">4</span> RStudio</h1>
<!-- 

https://itsfoss.com/install-r-ubuntu/ 

-->
<p>O RStudio <em>Desktop</em> é um ambiente integrado de desenvolvimento (IDE) para o <img src="images/logo_r.png" width="20">. Portanto, o RStudio depende da instalação prévia do <img src="images/logo_r.png" width="20">. Ele funciona como uma interface gráfica do usuário (GUI), mas com muito mais potencialidades.</p>
<p>O RStudio é uma ferramente que potencializará sua interação com o <img src="images/logo_r.png" width="20">:</p>
<ul>
<li><p>na produção de gráficos</p></li>
<li><p>na organização de seu código na forma de projetos</p></li>
<li><p>na reprodutibilidade de seu trabalho ou pesquisa</p></li>
<li><p>na manutenção e criação de seus próprios pacotes do R</p></li>
<li><p>na criação e compartilhamento de seus relatórios</p></li>
<li><p>no compartilhamento de seu código e a colaboração com outros</p></li>
</ul>
<p>Nessa seção você terá uma visão geral do RStudio <em>Desktop</em>.</p>
<div id="visão-geral-do-rstudio" class="section level2">
<h2><span class="header-section-number">4.1</span> Visão geral do RStudio</h2>
<p>Assumindo que o RStudio tenha sido instalado (seção @ref(install-rstudio)), ao abri-lo e clicar em <em><code>File ▶ New File ▶ R Script</code></em> você verá uma tela com aspecto similar ao da Figura @ref(fig:rstudio-fig).</p>
<div class="figure">
<img src="images/rstudio-panels.png" alt="Rstudio" width="960" />
<p class="caption">
(#fig:rstudio-fig)Rstudio
</p>
</div>
<p>O RStudio possui 4 painéis principais:</p>
<ol style="list-style-type: decimal">
<li><p>Editor para scripts e visualização de dados</p>
<ul>
<li><p>abrir e criar scripts</p></li>
<li><p>rodar scripts</p></li>
<li><p>código com sintaxe realçada</p></li>
<li><p>rodar partes do código <kbd>Ctrl</kbd>+<kbd>Enter</kbd></p></li>
<li><p>rodar todo script <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>s</kbd></p></li>
<li><p>autopreenchimento das funções <kbd>Tab</kbd></p></li>
<li><p>comentar linhas de um script <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>c</kbd></p></li>
<li><p>desfazer <kbd>Ctrl</kbd>+<kbd>z</kbd></p></li>
<li><p>refazer <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>z</kbd></p></li>
<li><p>referência para teclas de atalho <kbd>Alt</kbd>+<kbd>Shift</kbd>+<kbd>k</kbd></p></li>
<li><p>abrir script cujo nome aparece no código em visualização no painel <em>Source</em> <kbd>Ctrl</kbd>+<kbd>click</kbd></p></li>
<li><p>buscar e substituir termos <kbd>Ctrl</kbd>+<kbd>f</kbd></p></li>
<li><p>comentar texto em R Markdown <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>c</kbd></p></li>
</ul></li>
<li><p>Console do R</p></li>
<li><p>Navegador do espaço de trabalho e histórico de comandos</p></li>
<li><p>Arquivos/Plots/Pacotes/Ajuda/Visualizador</p></li>
</ol>
<p>Configuração de texto e painéis em:</p>
<ul>
<li>Menus
<em><code>Tools ▶ Global Options ▶ Appearance</code></em>
* mostrar linhas, alterar realce da sintaxe
* Session
* Plots</li>
</ul>
<p>A <strong>Folha de referência do RStudio</strong> (Figura @ref(fig:rstudio-cheat-sheet))) fornece uma visão geral das suas principais funcionalidades.</p>
<div class="figure" style="text-align: center">
<img src="images/print-screen-folha-ref-rstudio.png" alt="Folha de referência do RStudio, disponível em https://www.rstudio.com/wp-content/uploads/2016/03/rstudio-IDE-cheatsheet-portuguese.pdf" width="90%" />
<p class="caption">
(#fig:rstudio-cheat-sheet)Folha de referência do RStudio, disponível em <a href="https://www.rstudio.com/wp-content/uploads/2016/03/rstudio-IDE-cheatsheet-portuguese.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2016/03/rstudio-IDE-cheatsheet-portuguese.pdf</a>
</p>
</div>
</div>
<div id="verificação-ortográfica" class="section level2">
<h2><span class="header-section-number">4.2</span> Verificação ortográfica</h2>
<p>O RStudio oferece o recurso de verificação ortográfica do texto. No caso de línguas diferentes da Inglesa é necessário instalar os dicionários para outras línguas. Os dicionários podem ser instalados indo em <em><code>Tools ▶ Global Options</code></em>, selecionando <em><code>Spelling</code></em> no painel à esquerda e <em><code>Install More Languages</code></em> na caixa de seleção dos dicionários de línguas (Figura @ref(fig:rstudio-spell-config)). Dessa forma, os dicionários de 28 linguagens serão instalados.</p>
<div class="figure" style="text-align: center">
<img src="images/rstutio-spellcheck-more-langs.png" alt="Configuração do RStudio para instalar dicionários de outras línguas." width="80%" />
<p class="caption">
(#fig:rstudio-spell-config)Configuração do RStudio para instalar dicionários de outras línguas.
</p>
</div>
<p>Após a adição dos dicionários, acesse novamente a caixa de seleção de dicionários e selecione <code>Portuguese (Brazil)</code> e depois clique em <code>ok</code> (Figura @ref(fig:rstudio-set-dict)).</p>
<div class="figure" style="text-align: center">
<img src="images/rstudio-dictionarie-sel-ptbr.png" alt="Configuração do dicionário de Portugês-BR  no RStudio." width="80%" />
<p class="caption">
(#fig:rstudio-set-dict)Configuração do dicionário de Portugês-BR no RStudio.
</p>
</div>
<p>Agora você pode evitar erros ortográficos nos seus relatórios e demais documentos escritos em R Markdown através da tecla <code>F7</code> (ou <em><code>Edit ▶ Check Spelling</code></em>).</p>
<!-- rstudio.cloud -->
<!--
### Configurando dicionários customizados 

Se você quer usar um diferente variação de dicionário ou algum dicionário customizado, siga as orientações disponibilizadas no [suporte do RStudio](https://support.rstudio.com/hc/en-us/articles/200551916-Spelling-Dictionaries) e na vinheta do pacote [hunspell](https://docs.ropensci.org/hunspell/articles/intro.html#hunspell-dictionaries).


A instalação do dicionário de Português-brasileiro no Debian ou Ubuntu requer o pacote `hunspell-pt-br`: 


```bash
> sudo apt-get install hunspell-pt-br
```

A verificação de que o dicionário foi instalado pode ser feita se ele aparece listado pelo comando abaixo.


```bash
> ll /usr/share/hunspell
```
-->
<!--chapter:end:04-rstudio.Rmd-->
</div>
</div>
<div id="part-fundamentos-do-r" class="section level1 unnumbered">
<h1>(PART) Fundamentos do R</h1>
<!--
# Boas refrências
http://swcarpentry.github.io/r-novice-gapminder/
https://datacarpentry.org/R-ecology-lesson/
https://swcarpentry.github.io/r-novice-inflammation/06-best-practices-R/index.html
https://github.com/swcarpentry/2013-10-09-canberra
-->
<!--
NAO QUERO SER CHATO

If there’s one piece of advice I wish I could communicate to my past self, it’s “You have permission not to be boring.” Something being boring doesn’t make it necessary: often material is boring because it’s not solving a problem the students have. Something being boring doesn’t make it reliable, either. If students forget what you taught them, they can’t be relied upon to use it well.

In time, students will learn the “boring” material when they need to, during the thousands of hours it takes to become a proficient programmer. An introductory course has a different and important responsibility: to convince people that R is worth learning. And tidyverse packages are a powerful tool towards that goal.
-->
</div>
<div id="operbasic" class="section level1">
<h1><span class="header-section-number">5</span> Operações básicas</h1>
<p>Nesta seção veremos:</p>
<ul>
<li>operações aritméticas básicas com <img src="images/logo_r.png" width="20"></li>
<li>a atribuição de valores a uma variável</li>
<li>o uso de funções matemáticas internas do <img src="images/logo_r.png" width="20"></li>
<li>valores numéricos especiais do <img src="images/logo_r.png" width="20"></li>
<li>os cuidados ao nomear variáveis</li>
</ul>
<div id="convenção" class="section level2">
<h2><span class="header-section-number">5.1</span> Convenção</h2>
<!-- 
tenho que trocar isso de lugar 
-->
<p>A partir deste capítulo, os códigos a serem avaliadas no <img src="images/logo_r.png" width="20"> terão o <em>prompt</em> do <img src="images/logo_r.png" width="20"> (<code>&gt;</code>) omitidos. Essa convenção é para tornar mais fácil a ação de copiar e colar os códigos na linha de comando do <img src="images/logo_r.png" width="20">. O resultado da avaliação das expressões será mostrado precedido do símbolo (<code>#&gt;</code>). Esses valores são os resultados que esperam-se sejam reproduzidos pelo leitor na sessão do <img src="images/logo_r.png" width="20"> em seu computador. Por exemplo:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="co">#&gt; [1] 1 2 3 4 5</span></a></code></pre></div>
<p>No trecho de código acima, a primeira linha contém o código a ser copiado pelo leitor para execução em seu computador. A segunda linha é a saída do código avaliado pelo R.</p>
</div>
<div id="calculadora" class="section level2">
<h2><span class="header-section-number">5.2</span> Calculadora</h2>
<p>O <img src="images/logo_r.png" width="20"> é uma calculadora turbinada com diversas funções matemáticas disponíveis. Para quem não conhece o <img src="images/logo_r.png" width="20">, essa uma forma de familiarizar-se com a linha de comandos.</p>
<div id="aritmética-básica" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Aritmética básica</h3>
<p>Todas operações feitas em uma calculadora podem ser realizadas no painel com console do <img src="images/logo_r.png" width="20"> no RStudio. Podemos calcular diversas operações em uma expressão:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="dv">10</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span> <span class="op">-</span><span class="st"> </span>pi</a>
<a class="sourceLine" id="cb53-2" title="2"><span class="co">#&gt; [1] 22.85841</span></a></code></pre></div>
<p>Além de números e operadores artiméticos a expressão acima inclui a constante pré-definida (<span class="math inline">\(\pi\)</span>): <code>pi</code> (=3.1415927).</p>
<div class="rmdwarning">
<p>
Note que no R, o separador decimal é o ponto “.”, ao invés da vírgula “,” usada na notação brasileira. As vírgulas tem a finalidade de separar os argumentos nas chamadas de funções, tal como <code>log(10, 10)</code>, que veremos na seção <span class="citation">(<span class="citeproc-not-found" data-reference-id="ref"><strong>???</strong></span>)</span>(matfuns) .
</p>
</div>
<p>As operações no <img src="images/logo_r.png" width="20"> seguem a mesma ordem de precedência que aprendemos em matemática na escola:</p>
<ul>
<li><p>parênteses: <code>(</code> <code>)</code></p></li>
<li><p>expoentes: <code>^</code>ou <code>**</code></p></li>
<li><p>multiplicação: <code>*</code></p></li>
<li><p>divisão: <code>/</code></p></li>
</ul>
<p>Então os parênteses podem ser usados para forçar a ordem das operações acima conforme nossa intenção:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="dv">10</span> <span class="op">+</span><span class="st"> </span>((<span class="dv">8</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>) <span class="op">-</span><span class="st"> </span>pi <span class="co"># parênteses opcionais se você lembrar a regra</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="co">#&gt; [1] 22.85841</span></a>
<a class="sourceLine" id="cb54-3" title="3">(<span class="dv">10</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span> <span class="op">-</span><span class="st"> </span>pi</a>
<a class="sourceLine" id="cb54-4" title="4"><span class="co">#&gt; [1] 15.35841</span></a>
<a class="sourceLine" id="cb54-5" title="5">(<span class="dv">10</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span> <span class="op">-</span><span class="st"> </span>pi</a>
<a class="sourceLine" id="cb54-6" title="6"><span class="co">#&gt; [1] 77.85841</span></a>
<a class="sourceLine" id="cb54-7" title="7">(<span class="dv">10</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>) <span class="op">-</span><span class="st"> </span>pi</a>
<a class="sourceLine" id="cb54-8" title="8"><span class="co">#&gt; [1] 22.85841</span></a>
<a class="sourceLine" id="cb54-9" title="9"><span class="dv">10</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">8</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">-</span><span class="st"> </span>pi)</a>
<a class="sourceLine" id="cb54-10" title="10"><span class="co">#&gt; [1] 84.55668</span></a>
<a class="sourceLine" id="cb54-11" title="11"><span class="dv">10</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span><span class="op">^</span>(<span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>) <span class="op">-</span><span class="st"> </span>pi</a>
<a class="sourceLine" id="cb54-12" title="12"><span class="co">#&gt; [1] 9.686834</span></a>
<a class="sourceLine" id="cb54-13" title="13"><span class="dv">10</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span><span class="op">^</span>(<span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span> <span class="op">-</span><span class="st"> </span>pi)</a>
<a class="sourceLine" id="cb54-14" title="14"><span class="co">#&gt; [1] 10.00412</span></a></code></pre></div>
<!-- 
-1^2 = ?
-->
<p>Se você quer saber se um número é divisor exato de outro número (resto da divisão igual a zero), o operador <code>%%</code> determina o resto de uma divisão:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="dv">10</span> <span class="op">%%</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb55-3" title="3"><span class="dv">11</span> <span class="op">%%</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb55-4" title="4"><span class="co">#&gt; [1] 1</span></a></code></pre></div>
<p>O operador <code>%/%</code> fornece a parte inteira do quociente da divisão entre 2 números.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="dv">11</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="co">#&gt; [1] 5.5</span></a>
<a class="sourceLine" id="cb56-3" title="3"><span class="dv">11</span> <span class="op">%/%</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="co">#&gt; [1] 5</span></a></code></pre></div>
<p>Operações que resultam em números muito pequenos ou muito grandes são representados em notação científica.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="dv">5</span><span class="op">/</span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="co">#&gt; [1] 5e-04</span></a></code></pre></div>
<p>Este mesmo valor pode ser escrito nas seguintes formas equivalentes:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="fl">5e-4</span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="co">#&gt; [1] 5e-04</span></a>
<a class="sourceLine" id="cb58-3" title="3"><span class="fl">5E-4</span></a>
<a class="sourceLine" id="cb58-4" title="4"><span class="co">#&gt; [1] 5e-04</span></a>
<a class="sourceLine" id="cb58-5" title="5"><span class="dv">5</span><span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb58-6" title="6"><span class="co">#&gt; [1] 5e-04</span></a></code></pre></div>
<!--
Os resultados dos cálculos no <img src="images/logo_r.png" width="20"> são mostrados com 7 dígitos significativos, o que pode ser verificado pela `getOptions()`. É possível mudar para `n` dígitos usando a função `options()`, conforme exemplo abaixo.


```r
# opção de dígitos padrão
getOption("digits")
#> [1] 7
exp(1)
#> [1] 2.718282
# alterando para 14
options(digits = 14)
exp(1)
#> [1] 2.718281828459
getOption("digits")
#> [1] 14
# redefinindo para o número de casas decimais padrão
options(digits = 7)
getOption("digits")
#> [1] 7
```
-->
<p>O valor absoluto e o sinal de um número podem ser obtidos pelas seguintes expressões:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">abs</span>(<span class="op">-</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb59-2" title="2"><span class="co">#&gt; [1] 6</span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="kw">sign</span>(<span class="op">-</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb59-4" title="4"><span class="co">#&gt; [1] -1</span></a></code></pre></div>
</div>
<div id="nans" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Cálculos problemáticos</h3>
<p>Quando um cálculo não tem sentido matemático ou não pode ser propriamente realizado (Tabela @ref(tab:tab-num-esp)) surgirão alguns valores numéricos especiais na sua frente, como: <code>Inf</code>(Infinito) e <code>NaN</code> (abreviação do termo em inglês <em>Not a Number</em> - valor indefinido).</p>
<table>
<caption>(#tab:tab-num-esp)Exemplos de operações que resultam em NaN ou <span class="math inline">\(\pm\infty\)</span> .</caption>
<thead>
<tr class="header">
<th align="center">operação</th>
<th align="center">resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2/0</td>
<td align="center">Inf</td>
</tr>
<tr class="even">
<td align="center">-12/0</td>
<td align="center">-Inf</td>
</tr>
<tr class="odd">
<td align="center">log(0)</td>
<td align="center">-Inf</td>
</tr>
<tr class="even">
<td align="center">(c(-3, 3))^Inf</td>
<td align="center">NaN, Inf</td>
</tr>
<tr class="odd">
<td align="center">0*Inf</td>
<td align="center">NaN</td>
</tr>
<tr class="even">
<td align="center">log(-0.5)</td>
<td align="center">NaN</td>
</tr>
<tr class="odd">
<td align="center">sqrt(-1)</td>
<td align="center">NaN</td>
</tr>
<tr class="even">
<td align="center">0/0</td>
<td align="center">NaN</td>
</tr>
<tr class="odd">
<td align="center">Inf-Inf</td>
<td align="center">NaN</td>
</tr>
<tr class="even">
<td align="center">mean(c(NA, NA), na.rm = TRUE)</td>
<td align="center">NaN</td>
</tr>
</tbody>
</table>
<p>A demonstração das diferentes formas de se obter essas constantes especiais é importante para entender a origem delas ao rodar um script longo.</p>
<p>Por outro lado, há operações válidas com estes valores especiais.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">exp</span>(<span class="op">-</span><span class="ot">Inf</span>)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb60-3" title="3">(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>)<span class="op">^</span><span class="ot">Inf</span></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="co">#&gt; [1] 0 1</span></a>
<a class="sourceLine" id="cb60-5" title="5"><span class="dv">0</span> <span class="op">/</span><span class="st"> </span><span class="ot">Inf</span></a>
<a class="sourceLine" id="cb60-6" title="6"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb60-7" title="7">(<span class="op">-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="ot">Inf</span>)<span class="op">^</span><span class="dv">0</span></a>
<a class="sourceLine" id="cb60-8" title="8"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb60-9" title="9"><span class="dv">0</span><span class="op">^</span><span class="dv">0</span></a>
<a class="sourceLine" id="cb60-10" title="10"><span class="co">#&gt; [1] 1</span></a></code></pre></div>
</div>
<div id="NAs" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Dados faltantes</h3>
<!-- 
https://medium.com/coinmonks/dealing-with-missing-data-using-r-3ae428da2d17 
https://towardsdatascience.com/how-to-handle-missing-data-8646b18db0d4
-->
<p>Antes do que você imagina, na sua jornada pelo mundo real dos dados ambientais, você irá se deparar com os "NAs". <code>NA</code> é a abreviação do termo em inglês <em>Not Available</em>, uma constante especial do <img src="images/logo_r.png" width="20"> que representa <strong>dado faltante</strong>. Geralmente dados faltantes são representados por um código<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a> como "-999.99" ou qualquer outro valor fora do intervalo de variação possível da variável.</p>
<p>A coisa mais importante a saber sobre <code>NA</code> é que qualquer operação envolvendo <code>NA</code> resultará em <code>NA</code> (Tabela @ref(tab:tab-nas)).</p>
<table>
<caption>(#tab:tab-nas)Operações com NA.</caption>
<thead>
<tr class="header">
<th align="center">operação</th>
<th align="center">resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">NA + 5</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">sqrt(NA)</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">NA^2</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">NA/NaN</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="matfuns" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Funções matemáticas</h3>
<p>O <img src="images/logo_r.png" width="20"> tem diversas funções internas. A sintaxe para chamar uma função é simplesmente:</p>
<p style="color:DodgerBlue; font-size:1.3em; font-weight: bold;text-align:center;">
<code>funcão(argumento)</code>
</p>
<p>Por exemplo:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># cosseno de 60°</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="kw">cos</span>(<span class="dv">60</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">/</span><span class="st"> </span><span class="dv">180</span>)</a>
<a class="sourceLine" id="cb61-3" title="3"><span class="co">#&gt; [1] 0.5</span></a>
<a class="sourceLine" id="cb61-4" title="4"><span class="co"># raiz quadrada de 100</span></a>
<a class="sourceLine" id="cb61-5" title="5"><span class="kw">sqrt</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb61-6" title="6"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb61-7" title="7"><span class="co"># exponencial de 1</span></a>
<a class="sourceLine" id="cb61-8" title="8"><span class="kw">exp</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb61-9" title="9"><span class="co">#&gt; [1] 2.718282</span></a>
<a class="sourceLine" id="cb61-10" title="10"><span class="co"># fatorial de 4 (4*3*2*1)</span></a>
<a class="sourceLine" id="cb61-11" title="11"><span class="kw">factorial</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb61-12" title="12"><span class="co">#&gt; [1] 24</span></a></code></pre></div>
<p>Por padrão a função logaritmo (<code>log()</code>) determina o logaritmo natural (logaritmo na base <span class="math inline">\(e\)</span>).</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># logaritmo natural de 10</span></a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">log</span>(<span class="dt">x =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb62-3" title="3"><span class="co">#&gt; [1] 2.302585</span></a></code></pre></div>
<p>Para obter o logaritmo de 10 na base 10, o segundo argumento da função <code>log()</code> deve ser especificado, ou pode-se usar a função <code>log10()</code>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">log</span>(<span class="dt">x =</span> <span class="dv">10</span>, <span class="dt">base =</span> <span class="dv">10</span>) <span class="co"># logaritmo de 10 na base 10</span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb63-3" title="3"><span class="kw">log10</span>(<span class="dv">10</span>) <span class="co"># forma equivalente</span></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="co">#&gt; [1] 1</span></a></code></pre></div>
<p>No <img src="images/logo_r.png" width="20"> você verá que parênteses são frequentemente utilizados. Em geral, uma palavra antecedendo um parênteses em uma expressão: é uma função.</p>
<p>Você não precisa lembrar do nome de cada função do <img src="images/logo_r.png" width="20">. Você pode ou buscar pelo termo em um site de busca, ou usar o auto-preenchimento de código (<tab> no RStudio) após a parte inicial do nome da função.</p>
<p>Digitando <code>?</code> antes do nome de uma função ou operador abrirá a página de ajuda daquela função.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">?atan2</a></code></pre></div>
</div>
</div>
<div id="variaveis" class="section level2">
<h2><span class="header-section-number">5.3</span> Variáveis</h2>
<p>Até agora nós usamos expressões para fazer uma operação e obter um resultado. O termo "expressão" significa uma sentença de código que pode ser executada. Se a avaliação de uma expressão é salva usando o operador <code>&lt;-</code>, esta combinação é chamada de operador <strong>atribuição</strong>. A expressão geral para definir uma variável é:</p>
<p style="color:DodgerBlue; font-size:1.3em; font-weight: bold;text-align:center;">
<code>variavel &lt;- valor</code>
</p>
<p>Uma atribuição armazena o valor (no lado direita da atribuição) em uma <strong>variável</strong><a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a> (no lado esquerdo da atribuição). Então uma variável é um nome usado para guardar os dados. Os valores dos dados podem ser de diferentes tipos, como veremos na seção @ref(tipos-dados).</p>
<p>Quando uma variável recebe um valor, o <img src="images/logo_r.png" width="20"> não imprime nada no console.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">m_kg &lt;-<span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<p>Para visualizar o valor de uma variável, digite o nome da variável na linha de comando, ou imprima seu valor com a função <code>print()</code>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">m_kg</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="co">#&gt; [1] 100</span></a>
<a class="sourceLine" id="cb66-3" title="3"><span class="kw">print</span>(m_kg)</a>
<a class="sourceLine" id="cb66-4" title="4"><span class="co">#&gt; [1] 100</span></a></code></pre></div>
<p>O <img src="images/logo_r.png" width="20"> diferencia letras maiúsculas de minúsculas.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">m_kg</a>
<a class="sourceLine" id="cb67-2" title="2"><span class="co">#&gt; [1] 100</span></a>
<a class="sourceLine" id="cb67-3" title="3">M_KG</a>
<a class="sourceLine" id="cb67-4" title="4"><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;M_KG&#39; não encontrado</span></a></code></pre></div>
<p>Como criamos apenas a variável <code>m_kg</code>, <code>M_kg</code> não foi encontrada.</p>
<p>A variável <code>m_kg</code> pode ser utilizado para criar outras variáveis.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">peso_kg &lt;-<span class="st"> </span>m_kg <span class="op">*</span><span class="st"> </span><span class="fl">9.8</span></a>
<a class="sourceLine" id="cb68-2" title="2">peso_kg</a>
<a class="sourceLine" id="cb68-3" title="3"><span class="co">#&gt; [1] 980</span></a></code></pre></div>
<p>Os espaços em torno do operador de atribuição (<code>&lt;-</code>) não são obrigatórios mas eles ajudam na legibilidade do código. Veja as diferentes interpretações que as expressões abaixo podem ter dependendo de como os espaços são posicionados em torno da variável <code>g</code>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">g &lt;-<span class="st"> </span><span class="fl">9.8</span>  <span class="co"># g é igual a 9.8</span></a>
<a class="sourceLine" id="cb69-2" title="2">g <span class="op">&lt;</span><span class="st"> </span><span class="fl">-9.8</span>  <span class="co"># g é menor que -9.8 ?</span></a>
<a class="sourceLine" id="cb69-3" title="3">g&lt;-<span class="fl">9.8</span>    <span class="co"># g é igual a 9.8 ou é menor que -9.8 ?</span></a></code></pre></div>
<p>Nós estamos definindo a variável, digitando o nome dela na linha de comando e teclando enter para ver o resultado. Há uma forma mais prática de fazer isso. Para criar e já mostrar o resultado da variável, podemos colocar parênteses em torno da atribuição:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">g &lt;-<span class="st"> </span><span class="fl">9.8</span> <span class="co"># cria</span></a>
<a class="sourceLine" id="cb70-2" title="2">g        <span class="co"># imprime</span></a>
<a class="sourceLine" id="cb70-3" title="3"><span class="co">#&gt; [1] 9.8</span></a>
<a class="sourceLine" id="cb70-4" title="4">(g &lt;-<span class="st"> </span><span class="fl">9.8</span>) <span class="co"># cria e imprime</span></a>
<a class="sourceLine" id="cb70-5" title="5"><span class="co">#&gt; [1] 9.8</span></a></code></pre></div>
<p>Podemos criar uma variável baseado em variáveis criadas previamente. Por exemplo, vamos definir a variável peso, como <span class="math inline">\(p_{kg} = m_{kg}.g\)</span>:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">(peso_kg &lt;-<span class="st"> </span>m_kg <span class="op">*</span><span class="st"> </span>g)</a>
<a class="sourceLine" id="cb71-2" title="2"><span class="co">#&gt; [1] 980</span></a></code></pre></div>
<p>Se alterarmos o valor de uma das variáveis isso não mudará o valor da outra:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">(m_kg &lt;-<span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb72-2" title="2"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb72-3" title="3">peso_kg</a>
<a class="sourceLine" id="cb72-4" title="4"><span class="co">#&gt; [1] 980</span></a></code></pre></div>
<p>O antigo valor de <code>m_kg</code> será sobrescrito. Mas, embora <code>p_kg</code> tenha sido definida a partir de <code>m_kg</code>, seu valor permanecerá o mesmo. Esse comportamento que nos permite compreender o que acontece quando temos várias expressões em sequência num <em>script</em>.</p>
<p>Para saber as variáveis já criadas numa sessão <img src="images/logo_r.png" width="20">, use a função <code>ls()</code><a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> para verificar as variáveis existentes:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb73-2" title="2"><span class="co">#&gt; [1] &quot;cran_news_windows&quot;  &quot;format_hotkey&quot;      &quot;g&quot;                 </span></a>
<a class="sourceLine" id="cb73-3" title="3"><span class="co">#&gt; [4] &quot;m_kg&quot;               &quot;peso_kg&quot;            &quot;r_cran_version_win&quot;</span></a></code></pre></div>
<!--

```r
totd <- jan*7; totd <- totd + fev; totd <- totd + 4*abr
totd
```

#### Atribuição com a função `assign()`


Outra forma de atribuição é através da função `assign()`:


```r
es <- 3
assign(x = "es_hpa", value = es/10)
es_hpa
# usando função assign sem nome dos parâmetros
assign("u", 2.5)
u
```

Um exemplo mais elaborado de uso da função `assign()` para criar várias variáveis pode ser visto [aqui](https://gist.github.com/lhmet/d28856ed16690bb45d5be36ea4f5d458#file-assign-ex-rmd).


<div class="rmdwarning">
<p>Este método de atribuição é menos comum, por deixar o código menos legível que o método <code>variavel &lt;- valor</code>. Mas em alguns casos de programação avançada envolvendo ambientes (especificado como 3° argumento da <code>assign()</code>) ele pode ser útil.</p>
</div>
-->
<div id="removendo-variáveis" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Removendo variáveis</h3>
<p>Para remover variáveis usa-se a função <code>rm()</code>. Vamos remover a variável <code>m</code> criada previamente e ver a lista de objetos no espaço de trabalho.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">rm</span>(m_kg)</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb74-3" title="3"><span class="co">#&gt; [1] &quot;cran_news_windows&quot;  &quot;format_hotkey&quot;      &quot;g&quot;                 </span></a>
<a class="sourceLine" id="cb74-4" title="4"><span class="co">#&gt; [4] &quot;peso_kg&quot;            &quot;r_cran_version_win&quot;</span></a></code></pre></div>
<p>Podemos remover mais de uma variável ao mesmo tempo.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">rm</span>(g, peso_kg)</a>
<a class="sourceLine" id="cb75-2" title="2"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb75-3" title="3"><span class="co">#&gt; [1] &quot;cran_news_windows&quot;  &quot;format_hotkey&quot;      &quot;r_cran_version_win&quot;</span></a></code></pre></div>
<p>Para remover todas variáveis do espaço de trabalho (use com cautela):</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="co"># apagando tudo</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb76-3" title="3"><span class="kw">ls</span>()</a></code></pre></div>
</div>
</div>
<div id="erros-comuns" class="section level2">
<h2><span class="header-section-number">5.4</span> Erros comuns</h2>
<p>As expressões abaixo ilustram o que acontece quando cometemos alguns erros bem comuns ao trabalhar com <img src="images/logo_r.png" width="20">:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">srt</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb77-2" title="2"><span class="co">#&gt; Error in srt(2): não foi possível encontrar a função &quot;srt&quot;</span></a>
<a class="sourceLine" id="cb77-3" title="3">m <span class="op">*</span><span class="st"> </span>g</a>
<a class="sourceLine" id="cb77-4" title="4"><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;m&#39; não encontrado</span></a>
<a class="sourceLine" id="cb77-5" title="5"><span class="kw">setwd</span>(<span class="st">&quot;algum/caminho/no/alem&quot;</span>)</a>
<a class="sourceLine" id="cb77-6" title="6"><span class="co">#&gt; Error in setwd(&quot;algum/caminho/no/alem&quot;): não é possível mudar o diretório de trabalho</span></a>
<a class="sourceLine" id="cb77-7" title="7"><span class="kw">save</span>(<span class="dt">file =</span> <span class="st">&quot;algum/outro/caminho/no/alem&quot;</span>)</a>
<a class="sourceLine" id="cb77-8" title="8"><span class="co">#&gt; Warning in save(file = &quot;algum/outro/caminho/no/alem&quot;): nothing specified to be</span></a>
<a class="sourceLine" id="cb77-9" title="9"><span class="co">#&gt; save()d</span></a>
<a class="sourceLine" id="cb77-10" title="10"><span class="co">#&gt; Warning in gzfile(file, &quot;wb&quot;): não foi possível abrir o arquivo comprimido</span></a>
<a class="sourceLine" id="cb77-11" title="11"><span class="co">#&gt; &#39;algum/outro/caminho/no/alem&#39;, motivo provável &#39;No such file or directory&#39;</span></a>
<a class="sourceLine" id="cb77-12" title="12"><span class="co">#&gt; Error in gzfile(file, &quot;wb&quot;): não é possível abrir a conexão</span></a></code></pre></div>
<p>Reconhecemos um erro pela presença da palavra <strong><code>Error</code></strong> na mensagem e por estar destacada em vermelha ou laranja, dependendo de como o RStudio está configurado. O que tem depois do ":" na mensagem é uma tentativa do <img src="images/logo_r.png" width="20"> nos dizer o que deu errado.</p>
<div class="rmdtip">
<p>
<strong>As mensagens de erro são suas amigas. Sempre leia as mensagens de erro</strong>. Elas serão incompreensíveis no início, mas acabarão fazendo mais sentido e tornando-se útil (eu espero). Essa maneira de aprender só funciona se lermos as mensagens de erro em primeiro lugar.
</p>
</div>
<p>No trecho de código acima, na avaliação da expressão com a função <code>save()</code> surge primeiro um <strong>Warning</strong> (aviso). Avisos surgem quando algo inesperado ocorreu, mas que as coisas ainda podem dar certo. Outro exemplo de mensagem de aviso é:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb78-2" title="2"><span class="co">#&gt; Warning in sqrt(-1): NaNs produzidos</span></a>
<a class="sourceLine" id="cb78-3" title="3"><span class="co">#&gt; [1] NaN</span></a></code></pre></div>
<p>Na expressão acima foi possível obter um resultado, mas o R avisa que foi produzido <code>NaN</code>. Como visto na seção @ref(nans), qualquer operação derivada deste resultado produzirá <code>NaN</code>.</p>
<p>Algumas vezes, as mensagens de erro e aviso podem não fazer sentido nem mesmo para usuários experientes, então fica a dica de consulta para referência (Figura @ref(fig:google-it)).</p>
<div class="figure" style="text-align: center">
<img src="images/practicalDev_googleErrorMessage.jpg" alt="Aprenda como descobrir qual o significado das mensagens de erro." width="50%" />
<p class="caption">
(#fig:google-it)Aprenda como descobrir qual o significado das mensagens de erro.
</p>
</div>
<!--
https://br.pinterest.com/marcusoh/funny/
-->
</div>
<div id="boas-práticas-para-códigos-de-boa-qualidade" class="section level2">
<h2><span class="header-section-number">5.5</span> Boas práticas para códigos de boa qualidade</h2>
<!-- 
# consultar para acrescentar o que for útil/complementar
https://swcarpentry.github.io/r-novice-inflammation/06-best-practices-R/index.html

https://style.tidyverse.org/syntax.html#object-names

https://medium.com/experience-valley/ser%C3%A1-que-seus-coment%C3%A1rios-est%C3%A3o-deixando-seu-c%C3%B3digo-pior-5a961d5f4140

https://towardsdatascience.com/data-scientists-your-variable-names-are-awful-heres-how-to-fix-them-89053d2855be
-->
<blockquote>
<p>Uma codificação em bom estilo é como usar a pontuação corretamente. Você pode até escrever sem usá-la, mas ela certamente deixa as coisas mais fáceis de ler.</p>
<p>— Hadley Wickham</p>
</blockquote>
<!--
> O bom código não deve focar apenas na performance de execução, mas também em sua simplicidade, legibilidade e facilidade de manutenção por outros contribuidores.
>
>— [Silvio Henrique Ferreira](https://medium.com/experience-valley/ser%C3%A1-que-seus-coment%C3%A1rios-est%C3%A3o-deixando-seu-c%C3%B3digo-pior-5a961d5f4140)
-->
<p>A medida que a complexidade dos códigos aumenta, você perceberá que a organização é imprescindível para rápida compreensão dele por você mesmo no futuro, pelos usuários e colaboradores. Um bom código não deve focar somente no desempenho de execução, mas também em sua simplicidade, legibilidade, o que inerentemente facilita sua manutenção por outros contribuidores.</p>
<p>Para deixar seu código compreensível uma boa referência é o <a href="https://style.tidyverse.org/">Guia de estilo de codificação <strong><code>tidyverse</code></strong></a>. Um guia bastante utilizado pela comunidade <img src="images/logo_r.png" width="20"> e adotado pela <a href="https://google.github.io/styleguide/Rguide.html">Google</a>.</p>
<p>A aplicação de todas as regras de formatação de código do <strong><code>tidyverse</code></strong> podem ser difíceis de ser lembradas. Mas este problema pode ser amenizado com o pacote <a href="http://styler.r-lib.org/">styler</a> que fornece funções para estilizar o seu código no padrão <strong><code>tidyverse</code></strong>. Para utilizá-lo, instale o pacote <strong><code>styler</code></strong>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;styler&quot;</span>)</a></code></pre></div>
<p>As funções são acessíveis Através do menu <em><code>Addins</code></em> do RStudio e incluem as opções de: estilizar um arquivo e uma região destacada do código (Figura @ref(fig:styler-addin)).</p>
<div class="figure" style="text-align: center">
<img src="images/styler_0.1.gif" alt="Exemplo de aplicação do Estilo de codificação tidyverse."  />
<p class="caption">
(#fig:styler-addin)Exemplo de aplicação do Estilo de codificação tidyverse.
</p>
</div>
<p>A convenção de estilo dos seus códigos é uma escolha sua. Eu indico o estilo tidyverse, mas você pode optar por outro. O mais importante é ser consistente.</p>
<div id="nomes-de-variáveis" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Nomes de variáveis</h3>
<!-- 
Sobre boas práticas:
- falta inserir limite de largura de códigos num lugar mais adequado 
- falta falar sobre comentário de forma eficaz
-->
<blockquote>
<p>“Há somente duas coisas difíceis em Ciência da Computação: invalidação de cache e escolher nomes para as coisas.”</p>
<p>— Phil Karlton</p>
</blockquote>
<p>Na seção (@ref(variaveis)), vimos como criar variáveis. Este procedimento, implica em definir um nome para variável. Dar nomes claros, objetivos e coerentes para variáveis, funções, e argumentos é difícil.</p>
<div class="figure" style="text-align: center">
<img src="images/5-meaningfull-var-names.jpg" alt="Nomes de variáveis com significado." width="70%" />
<p class="caption">
(#fig:meanningfull-vnames)Nomes de variáveis com significado.
</p>
</div>
<p>A falta de clareza as vezes é compensada por excesso de comentários no código. Porém, hoje em dia, a prática de comentar o máximo possível está obsoleta e danosa.</p>
<blockquote>
<p>O bom código é sua própria melhor documentação. Quando você for a adicionar um comentário, se pergunte, “Como eu posso melhorar o código para que o este comentário não seja necessário?” Melhore o código e então o documente para torná-lo ainda mais claro.</p>
<p>— Steve McConnell</p>
</blockquote>
<p>De forma geral, podemos listar os seguintes cuidados ao nomear variáveis no <img src="images/logo_r.png" width="20">:</p>
<ul>
<li><p>usar nomes claros, objetivos e coerentes</p></li>
<li><p>não iniciar com um número, ponto (<code>.</code>) ou sublinhado (<code>_</code>) e não conter espaços</p></li>
<li><p>não usar acentos e caracteres especiais</p>
<pre><code>  ^, !, $, @, +, -, /, ou *</code></pre></li>
<li><p>evitar o uso de nomes reservados do <img src="images/logo_r.png" width="20"> (funções internas, constantes e etc):</p>
<pre><code>  c q  s  t  C  D  F  I  T  diff  exp  log  mean  pi  range  rank  var

  FALSE  Inf  NA  NaN  NULL TRUE 

  break  else  for  function  if  in  next  repeat  while</code></pre></li>
<li><p>usar <code>&lt;-</code> para atribuição (colocar um espaço antes e depois) e deixe o <code>=</code> para argumentos de funções.</p></li>
<li><p>não colocar <code>;</code> no final de uma linha e evite vários comandos na mesma linha.</p></li>
<li><p>usar somente letras minúsculas, números (após a primeira letra do nome). Use o <code>_</code> ou sublinhado para separar palavras dentro de um nome de variável longo(<a href="https://pt.qwe.wiki/wiki/Snake_case">caso cobra</a>).</p></li>
</ul>
<!---
; do operador igual ` = ` na chamada de função com argumentos.

- usar identação de código

   - Código sem identação:


```r
mydf <- cbind.data.frame(do.call(rbind, lapply(strsplit(myfile[!seq(length(myfile)) %% 2], ", "),function(x)gsub(".*\\=", "", x))), lca = gsub(".*\\:\\s+", "", myfile[seq(length(myfile)) %% 2]))
```

   - Código com identação:


```r
mydf <-
  cbind.data.frame(
    do.call(
      rbind,
      lapply(
        strsplit(
          x = myfile[!seq(length(myfile)) %% 2],
          split = ", "
        ),
        function(x) {
          gsub(".*\\=", "", x)
        }
      )
    ),
    lca = gsub(
      pattern = ".*\\:\\s+",
      replacement = "",
      x = myfile[seq(length(myfile)) %% 2]
    )
  )
```
-->
</div>
</div>
<div id="exercícios" class="section level2">
<h2><span class="header-section-number">5.6</span> Exercícios</h2>
<!-- 
equação de báskara para dados valores 
-->
<ol style="list-style-type: decimal">
<li>Execute as seguintes expressões no R mostrando os resultados obtidos.</li>
</ol>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="dv">100</span><span class="op">:</span><span class="dv">130</span></a>
<a class="sourceLine" id="cb82-3" title="3"><span class="dv">5</span> <span class="op">-</span><span class="st"> </span><span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="dv">3</span> % <span class="dv">5</span></a>
<a class="sourceLine" id="cb82-5" title="5"><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb82-6" title="6"><span class="dv">4</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb82-7" title="7"><span class="dv">6</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<hr />
<ol start="2" style="list-style-type: decimal">
<li>Utilize uma expressão para cada item.
<ol style="list-style-type: lower-alpha">
<li>Escolha um número e some 3 a ele.</li>
<li>Multiplique o resultado por 2.</li>
<li>Subtraia 10 da resposta.</li>
<li>Divida o que foi obtido por 4.</li>
</ol></li>
</ol>
<hr />
<ol start="3" style="list-style-type: decimal">
<li>Calcule <span class="math inline">\(\sqrt{16}\)</span>, <span class="math inline">\({16^{0.5}}^{3}\)</span>, <span class="math inline">\({(16^{0.5})}^{3}\)</span> e <span class="math inline">\(4^{\frac{3}{2}}\)</span>.</li>
</ol>
<hr />
<ol start="4" style="list-style-type: decimal">
<li>Teste as expressões <code>log10(1000)</code>, <code>log(1000)</code>, <code>exp(log(1000))</code>. Depois teste a expressão <code>log2(64)</code>. Verifique se você entendeu as diferentes funções logarítmicas.</li>
</ol>
<hr />
<ol start="5" style="list-style-type: decimal">
<li><p>Defina as variáveis abaixo tomando cuidados ao nomear as variáveis, conforme visto em sala de aula. Mostre os valores para as seguintes constantes:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Velocidade da luz: <span class="math inline">\(\nu = 2.998 \times 10^{8} \left[m \, s^{-1}\right]\)</span></p></li>
<li><p>Carga elementar ou eletrônica: <span class="math inline">\(e = 1.602 \times 10^{-19} \left[C\right]\)</span></p></li>
<li><p>Permissividade do vácuo: <span class="math inline">\(\epsilon_{0} = 8.85 \times 10^{-12} \left[C^{2} \, N^{-1} \, m^{2}\right]\)</span></p></li>
<li><p>Constante de Planck: <span class="math inline">\(h=6.626 \times 10^{-34} \left[J \, s\right]\)</span></p></li>
<li><p>Constante de Stefan Boltzman: <span class="math inline">\(\sigma = 5.67 \times 10^{-8} \left[W \, m^{-2} \, K^{-4}\right]\)</span><br />
</p></li>
<li><p>Constante solar: <span class="math inline">\(S_{0} = 1380 \left[W \, m^{-2}\right]\)</span></p></li>
<li><p>Constante de Avogadro: <span class="math inline">\(N_{A} = 6.022 \times 10^{23} \left[mol^{-1}\right]\)</span></p></li>
<li><p>Constante dos gases para o ar seco: <span class="math inline">\(R_{d} = 287.04 \left[J \, K^{-1} \, kg^{-1}\right]\)</span></p></li>
<li><p>Constante dos gases ideais para o vapor: <span class="math inline">\(R_{w} = 461.5 \left[J \, K^{-1} \, kg^{-1}\right]\)</span></p></li>
<li><p>Densidade do ar seco para CNTP (à 0 ° C em 1000 mb): <span class="math inline">\(\rho=1.2754 \left[kg \, m^{-3}\right]\)</span></p></li>
<li><p>Pressão média ao nível médio do mar para atmosfera padrão: <span class="math inline">\(P_{0}=1013.25 \left[mb\right]\)</span></p></li>
<li><p>Temperatura ao nível médio do mar para atmosfera padrão: <span class="math inline">\(T_{0}=288.15 \left[K\right]\)</span></p></li>
<li><p>Calor latente de vaporização ou condensação (à 0 °C): <span class="math inline">\(\lambda_{v} = 2.501 \times 10^{6}\left[J \, kg^{-1}\right]\)</span></p></li>
<li><p>Calor latente de fusão (à 0 °C): <span class="math inline">\(\lambda_{f} = 0.334 \times 10^{6}\left[J \, kg^{-1}\right]\)</span></p></li>
<li><p>Massa molecular da água: <span class="math inline">\(M_w = 18.016 \left[g \, mol^{-1}\right]\)</span></p></li>
<li><p>Peso molecular do ar: <span class="math inline">\(M_{ar} = 28.96 \left[g \, mol^{-1}\right]\)</span></p></li>
<li><p>Raio da terra: <span class="math inline">\(r = 6.37 \times 10^{6} \left[m\right]\)</span></p></li>
<li><p>Velocidade angular da Terra: <span class="math inline">\(\Omega=7.29 \times 10^{-5} \left[rad \, s^{-1}\right]\)</span></p></li>
</ol></li>
</ol>
<hr />
<ol start="6" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>Como você pode fazer para que a constante <code>pi</code> seja mostrada com 20 dígitos? (b) Como voltar a trabalhar a com 7 dígitos novamente? c. Mostre o número neperiano com 7 dígitos.</li>
</ol></li>
</ol>
<hr />
<ol start="7" style="list-style-type: decimal">
<li>Determine a temperatura de bulbo úmido (<span class="math inline">\(T_{w}\)</span>) usando a expressão empírica (<a href="http://journals.ametsoc.org/doi/abs/10.1175/JAMC-D-11-0143.1%5D">Stull, 2011</a>) abaixo. Salve os resultados em variáveis diferentes. Para uma temperatura do ar (<span class="math inline">\(T\)</span>) de 20°C e Umidade relativa (<span class="math inline">\(UR\)</span>) de 70%, qual o valor de <code>Tw</code>? Defina variáveis para os valores <span class="math inline">\(T\)</span> e (<span class="math inline">\(UR\)</span>) e use-as na equação de <span class="math inline">\(T_{w}\)</span>.</li>
</ol>
<p><span class="math display">\[
\begin{aligned} 
T_{w}=T\cdot atan\left [ 0.151977\cdot \left ( UR+8.313659 \right )^{1/2} \right ]+ \\
atan\left (T+UR \right )-\\
atan\left ( UR-1.676331 \right )+\\
0.00391838\left ( UR \right )^{3/2}\cdot atan\left ( 0.023101\cdot UR \right )-\\
4.686035
\end{aligned} 
\]</span></p>
<hr />
<ol start="8" style="list-style-type: decimal">
<li>Determine os valores de umidade do solo:</li>
</ol>
<ul>
<li><p>no potencial hídrico de 10kPa (<span class="math inline">\(\theta_{10kPa}\)</span>)</p></li>
<li><p>na capacidade de campo (<span class="math inline">\(\theta_{33kPa}\)</span>)</p></li>
<li><p>no ponto de murcha permanente (<span class="math inline">\(\theta_{1500kPa}\)</span>)</p>
<p>utilizando o conjunto de equações de pedotransferência abaixo (<a href="https://dl.sciencesocieties.org/publications/sssaj/abstracts/67/4/1085">Tomasela et al. 2003</a>):</p></li>
</ul>
<p><img src="images/conj-eqs-tomasella2003.png" width="88%" style="display: block; margin: auto;" /></p>
<ul>
<li>Considere <span class="math inline">\(SI = 16.29\)</span> (%), <span class="math inline">\(CL = 49.25\)</span> (%), <span class="math inline">\(Db = 1.25\)</span> (<span class="math inline">\(g \, cm^{-3}\)</span>), <span class="math inline">\(Me = 25\)</span> (%), onde
<span class="math inline">\(SI\)</span> é a porcentagem de silte no solo, <span class="math inline">\(CL\)</span> é a porcentagem de argila, <span class="math inline">\(Db\)</span> é a densidade do solo e <span class="math inline">\(Me\)</span> é a umidade equivalente em %.</li>
</ul>
<hr />
<ol start="9" style="list-style-type: decimal">
<li>Arredonde para 2 casas decimais os resultados da questão 8. Dica ver <code>?round</code>.</li>
</ol>
<hr />
<ol start="10" style="list-style-type: decimal">
<li>Instale a <strong>última versão do R</strong> no (seu) computador usado para resolução desta lista. Crie um <em>script</em> chamado <code>solucao-q10-NomeDoAluno.R</code> contendo os códigos gerados para solução das questões 7 e 8. Faça as seguintes alterações no código do <em>script</em>:</li>
</ol>
<ul>
<li><p>no código da questão 8, utilize a temperatura do ar (<span class="math inline">\(T\)</span>) de 30°C e Umidade relativa (<span class="math inline">\(UR\)</span>) de 30% para calcular <span class="math inline">\(Tw\)</span>.</p></li>
<li><p>no código da questão 9, considere <span class="math inline">\(SI = 13\)</span> (%), <span class="math inline">\(CL = 37\)</span> (%), <span class="math inline">\(Db = 1.3\)</span> (<span class="math inline">\(g \, cm^{-3}\)</span>), <span class="math inline">\(Me = 21\)</span> (%) para recalcular <span class="math inline">\(\theta_{10kPa}\)</span>, <span class="math inline">\(\theta_{33kPa}\)</span> e <span class="math inline">\(\theta_{1500kPa}\)</span>.</p></li>
<li><p>após os códigos usados para resolver as questões 8 e 9, adicione uma nova linha com a expressão <code>sessionInfo()</code>.</p></li>
<li><p>Finalmente rode o <em>script</em> usando o R no modo não iterativo. Anexe o arquivo de saída <code>solucao-q10-NomeDoAluno.Rout</code> como resposta para este problema.</p></li>
</ul>
<hr />
<div class="rmdimportant">
<p>
<strong>Instruções para entrega da resolução da lista de exercícios.</strong>
</p>
<p>
A resolução da lista deve conter um único arquivo compactado nomeado segundo o padrão <code>lista1-adar-NomedoAluno.zip</code>.
</p>
<p>
O arquivo compactado deve incluir pelo menos 3 arquivos:
</p>
<ol style="list-style-type: decimal">
<li>
<p>
<code>solucao-q10-NomeDoAluno.R</code>: um <em>script</em> com os códigos usados para resolver a questão 10.
</p>
</li>
<li>
<p>
<code>solucao-q10-NomeDoAluno.Rout</code> um arquivo texto de saída gerado (automaticamente) pelo R quando usado no modo não iterativo (<em>Batch</em>). Também faz parte da resolução da questão 10.
</p>
</li>
<li>
<p>
<code>lista1-adar-NomedoAluno.Rmd</code>: arquivo <strong>Rmarkdown</strong> gerado no RStudio (<em><code>File ▶ New File ▶ R Notebook</code></em>) e editado de forma que contenha o texto e o código (<em>chuncks</em>) necessários para resolução das questões 1 a 9.
</p>
</li>
</ol>
<p>
Sempre procure criar variáveis para cada etapa da resolução das questões. Utilize nomes contextualizados e intuitivos. Siga as boas práticas recomendadas no material para nomear as variáveis.
</p>
<ol start="4" style="list-style-type: decimal">
<li>
(Opcional) <code>lista1-adar-NomedoAluno.html</code> arquivo html gerado pelo RStudio (botão knit na aba do painel do editor) a partir do arquivo <code>lista1-adar-NomedoAluno.Rmd</code>.
</li>
</ol>
</div>
<!--chapter:end:05-operacoes-basicas.Rmd-->
</div>
</div>
<div id="datatype" class="section level1">
<h1><span class="header-section-number">6</span> Tipos básicos de dados</h1>
<p>Neste capítulo vamos:</p>
<ul>
<li>aprender a criar vetores</li>
<li>conhecer os tipos de dados mais usados no R</li>
<li>descobrir qual é o tipo de dado de uma variável</li>
<li>saber como converter uma variável de um tipo para outro</li>
</ul>
<!-- 
faltando: 
fórmulas 
factor 
-->
<div id="tipos-dados" class="section level2">
<h2><span class="header-section-number">6.1</span> Vetores e tipos de dados</h2>
<p>Uma conjunto de um ou elementos formam um vetor<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> (<strong><code>vector</code></strong> no idioma <img src="images/logo_r.png" width="20">). Vetor é a estrutura básica de dados do <img src="images/logo_r.png" width="20"> e podem ser de dois tipos: <strong>vetores atômicos</strong> e <strong>listas</strong><a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a>.</p>
<p>Um vetor atômico tem elementos só de um mesmo tipo de dado. Os quatro tipos básicos de vetores atômicos (tabela @ref(tab:classes-r)) são:</p>
<ul>
<li><p><strong><code>double</code></strong> (real)</p></li>
<li><p><strong><code>integer</code></strong> (inteiro)</p></li>
<li><p><strong><code>character</code></strong> (caracteres)</p></li>
<li><p><strong><code>logical</code></strong> (lógico)</p></li>
</ul>
<p>A relação entre estes tipos de dados é mostrada na Figura @ref(fig:data-types-rel).</p>
<table>
<caption>(#tab:classes-r)Principais tipos de dados do R.</caption>
<thead>
<tr class="header">
<th align="center">Tipo de dados</th>
<th align="center">Classe no R</th>
<th align="center">exemplo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Números inteiros</td>
<td align="center">integer</td>
<td align="center">2, 11</td>
</tr>
<tr class="even">
<td align="center">Números reais</td>
<td align="center">double</td>
<td align="center">0.1234, 1.23e4</td>
</tr>
<tr class="odd">
<td align="center">Caracteres</td>
<td align="center">character</td>
<td align="center">“adar”</td>
</tr>
<tr class="even">
<td align="center">Lógicos</td>
<td align="center">logical</td>
<td align="center">TRUE, FALSE</td>
</tr>
</tbody>
</table>
<div class="figure" style="text-align: center">
<img src="images/6-data-types-relation.png" alt="Relação entre os diferentes tipos de vetores atômicos." width="50%" />
<p class="caption">
(#fig:data-types-rel)Relação entre os diferentes tipos de vetores atômicos.
</p>
</div>
<div class="rmdtip">
<p>
Embora existam dois tipos de vetores o termo “vetor” é em geral usado para se referir ao do tipo atômico.
</p>
</div>
<div id="build-vectors" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Construindo vetores</h3>
<p><strong>Vetores atômicos</strong> são geralmente criados com a função <code>c()</code>, abreviatura para <strong>combinar ou concatenar</strong>. Os argumentos dessa função podem ser especificados separados por vírgula. Por exemplo, para criar um vetor com números reais chamado <code>vetor_dbl</code>, escrevemos:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">(vetor_dbl &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.51</span>, <span class="fl">0.33</span>, <span class="fl">1.46</span>, <span class="fl">2.04</span>))</a>
<a class="sourceLine" id="cb83-2" title="2"><span class="co">#&gt; [1] -1.51  0.33  1.46  2.04</span></a></code></pre></div>
<div class="rmdnote">
<p>
A função <code>c()</code> aceita um <strong>número variado de argumentos</strong>, o que é representado por três pontos ou reticências (<code>…</code>) na sua documentação de ajuda (<code>?c</code>).
</p>
</div>
<p>Para saber qual a classe ou tipo de uma variável podemos usar a função <code>class()</code>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">class</span>(vetor_dbl)</a>
<a class="sourceLine" id="cb84-2" title="2"><span class="co">#&gt; [1] &quot;numeric&quot;</span></a></code></pre></div>
</div>
<div id="números" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Números</h3>
<p>O tipo de dados mais usado no <img src="images/logo_r.png" width="20"> é chamado <em>numeric</em>. Este tipo inclui números inteiros, decimais, positivos, negativos e zero. Um dado do tipo numérico pode ser real (<code>double</code>) ou inteiro (<code>integer</code>) (Figura @ref(fig:data-types-rel)).</p>
<p><strong>Números inteiros</strong>: são geralmente usados para contagem (n° habitantes, n° de palavras, quantidade de eventos de um dado fenômeno). São números sem a parte fracionária.</p>
<p><strong>Números reais</strong>: podem ter uma parte fracionária e uma inteira. Estes resultam de medidas que podem assumir qualquer valor: 3.5 horas, 10.4 mm, 18.1 °C.</p>
<div class="rmdimportant">
<p>
Medidas são compostas de um número e uma escala. Você pode estar trabalhando com valores de população na escala de milhões de habitantes, mas o valor pode ser apenas 1.7. Para garantir consistência nos seus cálculos, em termos de unidades, é recomendado nomear sua variável com alguma referência à sua unidade de medida. Erros de unidades podem ter consequências catastróficas como o exemplo do <a href="https://pt.wikipedia.org/wiki/Mars_Climate_Orbiter#Resultados">Caso do Orbitador Climático de Marte</a>.
</p>
</div>
<p>Como todo n° inteiro pode ser representado como real, por padrão números (ou operações envolvendo números) são definidos como <strong><code>double</code></strong> (<a href="https://pt.wikipedia.org/wiki/Dupla_precis%C3%A3o_no_formato_de_ponto_flutuante">dupla precisão no formato de ponto flutuante</a>) no <img src="images/logo_r.png" width="20">. Por exemplo o vetor <code>vetor_num</code> é numérico:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">(vetor_num &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="ot">NA_real_</span>))</a>
<a class="sourceLine" id="cb85-2" title="2"><span class="co">#&gt; [1] -1  0  1  2 NA</span></a>
<a class="sourceLine" id="cb85-3" title="3"><span class="kw">class</span>(vetor_num)</a>
<a class="sourceLine" id="cb85-4" title="4"><span class="co">#&gt; [1] &quot;numeric&quot;</span></a></code></pre></div>
<p>Podemos determinar se uma variável é do tipo real ou inteiro com a função <code>typeof()</code>:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">typeof</span>(vetor_num)</a>
<a class="sourceLine" id="cb86-2" title="2"><span class="co">#&gt; [1] &quot;double&quot;</span></a></code></pre></div>
<p>Para definirmos um vetor como do tipo <strong><code>integer</code></strong> é necessário usar o sufixo <code>L</code> em cada elemento numérico do vetor.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">(vetor_int &lt;-<span class="st"> </span><span class="kw">c</span>(1L, 6L, 10L, <span class="ot">NA_integer_</span>))</a>
<a class="sourceLine" id="cb87-2" title="2"><span class="co">#&gt; [1]  1  6 10 NA</span></a>
<a class="sourceLine" id="cb87-3" title="3"><span class="kw">typeof</span>(vetor_int)</a>
<a class="sourceLine" id="cb87-4" title="4"><span class="co">#&gt; [1] &quot;integer&quot;</span></a></code></pre></div>
<p>Há outra forma, bem mais prática, de criar vetores de inteiros: a partir da conversão de uma variável do tipo real (<code>double</code>) usando a função <code>as.integer()</code>:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">vetor_num_fi &lt;-<span class="st"> </span><span class="kw">as.integer</span>(vetor_num)</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">typeof</span>(vetor_num_fi)</a>
<a class="sourceLine" id="cb88-3" title="3"><span class="co">#&gt; [1] &quot;integer&quot;</span></a></code></pre></div>
<p>Na exemplo acima nós forçamos a conversão da variável <code>vetor_num</code> do tipo real para inteiro e verificamos qual seu tipo.</p>
<div class="rmdnote">
<p>
Há outros tipos de dados numéricos no R, como: complexos e hexadecimais.
</p>
</div>
</div>
<div id="caractere" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Caractere</h3>
<p>Um grupo de caracteres (ou <em>strings</em>), letras ou qualquer forma de texto são dados do tipo <strong><code>character</code></strong>. Eles são identificados por aspas dupla (<code>"</code>) ou simples (<code>'</code>) no início e fim de uma sequência de caracteres. Qualquer um destes delimitadores de caracteres podem ser usados para definir um dado como caractere:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">(vetor_char &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;ae&#39;</span>, <span class="ot">NA_character_</span>, <span class="st">&quot;ou&quot;</span>))</a>
<a class="sourceLine" id="cb89-2" title="2"><span class="co">#&gt; [1] &quot;ae&quot; NA   &quot;ou&quot;</span></a>
<a class="sourceLine" id="cb89-3" title="3"><span class="kw">class</span>(vetor_char)</a>
<a class="sourceLine" id="cb89-4" title="4"><span class="co">#&gt; [1] &quot;character&quot;</span></a></code></pre></div>
<p>Dados do tipo caractere são usados para descrição qualitativa de uma variável, como no caso de identificadores (por exemplo: nome de pessoas, cidades, IP de computadores em uma rede, cores, etc).</p>
<p>O número de letras em cada elemento de um vetor do tipo <strong><code>character</code></strong> podemos determinar com <code>nchar()</code>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">nchar</span>(vetor_char)</a>
<a class="sourceLine" id="cb90-2" title="2"><span class="co">#&gt; [1]  2 NA  2</span></a></code></pre></div>
<p>O <img src="images/logo_r.png" width="20"> vem com alguns vetores de caracteres pré-definidos:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co"># alfabeto inglês em letras minúsculas</span></a>
<a class="sourceLine" id="cb91-2" title="2">letters</a>
<a class="sourceLine" id="cb91-3" title="3"><span class="co">#&gt;  [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; &quot;j&quot; &quot;k&quot; &quot;l&quot; &quot;m&quot; &quot;n&quot; &quot;o&quot; &quot;p&quot; &quot;q&quot; &quot;r&quot; &quot;s&quot;</span></a>
<a class="sourceLine" id="cb91-4" title="4"><span class="co">#&gt; [20] &quot;t&quot; &quot;u&quot; &quot;v&quot; &quot;w&quot; &quot;x&quot; &quot;y&quot; &quot;z&quot;</span></a>
<a class="sourceLine" id="cb91-5" title="5"><span class="co"># alfabeto inglês em letras maiúsculas</span></a>
<a class="sourceLine" id="cb91-6" title="6">LETTERS</a>
<a class="sourceLine" id="cb91-7" title="7"><span class="co">#&gt;  [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot; &quot;I&quot; &quot;J&quot; &quot;K&quot; &quot;L&quot; &quot;M&quot; &quot;N&quot; &quot;O&quot; &quot;P&quot; &quot;Q&quot; &quot;R&quot; &quot;S&quot;</span></a>
<a class="sourceLine" id="cb91-8" title="8"><span class="co">#&gt; [20] &quot;T&quot; &quot;U&quot; &quot;V&quot; &quot;W&quot; &quot;X&quot; &quot;Y&quot; &quot;Z&quot;</span></a>
<a class="sourceLine" id="cb91-9" title="9"><span class="co"># nomes dos meses em inglês</span></a>
<a class="sourceLine" id="cb91-10" title="10">month.name</a>
<a class="sourceLine" id="cb91-11" title="11"><span class="co">#&gt;  [1] &quot;January&quot;   &quot;February&quot;  &quot;March&quot;     &quot;April&quot;     &quot;May&quot;       &quot;June&quot;     </span></a>
<a class="sourceLine" id="cb91-12" title="12"><span class="co">#&gt;  [7] &quot;July&quot;      &quot;August&quot;    &quot;September&quot; &quot;October&quot;   &quot;November&quot;  &quot;December&quot;</span></a>
<a class="sourceLine" id="cb91-13" title="13"><span class="co"># abreviatura dos nomes dos meses em inglês</span></a>
<a class="sourceLine" id="cb91-14" title="14">month.abb</a>
<a class="sourceLine" id="cb91-15" title="15"><span class="co">#&gt;  [1] &quot;Jan&quot; &quot;Feb&quot; &quot;Mar&quot; &quot;Apr&quot; &quot;May&quot; &quot;Jun&quot; &quot;Jul&quot; &quot;Aug&quot; &quot;Sep&quot; &quot;Oct&quot; &quot;Nov&quot; &quot;Dec&quot;</span></a></code></pre></div>
<p>Se você precisar incluir aspas duplas ou apóstrofe em um caractere usando os dois delimitadores juntos, como nos dois exemplos, respectivamente:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">citacao &lt;-<span class="st"> &#39;Me diga o que é pior: &quot;Desistir do que quer ou se contentar com o que nunca quis?&quot; - Reverb Poesia.&#39;</span></a>
<a class="sourceLine" id="cb92-2" title="2">citacao</a>
<a class="sourceLine" id="cb92-3" title="3"><span class="co">#&gt; [1] &quot;Me diga o que é pior: \&quot;Desistir do que quer ou se contentar com o que nunca quis?\&quot; - Reverb Poesia.&quot;</span></a>
<a class="sourceLine" id="cb92-4" title="4"></a>
<a class="sourceLine" id="cb92-5" title="5">sentenca_apos &lt;-<span class="st"> &quot;Marca d&#39;água&quot;</span></a>
<a class="sourceLine" id="cb92-6" title="6">sentenca_apos</a>
<a class="sourceLine" id="cb92-7" title="7"><span class="co">#&gt; [1] &quot;Marca d&#39;água&quot;</span></a></code></pre></div>
<p>Se precisar usar ambos delimitadores dentro um mesmo caractere, use a barra invertida (<code>\</code>) antes do delimitador que deseja desconsiderar.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">(sentenca_2aspas &lt;-<span class="st"> &quot;Ele disse: </span><span class="ch">\&quot;</span><span class="st">Me sinto como um peixe fora d&#39;água</span><span class="ch">\&quot;</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb93-2" title="2"><span class="co">#&gt; [1] &quot;Ele disse: \&quot;Me sinto como um peixe fora d&#39;água\&quot;&quot;</span></a></code></pre></div>
<p>Note que a impressão de caracteres no console inclui a barra invertida para maior clareza. Esse padrão também ocorre com a função <code>print()</code>:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">print</span>(sentenca_2aspas)</a>
<a class="sourceLine" id="cb94-2" title="2"><span class="co">#&gt; [1] &quot;Ele disse: \&quot;Me sinto como um peixe fora d&#39;água\&quot;&quot;</span></a></code></pre></div>
<p>Já a função <code>cat()</code><a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a>, interpreta caracteres especiais (como a barra invertida <code>\</code> e a quebra de linha <code>\n</code>), para então dar saída na tela.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">cat</span>(sentenca_2aspas, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="co">#&gt; Ele disse: &quot;Me sinto como um peixe fora d&#39;água&quot;</span></a></code></pre></div>
<div class="rmdnote">
<p>
Há diversos caracteres especiais com interpretação especial dentro de caracteres (strings). Eles são precedidos por uma barra invertida (<em>escape</em>). Os mais comuns são:
</p>
<ul>
<li>
<p>
<code>\’</code> aspas simples
</p>
</li>
<li>
<p>
<code>\"</code> aspas duplas
</p>
</li>
<li>
<p>
<code>\n</code> quebra de lina ou nova linha
</p>
</li>
<li>
<p>
<code>\\</code> a própria barra invertida
</p>
</li>
</ul>
</div>
</div>
<div id="logico" class="section level3">
<h3><span class="header-section-number">6.1.4</span> Lógico</h3>
<p>Valores lógicos são um tipo de vetores atômicos extremamente úteis simples, pois só podem assumir os valores <code>TRUE</code> (verdadeiro), <code>FALSE</code> (falso) e <code>NA</code>. No <img src="images/logo_r.png" width="20"> eles são da classe de dados do tipo <code>logical</code>.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="co"># variável lógica</span></a>
<a class="sourceLine" id="cb96-2" title="2">vetor_log &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">NA</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb96-3" title="3">vetor_log</a>
<a class="sourceLine" id="cb96-4" title="4"><span class="co">#&gt; [1] FALSE    NA FALSE  TRUE</span></a>
<a class="sourceLine" id="cb96-5" title="5"><span class="kw">class</span>(vetor_log)</a>
<a class="sourceLine" id="cb96-6" title="6"><span class="co">#&gt; [1] &quot;logical&quot;</span></a></code></pre></div>
<p>O <img src="images/logo_r.png" width="20"> aceita as abreviaturas <code>T</code> e <code>F</code> para representar <code>TRUE</code> e <code>FALSE</code>. Entretanto, esta não é uma prática recomendável, pois <code>T</code> e <code>F</code> não fazem parte das palavras reservadas do <img src="images/logo_r.png" width="20">. Consequentemente isso pode levar a confusão, como no exemplo abaixo.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb97-2" title="2"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb97-3" title="3">T</a>
<a class="sourceLine" id="cb97-4" title="4"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb97-5" title="5"><span class="kw">class</span>(T)</a>
<a class="sourceLine" id="cb97-6" title="6"><span class="co">#&gt; [1] &quot;logical&quot;</span></a>
<a class="sourceLine" id="cb97-7" title="7">T &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb97-8" title="8"><span class="kw">class</span>(T)</a>
<a class="sourceLine" id="cb97-9" title="9"><span class="co">#&gt; [1] &quot;numeric&quot;</span></a>
<a class="sourceLine" id="cb97-10" title="10"><span class="kw">c</span>(T, F)</a>
<a class="sourceLine" id="cb97-11" title="11"><span class="co">#&gt; [1] 10  0</span></a></code></pre></div>
<p>Vetores lógicos resultam de comparações e são amplamente usados em estruturas de controle condicional do código (como por exemplo nas funções <code>if()</code> e <code>ifelse()</code>).</p>
</div>
</div>
<div id="testes-sobre-tipos-de-dados" class="section level2">
<h2><span class="header-section-number">6.2</span> Testes sobre tipos de dados</h2>
<p>Além função <code>typeof()</code>, a família de funções <code>is.{tipo_de_dados}()</code> também permite descobrir o tipo de dado de uma variável. Por exemplo, para testar se a variável <code>vetor_num</code> é do tipo <code>character</code>, substituímos <code>{tipo_de_dados}</code> por <code>character</code>:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">is.character</span>(vetor_num)</a>
<a class="sourceLine" id="cb98-2" title="2"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>O mesmo processo vale para <code>integer</code>, <code>numeric</code>, <code>double</code>, <code>logical</code>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">is.integer</span>(vetor_num)</a>
<a class="sourceLine" id="cb99-2" title="2"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb99-3" title="3"><span class="kw">is.numeric</span>(vetor_num)</a>
<a class="sourceLine" id="cb99-4" title="4"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb99-5" title="5"><span class="kw">is.double</span>(vetor_num)</a>
<a class="sourceLine" id="cb99-6" title="6"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb99-7" title="7"><span class="kw">is.logical</span>(vetor_num)</a>
<a class="sourceLine" id="cb99-8" title="8"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>Essa é uma forma de verificação mais direta do tipo de uma variável. Outra possível forma seria combinar o uso do operador relacional<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a> idêntico (<code>==</code>) e a mais legível que <code>typeof(vetor_num) == "double"</code>. O operador <code>==</code> é um operador relacional para verificar se dois objetos são iguais.</p>
<div class="rmdtip">
<p>
O grupo de funções <code>is.{tipo_de_dados}()</code> inclui também opções para verificar se a variável tem valores:
</p>
<ul>
<li>
<code>NA</code>: <code>is.na()</code>
</li>
<li>
<code>NaN</code>: <code>is.nan()</code>
</li>
<li>
<code>Inf</code>: <code>is.infinite</code>
</li>
<li>
valores finitos: <code>is.finite()</code>
</li>
</ul>
</div>
</div>
<div id="conversão-entre-tipos-de-dados" class="section level2">
<h2><span class="header-section-number">6.3</span> Conversão entre tipos de dados</h2>
<p>Em algumas circunstâncias precisamos alterar o tipo de uma variável para o tipo que queremos. Para isso há o grupo de funções <code>as.{tipo_de_dados}()</code>, semelhante ao grupo de funções <code>is.{tipo_de_dados}()</code>. Este tipo de operação é chamada de <strong>coerção</strong> no <img src="images/logo_r.png" width="20">.</p>
<!-- 
COLOCAR TUDO EM UMA TABELA SÓ 
-->
<p>Então, a coerção da variável <code>vetor_num</code> para inteiro pode ser feita com:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">vetor_num</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="co">#&gt; [1] -1  0  1  2 NA</span></a>
<a class="sourceLine" id="cb100-3" title="3"><span class="kw">as.integer</span>(vetor_num)</a>
<a class="sourceLine" id="cb100-4" title="4"><span class="co">#&gt; [1] -1  0  1  2 NA</span></a>
<a class="sourceLine" id="cb100-5" title="5"><span class="co"># verificação do resultado</span></a>
<a class="sourceLine" id="cb100-6" title="6"><span class="kw">typeof</span>(<span class="kw">as.integer</span>(vetor_num))</a>
<a class="sourceLine" id="cb100-7" title="7"><span class="co">#&gt; [1] &quot;integer&quot;</span></a></code></pre></div>
<p>Já a sua coerção para lógico</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">as.logical</span>(vetor_num)</a>
<a class="sourceLine" id="cb101-2" title="2"><span class="co">#&gt; [1]  TRUE FALSE  TRUE  TRUE    NA</span></a>
<a class="sourceLine" id="cb101-3" title="3"><span class="co"># verificação do resultado</span></a>
<a class="sourceLine" id="cb101-4" title="4"><span class="kw">typeof</span>(<span class="kw">as.logical</span>(vetor_num))</a>
<a class="sourceLine" id="cb101-5" title="5"><span class="co">#&gt; [1] &quot;logical&quot;</span></a></code></pre></div>
<p>converte <strong>0</strong> para <code>FALSE</code> e <strong>qualquer outro número</strong> para <code>TRUE</code>.</p>
<p>A coerção da variável <code>vetor_log</code> para numérica</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">vetor_log</a>
<a class="sourceLine" id="cb102-2" title="2"><span class="co">#&gt; [1] FALSE    NA FALSE  TRUE</span></a>
<a class="sourceLine" id="cb102-3" title="3"><span class="kw">as.numeric</span>(vetor_log)</a>
<a class="sourceLine" id="cb102-4" title="4"><span class="co">#&gt; [1]  0 NA  0  1</span></a>
<a class="sourceLine" id="cb102-5" title="5"><span class="co"># verificação do resultado</span></a>
<a class="sourceLine" id="cb102-6" title="6"><span class="kw">typeof</span>(<span class="kw">as.numeric</span>(vetor_log))</a>
<a class="sourceLine" id="cb102-7" title="7"><span class="co">#&gt; [1] &quot;double&quot;</span></a></code></pre></div>
<p>converte os valores <code>FALSE</code> para <strong>0</strong> e <strong>TRUE</strong> para <code>1</code>.</p>
<p>A coerção da variável <code>vetor_char</code> para numérica ou inteiro</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">vetor_char</a>
<a class="sourceLine" id="cb103-2" title="2"><span class="co">#&gt; [1] &quot;ae&quot; NA   &quot;ou&quot;</span></a>
<a class="sourceLine" id="cb103-3" title="3"><span class="kw">as.integer</span>(vetor_char)</a>
<a class="sourceLine" id="cb103-4" title="4"><span class="co">#&gt; Warning: NAs introduzidos por coerção</span></a>
<a class="sourceLine" id="cb103-5" title="5"><span class="co">#&gt; [1] NA NA NA</span></a>
<a class="sourceLine" id="cb103-6" title="6"><span class="co"># verificação do resultado</span></a>
<a class="sourceLine" id="cb103-7" title="7"><span class="kw">typeof</span>(<span class="kw">as.numeric</span>(vetor_char))</a>
<a class="sourceLine" id="cb103-8" title="8"><span class="co">#&gt; Warning in typeof(as.numeric(vetor_char)): NAs introduzidos por coerção</span></a>
<a class="sourceLine" id="cb103-9" title="9"><span class="co">#&gt; [1] &quot;double&quot;</span></a></code></pre></div>
<p>gera <code>NA</code>.</p>
<p>Como vetores atômicos podem ter dados de um único tipo, a concatenação de vetores de tipos diferentes levará a coerção automática (ou implícita) dos dados pelo <img src="images/logo_r.png" width="20">, para o tipo mais fácil de ser convertido.</p>
<p>Misturando <code>numeric</code> com <code>character</code> resulta:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1">(vmix_num_char &lt;-<span class="st"> </span><span class="kw">c</span>(vetor_num, vetor_char))</a>
<a class="sourceLine" id="cb104-2" title="2"><span class="co">#&gt; [1] &quot;-1&quot; &quot;0&quot;  &quot;1&quot;  &quot;2&quot;  NA   &quot;ae&quot; NA   &quot;ou&quot;</span></a>
<a class="sourceLine" id="cb104-3" title="3"><span class="kw">typeof</span>(vmix_num_char)</a>
<a class="sourceLine" id="cb104-4" title="4"><span class="co">#&gt; [1] &quot;character&quot;</span></a></code></pre></div>
<p>Misturando <code>logical</code> com <code>numeric</code> resulta:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">(vmix_log_num &lt;-<span class="st"> </span><span class="kw">c</span>(vetor_log, vetor_num))</a>
<a class="sourceLine" id="cb105-2" title="2"><span class="co">#&gt; [1]  0 NA  0  1 -1  0  1  2 NA</span></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="kw">typeof</span>(vmix_log_num)</a>
<a class="sourceLine" id="cb105-4" title="4"><span class="co">#&gt; [1] &quot;double&quot;</span></a></code></pre></div>
<p>Misturando <code>double</code> com <code>integer</code> resulta:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">(vmix_dbl_int &lt;-<span class="st"> </span><span class="kw">c</span>(vetor_dbl, vetor_int))</a>
<a class="sourceLine" id="cb106-2" title="2"><span class="co">#&gt; [1] -1.51  0.33  1.46  2.04  1.00  6.00 10.00    NA</span></a>
<a class="sourceLine" id="cb106-3" title="3"><span class="kw">typeof</span>(vmix_dbl_int)</a>
<a class="sourceLine" id="cb106-4" title="4"><span class="co">#&gt; [1] &quot;double&quot;</span></a></code></pre></div>
<p>Misturando <code>lógical</code> com <code>character</code> resulta:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">(vmix_log_char &lt;-<span class="st"> </span><span class="kw">c</span>(vetor_log, vetor_char))</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="co">#&gt; [1] &quot;FALSE&quot; NA      &quot;FALSE&quot; &quot;TRUE&quot;  &quot;ae&quot;    NA      &quot;ou&quot;</span></a>
<a class="sourceLine" id="cb107-3" title="3"><span class="kw">typeof</span>(vmix_log_char)</a>
<a class="sourceLine" id="cb107-4" title="4"><span class="co">#&gt; [1] &quot;character&quot;</span></a></code></pre></div>
<p>A hierarquia usada na coerção entre tipos de dados segue a relação:</p>
<p style="color:DodgerBlue; font-size:1.3em; font-weight: bold;text-align:center;">
<code>logical &lt; integer &lt; numeric &lt;  character</code>
</p>
<p>A coerção implícita pode ser bastante útil em operações com variáveis lógicas. Para descobrirmos quantos números são positivos na variável <code>vetor_num</code>, podemos fazer:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="co"># vetor lógico</span></a>
<a class="sourceLine" id="cb108-2" title="2">vetor_num <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> </a>
<a class="sourceLine" id="cb108-3" title="3"><span class="co">#&gt; [1] FALSE FALSE  TRUE  TRUE    NA</span></a>
<a class="sourceLine" id="cb108-4" title="4"><span class="kw">sum</span>(vetor_num <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb108-5" title="5"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<p>Neste exemplo, os valores lógicos obtidos com o operador <code>&gt;</code> foram implicitamente convertidos para numéricos (<code>TRUE</code> para <code>1</code>, <code>FALSE</code> para <code>0</code>) antes de se obter a soma dos casos verdadeiros. O argumento <code>na.rm = TRUE</code> habilita a funcionalidade de realizar a soma ignorando os itens faltantes.</p>
</div>
<div id="outros-tipos-de-dados-derivados" class="section level2">
<h2><span class="header-section-number">6.4</span> Outros tipos de dados derivados</h2>
<div id="fator" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Fator</h3>
<p>Em alguns casos variáveis do tipo caractere possuem uma ordem implícita. Este tipo de variável é geralmente chamada de <strong>categórica</strong>. Então qualquer variável que pode ser ordenada ou classificada em grupos pode ser representada como <code>factor</code> no <img src="images/logo_r.png" width="20">.</p>
<p>Podemos por exemplo classificar eventos de ocorrência de chuva por classe de intensidade:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">intensidade &lt;-<span class="st"> </span><span class="kw">factor</span>(</a>
<a class="sourceLine" id="cb109-2" title="2">  <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;baixa&quot;</span>, <span class="st">&quot;moderada&quot;</span>, <span class="st">&quot;alta&quot;</span>)</a>
<a class="sourceLine" id="cb109-3" title="3">  )</a>
<a class="sourceLine" id="cb109-4" title="4">intensidade</a>
<a class="sourceLine" id="cb109-5" title="5"><span class="co">#&gt; [1] baixa    moderada alta    </span></a>
<a class="sourceLine" id="cb109-6" title="6"><span class="co">#&gt; Levels: alta baixa moderada</span></a></code></pre></div>
<p>Note que a impressão de um fator na tela é diferente da de um caractere. Ele é impresso sem as aspas e há uma segunda linha de informação sobre os níveis (<em>levels</em>) da variável <code>intensidade</code>. Um fator possui o atributo adicional: níveis. Os níveis de um fator são obtidos com a função <code>levels()</code>:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">levels</span>(intensidade)</a>
<a class="sourceLine" id="cb110-2" title="2"><span class="co">#&gt; [1] &quot;alta&quot;     &quot;baixa&quot;    &quot;moderada&quot;</span></a></code></pre></div>
<p>Por padrão os níveis são definidos em ordem alfabética. Então <code>"alta"</code> recebeu o índice <code>1</code>, <code>"baixa"</code> o índice <code>2</code> e <code>moderada</code> o índice <code>3</code>. Estes índices são mostrados com a função <code>str()</code> ou convertendo um fator para numérico:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">str</span>(intensidade)</a>
<a class="sourceLine" id="cb111-2" title="2"><span class="co">#&gt;  Factor w/ 3 levels &quot;alta&quot;,&quot;baixa&quot;,..: 2 3 1</span></a>
<a class="sourceLine" id="cb111-3" title="3"><span class="kw">as.numeric</span>(intensidade)</a>
<a class="sourceLine" id="cb111-4" title="4"><span class="co">#&gt; [1] 2 3 1</span></a></code></pre></div>
<p>A função <code>str()</code> é uma abreviação para <code>structure</code> e serve para nos fornecer um resumo da estrutura dos dados.</p>
<p>No caso das intensidade, seria melhor que os níveis fossem ordenados como: <code>baixa &lt; moderada &lt; alta</code>. Nós podemos especificar um <strong>fator ordenado</strong> ao <img src="images/logo_r.png" width="20">, especificando no argumento <code>levels</code>:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">intensidade_o &lt;-<span class="st"> </span><span class="kw">factor</span>(</a>
<a class="sourceLine" id="cb112-2" title="2">  <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;baixa&quot;</span>, <span class="st">&quot;moderada&quot;</span>, <span class="st">&quot;alta&quot;</span>),</a>
<a class="sourceLine" id="cb112-3" title="3">  <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;baixa&quot;</span>, <span class="st">&quot;moderada&quot;</span>, <span class="st">&quot;alta&quot;</span>),</a>
<a class="sourceLine" id="cb112-4" title="4">  <span class="dt">ordered =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb112-5" title="5">  )</a>
<a class="sourceLine" id="cb112-6" title="6">intensidade_o</a>
<a class="sourceLine" id="cb112-7" title="7"><span class="co">#&gt; [1] baixa    moderada alta    </span></a>
<a class="sourceLine" id="cb112-8" title="8"><span class="co">#&gt; Levels: baixa &lt; moderada &lt; alta</span></a></code></pre></div>
<p>Fatores são úteis em alguns processos analíticos e gráficos. Para ilustrar um exemplo simples, suponha que o número de casos registrados em cada intensidade tenha sido:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">n_casos &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">30</span>, <span class="dv">5</span>)</a></code></pre></div>
<p>Poderíamos representar graficamente estas informações. Veja abaixo a diferença na ordem do eixo x, ao usar o fator <code>intensidade</code>(ordem alfabética) e <code>intensidade_o</code> (ordenado):</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb114-2" title="2"><span class="kw">qplot</span>(<span class="dt">x =</span> intensidade, <span class="dt">y =</span> n_casos, <span class="dt">geom =</span> <span class="st">&quot;col&quot;</span>)</a></code></pre></div>
<p><img src="images/unnamed-chunk-23-1.png" width="672" /></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">qplot</span>(<span class="dt">x =</span> intensidade_o, <span class="dt">y =</span> n_casos, <span class="dt">geom =</span> <span class="st">&quot;col&quot;</span>)</a></code></pre></div>
<p><img src="images/unnamed-chunk-23-2.png" width="672" /></p>
<p>Para verificar se uma variável é um <strong>fator</strong> e se esse fator é ordenado usamos, respectivamente:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">is.factor</span>(intensidade)</a>
<a class="sourceLine" id="cb116-2" title="2"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb116-3" title="3"><span class="kw">is.ordered</span>(intensidade)</a>
<a class="sourceLine" id="cb116-4" title="4"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>A coerção para <strong>fator</strong> é feita pela função <code>as.factor</code>:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">(intensidade_no &lt;-<span class="st"> </span><span class="kw">as.factor</span>(</a>
<a class="sourceLine" id="cb117-2" title="2">  <span class="kw">c</span>(<span class="st">&quot;baixa&quot;</span>, <span class="st">&quot;moderada&quot;</span>, <span class="st">&quot;alta&quot;</span>, <span class="st">&quot;baixa&quot;</span>, <span class="st">&quot;baixa&quot;</span>, <span class="st">&quot;moderada&quot;</span>)</a>
<a class="sourceLine" id="cb117-3" title="3">))</a>
<a class="sourceLine" id="cb117-4" title="4"><span class="co">#&gt; [1] baixa    moderada alta     baixa    baixa    moderada</span></a>
<a class="sourceLine" id="cb117-5" title="5"><span class="co">#&gt; Levels: alta baixa moderada</span></a></code></pre></div>
<!-- 
summary(intensidade_no)
-->
</div>
<div id="datas-e-horários" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Datas e horários</h3>
<p>Lidar com datas e horários pode ser difícil se não for usada uma estrutura de dados específica para isso. Entre as classes mais úteis para armazenar este tipo de informação, estão:</p>
<ul>
<li><p><code>Date</code>: para combinar datas (anos, meses e dias)</p></li>
<li><p><code>POSIXct</code>: para combinar datas e horas (horas, minutos e segundos)</p></li>
</ul>
<p><code>Date</code> armazena apenas datas, enquanto <code>POSIXct</code> armazena a datas associadas com horários. Ambos dados são representados como o número de dias (<strong><code>Date</code></strong>) ou de segundos (<strong><code>POSIXct</code></strong>) decorridos desde 1 de Janeiro de 1970.</p>
<p>Exemplos de cada um destes tipos de dados podem ser obtidos com o <img src="images/logo_r.png" width="20"> usando as funções internas <code>Sys.Date()</code> e <code>Sys.time()</code> que informam a data e a hora atual:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">Sys.Date</span>()</a>
<a class="sourceLine" id="cb118-2" title="2"><span class="co">#&gt; [1] &quot;2020-05-30&quot;</span></a>
<a class="sourceLine" id="cb118-3" title="3"><span class="kw">Sys.time</span>()</a>
<a class="sourceLine" id="cb118-4" title="4"><span class="co">#&gt; [1] &quot;2020-05-30 17:10:37 -03&quot;</span></a></code></pre></div>
<!-- Na saída da `Sys.time()` a última parte (`03`) refere-se ao fuso horário (3h antes do meridiano de Greenwich). -->
<p>As datas seguem o formato padrão de representação <a href="https://pt.wikipedia.org/wiki/ISO_8601">ISO-8601</a>, ou seja o formato <code>YYYY-MM-DD</code> para <code>ano-mês-dia</code>, independente do local onde você mora.</p>
<p>Datas são criadas a partir da coerção de dados do tipo <code>character</code> para <code>date</code>:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">amd &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2012-06-28&quot;</span>)</a>
<a class="sourceLine" id="cb119-2" title="2">amd</a>
<a class="sourceLine" id="cb119-3" title="3"><span class="co">#&gt; [1] &quot;2012-06-28&quot;</span></a>
<a class="sourceLine" id="cb119-4" title="4"><span class="kw">class</span>(amd)</a>
<a class="sourceLine" id="cb119-5" title="5"><span class="co">#&gt; [1] &quot;Date&quot;</span></a>
<a class="sourceLine" id="cb119-6" title="6"><span class="co"># num. de dias de 1971</span></a>
<a class="sourceLine" id="cb119-7" title="7"><span class="kw">as.numeric</span>(amd)</a>
<a class="sourceLine" id="cb119-8" title="8"><span class="co">#&gt; [1] 15519</span></a></code></pre></div>
<p>Datas com horários são criados a partir da coerção de dados do tipo <code>character</code> para <code>POSIXct</code>:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1">amd_hms &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-06-28 17:42&quot;</span>)</a>
<a class="sourceLine" id="cb120-2" title="2">amd_hms</a>
<a class="sourceLine" id="cb120-3" title="3"><span class="co">#&gt; [1] &quot;2012-06-28 17:42:00 -03&quot;</span></a>
<a class="sourceLine" id="cb120-4" title="4"><span class="kw">class</span>(amd_hms)</a>
<a class="sourceLine" id="cb120-5" title="5"><span class="co">#&gt; [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</span></a>
<a class="sourceLine" id="cb120-6" title="6"><span class="kw">as.numeric</span>(amd_hms)</a>
<a class="sourceLine" id="cb120-7" title="7"><span class="co">#&gt; [1] 1340916120</span></a></code></pre></div>
<p>A manipulação de dados da classe de datas com horários (<code>POSIXct</code>) torna-se mais versátil através do pacote <code>lubridate</code>, específico para manipulação de datas, o que será visto posteriormente.</p>
<p>O <img src="images/logo_r.png" width="20"> requer que o formato de entrada dos dados sejam especificados usando a <code>%</code> e outros códigos que são descritos no manual de ajuda da função <code>?strptime</code>. O formato padrão assumido pelo R para caracteres contendo datas com horas é <code>%Y-%m-%d %H:%M:%S</code>.</p>
<table>
<caption>(#tab:format-dates)Códigos de formato de datas e horas.</caption>
<thead>
<tr class="header">
<th align="center">código</th>
<th align="center">Significado</th>
<th align="center">Intervalo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">%Y</td>
<td align="center">ano (incluindo século)</td>
<td align="center">1 - 9999</td>
</tr>
<tr class="even">
<td align="center">%m</td>
<td align="center">mês</td>
<td align="center">01 - 12</td>
</tr>
<tr class="odd">
<td align="center">%d</td>
<td align="center">dia</td>
<td align="center">01 - 31</td>
</tr>
<tr class="even">
<td align="center">%H</td>
<td align="center">hora</td>
<td align="center">00 - 23</td>
</tr>
<tr class="odd">
<td align="center">%M</td>
<td align="center">minuto</td>
<td align="center">00 - 59</td>
</tr>
<tr class="even">
<td align="center">%S</td>
<td align="center">segundo</td>
<td align="center">00 - 59</td>
</tr>
</tbody>
</table>
<p>Há vários outros códigos adicionais, por exemplo, para usar abreviações de meses como <code>Jan</code> (<code>%b</code>), e estes códigos são listados em <code>?strptime</code>.</p>
<p>Para extrair informações de uma data, como por exemplo o ano, podemos usar a função <code>format()</code> passando o código de formato ao argumento <code>format</code>.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">format</span>(<span class="dt">x =</span> <span class="kw">Sys.Date</span>(), <span class="dt">format =</span> <span class="st">&quot;%Y&quot;</span>)</a>
<a class="sourceLine" id="cb121-2" title="2"><span class="co">#&gt; [1] &quot;2020&quot;</span></a></code></pre></div>
<p>O argumento format também pode ser especificado nas funções <code>as.Date()</code> e <code>as.POSIXct()</code>, assim provendo grande versatilidade para ler datas em diferentes formatos. No exemplo a seguir, vamos converter um caractere com as informações de data com horário armazenadas na ordem dia, mês, ano, hora, minuto e segundo, sem nenhum delimitador.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">as.POSIXct</span>(</a>
<a class="sourceLine" id="cb122-2" title="2">  <span class="dt">x =</span> <span class="st">&quot;prec010120001942.grib&quot;</span>,</a>
<a class="sourceLine" id="cb122-3" title="3">  <span class="dt">tz =</span> <span class="st">&quot;UTC&quot;</span>, </a>
<a class="sourceLine" id="cb122-4" title="4">  <span class="dt">format =</span> <span class="st">&quot;prec%d%m%Y%H%M.grib&quot;</span></a>
<a class="sourceLine" id="cb122-5" title="5">  )</a>
<a class="sourceLine" id="cb122-6" title="6"><span class="co">#&gt; [1] &quot;2000-01-01 19:42:00 UTC&quot;</span></a></code></pre></div>
<!--chapter:end:06-tipos-dados.Rmd-->
</div>
</div>
</div>
<div id="manip-vectors" class="section level1">
<h1><span class="header-section-number">7</span> Manipulação de Vetores</h1>
<p>Neste capítulo veremos como manipular vetores, incluindo:</p>
<ul>
<li><p>como nomear vetores</p></li>
<li><p>realizar cálculos entre vetores</p></li>
<li><p>gerar sequências</p></li>
<li><p>entender a indexação de vetores</p></li>
<li><p>lidar com dados faltantes, nulos e duplicados</p></li>
<li><p>usar as funções para cálculos móveis</p></li>
</ul>
<p>Em algumas seções deste capítulos usaremos funções dos pacotes do grupo <a href="https://www.tidyverse.org/">tidyverse</a>, como o <a href="https://ggplot2.tidyverse.org/">ggplot2</a> e <a href="https://dplyr.tidyverse.org/">dplyr</a>. Para carregá-los basta digitar:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="propriedades" class="section level2">
<h2><span class="header-section-number">7.1</span> Propriedades</h2>
<ul>
<li><p><code>typeof()</code> para descobrir o tipo de dado</p></li>
<li><p><code>length()</code> para descobrir o tamanho de um tipo de dado</p></li>
<li><p><code>attributes</code> (informações acionais específicas do dado), entre eles o atributo mais comum está o <code>names()</code>.</p></li>
</ul>
<div id="nomeando-vetores" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Nomeando vetores</h3>
<p>As 3 formas equivalentes mais comuns de criar vetores com nomes são demostradas abaixo com um exemplo de dados mensais de precipitação.</p>
<ul>
<li>Durante a criação, com a função <code>c()</code> incluindo os nomes nos argumentos</li>
</ul>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="co"># vetor de chuva mensal para um dado ano</span></a>
<a class="sourceLine" id="cb124-2" title="2">prec &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb124-3" title="3">  <span class="dt">jan =</span> <span class="dv">300</span>, </a>
<a class="sourceLine" id="cb124-4" title="4">  <span class="dt">fev =</span> <span class="dv">150</span>,</a>
<a class="sourceLine" id="cb124-5" title="5">  <span class="dt">mar =</span> <span class="dv">210</span>,</a>
<a class="sourceLine" id="cb124-6" title="6">  <span class="dt">abr =</span> <span class="dv">12</span>, </a>
<a class="sourceLine" id="cb124-7" title="7">  <span class="dt">mai =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb124-8" title="8">  <span class="dt">jun =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb124-9" title="9">  <span class="dt">jul =</span> <span class="dv">12</span>, </a>
<a class="sourceLine" id="cb124-10" title="10">  <span class="dt">ago =</span> <span class="dv">22</span>, </a>
<a class="sourceLine" id="cb124-11" title="11">  <span class="dt">set =</span> <span class="dv">100</span>, </a>
<a class="sourceLine" id="cb124-12" title="12">  <span class="dt">out =</span> <span class="dv">120</span>, </a>
<a class="sourceLine" id="cb124-13" title="13">  <span class="dt">nov =</span> <span class="dv">10</span>,  </a>
<a class="sourceLine" id="cb124-14" title="14">  <span class="dt">dez =</span> <span class="dv">280</span></a>
<a class="sourceLine" id="cb124-15" title="15">  )</a></code></pre></div>
<ul>
<li>Modificando um vetor com a função <code>names()&lt;-</code></li>
</ul>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1">prec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">300</span>, <span class="dv">200</span>, <span class="dv">210</span>, <span class="dv">12</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">10</span>, <span class="dv">280</span>)</a>
<a class="sourceLine" id="cb125-2" title="2">meses &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;jan&quot;</span>, <span class="st">&quot;fev&quot;</span>, <span class="st">&quot;mar&quot;</span>, <span class="st">&quot;abr&quot;</span>, <span class="st">&quot;mai&quot;</span>, <span class="st">&quot;jun&quot;</span>, <span class="st">&quot;jul&quot;</span>, <span class="st">&quot;ago&quot;</span>, <span class="st">&quot;set&quot;</span>, <span class="st">&quot;out&quot;</span>, <span class="st">&quot;nov&quot;</span>, <span class="st">&quot;dez&quot;</span>)</a>
<a class="sourceLine" id="cb125-3" title="3"><span class="kw">names</span>(prec) &lt;-<span class="st"> </span>meses</a>
<a class="sourceLine" id="cb125-4" title="4">prec</a>
<a class="sourceLine" id="cb125-5" title="5"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb125-6" title="6"><span class="co">#&gt; 300 200 210  12   0   0  12  22 100 120  10 280</span></a></code></pre></div>
<ul>
<li>Criando um vetor modificado</li>
</ul>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1">prec &lt;-<span class="st"> </span><span class="kw">setNames</span>(</a>
<a class="sourceLine" id="cb126-2" title="2">  <span class="dt">object =</span> <span class="kw">c</span>(<span class="dv">300</span>, <span class="dv">200</span>, <span class="dv">210</span>, <span class="dv">12</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">10</span>, <span class="dv">280</span>),</a>
<a class="sourceLine" id="cb126-3" title="3">  <span class="dt">nm =</span> <span class="kw">c</span>(<span class="st">&quot;jan&quot;</span>, <span class="st">&quot;fev&quot;</span>, <span class="st">&quot;mar&quot;</span>, <span class="st">&quot;abr&quot;</span>, <span class="st">&quot;mai&quot;</span>, <span class="st">&quot;jun&quot;</span>, <span class="st">&quot;jul&quot;</span>, <span class="st">&quot;ago&quot;</span>, <span class="st">&quot;set&quot;</span>, <span class="st">&quot;out&quot;</span>, <span class="st">&quot;nov&quot;</span>, <span class="st">&quot;dez&quot;</span>)</a>
<a class="sourceLine" id="cb126-4" title="4">)</a>
<a class="sourceLine" id="cb126-5" title="5">prec</a>
<a class="sourceLine" id="cb126-6" title="6"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb126-7" title="7"><span class="co">#&gt; 300 200 210  12   0   0  12  22 100 120  10 280</span></a></code></pre></div>
<p>Nomes não podem ser repetidos entre os elementos, porque a seleção de um subconjunto do vetor baseada nos nomes retornará somente o primeiro elemento que tiver nome repetido.</p>
<p>Embora não faça muito sentido, nem todos elementos precisam ter nomes. A saída da função <code>names()</code> retornará um vetor caractere vazio ("") para aqueles elementos sem nomes especificados.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">(meses &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">jan =</span> <span class="dv">1</span>, <span class="dt">fev =</span> <span class="dv">2</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">12</span>))</a>
<a class="sourceLine" id="cb127-2" title="2"><span class="co">#&gt; jan fev                                         </span></a>
<a class="sourceLine" id="cb127-3" title="3"><span class="co">#&gt;   1   2   3   4   5   6   7   8   9  10  11  12</span></a>
<a class="sourceLine" id="cb127-4" title="4"><span class="kw">names</span>(meses)</a>
<a class="sourceLine" id="cb127-5" title="5"><span class="co">#&gt;  [1] &quot;jan&quot; &quot;fev&quot; &quot;&quot;    &quot;&quot;    &quot;&quot;    &quot;&quot;    &quot;&quot;    &quot;&quot;    &quot;&quot;    &quot;&quot;    &quot;&quot;    &quot;&quot;</span></a></code></pre></div>
<p>Quando nenhum nome é especificado, <code>names()</code> retornará <code>NULL</code><a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">names</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</a>
<a class="sourceLine" id="cb128-2" title="2"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>Para remover os nomes de um vetor, podemos usar a função <code>unname()</code> ou <code>names() &lt;- NULL</code>.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1">prec_clim &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">230</span>, <span class="dv">205</span>, <span class="dv">160</span>, <span class="dv">100</span>, <span class="dv">60</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">110</span>, <span class="dv">165</span>, <span class="dv">200</span>, <span class="dv">220</span>)</a>
<a class="sourceLine" id="cb129-2" title="2"><span class="kw">names</span>(prec_clim) &lt;-<span class="st"> </span><span class="kw">names</span>(prec)</a>
<a class="sourceLine" id="cb129-3" title="3">prec_clim</a>
<a class="sourceLine" id="cb129-4" title="4"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb129-5" title="5"><span class="co">#&gt; 230 205 160 100  60  30  40  60 110 165 200 220</span></a>
<a class="sourceLine" id="cb129-6" title="6"><span class="kw">unname</span>(prec_clim)</a>
<a class="sourceLine" id="cb129-7" title="7"><span class="co">#&gt;  [1] 230 205 160 100  60  30  40  60 110 165 200 220</span></a>
<a class="sourceLine" id="cb129-8" title="8"><span class="kw">names</span>(prec_clim) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb129-9" title="9">prec_clim</a>
<a class="sourceLine" id="cb129-10" title="10"><span class="co">#&gt;  [1] 230 205 160 100  60  30  40  60 110 165 200 220</span></a></code></pre></div>
<p>Nas próximas seções frequentemente usaremos os vetores <code>prec</code> e <code>prec_clim</code>. É importante então contextualizar essas variáveis. A variável <code>prec</code> consiste na precipitação mensal observada em um ano qualquer em um dado local. A variável <code>prec_clim</code> refere-se aos valores esperados de precipitação mensal<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a> (médias de pelo menos 30 anos) do mesmo local.</p>
</div>
</div>
<div id="atributos" class="section level2">
<h2><span class="header-section-number">7.2</span> Atributos</h2>
<p>Nós podemos adicionar atributos a um vetor, como por exemplo alguma informação sobre os valores daquela variável. A variável <code>prec</code> possui um atributo (<code>names</code>). A função <code>attributes()</code> lista qualquer atributo de uma variável. Vamos criar uma variável para mostrar como podemos adicionar um atributo a um vetor.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1">temp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">27</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">28</span>)</a>
<a class="sourceLine" id="cb130-2" title="2"><span class="kw">attributes</span>(temp)</a>
<a class="sourceLine" id="cb130-3" title="3"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>Podemos adicionar um atributo chamado <code>metadados</code> à <code>temp</code> e fornecer um vetor caractere com a função de atribuição de atributo <code>attr()&lt;-</code></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">attr</span>(temp, <span class="st">&quot;metadados&quot;</span>) &lt;-<span class="st"> &quot;dados obtidos em www.inmet.gov.br, acesso em 10/10/2010&quot;</span></a>
<a class="sourceLine" id="cb131-2" title="2">temp</a>
<a class="sourceLine" id="cb131-3" title="3"><span class="co">#&gt; [1] 27 23 21 18 19 28</span></a>
<a class="sourceLine" id="cb131-4" title="4"><span class="co">#&gt; attr(,&quot;metadados&quot;)</span></a>
<a class="sourceLine" id="cb131-5" title="5"><span class="co">#&gt; [1] &quot;dados obtidos em www.inmet.gov.br, acesso em 10/10/2010&quot;</span></a></code></pre></div>
<p>Algumas funções carregarão este atributo adiante, mas outras não, conforme exemplo a seguir.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1">(temp_inc &lt;-<span class="st"> </span>temp <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb132-2" title="2"><span class="co">#&gt; [1] 28 24 22 19 20 29</span></a>
<a class="sourceLine" id="cb132-3" title="3"><span class="co">#&gt; attr(,&quot;metadados&quot;)</span></a>
<a class="sourceLine" id="cb132-4" title="4"><span class="co">#&gt; [1] &quot;dados obtidos em www.inmet.gov.br, acesso em 10/10/2010&quot;</span></a>
<a class="sourceLine" id="cb132-5" title="5">(temp_inc &lt;-<span class="st"> </span><span class="kw">c</span>(temp_inc, <span class="dv">18</span>))</a>
<a class="sourceLine" id="cb132-6" title="6"><span class="co">#&gt; [1] 28 24 22 19 20 29 18</span></a></code></pre></div>
<p>Há situações de uso válido deste recurso, mas inicialmente é melhor não confiar nele.</p>
</div>
<div id="oper-vect" class="section level2">
<h2><span class="header-section-number">7.3</span> Operações com vetores</h2>
<p>Como o <code>R</code> é uma linguagem vetorizada, as operações são aplicadas a cada elemento do vetor automaticamente, sem a necessidade de laços (ou <em>loopings</em>) ao longo do vetor. Esta é uma das grandes vantagens do <img src="images/logo_r.png" width="20">.</p>
<p>Operações aritméticas podem ser aplicadas diretamente entre vetores.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="co"># desvios da prec em relação a média climatológica</span></a>
<a class="sourceLine" id="cb133-2" title="2">prec <span class="op">-</span><span class="st"> </span>prec_clim</a>
<a class="sourceLine" id="cb133-3" title="3"><span class="co">#&gt;  jan  fev  mar  abr  mai  jun  jul  ago  set  out  nov  dez </span></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="co">#&gt;   70   -5   50  -88  -60  -30  -28  -38  -10  -45 -190   60</span></a>
<a class="sourceLine" id="cb133-5" title="5"><span class="co"># anomalia em % relativa</span></a>
<a class="sourceLine" id="cb133-6" title="6">prec<span class="op">/</span>prec_clim <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb133-7" title="7"><span class="co">#&gt;       jan       fev       mar       abr       mai       jun       jul       ago </span></a>
<a class="sourceLine" id="cb133-8" title="8"><span class="co">#&gt; 130.43478  97.56098 131.25000  12.00000   0.00000   0.00000  30.00000  36.66667 </span></a>
<a class="sourceLine" id="cb133-9" title="9"><span class="co">#&gt;       set       out       nov       dez </span></a>
<a class="sourceLine" id="cb133-10" title="10"><span class="co">#&gt;  90.90909  72.72727   5.00000 127.27273</span></a>
<a class="sourceLine" id="cb133-11" title="11"><span class="co"># transformação boxcox da prec com alpha = 0.335</span></a>
<a class="sourceLine" id="cb133-12" title="12">((prec<span class="op">^</span><span class="fl">0.335</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span><span class="fl">0.335</span>)</a>
<a class="sourceLine" id="cb133-13" title="13"><span class="co">#&gt;       jan       fev       mar       abr       mai       jun       jul       ago </span></a>
<a class="sourceLine" id="cb133-14" title="14"><span class="co">#&gt; 17.188869 14.626583 14.916806  3.877403 -2.985075 -2.985075  3.877403  5.422424 </span></a>
<a class="sourceLine" id="cb133-15" title="15"><span class="co">#&gt;       set       out       nov       dez </span></a>
<a class="sourceLine" id="cb133-16" title="16"><span class="co">#&gt; 10.977168 11.856532  3.470802 16.727944</span></a>
<a class="sourceLine" id="cb133-17" title="17"><span class="co"># cte^intervalo</span></a>
<a class="sourceLine" id="cb133-18" title="18"><span class="kw">mean</span>(prec)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb133-19" title="19"><span class="co">#&gt; [1] 10.271319  4.725171  3.204890  2.538929</span></a></code></pre></div>
<p>Uma peculiaridade do <img src="images/logo_r.png" width="20"> é o tratamento de operações com vetores de tamanhos diferentes. O vetor menor é reciclado, de forma que seus elementos sejam repetidos em ordem até atingirem o tamanho do vetor mais longo envolvido na operação.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="co"># velocidades em m s-1</span></a>
<a class="sourceLine" id="cb134-2" title="2">(vel_ms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">0.3</span>, <span class="fl">1.4</span>, <span class="fl">2.0</span>))</a>
<a class="sourceLine" id="cb134-3" title="3"><span class="co">#&gt; [1] 1.5 0.3 1.4 2.0</span></a>
<a class="sourceLine" id="cb134-4" title="4"><span class="co"># fator de conversão para km h-1</span></a>
<a class="sourceLine" id="cb134-5" title="5">fator_conv &lt;-<span class="st"> </span><span class="fl">3.6</span></a>
<a class="sourceLine" id="cb134-6" title="6">vel_ms <span class="op">*</span><span class="st"> </span>fator_conv</a>
<a class="sourceLine" id="cb134-7" title="7"><span class="co">#&gt; [1] 5.40 1.08 5.04 7.20</span></a>
<a class="sourceLine" id="cb134-8" title="8"><span class="co"># equivalência</span></a>
<a class="sourceLine" id="cb134-9" title="9">fator_conv &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.6</span>, <span class="fl">3.6</span>, <span class="fl">3.6</span>, <span class="fl">3.6</span>)</a>
<a class="sourceLine" id="cb134-10" title="10">vel_ms <span class="op">*</span><span class="st"> </span>fator_conv</a>
<a class="sourceLine" id="cb134-11" title="11"><span class="co">#&gt; [1] 5.40 1.08 5.04 7.20</span></a></code></pre></div>
<p>A constante <code>fator_conv = 3.6</code> nesse caso é reciclada 4 vezes (tamanho do vetor <code>vel_ms</code>) e então multiplicada por cada elemento de <code>vetor_dbl</code>. Por isso os resultados no código acima são idênticos. Essa funcionalidade de fazer um vetor do mesmo tamanho de outro é conhecida como <strong>reciclagem</strong>. Se o vetor mais longo não tem tamanho múltiplo do mais curto, o <img src="images/logo_r.png" width="20"> realiza a operação com uma mensagem de aviso.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="dv">1</span><span class="op">:</span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb135-2" title="2"><span class="co">#&gt;  [1]  1  4  3  8  5 12  7 16  9 20</span></a>
<a class="sourceLine" id="cb135-3" title="3"><span class="dv">1</span><span class="op">:</span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb135-4" title="4"><span class="co">#&gt; Warning in 1:10 * 1:3: comprimento do objeto maior não é múltiplo do comprimento</span></a>
<a class="sourceLine" id="cb135-5" title="5"><span class="co">#&gt; do objeto menor</span></a>
<a class="sourceLine" id="cb135-6" title="6"><span class="co">#&gt;  [1]  1  4  9  4 10 18  7 16 27 10</span></a></code></pre></div>
<p>A reciclagem é um recurso útil, mas também perigoso. Seu código pode ficar mais elegante ou gerar resultados inesperados.</p>
<p>Operações aritméticas podem ser feitas com vetores lógicos, como nos exemplos abaixo:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="ot">FALSE</span> <span class="op">-</span><span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb136-2" title="2"><span class="co">#&gt; [1] -1</span></a>
<a class="sourceLine" id="cb136-3" title="3">prec_clim <span class="op">&gt;=</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb136-4" title="4"><span class="co">#&gt;  [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE</span></a>
<a class="sourceLine" id="cb136-5" title="5">(prec_clim <span class="op">&gt;=</span><span class="st"> </span><span class="dv">100</span>) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span></a>
<a class="sourceLine" id="cb136-6" title="6"><span class="co">#&gt;  [1]  1  2  3  4  0  0  0  0  9 10 11 12</span></a></code></pre></div>
<div id="comparações" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Comparações</h3>
<p>Vetores lógicos resultam da comparação de números ou caracteres. A Tabela @ref(tab:oper-logic) apresenta os principais operadores lógicos para comparações.</p>
<table>
<caption>(#tab:oper-logic)Operadores Lógicos</caption>
<thead>
<tr class="header">
<th align="center">Operador</th>
<th align="center">Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">&lt;</td>
<td align="center">menor que</td>
</tr>
<tr class="even">
<td align="center">&lt;=</td>
<td align="center">menor ou igual a</td>
</tr>
<tr class="odd">
<td align="center">&gt;</td>
<td align="center">maior que</td>
</tr>
<tr class="even">
<td align="center">&gt;=</td>
<td align="center">maior ou igual</td>
</tr>
<tr class="odd">
<td align="center">==</td>
<td align="center">idêntico</td>
</tr>
<tr class="even">
<td align="center">!=</td>
<td align="center">diferente</td>
</tr>
<tr class="odd">
<td align="center">!x</td>
<td align="center">não é x (negação)</td>
</tr>
<tr class="even">
<td align="center">x | y</td>
<td align="center">x ou y</td>
</tr>
<tr class="odd">
<td align="center">x &amp; y</td>
<td align="center">x e y</td>
</tr>
<tr class="even">
<td align="center">isTRUE(x)</td>
<td align="center">teste se x é verdadeiro</td>
</tr>
<tr class="odd">
<td align="center">%in%</td>
<td align="center">está contido em</td>
</tr>
</tbody>
</table>
<p>Este conjunto de operadores permite diversas comparações entre vetores, por exemplo:</p>
<ul>
<li>quais meses de <code>prec</code> foram abaixo do normal?</li>
</ul>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">prec</a>
<a class="sourceLine" id="cb137-2" title="2"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb137-3" title="3"><span class="co">#&gt; 300 200 210  12   0   0  12  22 100 120  10 280</span></a>
<a class="sourceLine" id="cb137-4" title="4">prec_clim</a>
<a class="sourceLine" id="cb137-5" title="5"><span class="co">#&gt;  [1] 230 205 160 100  60  30  40  60 110 165 200 220</span></a>
<a class="sourceLine" id="cb137-6" title="6">prec <span class="op">-</span><span class="st"> </span>prec_clim <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb137-7" title="7"><span class="co">#&gt;   jan   fev   mar   abr   mai   jun   jul   ago   set   out   nov   dez </span></a>
<a class="sourceLine" id="cb137-8" title="8"><span class="co">#&gt; FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE</span></a></code></pre></div>
<p>O operador <code>%in%</code> serve para verificar se um vetor está contido parcial ou totalmente em outro vetor.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1"><span class="co"># operador está contido em</span></a>
<a class="sourceLine" id="cb138-2" title="2"><span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">100</span>) <span class="op">%in%</span><span class="st"> </span>prec</a>
<a class="sourceLine" id="cb138-3" title="3"><span class="co">#&gt; [1]  TRUE FALSE  TRUE</span></a>
<a class="sourceLine" id="cb138-4" title="4"><span class="co"># 2:4 são elementos de x?</span></a>
<a class="sourceLine" id="cb138-5" title="5"><span class="kw">is.element</span>(<span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">100</span>), prec)</a>
<a class="sourceLine" id="cb138-6" title="6"><span class="co">#&gt; [1]  TRUE FALSE  TRUE</span></a></code></pre></div>
<p>Nos exemplos acima, vimos como buscar os os elementos de um vetor para apenas uma condição. Entretanto, frequentemente precisamos testar mais condições, ou seja, combinar comparações. Por exemplo, para condições do tipo:</p>
<ul>
<li><span class="math inline">\(0 &lt; prec \leq 100\)</span></li>
<li><span class="math inline">\(prec &lt; 50\)</span> ou <span class="math inline">\(prec \geq 150\)</span></li>
</ul>
<p>precisamos usar os operadores relacionais:</p>
<ul>
<li><p><code>&amp;</code> e <code>&amp;&amp;</code> ("e")</p></li>
<li><p><code>|</code> e <code>||</code> ("ou")</p></li>
</ul>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"><span class="co"># prec entre 0 e 100 mm</span></a>
<a class="sourceLine" id="cb139-2" title="2">prec <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>prec <span class="op">&lt;=</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb139-3" title="3"><span class="co">#&gt;   jan   fev   mar   abr   mai   jun   jul   ago   set   out   nov   dez </span></a>
<a class="sourceLine" id="cb139-4" title="4"><span class="co">#&gt; FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE FALSE</span></a>
<a class="sourceLine" id="cb139-5" title="5"><span class="co"># prec abaixo de 50 e acima de 150 mm</span></a>
<a class="sourceLine" id="cb139-6" title="6">prec <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span> <span class="op">|</span><span class="st"> </span>prec <span class="op">&gt;=</span><span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb139-7" title="7"><span class="co">#&gt;   jan   fev   mar   abr   mai   jun   jul   ago   set   out   nov   dez </span></a>
<a class="sourceLine" id="cb139-8" title="8"><span class="co">#&gt;  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE</span></a></code></pre></div>
<p>A ordem das operações pode ser controlada por parênteses. Os operadores <code>&amp;</code> e <code>|</code> são vetorizados (retornam vetores de mesmo tamanho que os vetores testados).</p>
<p>A forma dupla (<code>&amp;&amp;</code> ou <code>||</code>) compara somente um elemento de cada lado, enquanto a forma normal (<code>&amp;</code> e <code>|</code>), compara cada elemento dos vetores em cada lado.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb140-2" title="2">b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb140-3" title="3"><span class="co"># forma normal verifica cada elemento de a e cada elemento de b</span></a>
<a class="sourceLine" id="cb140-4" title="4">a <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>b <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb140-5" title="5"><span class="co">#&gt; [1] FALSE  TRUE FALSE  TRUE</span></a>
<a class="sourceLine" id="cb140-6" title="6"><span class="co"># forma dupla verifica somente o primeiro elemento de a e o primeiro elemento de b</span></a>
<a class="sourceLine" id="cb140-7" title="7"><span class="co"># retornando somente um resultado</span></a>
<a class="sourceLine" id="cb140-8" title="8">a <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span><span class="st"> </span>b <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb140-9" title="9"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<table style="width:85%;">
<caption>Demonstração da diferença entre &amp; e &amp;&amp;.</caption>
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="11%" />
<col width="11%" />
<col width="25%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">a</th>
<th align="center">b</th>
<th align="center">a==1</th>
<th align="center">b==1</th>
<th align="center">a == 1 &amp; b == 1</th>
<th align="center">a == 1 &amp;&amp; b == 1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">TRUE</td>
<td align="center">FALSE</td>
<td align="center">FALSE</td>
<td align="center">FALSE</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
<td align="center">FALSE</td>
<td align="center">FALSE</td>
<td align="center">FALSE</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Podem haver mais que duas condições a serem testadas. As condições podem ser combinadas usando múltiplos <code>&amp;</code> ou <code>|</code>. As diferentes condições podem ser agrupadas por parênteses assim como feito nas operações matemáticas.</p>
<div id="testes-de-igualdade" class="section level4">
<h4><span class="header-section-number">7.3.1.1</span> Testes de igualdade</h4>
<p>A comparação de igualdade no <img src="images/logo_r.png" width="20"> pode ser meio confusa devido as forma de armazenamento diferentes dos números.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="fl">0.6</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.3</span></a>
<a class="sourceLine" id="cb141-2" title="2"><span class="co">#&gt; [1] 0.3</span></a>
<a class="sourceLine" id="cb141-3" title="3"><span class="fl">0.9</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.6</span></a>
<a class="sourceLine" id="cb141-4" title="4"><span class="co">#&gt; [1] 0.3</span></a>
<a class="sourceLine" id="cb141-5" title="5"><span class="fl">0.3</span> <span class="op">==</span><span class="st"> </span><span class="fl">0.3</span></a>
<a class="sourceLine" id="cb141-6" title="6"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Tudo normal, mas ao comparar operações com valores decimais, você pode se surpreender:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1">(<span class="fl">0.6</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.3</span>) <span class="op">==</span><span class="st"> </span>(<span class="fl">0.9</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb142-2" title="2"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>Isso ocorre por imprecisão no final da parte decimal que pode ser arrendondada incorretamente. Isso não acarreta problema na maioria dos cálculos. Para evitar esse problema é melhor comparar os resultados usando a função <code>all.equal()</code>.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">all.equal</span>(</a>
<a class="sourceLine" id="cb143-2" title="2">  <span class="dt">target =</span> <span class="fl">0.6</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.3</span>,</a>
<a class="sourceLine" id="cb143-3" title="3">  <span class="dt">current =</span> <span class="fl">0.9</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.6</span></a>
<a class="sourceLine" id="cb143-4" title="4">)</a>
<a class="sourceLine" id="cb143-5" title="5"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>A <code>all.equal()</code> inclui uma tolerância na comparação (<span class="math inline">\(1,5\times10^{-8}\)</span>) fazendo com aquela imprecisão seja ignorada. Para mais detalhes consulte <code>?all.equal</code>.</p>
</div>
</div>
<div id="funções-any-e-all" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Funções <code>any</code> e <code>all</code></h3>
<p>Estas funções fornecem um único valor (vetor lógico de tamanho 1) para resumir ou descrever o resultado da condição aplicada ao vetor.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1">vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">-2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">-5</span>)</a>
<a class="sourceLine" id="cb144-2" title="2"><span class="kw">all</span>(vetor <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) <span class="co"># todas as posições são maiores que 0 ?</span></a>
<a class="sourceLine" id="cb144-3" title="3"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb144-4" title="4"><span class="kw">any</span>(vetor <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="co"># alguma posição é maior que 0?</span></a>
<a class="sourceLine" id="cb144-5" title="5"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<ul>
<li><p><code>all()</code> verifica se a condição avaliada é válida para todos elementos de um vetor;</p></li>
<li><p><code>any()</code> verifica se a condição avaliada é válida para pelo menos um dos elementos de um vetor;</p></li>
</ul>
</div>
</div>
<div id="sequências" class="section level2">
<h2><span class="header-section-number">7.4</span> Sequências</h2>
<p>Vimos nas seções anteriores que é muito simples criar sequências de números inteiros com o operador <code>:</code>. Nesta seção veremos outras formas de gerar sequências, como uma sequência de números reais e sequências de números repetidos.</p>
<div id="sequências-de-números-inteiros" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Sequências de números inteiros</h3>
<p>Os dois pontos (<code>:</code>) são uma maneira muito fácil de gerar uma sequência de números igualmente espaçados por 1. Você especifica um número inicial e um número final e o <code>R</code> produzirá todos os números inteiros entre eles, incluindo os dois números. Isso funciona mesmo para números negativos ou para valores decrescentes.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1">(ddm &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">31</span>)</a>
<a class="sourceLine" id="cb145-2" title="2"><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25</span></a>
<a class="sourceLine" id="cb145-3" title="3"><span class="co">#&gt; [26] 26 27 28 29 30 31</span></a>
<a class="sourceLine" id="cb145-4" title="4"><span class="kw">typeof</span>(ddm)</a>
<a class="sourceLine" id="cb145-5" title="5"><span class="co">#&gt; [1] &quot;integer&quot;</span></a>
<a class="sourceLine" id="cb145-6" title="6"><span class="co"># sequencia de inteiros decrescente</span></a>
<a class="sourceLine" id="cb145-7" title="7">(si_dec &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">:-</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb145-8" title="8"><span class="co">#&gt;  [1]  10   9   8   7   6   5   4   3   2   1   0  -1  -2  -3  -4  -5  -6  -7  -8</span></a>
<a class="sourceLine" id="cb145-9" title="9"><span class="co">#&gt; [20]  -9 -10</span></a>
<a class="sourceLine" id="cb145-10" title="10"><span class="kw">typeof</span>(si_dec)</a>
<a class="sourceLine" id="cb145-11" title="11"><span class="co">#&gt; [1] &quot;integer&quot;</span></a></code></pre></div>
</div>
<div id="sequências-de-números-reais" class="section level3">
<h3><span class="header-section-number">7.4.2</span> Sequências de números reais</h3>
<p>A função <code>seq()</code>pode ser usada para gerar sequências tanto de números reais como inteiros.</p>
<p>No código abaixo são geradas uma sequência crescente e uma decrescente, ambas igualmente espaçadas por 3.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb146-2" title="2"><span class="co">#&gt; [1]  1  4  7 10</span></a>
<a class="sourceLine" id="cb146-3" title="3"><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">10</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="dv">-3</span>)</a>
<a class="sourceLine" id="cb146-4" title="4"><span class="co">#&gt; [1] 10  7  4  1</span></a></code></pre></div>
<p>Para sequências decrescentes o argumento <code>by</code> ("por") deve ser negativo.</p>
<p>A saída da <code>seq()</code> vai sempre incluir o n° inicial (passado no argumento <code>from</code> - "de"), mas nem sempre incluirá o n° final (passado no argumento <code>to</code> - "até"). Se sua sequência está aumentando por um argumento <code>by</code> que é par (ímpar) e o argumento <code>to</code> também é par (ímpar), não incluirá o valor do argumento <code>to</code> no resultado (Tabela @ref(tab:seqs-by)). Quando <code>to</code> e <code>by</code> diferem o valor de <code>to</code> fará parte da sequência de saída.</p>
<table>
<caption>(#tab:seqs-by)Sequências com argumentos ímpares e pares.</caption>
<thead>
<tr class="header">
<th align="center">‘from’</th>
<th align="center">‘to’</th>
<th align="center">‘to’ é par?</th>
<th align="center">‘by’</th>
<th align="center">‘by’ é par?</th>
<th align="center">sequência</th>
<th align="center">resultado inclui ‘to’</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">10</td>
<td align="center">TRUE</td>
<td align="center">2</td>
<td align="center">TRUE</td>
<td align="center">c(1, 3, 5, 7, 9)</td>
<td align="center">FALSE</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">10</td>
<td align="center">TRUE</td>
<td align="center">3</td>
<td align="center">FALSE</td>
<td align="center">c(1, 4, 7, 10)</td>
<td align="center">TRUE</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">11</td>
<td align="center">FALSE</td>
<td align="center">2</td>
<td align="center">TRUE</td>
<td align="center">c(1, 3, 5, 7, 9, 11)</td>
<td align="center">TRUE</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">11</td>
<td align="center">FALSE</td>
<td align="center">3</td>
<td align="center">FALSE</td>
<td align="center">c(1, 4, 7, 10)</td>
<td align="center">FALSE</td>
</tr>
</tbody>
</table>
<p>Ao invés de usar o argumento <code>by</code>, podemos especificar um valor para o argumento <code>length.out</code> ("tamanho de saída") para produzir um vetor com tantos números, igualmente espaçados, entre os valores <code>from</code> e <code>to</code>.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1"><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">length.out =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb147-2" title="2"><span class="co">#&gt;  [1]  1.000000  1.473684  1.947368  2.421053  2.894737  3.368421  3.842105</span></a>
<a class="sourceLine" id="cb147-3" title="3"><span class="co">#&gt;  [8]  4.315789  4.789474  5.263158  5.736842  6.210526  6.684211  7.157895</span></a>
<a class="sourceLine" id="cb147-4" title="4"><span class="co">#&gt; [15]  7.631579  8.105263  8.578947  9.052632  9.526316 10.000000</span></a></code></pre></div>
<p>O <code>length.out = 20</code> no código acima permite gerar 20 números igualmente espaçados entre 1 e 10.</p>
</div>
<div id="repetições" class="section level3">
<h3><span class="header-section-number">7.4.3</span> Repetições</h3>
<p>Algumas vezes precisamos repetir certos valores, o que pode ser feito com a função <code>rep()</code>. O argumento <code>times</code> especifica o número de vezes para repetir o <code>x</code>.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"><span class="kw">rep</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">times =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb148-2" title="2"><span class="co">#&gt; [1] 1 2 1 2 1 2 1 2</span></a></code></pre></div>
<p>O argumento <code>each</code> especifica o número de vezes para repetir cada elemento de <code>x</code>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1"><span class="kw">rep</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">each =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb149-2" title="2"><span class="co">#&gt; [1] 1 1 1 2 2 2</span></a></code></pre></div>
<p>Os argumentos podem ser combinados.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1"><span class="kw">rep</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">times =</span> <span class="dv">4</span>, <span class="dt">each =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb150-2" title="2"><span class="co">#&gt;  [1] 1 1 1 2 2 2 1 1 1 2 2 2 1 1 1 2 2 2 1 1 1 2 2 2</span></a></code></pre></div>
<p>No caso acima, <code>x</code> primeiro foi repetido 4 vezes e depois cada elemento foi repetido 3 vezes.</p>
<p>Quando argumento <code>times</code> é um vetor de mesmo tamanho que <code>x</code>, cada um de seus valores será usado para repetir tantas vezes o respectivo elemento de <code>x</code>.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1"><span class="kw">rep</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">times =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb151-2" title="2"><span class="co">#&gt; [1] 1 1 1 1 2 2 2</span></a></code></pre></div>
<!-- 
AULA-6 encerrou aqui 
-->
</div>
</div>
<div id="index-vetores" class="section level2">
<h2><span class="header-section-number">7.5</span> Indexação de vetores</h2>
<p>Os elementos de um vetor são indexados e para acessá-los usamos a notação de índices do <img src="images/logo_r.png" width="20">. Para extrair ou filtrar elementos de um vetor usamos o operador colchetes <strong><code>[ ]</code></strong>, seguindo a sintaxe:</p>
<p style="color:DodgerBlue; font-size:1.3em; font-weight: bold;text-align:center;">
<code>vetor[indices]</code>
</p>
<p>onde <strong><code>indices</code></strong> representa o vetor com os índices dos elementos da variável <code>vetor</code> a serem selecionados. O operador <strong><code>[</code></strong> quando aplicado a um vetor retornará sempre um vetor.</p>
<p>Para acessar partes um elemento de um vetor o vetor <code>indices</code> dentro dos colchetes pode ser especificado de diferentes formas:</p>
<ul>
<li><p>por posições (vetor numérico)</p></li>
<li><p>por nomes (vetor de caracteres)</p></li>
<li><p>por comparações, testes ou condições (vetor lógico)</p></li>
</ul>
<div id="indexação-por-vetores-numéricos" class="section level3">
<h3><span class="header-section-number">7.5.1</span> Indexação por vetores numéricos</h3>
<div id="positivos" class="section level4">
<h4><span class="header-section-number">7.5.1.1</span> Positivos</h4>
<p>Para extrairmos a precipitação de janeiro e dezembro do vetor <code>prec</code> podemos usar o seguinte código:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="co"># vetor com as posições dos meses de janeiro e dezembro</span></a>
<a class="sourceLine" id="cb152-2" title="2"><span class="kw">c</span>(<span class="dv">1</span>, <span class="kw">length</span>(prec))</a>
<a class="sourceLine" id="cb152-3" title="3"><span class="co">#&gt; [1]  1 12</span></a>
<a class="sourceLine" id="cb152-4" title="4"><span class="co"># acesso aos valores localizados nas posições 1 e 12 </span></a>
<a class="sourceLine" id="cb152-5" title="5">prec[<span class="kw">c</span>(<span class="dv">1</span>, <span class="kw">length</span>(prec))]</a>
<a class="sourceLine" id="cb152-6" title="6"><span class="co">#&gt; jan dez </span></a>
<a class="sourceLine" id="cb152-7" title="7"><span class="co">#&gt; 300 280</span></a></code></pre></div>
<p>Passando um vetor numérico entre os colchetes retorna a parte do vetor contendo os elementos daquelas posições.</p>
<p>Similarmente a precipitação dos meses de inverno (Junho, Julho e Agosto) podem ser selecionadas usando um vetor definido com os índices das posições daqueles meses:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1">inds_jja &lt;-<span class="st"> </span><span class="dv">6</span><span class="op">:</span><span class="dv">8</span></a>
<a class="sourceLine" id="cb153-2" title="2"><span class="co"># vetor de chuva JJA</span></a>
<a class="sourceLine" id="cb153-3" title="3">prec[inds_jja]</a>
<a class="sourceLine" id="cb153-4" title="4"><span class="co">#&gt; jun jul ago </span></a>
<a class="sourceLine" id="cb153-5" title="5"><span class="co">#&gt;   0  12  22</span></a></code></pre></div>
<div class="rmdtip">
<p>
O reposicionamento dos elementos de um vetor pode ser feito pela especificação da ordem dos índices. Par ordenar os elementos na ordem dezembro, Janeiro e Fevereiro indexamos da seguinte maneira:
</p>
<p>
<code>prec[c(12, 1, 2)]</code>
</p>
<p>
A inversão da ordem dos elementos pode ser feita com a indexação:
</p>
<p>
<code>prec[length(prec):1]</code>
</p>
<p>
A função <code>rev()</code> economiza tempo de digitação de código para realizar esta mesma ação:
</p>
<p>
<code>rev(prec)</code>
</p>
</div>
</div>
<div id="negativos" class="section level4">
<h4><span class="header-section-number">7.5.1.2</span> Negativos</h4>
<p>O acesso aos dados de precipitação de janeiro e dezembro do vetor <code>prec</code> poderia ser feita uma lógica complementar. Poderíamos selecionar todos elementos de <code>prec</code> exceto aqueles entre Fevereiro (posição 2) e Novembro (posição 11). Esta frase poderia ser transcrita em código <code>R</code>, simplesmente como <code>-(2:11)</code>. O sinal <code>-</code> precedendo o vetor numérico, exclui o acesso aquelas posições quando usado entre o operador <strong><code>[</code></strong>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1">prec[<span class="op">-</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">11</span>)]</a>
<a class="sourceLine" id="cb154-2" title="2"><span class="co">#&gt; jan dez </span></a>
<a class="sourceLine" id="cb154-3" title="3"><span class="co">#&gt; 300 280</span></a></code></pre></div>
<p>Analogamente, os meses de inverno poderiam ser selecionados com:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1"> prec[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>)]</a>
<a class="sourceLine" id="cb155-2" title="2"><span class="co">#&gt; jun jul ago </span></a>
<a class="sourceLine" id="cb155-3" title="3"><span class="co">#&gt;   0  12  22</span></a></code></pre></div>
</div>
</div>
<div id="indexação-por-nomes" class="section level3">
<h3><span class="header-section-number">7.5.2</span> Indexação por nomes</h3>
<p>A seleção de partes e um vetor pode ser feita também usando os nomes de seus elementos. As precipitações de janeiro e dezembro poderiam ser extraídas usando os nomes daqueles elementos:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1">prec[<span class="kw">c</span>(<span class="st">&quot;jan&quot;</span>, <span class="st">&quot;dez&quot;</span>)]</a>
<a class="sourceLine" id="cb156-2" title="2"><span class="co">#&gt; jan dez </span></a>
<a class="sourceLine" id="cb156-3" title="3"><span class="co">#&gt; 300 280</span></a></code></pre></div>
<p>Assim como as precipitações de inverno.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1">prec[<span class="kw">c</span>(<span class="st">&quot;jun&quot;</span>, <span class="st">&quot;jul&quot;</span>, <span class="st">&quot;ago&quot;</span>)]</a>
<a class="sourceLine" id="cb157-2" title="2"><span class="co">#&gt; jun jul ago </span></a>
<a class="sourceLine" id="cb157-3" title="3"><span class="co">#&gt;   0  12  22</span></a></code></pre></div>
</div>
<div id="indexação-por-vetores-lógicos" class="section level3">
<h3><span class="header-section-number">7.5.3</span> Indexação por vetores lógicos</h3>
<p>Vamos criar um vetor lógico e usá-lo para a seleção com um vetor lógico dos elementos de <code>prec</code> para Janeiro e Dezembro.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1">inds_log &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb158-2" title="2">  <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb158-3" title="3">  <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb158-4" title="4">  <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb158-5" title="5">)</a>
<a class="sourceLine" id="cb158-6" title="6">prec[inds_log]</a>
<a class="sourceLine" id="cb158-7" title="7"><span class="co">#&gt; jan dez </span></a>
<a class="sourceLine" id="cb158-8" title="8"><span class="co">#&gt; 300 280</span></a></code></pre></div>
<p>Somente os elementos de <code>inds_log</code> correspondentes a <code>TRUE</code> foram selecionados.</p>
<p>Vetores lógicos são muito úteis quando aproveitamos a funcionalidade de <strong>coerção</strong>. Imagine que você queira extrair de <code>prec</code> o primeiro elemento, mas o segundo não, o terceiro elemento sim, o quarto não e assim sucessivamente. Essa seleção intercalada pode ser simplesmente feita com:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1">inds_log &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb159-2" title="2">prec[inds_log]</a>
<a class="sourceLine" id="cb159-3" title="3"><span class="co">#&gt; jan mar mai jul set nov </span></a>
<a class="sourceLine" id="cb159-4" title="4"><span class="co">#&gt; 300 210   0  12 100  10</span></a></code></pre></div>
<p>Uma forma mais prática de filtrar vetores é por comparações. Por exemplo, quais valores de precipitação foram acima de 80 mm?</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1">inds_prec_alta &lt;-<span class="st"> </span>prec <span class="op">&gt;</span><span class="st"> </span><span class="dv">80</span></a>
<a class="sourceLine" id="cb160-2" title="2">prec[inds_prec_alta]</a>
<a class="sourceLine" id="cb160-3" title="3"><span class="co">#&gt; jan fev mar set out dez </span></a>
<a class="sourceLine" id="cb160-4" title="4"><span class="co">#&gt; 300 200 210 100 120 280</span></a></code></pre></div>
<p>Vimos que a filtragem consiste em extrair elementos de um vetor que satisfaça uma ou várias condições. Entretanto, em alguns casos, o interesse está nas posições do vetor que atendem a condição (onde ela é verdadeira). Nós podemos localizar essas ocorrências usando a função <code>which()</code>. Por exemplo, qual a posição dos elementos do vetor <code>inds_prec_alta</code> que são verdadeiros?</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1"><span class="kw">which</span>(inds_prec_alta)</a>
<a class="sourceLine" id="cb161-2" title="2"><span class="co">#&gt; jan fev mar set out dez </span></a>
<a class="sourceLine" id="cb161-3" title="3"><span class="co">#&gt;   1   2   3   9  10  12</span></a></code></pre></div>
<p>A função <code>which()</code> converte um vetor lógico em numérico, somente os índices em que a condição é <code>TRUE</code>.</p>
<p>A utilidade da <code>which()</code> é mais evidente quando usada para, por exemplo, sabermos qual o mês do 4° caso mais chuvoso.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">which</span>(inds_prec_alta)[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb162-2" title="2"><span class="co">#&gt; set </span></a>
<a class="sourceLine" id="cb162-3" title="3"><span class="co">#&gt;   9</span></a>
<a class="sourceLine" id="cb162-4" title="4"><span class="kw">names</span>(<span class="kw">which</span>(inds_prec_alta)[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb162-5" title="5"><span class="co">#&gt; [1] &quot;set&quot;</span></a>
<a class="sourceLine" id="cb162-6" title="6"><span class="co"># ou</span></a>
<a class="sourceLine" id="cb162-7" title="7"><span class="kw">names</span>(prec)[<span class="kw">which</span>(inds_prec_alta)[<span class="dv">4</span>]]</a>
<a class="sourceLine" id="cb162-8" title="8"><span class="co">#&gt; [1] &quot;set&quot;</span></a></code></pre></div>
<div class="rmdtip">
<p>
A resultado da <code>which()</code> é um vetor numérico e portanto equivale a indexação numérica. Então a seleções abaixo são equivalentes:
</p>
<p>
<code>prec[which(inds_prec_alta)]</code>
</p>
<p>
<code>prec[inds_prec_alta]</code>
</p>
<p>
Quando é melhor usar uma ou outra opção? Note que o resultado de <code>which(inds_prec_alta)</code> armazena somente os índices que satisfazem a condição, enquanto que o resultado de <code>inds_prec_alta</code> é um vetor lógico de mesmo tamanho que <code>prec</code>. Então, se estiver trabalhando com <strong>big data</strong> (p.ex.: um vetor com milhões de elementos) em termos de eficiência de uso da memória a <code>which()</code> é melhor opção.
</p>
</div>
<div class="rmdimportant">
<p>
Para localizar valores extremos em um vetor podemos usar as funções <code>which.max()</code> e <code>which.min()</code> que fornecem respectivamente, a posição do valor máximo e mínimo no vetor. Elas são versões eficientes dos códigos <code>which(x == max(x))</code> e <code>which(x == min(x))</code>. Contudo, há uma diferença entre elas que pode ser verificada pela comparação dos resultados das instruções:
</p>
<p>
<code>which.min(prec)</code>
</p>
<p>
<code>which(prec == min(prec))</code>
</p>
<p>
A primeira seleciona o primeiro índice para o qual <code>prec</code> tem seu mínimo (5° elemento), enquanto a segunda retorna todos os índices correspondentes ao mínimo (5° e 6° elemento).
</p>
</div>
</div>
</div>
<div id="replace-vect" class="section level2">
<h2><span class="header-section-number">7.6</span> Substituição de elementos de um vetor</h2>
<p>Podemos substituir os valores de um vetor usando os mesmos esquemas de indexação vistos na seção anterior. A sintaxe geral para substituir elementos de um vetor por novos valores é:</p>
<p style="color:DodgerBlue; font-size:1.3em; font-weight: bold;text-align:center;">
<code>vetor[indices] &lt;- novos_valores</code>
</p>
<p>Vamos fazer uma cópia do vetor <code>prec</code> para então alterá-lo, fazendo substituição de seus elementos usando as diferentes formas de indexação.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1">(prec_alt &lt;-<span class="st"> </span>prec)</a>
<a class="sourceLine" id="cb163-2" title="2"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb163-3" title="3"><span class="co">#&gt; 300 200 210  12   0   0  12  22 100 120  10 280</span></a></code></pre></div>
<div id="por-posições" class="section level4">
<h4><span class="header-section-number">7.6.0.1</span> Por posições</h4>
<p>suponha que você precisa substituir os valores de precipitação dos meses de inverno por valores corrigidos.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1">inds_jja</a>
<a class="sourceLine" id="cb164-2" title="2"><span class="co">#&gt; [1] 6 7 8</span></a>
<a class="sourceLine" id="cb164-3" title="3">prec_alt[inds_jja] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, <span class="dv">21</span>, <span class="dv">42</span>)</a>
<a class="sourceLine" id="cb164-4" title="4">prec</a>
<a class="sourceLine" id="cb164-5" title="5"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb164-6" title="6"><span class="co">#&gt; 300 200 210  12   0   0  12  22 100 120  10 280</span></a>
<a class="sourceLine" id="cb164-7" title="7">prec_alt</a>
<a class="sourceLine" id="cb164-8" title="8"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb164-9" title="9"><span class="co">#&gt; 300 200 210  12   0  NA  21  42 100 120  10 280</span></a></code></pre></div>
</div>
<div id="por-nomes" class="section level4">
<h4><span class="header-section-number">7.6.0.2</span> Por nomes</h4>
<p>Suponha que os valores de precipitação de janeiro e dezembro foram atualizados para 250 e 208, respectivamente. Esta alteração pode ser com o código abaixo.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1">prec_jd_corr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">250</span>, <span class="dv">208</span>)</a>
<a class="sourceLine" id="cb165-2" title="2">prec_alt[<span class="kw">c</span>(<span class="st">&quot;jan&quot;</span>, <span class="st">&quot;dez&quot;</span>)] &lt;-<span class="st"> </span>prec_jd_corr</a>
<a class="sourceLine" id="cb165-3" title="3">prec</a>
<a class="sourceLine" id="cb165-4" title="4"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb165-5" title="5"><span class="co">#&gt; 300 200 210  12   0   0  12  22 100 120  10 280</span></a>
<a class="sourceLine" id="cb165-6" title="6">prec_alt</a>
<a class="sourceLine" id="cb165-7" title="7"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb165-8" title="8"><span class="co">#&gt; 250 200 210  12   0  NA  21  42 100 120  10 208</span></a></code></pre></div>
</div>
<div id="por-comparação" class="section level4">
<h4><span class="header-section-number">7.6.0.3</span> Por comparação</h4>
<p>Imagine que você precisa substituir os valores de <code>prec</code> que ficaram em torno de <span class="math inline">\(\pm10 \%\)</span> da média mensal climatológica pelos valores climatológicos.</p>
<p>Vamos primeiro determinar os desvios relativos (em %) em relação as médias climatológicas:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1"><span class="co"># limiar em % da normal climatológica</span></a>
<a class="sourceLine" id="cb166-2" title="2">limiar &lt;-<span class="st"> </span><span class="dv">10</span> </a>
<a class="sourceLine" id="cb166-3" title="3">desvios &lt;-<span class="st"> </span>prec <span class="op">-</span><span class="st"> </span>prec_clim</a>
<a class="sourceLine" id="cb166-4" title="4"><span class="co"># anomalias relativas em %</span></a>
<a class="sourceLine" id="cb166-5" title="5">(anom_perc &lt;-<span class="st">  </span><span class="kw">abs</span>(desvios)<span class="op">/</span>prec_clim <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb166-6" title="6"><span class="co">#&gt;        jan        fev        mar        abr        mai        jun        jul </span></a>
<a class="sourceLine" id="cb166-7" title="7"><span class="co">#&gt;  30.434783   2.439024  31.250000  88.000000 100.000000 100.000000  70.000000 </span></a>
<a class="sourceLine" id="cb166-8" title="8"><span class="co">#&gt;        ago        set        out        nov        dez </span></a>
<a class="sourceLine" id="cb166-9" title="9"><span class="co">#&gt;  63.333333   9.090909  27.272727  95.000000  27.272727</span></a></code></pre></div>
<p>Então substituímos os casos com baixo desvio pela precipitação climatológica.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1"><span class="co"># meses com prec em torno de +-10% da média climatol.</span></a>
<a class="sourceLine" id="cb167-2" title="2">prec[anom_perc <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb167-3" title="3"><span class="co">#&gt; fev set </span></a>
<a class="sourceLine" id="cb167-4" title="4"><span class="co">#&gt; 200 100</span></a>
<a class="sourceLine" id="cb167-5" title="5"><span class="co"># substituição pela prec mensal climatol. </span></a>
<a class="sourceLine" id="cb167-6" title="6">prec[anom_perc <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>] &lt;-<span class="st"> </span>prec_clim[anom_perc <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb167-7" title="7">prec</a>
<a class="sourceLine" id="cb167-8" title="8"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb167-9" title="9"><span class="co">#&gt; 300 205 210  12   0   0  12  22 110 120  10 280</span></a></code></pre></div>
<p>A função <code>abs()</code> determina o valor absoluto ou módulo de um vetor.</p>
<p>Uma alternativa bastante útil para substituir valores de um vetor usando comparações é a <strong>função vetorizada</strong> <strong><code>ifelse()</code></strong>. A mesma operação realizada no trecho de código anterior poderia ser feita com <code>ifelse()</code> da seguinte forma:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1">prec &lt;-<span class="st"> </span><span class="kw">ifelse</span>(ano_perc <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>, prec_clim, prec)</a></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1">prec</a>
<a class="sourceLine" id="cb169-2" title="2"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb169-3" title="3"><span class="co">#&gt; 300 205 210  12   0   0  12  22 110 120  10 280</span></a></code></pre></div>
<!---
Uma exemplo é sua aplicação para preencher as falhas no vetor `prec_alt` por seus valores climatológicos.


```r
prec_alt_comp <- ifelse(
  test = is.na(prec_alt), # condição: é faltante?
  yes = prec_clim,        # se verdadeira: preenche com prec_clim 
  no = prec_alt           # se falsa: mantém prec_alt
)
prec_alt_comp
#> jan fev mar abr mai jun jul ago set out nov dez 
#> 250 200 210  12   0  30  21  42 100 120  10 208
```
--->
</div>
</div>
<div id="lidando-com-dados-faltantes" class="section level2">
<h2><span class="header-section-number">7.7</span> Lidando com dados faltantes</h2>
<p>Dados faltantes (<code>NA</code>s) são inevitáveis e em qualquer processamento de dados reais nós precisamos determinar se existem dados faltantes e a quantidade de observações válidas. É importante também, saber o efeito que eles tem nos cálculos, as funcionalidades para identificá-los e substituí-los se necessários.</p>
<p>Vamos substituir alguns valores da <code>prec_alt</code> por <code>NA</code> para poder tratar de dados faltantes usando as diferentes funcionalidades que o <img src="images/logo_r.png" width="20"> oferece para isso.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1">prec_alt[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">11</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb170-2" title="2">prec_alt</a>
<a class="sourceLine" id="cb170-3" title="3"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb170-4" title="4"><span class="co">#&gt; 250 200  NA  NA   0  NA  21  42 100 120  NA 208</span></a></code></pre></div>
<div id="identificação-e-remoção-de-nas" class="section level3">
<h3><span class="header-section-number">7.7.1</span> Identificação e remoção de <code>NA</code>s</h3>
<p>Para identificar <code>NA</code>s em um vetor, a função específica para isso é a <code>is.na()</code>.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"><span class="kw">is.na</span>(prec_alt)</a>
<a class="sourceLine" id="cb171-2" title="2"><span class="co">#&gt;   jan   fev   mar   abr   mai   jun   jul   ago   set   out   nov   dez </span></a>
<a class="sourceLine" id="cb171-3" title="3"><span class="co">#&gt; FALSE FALSE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE</span></a></code></pre></div>
<p>Também podemos usá-la aninhada com a função <code>which()</code> para obter os índices dos elementos faltantes.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1"><span class="kw">which</span>(<span class="kw">is.na</span>(prec_alt))</a>
<a class="sourceLine" id="cb172-2" title="2"><span class="co">#&gt; mar abr jun nov </span></a>
<a class="sourceLine" id="cb172-3" title="3"><span class="co">#&gt;   3   4   6  11</span></a></code></pre></div>
<p>Novos usuários do R tentam identificar dados faltantes com a expressão:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1">prec_alt <span class="op">==</span><span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb173-2" title="2"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb173-3" title="3"><span class="co">#&gt;  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA</span></a></code></pre></div>
<p>O que produzirá somente <code>NA</code>s mesmo que o vetor testado possua algum <code>NA</code>. Isso ocorre pela regra de qualquer operação com <code>NA</code>s resulta em <code>NA</code>s.</p>
<p>Para verificar se há algum dado faltante em um vetor usamos a função <code>anyNA()</code> e para quantificar o total de observações faltantes combinamos as expressões <code>sum()</code> e <code>is.na()</code>:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"><span class="kw">anyNA</span>(prec_alt)</a>
<a class="sourceLine" id="cb174-2" title="2"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb174-3" title="3"><span class="kw">sum</span>(<span class="kw">is.na</span>(prec_alt))</a>
<a class="sourceLine" id="cb174-4" title="4"><span class="co">#&gt; [1] 4</span></a></code></pre></div>
<p>A remoção dos elementos faltantes de um vetor é moleza. É só combinar o operador negação <code>!</code> e <code>is.na()</code> por indexação lógica:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1">prec_alt[<span class="op">!</span><span class="kw">is.na</span>(prec_alt)]</a>
<a class="sourceLine" id="cb175-2" title="2"><span class="co">#&gt; jan fev mai jul ago set out dez </span></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="co">#&gt; 250 200   0  21  42 100 120 208</span></a>
<a class="sourceLine" id="cb175-4" title="4"><span class="co"># outra forma equivalente</span></a>
<a class="sourceLine" id="cb175-5" title="5"><span class="co">#prec_alt[-which(is.na(prec_alt))]</span></a></code></pre></div>
<p>Uma alternativa mais sofisticada é a função <code>na.omit()</code>. Ela não só remove os valores faltantes, mas como também guarda a localização dos dados faltantes. Esta informação é armazenada na lista de atributos do vetor.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1">prec_alt_sem_falt &lt;-<span class="st"> </span><span class="kw">na.omit</span>(prec_alt)</a>
<a class="sourceLine" id="cb176-2" title="2"><span class="kw">attributes</span>(prec_alt_sem_falt)</a>
<a class="sourceLine" id="cb176-3" title="3"><span class="co">#&gt; $names</span></a>
<a class="sourceLine" id="cb176-4" title="4"><span class="co">#&gt; [1] &quot;jan&quot; &quot;fev&quot; &quot;mai&quot; &quot;jul&quot; &quot;ago&quot; &quot;set&quot; &quot;out&quot; &quot;dez&quot;</span></a>
<a class="sourceLine" id="cb176-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb176-6" title="6"><span class="co">#&gt; $na.action</span></a>
<a class="sourceLine" id="cb176-7" title="7"><span class="co">#&gt; mar abr jun nov </span></a>
<a class="sourceLine" id="cb176-8" title="8"><span class="co">#&gt;   3   4   6  11 </span></a>
<a class="sourceLine" id="cb176-9" title="9"><span class="co">#&gt; attr(,&quot;class&quot;)</span></a>
<a class="sourceLine" id="cb176-10" title="10"><span class="co">#&gt; [1] &quot;omit&quot;</span></a></code></pre></div>
<p>As posições originais dos dados faltantes descartados podem ser obtidas com:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1"><span class="kw">attr</span>(</a>
<a class="sourceLine" id="cb177-2" title="2">  <span class="dt">x =</span> prec_alt_sem_falt,</a>
<a class="sourceLine" id="cb177-3" title="3">  <span class="dt">which =</span> <span class="st">&quot;na.action&quot;</span></a>
<a class="sourceLine" id="cb177-4" title="4">)</a>
<a class="sourceLine" id="cb177-5" title="5"><span class="co">#&gt; mar abr jun nov </span></a>
<a class="sourceLine" id="cb177-6" title="6"><span class="co">#&gt;   3   4   6  11 </span></a>
<a class="sourceLine" id="cb177-7" title="7"><span class="co">#&gt; attr(,&quot;class&quot;)</span></a>
<a class="sourceLine" id="cb177-8" title="8"><span class="co">#&gt; [1] &quot;omit&quot;</span></a></code></pre></div>
<p>Quando trabalhamos com vetores grandes que contenham várias falhas é útil saber a posição da sequência de dados consecutivos válidos mais longa. A função <code>na.contiguous()</code> retornará somente elementos daquela sequência.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1">prec_alt_val_long &lt;-<span class="st"> </span><span class="kw">na.contiguous</span>(prec_alt)</a>
<a class="sourceLine" id="cb178-2" title="2">prec_alt_val_long</a>
<a class="sourceLine" id="cb178-3" title="3"><span class="co">#&gt; jul ago set out </span></a>
<a class="sourceLine" id="cb178-4" title="4"><span class="co">#&gt;  21  42 100 120 </span></a>
<a class="sourceLine" id="cb178-5" title="5"><span class="co">#&gt; attr(,&quot;na.action&quot;)</span></a>
<a class="sourceLine" id="cb178-6" title="6"><span class="co">#&gt; [1]  1  2  3  4  5  6 11 12</span></a>
<a class="sourceLine" id="cb178-7" title="7"><span class="co">#&gt; attr(,&quot;class&quot;)</span></a>
<a class="sourceLine" id="cb178-8" title="8"><span class="co">#&gt; [1] &quot;omit&quot;</span></a>
<a class="sourceLine" id="cb178-9" title="9"><span class="co">#&gt; attr(,&quot;tsp&quot;)</span></a>
<a class="sourceLine" id="cb178-10" title="10"><span class="co">#&gt; [1]  7 10  1</span></a></code></pre></div>
</div>
<div id="indexação-com-nas" class="section level3">
<h3><span class="header-section-number">7.7.2</span> Indexação com <code>NA</code>s</h3>
<p>Suponha que queremos extrair um conjunto de elementos de <code>prec_clim</code> baseado em <code>inds_na</code>.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1">prec_alt <span class="op">&gt;</span><span class="st"> </span><span class="dv">220</span></a>
<a class="sourceLine" id="cb179-2" title="2"><span class="co">#&gt;   jan   fev   mar   abr   mai   jun   jul   ago   set   out   nov   dez </span></a>
<a class="sourceLine" id="cb179-3" title="3"><span class="co">#&gt;  TRUE FALSE    NA    NA FALSE    NA FALSE FALSE FALSE FALSE    NA FALSE</span></a></code></pre></div>
<p>O interesse é extrair os valores de <code>prec_clim</code> quando a <code>prec_alt</code> superou 220 mm. A expressão para essa seleção é:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" title="1">prec_clim[prec_alt <span class="op">&gt;</span><span class="st"> </span><span class="dv">220</span>]</a>
<a class="sourceLine" id="cb180-2" title="2"><span class="co">#&gt; [1] 230  NA  NA  NA  NA</span></a></code></pre></div>
<p>o resultado da filtragem foi um vetor com o resultado da condição de prec_clim para qual <code>prec_alt &gt; 220</code> e também <code>NA</code>s. Isto é um resultado que provavelmente ninguém deseja.</p>
<p>Se nós queremos extrair os valores de <code>prec_clim</code> para os quais <code>prec_alt</code> <strong>não é faltante</strong> e <strong>também superior a 220</strong> nós devemos usar a seguinte expressão:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1">prec_clim[<span class="op">!</span><span class="kw">is.na</span>(prec_alt) <span class="op">&amp;</span><span class="st"> </span>prec_alt <span class="op">&gt;</span><span class="st"> </span><span class="dv">220</span>]</a>
<a class="sourceLine" id="cb181-2" title="2"><span class="co">#&gt; [1] 230</span></a></code></pre></div>
<p>A moral da história aqui é que na prática quando você tem <code>NA</code>s em índices (ou seja, nos valores de qualquer vetor dentro do colchetes) o <img src="images/logo_r.png" width="20"> pode retornar algo diferente do que era esperado.</p>
<p>Uma função para filtragem de dados que é capaz de dar conta disso mais prontamente é função <code>subset()</code> (que pode ser traduzida como <em>subconjunto</em>) que recebe os dados no primeiro argumento (<code>x</code>) e a expressão lógica no segundo (argumento <code>subset</code> de mesmo nome da função).</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" title="1"><span class="kw">subset</span>(</a>
<a class="sourceLine" id="cb182-2" title="2">  <span class="dt">x =</span> prec_clim,</a>
<a class="sourceLine" id="cb182-3" title="3">  <span class="dt">subset =</span> prec_alt <span class="op">&gt;</span><span class="st"> </span><span class="dv">220</span></a>
<a class="sourceLine" id="cb182-4" title="4">)</a>
<a class="sourceLine" id="cb182-5" title="5"><span class="co">#&gt; [1] 230</span></a></code></pre></div>
</div>
<div id="efeito-de-nas-em-funções" class="section level3">
<h3><span class="header-section-number">7.7.3</span> Efeito de <code>NAs</code> em funções</h3>
<p>Na seção @ref(NAs) vimos que qualquer operação com <code>NA</code> resulta em <code>NA</code>. Algumas funções úteis merecem ser enfatizadas quando usadas em vetores com dados faltantes.</p>
<p>A função <code>range()</code> retorna a amplitude de variação dos valores em um vetor.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1"><span class="kw">range</span>(prec_alt)</a>
<a class="sourceLine" id="cb183-2" title="2"><span class="co">#&gt; [1] NA NA</span></a></code></pre></div>
<p>Como <code>prec_alt</code> possui dados faltantes ela retornará <code>NA</code>. Assim como várias outras funções matemáticas básicas no <img src="images/logo_r.png" width="20"> a função <code>range()</code> permite especificar o argumento <code>na.rm = TRUE</code> para calcular o resultado após omitir os valores faltantes.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" title="1"><span class="kw">range</span>(prec_alt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb184-2" title="2"><span class="co">#&gt; [1]   0 250</span></a></code></pre></div>
<p>Logo, <code>prec_alt</code> varia de um mínimo 0 a um máximo de 250.</p>
<p>Diversas funções tem essa funcionalidade, entre elas as mais usadas para estatísticas descritivas, como:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1"><span class="co"># prec máx. mensal</span></a>
<a class="sourceLine" id="cb185-2" title="2"><span class="kw">max</span>(prec_alt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb185-3" title="3"><span class="co">#&gt; [1] 250</span></a>
<a class="sourceLine" id="cb185-4" title="4"><span class="co"># pŕec min mensal</span></a>
<a class="sourceLine" id="cb185-5" title="5"><span class="kw">min</span>(prec_alt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb185-6" title="6"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb185-7" title="7"><span class="co"># prec total anual</span></a>
<a class="sourceLine" id="cb185-8" title="8"><span class="kw">sum</span>(prec_alt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb185-9" title="9"><span class="co">#&gt; [1] 941</span></a>
<a class="sourceLine" id="cb185-10" title="10"><span class="co"># prec média</span></a>
<a class="sourceLine" id="cb185-11" title="11"><span class="kw">mean</span>(prec_alt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb185-12" title="12"><span class="co">#&gt; [1] 117.625</span></a>
<a class="sourceLine" id="cb185-13" title="13"><span class="co"># mediana da prec </span></a>
<a class="sourceLine" id="cb185-14" title="14"><span class="kw">median</span>(prec_alt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb185-15" title="15"><span class="co">#&gt; [1] 110</span></a>
<a class="sourceLine" id="cb185-16" title="16"><span class="co"># desvio padrão</span></a>
<a class="sourceLine" id="cb185-17" title="17"><span class="kw">sd</span>(prec_alt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb185-18" title="18"><span class="co">#&gt; [1] 93.87216</span></a>
<a class="sourceLine" id="cb185-19" title="19"><span class="co"># variância</span></a>
<a class="sourceLine" id="cb185-20" title="20"><span class="kw">var</span>(prec_alt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb185-21" title="21"><span class="co">#&gt; [1] 8811.982</span></a></code></pre></div>
<p>A função <code>summary()</code> fornece um resumo estatístico de uma variável, incluindo: mínimo, 1° quartil, mediana, média, 3° quartil, máximo e o número de casos faltantes (se aplicável).</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" title="1"><span class="kw">summary</span>(prec_alt)</a>
<a class="sourceLine" id="cb186-2" title="2"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s </span></a>
<a class="sourceLine" id="cb186-3" title="3"><span class="co">#&gt;    0.00   36.75  110.00  117.62  202.00  250.00       4</span></a></code></pre></div>
</div>
</div>
<div id="dados-nulos" class="section level2">
<h2><span class="header-section-number">7.8</span> Dados Nulos (<code>NULL</code>)</h2>
<p>O <code>NULL</code> é um tipo especial de dado no <img src="images/logo_r.png" width="20">. Ele é um vetor de tamanho zero.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1">vetor_nulo1 &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb187-2" title="2">vetor_nulo1</a>
<a class="sourceLine" id="cb187-3" title="3"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb187-4" title="4"><span class="kw">length</span>(vetor_nulo1)</a>
<a class="sourceLine" id="cb187-5" title="5"><span class="co">#&gt; [1] 0</span></a></code></pre></div>
<p>Um vetor nulo também pode ser definido com:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" title="1">vetor_nulo2 &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb188-2" title="2">vetor_nulo2</a>
<a class="sourceLine" id="cb188-3" title="3"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>Note que um vetor ser nulo não significa que ele não exista. Ou seja, a atribuição de <code>NULL</code> a uma variável não apaga a variável de seu ambiente de trabalho. A existência de uma variável pode ser verificada com a função <code>exists()</code>, na qual o argumento <code>x</code> deve ser passado como caractere.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1"><span class="kw">exists</span>(<span class="dt">x =</span> <span class="st">&quot;vetor_nulo1&quot;</span>)</a>
<a class="sourceLine" id="cb189-2" title="2"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Como o <code>NULL</code> é um vetor vazio, seu uso explícito dentro de um vetor não conta. Assim, qualquer operação com <code>NULL</code> resulta em um vetor vazio.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" title="1">(vetor_elem_nulo &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="ot">NULL</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb190-2" title="2"><span class="co">#&gt; [1] 1 2 4</span></a>
<a class="sourceLine" id="cb190-3" title="3"><span class="kw">length</span>(vetor_elem_nulo)</a>
<a class="sourceLine" id="cb190-4" title="4"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb190-5" title="5">vetor_elem_nulo <span class="op">+</span><span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb190-6" title="6"><span class="co">#&gt; numeric(0)</span></a></code></pre></div>
<p>Em algumas situações você pode querer anular um atributo de um vetor, como os nomes. Eventualmente até mesmo o próprio vetor.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1">prec</a>
<a class="sourceLine" id="cb191-2" title="2"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb191-3" title="3"><span class="co">#&gt; 300 205 210  12   0   0  12  22 110 120  10 280</span></a>
<a class="sourceLine" id="cb191-4" title="4"><span class="kw">names</span>(prec) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb191-5" title="5">prec</a>
<a class="sourceLine" id="cb191-6" title="6"><span class="co">#&gt;  [1] 300 205 210  12   0   0  12  22 110 120  10 280</span></a>
<a class="sourceLine" id="cb191-7" title="7">prec &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb191-8" title="8">prec</a>
<a class="sourceLine" id="cb191-9" title="9"><span class="co">#&gt; NULL</span></a></code></pre></div>
</div>
<div id="dados-duplicados" class="section level2">
<h2><span class="header-section-number">7.9</span> Dados duplicados</h2>
<p>Dados frequentemente pode ter valores duplicados ou repetidos e dependendo da aplicação isso pode causar problemas nos resultados. Portanto é importante detectar e remover essas ocorrências. O <img src="images/logo_r.png" width="20"> oferece algumas funções convenientes para detectar dados duplicados.</p>
<p>Mas antes, vamos criar um vetor de datas com alguns dias repetidos para então mostrar as funcionalidades disponíveis.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" title="1">datas &lt;-<span class="st"> </span><span class="kw">seq</span>(</a>
<a class="sourceLine" id="cb192-2" title="2">  <span class="dt">from =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-01-10&quot;</span>),</a>
<a class="sourceLine" id="cb192-3" title="3">  <span class="dt">to =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-01-10&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb192-4" title="4">  <span class="dt">by =</span> <span class="st">&quot;day&quot;</span></a>
<a class="sourceLine" id="cb192-5" title="5">)</a>
<a class="sourceLine" id="cb192-6" title="6">datas &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb192-7" title="7">  datas[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb192-8" title="8">  datas[<span class="dv">7</span><span class="op">:</span><span class="kw">length</span>(datas)], </a>
<a class="sourceLine" id="cb192-9" title="9">  datas[<span class="kw">length</span>(datas)], </a>
<a class="sourceLine" id="cb192-10" title="10">  datas[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb192-11" title="11">)</a>
<a class="sourceLine" id="cb192-12" title="12">datas</a>
<a class="sourceLine" id="cb192-13" title="13"><span class="co">#&gt;  [1] &quot;2017-01-10&quot; &quot;2017-01-11&quot; &quot;2017-01-12&quot; &quot;2017-01-13&quot; &quot;2017-01-14&quot;</span></a>
<a class="sourceLine" id="cb192-14" title="14"><span class="co">#&gt;  [6] &quot;2017-01-15&quot; NA           &quot;2017-01-16&quot; &quot;2017-01-17&quot; &quot;2017-01-18&quot;</span></a>
<a class="sourceLine" id="cb192-15" title="15"><span class="co">#&gt; [11] &quot;2017-01-19&quot; &quot;2017-01-20&quot; &quot;2017-01-20&quot; &quot;2017-01-14&quot; &quot;2017-01-15&quot;</span></a></code></pre></div>
<p>A função <code>duplicated()</code> detecta onde ocorrem valores repetidos.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1"><span class="kw">duplicated</span>(datas)</a>
<a class="sourceLine" id="cb193-2" title="2"><span class="co">#&gt;  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></a>
<a class="sourceLine" id="cb193-3" title="3"><span class="co">#&gt; [13]  TRUE  TRUE  TRUE</span></a></code></pre></div>
<p>Ela retorna um vetor lógico mostrando quais elementos são duplicados. Neste exemplo os últimos 3 elementos. Este resultado pode ser usado para remover os valores repetidos:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" title="1"><span class="co"># datas únicas: sem valores duplicados</span></a>
<a class="sourceLine" id="cb194-2" title="2">datas[<span class="op">!</span><span class="kw">duplicated</span>(datas)]</a>
<a class="sourceLine" id="cb194-3" title="3"><span class="co">#&gt;  [1] &quot;2017-01-10&quot; &quot;2017-01-11&quot; &quot;2017-01-12&quot; &quot;2017-01-13&quot; &quot;2017-01-14&quot;</span></a>
<a class="sourceLine" id="cb194-4" title="4"><span class="co">#&gt;  [6] &quot;2017-01-15&quot; NA           &quot;2017-01-16&quot; &quot;2017-01-17&quot; &quot;2017-01-18&quot;</span></a>
<a class="sourceLine" id="cb194-5" title="5"><span class="co">#&gt; [11] &quot;2017-01-19&quot; &quot;2017-01-20&quot;</span></a></code></pre></div>
<p>Alternativamente, há função <code>unique()</code> para remover valores repetidos de um vetor:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1"><span class="kw">unique</span>(datas)</a>
<a class="sourceLine" id="cb195-2" title="2"><span class="co">#&gt;  [1] &quot;2017-01-10&quot; &quot;2017-01-11&quot; &quot;2017-01-12&quot; &quot;2017-01-13&quot; &quot;2017-01-14&quot;</span></a>
<a class="sourceLine" id="cb195-3" title="3"><span class="co">#&gt;  [6] &quot;2017-01-15&quot; NA           &quot;2017-01-16&quot; &quot;2017-01-17&quot; &quot;2017-01-18&quot;</span></a>
<a class="sourceLine" id="cb195-4" title="4"><span class="co">#&gt; [11] &quot;2017-01-19&quot; &quot;2017-01-20&quot;</span></a></code></pre></div>
</div>
<div id="dados-ordenados" class="section level2">
<h2><span class="header-section-number">7.10</span> Dados ordenados</h2>
<p>Duas operações comuns em análise de dados são a ordenação e a classificação dados de um vetor.</p>
<p>A função <code>sort()</code> arranja os dados de um vetor numérico em ordem crescente ou descrescente (se argumento for especificado como <code>decreasing = TRUE</code>). Se o vetor for de caracteres, o arranjo segue a ordem alfabética dando precedência às letras em minúsculo.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" title="1"><span class="kw">sort</span>(prec_alt)</a>
<a class="sourceLine" id="cb196-2" title="2"><span class="co">#&gt; mai jul ago set out fev dez jan </span></a>
<a class="sourceLine" id="cb196-3" title="3"><span class="co">#&gt;   0  21  42 100 120 200 208 250</span></a>
<a class="sourceLine" id="cb196-4" title="4"><span class="kw">sort</span>(prec_alt, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb196-5" title="5"><span class="co">#&gt; jan dez fev out set ago jul mai </span></a>
<a class="sourceLine" id="cb196-6" title="6"><span class="co">#&gt; 250 208 200 120 100  42  21   0</span></a></code></pre></div>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1"><span class="kw">sort</span>(<span class="kw">names</span>(prec_alt))</a>
<a class="sourceLine" id="cb197-2" title="2"><span class="co">#&gt;  [1] &quot;abr&quot; &quot;ago&quot; &quot;dez&quot; &quot;fev&quot; &quot;jan&quot; &quot;jul&quot; &quot;jun&quot; &quot;mai&quot; &quot;mar&quot; &quot;nov&quot; &quot;out&quot; &quot;set&quot;</span></a></code></pre></div>
<p>A ordem de classificação de cada elemento de um vetor numérico é obtida com a função <code>order()</code>:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" title="1">prec_alt</a>
<a class="sourceLine" id="cb198-2" title="2"><span class="co">#&gt; jan fev mar abr mai jun jul ago set out nov dez </span></a>
<a class="sourceLine" id="cb198-3" title="3"><span class="co">#&gt; 250 200  NA  NA   0  NA  21  42 100 120  NA 208</span></a>
<a class="sourceLine" id="cb198-4" title="4"><span class="kw">order</span>(prec_alt)</a>
<a class="sourceLine" id="cb198-5" title="5"><span class="co">#&gt;  [1]  5  7  8  9 10  2 12  1  3  4  6 11</span></a></code></pre></div>
<p>O resultado indica que o 5º elemento de <code>prec_alt</code> é o menor valor e o 1º elemento é o de maior valor. Isso pode ser facilmente verificado passando este resultado na indexação da <code>prec_alt</code>.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1"><span class="co"># equivalente a sort()</span></a>
<a class="sourceLine" id="cb199-2" title="2">prec_alt[<span class="kw">order</span>(prec_alt)]</a>
<a class="sourceLine" id="cb199-3" title="3"><span class="co">#&gt; mai jul ago set out fev dez jan mar abr jun nov </span></a>
<a class="sourceLine" id="cb199-4" title="4"><span class="co">#&gt;   0  21  42 100 120 200 208 250  NA  NA  NA  NA</span></a></code></pre></div>
<p>Nota-se então, que por padrão na saída da <code>order()</code> os elementos faltantes são colocados nas últimas posições (no exemplo: 3, 4, 6, 11). Para remover os casos faltantes especificamos o argumento <code>na.last = NA</code>.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1"><span class="kw">order</span>(prec_alt, <span class="dt">na.last =</span> <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb200-2" title="2"><span class="co">#&gt; [1]  5  7  8  9 10  2 12  1</span></a></code></pre></div>
</div>
<div id="funções-móveis-úteis" class="section level2">
<h2><span class="header-section-number">7.11</span> Funções móveis úteis</h2>
<p>Se queremos obter um valor que leve em consideração todos os valores anteriores e o valor atual, podemos usar funções da família <strong>cum{fun}()</strong>, como a <strong><code>cumsum()</code></strong> para somar valores à medida que avançamos na sequência. Esta operação é conhecida como soma cumulativa, total móvel ou soma móvel.</p>
<p>Vamos obter a soma cumulativa da série da precipitação mensal abaixo.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1"><span class="co"># serie de com 2 anos de prec mensal</span></a>
<a class="sourceLine" id="cb201-2" title="2">prec &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb201-3" title="3">    <span class="dv">230</span>, <span class="dv">205</span>, <span class="dv">160</span>, <span class="dv">100</span>, <span class="dv">60</span>, <span class="dv">30</span>, </a>
<a class="sourceLine" id="cb201-4" title="4">    <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">110</span>, <span class="dv">165</span>, <span class="dv">200</span>, <span class="dv">220</span>, </a>
<a class="sourceLine" id="cb201-5" title="5">    <span class="dv">250</span>,<span class="dv">200</span>, <span class="dv">210</span>, <span class="dv">12</span>, <span class="dv">0</span>, <span class="dv">30</span>, </a>
<a class="sourceLine" id="cb201-6" title="6">    <span class="dv">21</span>, <span class="dv">42</span>, <span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">10</span>, <span class="dv">208</span></a>
<a class="sourceLine" id="cb201-7" title="7">  )</a>
<a class="sourceLine" id="cb201-8" title="8">prec</a>
<a class="sourceLine" id="cb201-9" title="9"><span class="co">#&gt;  [1] 230 205 160 100  60  30  40  60 110 165 200 220 250 200 210  12   0  30  21</span></a>
<a class="sourceLine" id="cb201-10" title="10"><span class="co">#&gt; [20]  42 100 120  10 208</span></a>
<a class="sourceLine" id="cb201-11" title="11"><span class="co"># meses de prec como datas</span></a>
<a class="sourceLine" id="cb201-12" title="12">dts &lt;-<span class="st"> </span><span class="kw">seq</span>(</a>
<a class="sourceLine" id="cb201-13" title="13">  <span class="dt">from =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2010-01-01&quot;</span>),</a>
<a class="sourceLine" id="cb201-14" title="14">  <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>,</a>
<a class="sourceLine" id="cb201-15" title="15">  <span class="dt">length.out =</span> <span class="kw">length</span>(prec)</a>
<a class="sourceLine" id="cb201-16" title="16">)</a>
<a class="sourceLine" id="cb201-17" title="17">dts</a>
<a class="sourceLine" id="cb201-18" title="18"><span class="co">#&gt;  [1] &quot;2010-01-01&quot; &quot;2010-02-01&quot; &quot;2010-03-01&quot; &quot;2010-04-01&quot; &quot;2010-05-01&quot;</span></a>
<a class="sourceLine" id="cb201-19" title="19"><span class="co">#&gt;  [6] &quot;2010-06-01&quot; &quot;2010-07-01&quot; &quot;2010-08-01&quot; &quot;2010-09-01&quot; &quot;2010-10-01&quot;</span></a>
<a class="sourceLine" id="cb201-20" title="20"><span class="co">#&gt; [11] &quot;2010-11-01&quot; &quot;2010-12-01&quot; &quot;2011-01-01&quot; &quot;2011-02-01&quot; &quot;2011-03-01&quot;</span></a>
<a class="sourceLine" id="cb201-21" title="21"><span class="co">#&gt; [16] &quot;2011-04-01&quot; &quot;2011-05-01&quot; &quot;2011-06-01&quot; &quot;2011-07-01&quot; &quot;2011-08-01&quot;</span></a>
<a class="sourceLine" id="cb201-22" title="22"><span class="co">#&gt; [21] &quot;2011-09-01&quot; &quot;2011-10-01&quot; &quot;2011-11-01&quot; &quot;2011-12-01&quot;</span></a>
<a class="sourceLine" id="cb201-23" title="23">prec_ac &lt;-<span class="st"> </span><span class="kw">cumsum</span>(prec)</a>
<a class="sourceLine" id="cb201-24" title="24">prec_ac</a>
<a class="sourceLine" id="cb201-25" title="25"><span class="co">#&gt;  [1]  230  435  595  695  755  785  825  885  995 1160 1360 1580 1830 2030 2240</span></a>
<a class="sourceLine" id="cb201-26" title="26"><span class="co">#&gt; [16] 2252 2252 2282 2303 2345 2445 2565 2575 2783</span></a></code></pre></div>
<p>A relação entre essas duas variáveis pode ser melhor compreendida pelo gráfico da Figura @ref(fig:plot-cumsum).</p>
<div class="figure" style="text-align: center">
<img src="images/plot-cumsum-1.png" alt="Visualização da soma acumulada. A precipitação será representada por barras e a precipitação acumulada até o mês decorrido como linha. Nós abordaremos os recursos para visualização gráfica na seção **Visualização de dados**." width="90%" />
<p class="caption">
(#fig:plot-cumsum)Visualização da soma acumulada. A precipitação será representada por barras e a precipitação acumulada até o mês decorrido como linha. Nós abordaremos os recursos para visualização gráfica na seção <strong>Visualização de dados</strong>.
</p>
</div>
<p>As funções <code>cummax()</code> e <code>cummin()</code> fornecem os valores mínimo e máximo entre o início do vetor e a posição de cada elemento. Para enfatizar a utilidade destas funções, vamos considerar o vetor <code>y</code> abaixo, representando uma onda com amplitude que aumenta no tempo.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" title="1">(x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="fl">2.75</span><span class="op">*</span>pi, <span class="dt">length.out =</span> <span class="dv">20</span>))</a>
<a class="sourceLine" id="cb202-2" title="2"><span class="co">#&gt;  [1] 0.0000000 0.4547042 0.9094084 1.3641126 1.8188168 2.2735210 2.7282252</span></a>
<a class="sourceLine" id="cb202-3" title="3"><span class="co">#&gt;  [8] 3.1829294 3.6376336 4.0923378 4.5470420 5.0017462 5.4564504 5.9111546</span></a>
<a class="sourceLine" id="cb202-4" title="4"><span class="co">#&gt; [15] 6.3658588 6.8205630 7.2752672 7.7299714 8.1846756 8.6393798</span></a>
<a class="sourceLine" id="cb202-5" title="5">(y &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="op">-</span>x<span class="op">*</span><span class="kw">cos</span>(<span class="dv">2</span><span class="op">*</span>x), <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb202-6" title="6"><span class="co">#&gt;  [1]  0.00 -0.28  0.22  1.25  1.60  0.37 -1.85 -3.17 -1.99  1.33  4.30  4.19</span></a>
<a class="sourceLine" id="cb202-7" title="7"><span class="co">#&gt; [13]  0.45 -4.35 -6.28 -3.25  2.92  7.49  6.46  0.00</span></a>
<a class="sourceLine" id="cb202-8" title="8"><span class="co"># maximos e minimos móveis de y</span></a>
<a class="sourceLine" id="cb202-9" title="9">(y_env_sup &lt;-<span class="st"> </span><span class="kw">cummax</span>(y))</a>
<a class="sourceLine" id="cb202-10" title="10"><span class="co">#&gt;  [1] 0.00 0.00 0.22 1.25 1.60 1.60 1.60 1.60 1.60 1.60 4.30 4.30 4.30 4.30 4.30</span></a>
<a class="sourceLine" id="cb202-11" title="11"><span class="co">#&gt; [16] 4.30 4.30 7.49 7.49 7.49</span></a>
<a class="sourceLine" id="cb202-12" title="12">(y_env_inf &lt;-<span class="st"> </span><span class="kw">cummin</span>(y))</a>
<a class="sourceLine" id="cb202-13" title="13"><span class="co">#&gt;  [1]  0.00 -0.28 -0.28 -0.28 -0.28 -0.28 -1.85 -3.17 -3.17 -3.17 -3.17 -3.17</span></a>
<a class="sourceLine" id="cb202-14" title="14"><span class="co">#&gt; [13] -3.17 -4.35 -6.28 -6.28 -6.28 -6.28 -6.28 -6.28</span></a></code></pre></div>
<p>A Figura @ref(fig:plot-cumaxmin) permite visualizar que estas funções fornecem os envelopes superior e inferior de variação de um vetor.</p>
<div class="figure" style="text-align: center">
<img src="images/plot-cumaxmin-1.png" alt="Visualização do potencial uso das funções `cummax()` e `cummin()`." width="90%" />
<p class="caption">
(#fig:plot-cumaxmin)Visualização do potencial uso das funções <code>cummax()</code> e <code>cummin()</code>.
</p>
</div>
<p>Em alguns casos precisamos comparar os valores em relação a valores antes ou depois de um elemento do vetor. Para este tipo de operação podemos usar as funções:</p>
<ul>
<li><p><code>diff(x)</code>: diferencial ou primeira diferença, calcula para cada elemento de <code>x</code> a diferença <code>x[i] - x[i-1]</code> para i de 2 até <code>length(x)</code>. Resulta em um vetor com um elemento a menos que o vetor de entrada.</p></li>
<li><p><code>lag(x, n)</code> do pacote <strong><code>dplyr</code></strong><a href="#fn25" class="footnote-ref" id="fnref25"><sup>25</sup></a>: atrasa os valores de um vetor <code>x</code> por <code>n</code> observações (valor predefinido <code>n = 1</code>);</p></li>
<li><p><code>lead(x, n)</code> do pacote <strong><code>dplyr</code></strong>: adianta os valores de um vetor <code>x</code> por <code>n</code> observações (valor predefinido <code>n = 1</code>);</p></li>
</ul>
<p>Vamos comparar o resultado da <code>diff()</code> aplicada ao vetor de <code>prec</code> acumulado (<code>prec_ac</code>) com os valores <code>prec</code>.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1"><span class="kw">diff</span>(prec_ac) </a>
<a class="sourceLine" id="cb203-2" title="2"><span class="co">#&gt;  [1] 205 160 100  60  30  40  60 110 165 200 220 250 200 210  12   0  30  21  42</span></a>
<a class="sourceLine" id="cb203-3" title="3"><span class="co">#&gt; [20] 100 120  10 208</span></a>
<a class="sourceLine" id="cb203-4" title="4"><span class="co">#length(diff(prec_ac))</span></a>
<a class="sourceLine" id="cb203-5" title="5">prec</a>
<a class="sourceLine" id="cb203-6" title="6"><span class="co">#&gt;  [1] 230 205 160 100  60  30  40  60 110 165 200 220 250 200 210  12   0  30  21</span></a>
<a class="sourceLine" id="cb203-7" title="7"><span class="co">#&gt; [20]  42 100 120  10 208</span></a>
<a class="sourceLine" id="cb203-8" title="8"><span class="co">#length(prec)</span></a></code></pre></div>
<p>Se precisássemos comparar <code>prec</code> com valores do mês anterior e posterior, estes vetores poderiam ser obtidos simplesmente com:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" title="1"><span class="co"># vetor prec deslocado para frente (atrasado)</span></a>
<a class="sourceLine" id="cb204-2" title="2"><span class="kw">lag</span>(prec)</a>
<a class="sourceLine" id="cb204-3" title="3"><span class="co">#&gt;  [1]  NA 230 205 160 100  60  30  40  60 110 165 200 220 250 200 210  12   0  30</span></a>
<a class="sourceLine" id="cb204-4" title="4"><span class="co">#&gt; [20]  21  42 100 120  10</span></a>
<a class="sourceLine" id="cb204-5" title="5"><span class="co"># vetor prec deslocado para trás (adiantados)</span></a>
<a class="sourceLine" id="cb204-6" title="6"><span class="kw">lead</span>(prec)</a>
<a class="sourceLine" id="cb204-7" title="7"><span class="co">#&gt;  [1] 205 160 100  60  30  40  60 110 165 200 220 250 200 210  12   0  30  21  42</span></a>
<a class="sourceLine" id="cb204-8" title="8"><span class="co">#&gt; [20] 100 120  10 208  NA</span></a></code></pre></div>
<p>Para detectar períodos de aumento (ou redução) da precipitação do mês atual em relação ao anterior.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1">prec <span class="op">-</span><span class="st"> </span><span class="kw">lag</span>(prec) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb205-2" title="2"><span class="co">#&gt;  [1]    NA FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</span></a>
<a class="sourceLine" id="cb205-3" title="3"><span class="co">#&gt; [13]  TRUE FALSE  TRUE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE</span></a>
<a class="sourceLine" id="cb205-4" title="4">prec <span class="op">-</span><span class="st"> </span><span class="kw">lag</span>(prec) <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb205-5" title="5"><span class="co">#&gt;  [1]    NA  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</span></a>
<a class="sourceLine" id="cb205-6" title="6"><span class="co">#&gt; [13] FALSE  TRUE FALSE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE</span></a></code></pre></div>
<!---
- table()
frequência de ocorrência, contagens, porcentagem e proporção
- prop.table()*100
--->
</div>
<div id="identificação-de-eventos-discretos" class="section level2">
<h2><span class="header-section-number">7.12</span> Identificação de eventos discretos</h2>
<p>Frequentemente precisamos separar a série temporal de uma variável em eventos discretos, como a identificação de períodos extremos ou de risco, como secas, tempestades, ondas de calor, períodos de poluição atmosférica crítica (acima ou abaixo de um limiar de concentração do poluentes) e etc.</p>
<p>Para caracterização destes eventos as informação essencias são o <strong>início</strong>, o <strong>fim</strong> e a <strong>duração</strong> de cada evento. Com essas informações podemos identificar cada evento e extrair outros atributos, na escala de evento, para aprofundar a análise.</p>
<p>Para ilustrar a conveniência das funções vistas até agora, veremos uma forma geral para identificação de eventos. O evento de interesse será o período da estação chuvosa nos dados <code>prec</code>. Neste exemplo, a estação chuvosa é definida quando <code>prec &gt; 100</code> mm mês<sup>-1</sup>.</p>
<p>O primeiro passo é identificar a ocorrência dos eventos.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" title="1">limiar &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb206-2" title="2"><span class="co"># definição de evento (condição)</span></a>
<a class="sourceLine" id="cb206-3" title="3">(x &lt;-<span class="st"> </span>evts &lt;-<span class="st"> </span><span class="kw">as.integer</span>(prec <span class="op">&gt;</span><span class="st"> </span>limiar))</a>
<a class="sourceLine" id="cb206-4" title="4"><span class="co">#&gt;  [1] 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1 0 0 0 0 0 0 1 0 1</span></a></code></pre></div>
<p>A conversão dos eventos de lógico para numérico é opcional<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a> e foi usada apenas para facilitar a localização dos eventos visualmente (1: ocorrência de evento, 0: não ocorrência). A partir daí, o problema consiste em identificar sequências de elementos adjacentes iguais (sequências de 1 repetidos).</p>
<p>As posições iniciais de cada evento podem ser encontradas subtraindo o elemento prévio (<code>lag(x)</code>) do elemento atual (<code>x</code>). Se a diferença for <code>-1</code> temos o início de um evento. A tabela abaixo permite visualizar melhor isso.</p>
<table>
<tbody>
<tr class="odd">
<td align="left">elemento</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="right">10</td>
<td align="right">11</td>
<td align="right">12</td>
<td align="right">13</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">16</td>
<td align="right">17</td>
<td align="right">18</td>
<td align="right">19</td>
<td align="right">20</td>
<td align="right">21</td>
<td align="right">22</td>
<td align="right">23</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">lag(x)</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">pos_ini</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1"><span class="co"># x atrasado: desloca os elementos para para frente</span></a>
<a class="sourceLine" id="cb207-2" title="2">pos_ini &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">lag</span>(x) <span class="op">-</span><span class="st"> </span>x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb207-3" title="3"><span class="co"># ajuste do primeiro elemento de pos_ini</span></a>
<a class="sourceLine" id="cb207-4" title="4">pos_prim &lt;-<span class="st"> </span><span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb207-5" title="5">  <span class="dt">test =</span> x[<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb207-6" title="6">  <span class="dt">yes =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb207-7" title="7">  <span class="dt">no =</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb207-8" title="8">)</a>
<a class="sourceLine" id="cb207-9" title="9">(pos_ini &lt;-<span class="st"> </span><span class="kw">c</span>(pos_prim, pos_ini))</a>
<a class="sourceLine" id="cb207-10" title="10"><span class="co">#&gt; [1]  1  9 22 24</span></a>
<a class="sourceLine" id="cb207-11" title="11"><span class="co"># datas de início dos eventos</span></a>
<a class="sourceLine" id="cb207-12" title="12">dts[pos_ini]</a>
<a class="sourceLine" id="cb207-13" title="13"><span class="co">#&gt; [1] &quot;2010-01-01&quot; &quot;2010-09-01&quot; &quot;2011-10-01&quot; &quot;2011-12-01&quot;</span></a></code></pre></div>
<p>Temos que ter cuidado especial com o primeiro índice das posições iniciais (<code>pos_prim</code>), ajustando-o para considerar adequadamente eventos começando logo início do vetor. Esse ajuste é necessário porque usando a diferença do vetor defasado não há como detectar se o primeiro elemento é evento ou não.</p>
<p>Analogamente, as posições finais de cada evento podem ser encontradas subtraindo o elemento seguinte (<code>lead(x)</code>) do elemento atual (<code>x</code>). Quando essa diferença é <code>-1</code> temos o fim de um evento, o que pode ser visualizado na tabela abaixo.</p>
<table>
<tbody>
<tr class="odd">
<td align="left">elemento</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="right">10</td>
<td align="right">11</td>
<td align="right">12</td>
<td align="right">13</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">16</td>
<td align="right">17</td>
<td align="right">18</td>
<td align="right">19</td>
<td align="right">20</td>
<td align="right">21</td>
<td align="right">22</td>
<td align="right">23</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">lead(x)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">pos_fim</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1">pos_fim &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">lead</span>(x) <span class="op">-</span><span class="st"> </span>x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb208-2" title="2"><span class="co"># ajuste do último elemento de pos_fim</span></a>
<a class="sourceLine" id="cb208-3" title="3">pos_ult &lt;-<span class="st"> </span><span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb208-4" title="4">  <span class="dt">test =</span> x[<span class="kw">length</span>(x)] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb208-5" title="5">  <span class="dt">yes =</span> <span class="kw">length</span>(x),</a>
<a class="sourceLine" id="cb208-6" title="6">  <span class="dt">no =</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb208-7" title="7">)</a>
<a class="sourceLine" id="cb208-8" title="8">(pos_fim &lt;-<span class="st"> </span><span class="kw">c</span>(pos_fim, pos_ult))</a>
<a class="sourceLine" id="cb208-9" title="9"><span class="co">#&gt; [1]  3 15 22 24</span></a>
<a class="sourceLine" id="cb208-10" title="10"><span class="co"># datas do fim dos eventos</span></a>
<a class="sourceLine" id="cb208-11" title="11">dts[pos_fim]</a>
<a class="sourceLine" id="cb208-12" title="12"><span class="co">#&gt; [1] &quot;2010-03-01&quot; &quot;2011-03-01&quot; &quot;2011-10-01&quot; &quot;2011-12-01&quot;</span></a></code></pre></div>
<p>O último índice do vetor de posições finais requer tratamento similar ao do 1° elemento das posições iniciais. Ele deve ser ajustado para tratar dos casos com eventos no último elemento de <code>x</code>.</p>
<p>A duração de cada evento é facilmente obtida do fim e início de cada evento:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1">duracao &lt;-<span class="st"> </span>pos_fim <span class="op">-</span><span class="st"> </span>pos_ini <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb209-2" title="2">duracao</a>
<a class="sourceLine" id="cb209-3" title="3"><span class="co">#&gt; [1] 3 7 1 1</span></a>
<a class="sourceLine" id="cb209-4" title="4"><span class="co"># rbind(x, atras = lag(x), adiant = lead(x), pos_ini = lag(x)-x, pos_fim = lead(x) - x)</span></a></code></pre></div>
<p>Eventualmente você pode precisar de um vetor identificando cada evento, o que pode ser feito usando:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1">evts_id &lt;-<span class="st"> </span>evts</a>
<a class="sourceLine" id="cb210-2" title="2">evts_id[evts <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">seq_along</span>(duracao), <span class="dt">times =</span> duracao)</a>
<a class="sourceLine" id="cb210-3" title="3">evts_id</a>
<a class="sourceLine" id="cb210-4" title="4"><span class="co">#&gt;  [1] 1 1 1 0 0 0 0 0 2 2 2 2 2 2 2 0 0 0 0 0 0 3 0 4</span></a></code></pre></div>
<p>Este vetor pode ser usado, para obter estatísticas de cada evento. Por exemplo, a precipitação média em cada evento pode ser determinada passando este vetor como argumento da função <code>tapply()</code>. Como só queremos informação nos eventos vamos substituir os valores = 0 por NA em <code>evts_id</code>. Assim, a <code>tapply()</code> retornará a média só para os eventos de interesse.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1">evts_id &lt;-<span class="st"> </span><span class="kw">ifelse</span>(evts_id <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>, evts_id)</a>
<a class="sourceLine" id="cb211-2" title="2"><span class="co"># prec média em cada evento</span></a>
<a class="sourceLine" id="cb211-3" title="3"><span class="kw">tapply</span>(</a>
<a class="sourceLine" id="cb211-4" title="4">  <span class="dt">X =</span> prec,</a>
<a class="sourceLine" id="cb211-5" title="5">  <span class="dt">INDEX =</span> evts_id,</a>
<a class="sourceLine" id="cb211-6" title="6">  <span class="dt">FUN =</span> sum</a>
<a class="sourceLine" id="cb211-7" title="7">)</a>
<a class="sourceLine" id="cb211-8" title="8"><span class="co">#&gt;    1    2    3    4 </span></a>
<a class="sourceLine" id="cb211-9" title="9"><span class="co">#&gt;  595 1355  120  208</span></a></code></pre></div>
<p>A <code>tapply()</code> tem três argumentos:</p>
<ul>
<li><p><code>X</code>: dados que queremos aplicar a função</p></li>
<li><p><code>INDEX:</code> vetor de índices com os grupos para os quais a função será aplicada separadamente.</p></li>
<li><p><code>FUN</code>: a função que desejamos aplicar aos dados (e.g.: <code>mean()</code>, ``)</p></li>
</ul>
<!--
# Forma alternativa de resolução
acum_eventos <- cumsum(eventos)
# mantém valores de cumsum qdo não é evento
# e zera qdo é evento
entre_eventos <- acum_eventos * (!eventos)
# sequencia das ocorrência dentro de um evento
(seq_eventos <- acum_eventos - cummax(entre_eventos))
# identificador da ordem cronológica de cada evento
(ordem_eventos <- cumsum(seq_eventos == 1) * eventos)
# Com os vetores que identificam cada evento e quantificam suas ocorrências em 
# cada evento, podemos extrair os índices de início, fim e a duração de cada 
# evento.
pos_ult <- ifelse(eventos[length(eventos)] == TRUE, length(eventos), 0)
#replace(pos_ult, is.na(pos_ult), NULL)
(fim <- c(which(c(NA, diff(eventos) < 0) == 1) - 1, pos_ult))
(inicio <- which(seq_eventos == 1))
(dur <- seq_eventos[fim])
unique(ordem_eventos[ordem_eventos > 0])

# freq <- table(ordem_eventos[ordem_eventos > 0])
# duracao <- unname(rep(freq, times = freq))
# dur <- ordem_eventos
# dur[ordem_eventos != 0] <- duracao
-->
</div>
<div id="exercícios-1" class="section level2">
<h2><span class="header-section-number">7.13</span> Exercícios</h2>
<ol style="list-style-type: decimal">
<li>Crie um vetor com os valores de <span class="math inline">\(e^{x}cos{x}\)</span> para os valores de <span class="math inline">\(x = (3, 3.1, 3.2, ..., 6\)</span>).</li>
</ol>
<hr />
<ol start="2" style="list-style-type: decimal">
<li>Crie os seguintes vetores.
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\((0.1^{3}\times0.2^{1}, 0.1^{6}\times0.2^{4}, ..., 0.1^{36}\times0.2^{34})\)</span></p></li>
<li><p><span class="math inline">\((2, \frac{2^{2}}{2}, \frac{2^{3}}{3}, ..., \frac{2^{25}}{25})\)</span></p></li>
</ol></li>
</ol>
<hr />
<ol start="3" style="list-style-type: decimal">
<li>Reproduza a criação do vetor dias da semana (<code>dds</code>) mostrado abaixo.</li>
</ol>
<pre><code>domingo segunda   terca  quarta  quinta   sexta   sabado
      1       2       3       4       5       6        7</code></pre>
<hr />
<ol start="4" style="list-style-type: decimal">
<li>Interprete o resultado da seguinte operação:</li>
</ol>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1">dds_nums &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb213-2" title="2">  5L, 2L, 5L, 2L, 7L, 7L, 2L,</a>
<a class="sourceLine" id="cb213-3" title="3">  6L, 6L, 3L, 7L, 1L, 2L, 2L,</a>
<a class="sourceLine" id="cb213-4" title="4">  5L, 7L, 3L, 2L, 6L, 4L, 1L</a>
<a class="sourceLine" id="cb213-5" title="5">)</a>
<a class="sourceLine" id="cb213-6" title="6"><span class="kw">names</span>(dds)[dds_nums]</a></code></pre></div>
<hr />
<ol start="5" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>Escreva o código necessário para determinar o vetor lógico indicando quais números são pares na sequência de valores 85, 79, 70, 6, 32, 8, 17, 93, 81, 76. b. Calcule o total de números ímpares.</li>
</ol></li>
</ol>
<hr />
<ol start="6" style="list-style-type: decimal">
<li>Para um ano ser bissexto, ele deve ser:</li>
</ol>
<ul>
<li><p>divísivel por 4 (a divisão é exata com resto igual a zero)</p></li>
<li><p>não pode ser divisível por 100 (a divisão não é exata, ou seja, o resto é diferente de zero)</p></li>
<li><p>pode ser que seja divisível por 400: caso seja divisível por 400, a divisão deve ser exata, deixando o resto igual a zero.</p>
<p>Com os critérios definidos acima, construa o código para:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Verificar se os anos 1894, 1947, 1901, 1992, 1925, 2014, 1993, 1996, 1984, 1897, 2100, 2300 são bissextos.</p></li>
<li><p>Mostre quais anos são bissextos.</p></li>
<li><p>Usando o código para verificar se o ano é bissexto, gere um vetor nomeado <code>ndias</code> com o número de dias do ano para os anos do item (a).</p></li>
<li><p>Programe como obter o total de anos com 366 dias?</p></li>
</ol></li>
</ul>
<hr />
<ol start="7" style="list-style-type: decimal">
<li>Quais códigos para gerar os seguintes dados:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre><code>[1] -30   0   5  10  15  20  30</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre><code>[1] 1.0 0.8 0.6 0.4 0.2 0.0</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre><code>[1] -3.1415927 -2.4434610 -1.7453293 -1.0471976 -0.3490659  0.3490659
[7]  1.0471976  1.7453293  2.4434610  3.1415927</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre><code>[1] -1 -1  0  0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  3  3  4  4  4
[24]  4  4  4  4  5  5  5  5  5  5  5  5</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre><code>[1] 5 5 5 5 5 4 4 4 4 3 3 3 2 2 1 2 2 3 3 3 4 4 4 4 5 5 5 5 5</code></pre>
<hr />
<ol start="8" style="list-style-type: decimal">
<li>Usando o mesmo código para solução em todos os itens abaixo, obtenha as seguintes sequências usando os vetores fornecidos.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>v3 = (11, 0.25, 7, 2)</li>
</ol>
<pre><code>[1] 1 2 3 4</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>v2 = (11, 0.25)</li>
</ol>
<pre><code>[1] 1 2</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>v1 = (11)</li>
</ol>
<pre><code>[1] 1</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>v0 = ()</li>
</ol>
<pre><code>integer(0)</code></pre>
<hr />
<ol start="9" style="list-style-type: decimal">
<li>Considere os seguintes dados horários de temperatura do ar (<span class="math inline">\(T_{ar}\)</span>) registrados em duas estações meteorológicas, entre as 0 e 23 horas de um dado dia.</li>
</ol>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1">tar_est1 &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb223-2" title="2">  <span class="fl">14.92</span>, <span class="fl">14.61</span>, <span class="fl">14.32</span>, <span class="fl">14.07</span>, <span class="fl">13.84</span>, <span class="fl">13.65</span>, <span class="fl">13.56</span>, <span class="fl">13.97</span>, <span class="fl">15.08</span>,</a>
<a class="sourceLine" id="cb223-3" title="3">  <span class="fl">16.5</span>, <span class="fl">17.88</span>, <span class="fl">19.08</span>, <span class="fl">20.02</span>, <span class="fl">20.66</span>, <span class="fl">21.01</span>, <span class="fl">21.05</span>, <span class="fl">20.76</span>, <span class="fl">20.05</span>,</a>
<a class="sourceLine" id="cb223-4" title="4">  <span class="fl">18.77</span>, <span class="fl">17.51</span>, <span class="fl">16.67</span>, <span class="fl">16.11</span>, <span class="fl">15.66</span>, <span class="fl">15.27</span></a>
<a class="sourceLine" id="cb223-5" title="5">)</a>
<a class="sourceLine" id="cb223-6" title="6">tar_est2 &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb223-7" title="7">  <span class="fl">13.13</span>, <span class="fl">13.01</span>, <span class="fl">12.93</span>, <span class="fl">12.87</span>, <span class="fl">12.82</span>, <span class="fl">12.81</span>, <span class="fl">13.2</span>, <span class="fl">14.22</span>, <span class="fl">15.77</span>,</a>
<a class="sourceLine" id="cb223-8" title="8">  <span class="fl">17.49</span>, <span class="fl">19.2</span>, <span class="fl">20.57</span>, <span class="fl">21.49</span>, <span class="fl">22.01</span>, <span class="fl">22.03</span>, <span class="fl">21.71</span>, <span class="fl">20.84</span>, <span class="fl">18.77</span>,</a>
<a class="sourceLine" id="cb223-9" title="9">  <span class="fl">16.54</span>, <span class="fl">15.13</span>, <span class="fl">14.34</span>, <span class="fl">13.81</span>, <span class="fl">13.49</span>, <span class="fl">13.28</span></a>
<a class="sourceLine" id="cb223-10" title="10">)</a></code></pre></div>
<blockquote>
<p>Dica: Faça um gráfico para visualizar as temperaturas das duas estações. Isso facilitará a solução.</p>
</blockquote>
<p><strong>a.</strong> Determine a média diária da <span class="math inline">\(T_{ar}\)</span> das duas estações arrendondando para uma casa decimal. Salve a média de cada estação nas variáveis <code>tmed_est1</code> e <code>tmed_est2</code>.</p>
<p><strong>b</strong>. Utilizando as variáveis do item anterior, verifique usando comparação lógica, em qual estação o ambiente é mais quente?</p>
<p><strong>c</strong>. Obtenha a 3ª maior temperatura do dia em cada estação.</p>
<p><strong>d</strong>. Calcule a amplitude térmica diária (<span class="math inline">\(ATD = T_{max}-T_{min}\)</span>, onde <span class="math inline">\(T_{max}\)</span>: temperatura máxima dária e <span class="math inline">\(T_{min}\)</span>: temperatura mínima dária) das estações 1 e 2, arrendondando para uma casa decimal. Salve os resultados nas variaveis <code>atd_est1</code> e <code>atd_est2</code>.</p>
<p><strong>e</strong>. Qual o horário de ocorrência das temperaturas máximas e mínimas em cada estação? Salve os resultados nas variáveis <code>hmax_est{i}</code> e <code>hmin_est{i}</code>, com <span class="math inline">\(i = 1, 2\)</span>.</p>
<p><strong>f</strong>. Quando <code>tar_est2</code> é maior que <code>tar_est1</code> qual a maior diferença absoluta de temperatura entre as duas estações?</p>
<p><strong>g</strong>. Qual a hora correspondende a ocorrência daquela maior diferença absoluta de temperatura obtida no item anterior?</p>
<p><strong>h</strong>. O horário do pôr do sol pode ser estimado a partir da <span class="math inline">\(T_{ar}\)</span>. Para o período após o horário de ocorrência da <span class="math inline">\(T_{max}\)</span> determina-se em qual hora ocorre a maior queda de <span class="math inline">\(T_{ar}\)</span> em relação a hora anterior. Estime o horário do pôr do sol para as duas estações (<code>hps_est{i}</code>).</p>
<p><strong>i</strong>. Em quais horas as temperaturas das duas estações estão mais próximas uma da outra, ou seja com menos de 0,5°C de diferença ?</p>
<p><strong>j</strong>. Calcule a temperatura média diária usando os seguintes métodos para estação 2.</p>
<p><span class="math inline">\(T_{med_{1}} = (T_{max} + T_{min})/2\)</span>, salvando em uma variável <code>tar_met1</code>.</p>
<p><span class="math inline">\(T_{med_{2}} = (T_{max} + T_{min} + T_{9} + 2T_{21})/5\)</span>, salvando em uma variável <code>tar_met2</code>.</p>
<p><span class="math inline">\(T_{med_{3}} = (T_{7} + T_{14} + 2T_{21})/4\)</span>, salvando em uma variável <code>tar_met2</code>.</p>
<p><strong>k</strong>.Compare este resultados com aqueles obtidos no item <strong>a</strong>. Qual é melhor?</p>
<hr />
<ol start="10" style="list-style-type: decimal">
<li>Calcule a temperatura do ar horária usando o <strong>modelo de onda</strong> para representação do ciclo diário da temperatura do ar, descrito pelas seguintes equações:</li>
</ol>
<p><span class="math display">\[\left\{\begin{matrix}
h_{T_{min}}\leq h &lt; h_{T_{max}}, &amp; T_{calc} =  \bar{T} - A \, cos\left ( arg \right )\\ 
demais\; horas, &amp; T_{calc} =  \bar{T} + A \, cos\left ( arg \right )
\end{matrix}\right.\]</span></p>
<p>onde:</p>
<p><span class="math display">\[\bar{T} = \left ( \frac{T_{max} + T_{min}}{2} \right )\]</span></p>
<p>e</p>
<p><span class="math display">\[A =\left ( \frac{T_{max}-T_{min}}{2} \right ) \]</span></p>
<p>O argumento do cosseno (<span class="math inline">\(arg\)</span>) é definido por:</p>
<p><span class="math display">\[\left\{\begin{matrix}
h &lt;  h_{T_{min}}, &amp; arg = \pi  \left ( \frac{h+10}{10+h_{Tmin}} \right )\\ 
h_{T_{min}}\leq h &lt; h_{T_{max}}, &amp; arg = \pi  \left ( \frac{h-h_{T_{min}}}{14-h_{T_{min}}} \right )\\ 
h &gt; h_{T_{max}},  &amp; arg = \pi\left ( \frac{14-h}{10+h_{Tmin}} \right )
\end{matrix}\right. \]</span></p>
<p><strong>a</strong>. Aplique o método acima para estação 1 e 2 substituindo os valores de <span class="math inline">\(T_{max}\)</span>, <span class="math inline">\(T_{min}\)</span>, <span class="math inline">\(h_{T_{max}}\)</span>, <span class="math inline">\(h_{T_{max}}\)</span>, adequadamente.</p>
<p><strong>b</strong>. Calcule o RMSE nos dois casos. <span class="math inline">\(RMSE = \sqrt{\frac{1}{n}\sum_{i=1}^{n}\left (T_{calc}-T_{obs} \right )^{2}}\)</span></p>
<p><strong>c</strong>. Calcule a correlação (<span class="math inline">\(r\)</span>) nos dois casos. A barra representa a média aritmética. Confira seu resultado com a saída da função <code>cor(tar_obs, tar_calc)</code>.</p>
<p><span class="math display">\[r = \frac{\sum_{i=1}^{n} (T_{obs}-\bar{T}_{obs})(T_{calc}-\bar{T}_{calc}))}{\sqrt{\sum_{i = 1}^{n} (T_{obs}-\bar{T}_{obs})^{2}(T_{calc}-\bar{T}_{calc})^{2})}}\]</span></p>
<hr />
<ol start="11" style="list-style-type: decimal">
<li>Os dados abaixo são de precipitação horária de um evento severo ocorrido em 03/12/2012 em Santa Maria-RS.</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="center">hora</th>
<th align="center">prec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">9</td>
<td align="center">0.0</td>
</tr>
<tr class="even">
<td align="center">10</td>
<td align="center">0.0</td>
</tr>
<tr class="odd">
<td align="center">11</td>
<td align="center">0.0</td>
</tr>
<tr class="even">
<td align="center">12</td>
<td align="center">0.0</td>
</tr>
<tr class="odd">
<td align="center">13</td>
<td align="center">0.0</td>
</tr>
<tr class="even">
<td align="center">14</td>
<td align="center">0.0</td>
</tr>
<tr class="odd">
<td align="center">15</td>
<td align="center">0.0</td>
</tr>
<tr class="even">
<td align="center">16</td>
<td align="center">21.4</td>
</tr>
<tr class="odd">
<td align="center">17</td>
<td align="center">41.2</td>
</tr>
<tr class="even">
<td align="center">18</td>
<td align="center">2.6</td>
</tr>
<tr class="odd">
<td align="center">19</td>
<td align="center">1.0</td>
</tr>
<tr class="even">
<td align="center">20</td>
<td align="center">0.4</td>
</tr>
<tr class="odd">
<td align="center">21</td>
<td align="center">0.0</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li><p>Como seria o código para determinar a soma cumulativa da precipitação horária? Salve o resultado em um vetor chamado <code>prec_acum</code>. Interprete o resultado de <code>c(NA, diff(prec_acum))</code>.</p></li>
<li><p>Mostre o código para encontrar o horário de ocorrência da precipitação máxima?</p></li>
<li><p>Mostre o código para obter a hora de início e fim do evento de precipitação severa. Qual foi a duração do evento?</p></li>
<li><p>Qual foi a precipitação total do evento? Quanto da precipitação total do evento, em %, ocorreu até às 17 h?</p></li>
</ol>
<hr />
<ol start="12" style="list-style-type: decimal">
<li>Considere o vetor <code>x</code> definido pelos números descritos abaixo. Mostre como encontrar o primeiro número positivo localizado após o último número negativo. Por exemplo, seja o vetor <code>z</code> definido pelos valores (11, 10, 15, 2, 6, -15, -10, -22, -8, 5, 7, 2, 12, 8, 4, 1, 3, -3, -1, 30, 14). Os valores selecionados seriam 5 e 30.</li>
</ol>
<hr />
<ol start="13" style="list-style-type: decimal">
<li>Considerando o vetor <code>prec</code> com valores de precipitação diária indicado abaixo. Escreva o código para resolver as seguintes tarefas.</li>
</ol>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" title="1">prec &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb224-2" title="2">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.8</span>, <span class="dv">0</span>, <span class="fl">0.01</span>, <span class="fl">0.75</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb224-3" title="3">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.35</span>, <span class="fl">0.08</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.31</span>, <span class="dv">0</span>, <span class="fl">3.57</span>, <span class="fl">12.17</span>, <span class="dv">0</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb224-4" title="4">  <span class="dv">0</span>, <span class="fl">0.04</span>, <span class="fl">3.16</span>, <span class="dv">0</span>, <span class="fl">0.95</span>, <span class="fl">0.79</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">3.51</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.16</span>,</a>
<a class="sourceLine" id="cb224-5" title="5">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">8.16</span>, <span class="fl">0.54</span>, <span class="fl">4.39</span>, <span class="fl">1.24</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.43</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb224-6" title="6">  <span class="dv">0</span>, <span class="fl">7.18</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.26</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.28</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.09</span>, <span class="fl">0.38</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb224-7" title="7">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.51</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.67</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.15</span>, <span class="dv">0</span>, <span class="fl">0.82</span>,</a>
<a class="sourceLine" id="cb224-8" title="8">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.37</span>, <span class="dv">0</span>, <span class="fl">0.58</span>, <span class="fl">4.95</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">7.68</span>,</a>
<a class="sourceLine" id="cb224-9" title="9">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.37</span>, <span class="dv">0</span>, <span class="fl">1.56</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.34</span>, <span class="fl">0.48</span>, <span class="dv">0</span>, <span class="fl">4.21</span>, <span class="fl">2.28</span>, <span class="fl">4.3</span>,</a>
<a class="sourceLine" id="cb224-10" title="10">  <span class="dv">0</span>, <span class="fl">3.38</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">7.28</span>, <span class="dv">0</span>, <span class="fl">4.89</span>, <span class="fl">3.91</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.93</span>,</a>
<a class="sourceLine" id="cb224-11" title="11">  <span class="dv">0</span>, <span class="fl">2.49</span>, <span class="fl">0.77</span>, <span class="dv">0</span>, <span class="fl">2.9</span>, <span class="fl">3.53</span>, <span class="fl">0.83</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.94</span>, <span class="fl">0.59</span>, <span class="dv">0</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb224-12" title="12">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.04</span>, <span class="dv">0</span>, <span class="fl">0.65</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">6.23</span>, <span class="fl">0.09</span>, <span class="dv">0</span>, <span class="fl">0.66</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">4.42</span>,</a>
<a class="sourceLine" id="cb224-13" title="13">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.84</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.09</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.08</span>, <span class="dv">0</span>, <span class="fl">0.66</span>, <span class="dv">0</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb224-14" title="14">  <span class="dv">0</span>, <span class="fl">0.06</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">3.28</span>, <span class="dv">0</span>, <span class="fl">0.8</span>, <span class="fl">5.69</span>, <span class="fl">0.8</span>, <span class="dv">0</span></a>
<a class="sourceLine" id="cb224-15" title="15">)</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Quantos dias ocorreram no intervalo 0 &lt; prec &lt; 0.25?</p></li>
<li><p>Substitua os valores de chuva registrados no intervalo 0 &lt; prec &lt; 0.25 por 0.</p></li>
<li><p>Crie um vetor denominado <code>prec01</code> indicando o estado da precipitação (chuvoso = 1, seco = 0) baseado no limiar de 0.25 mm para detecção de chuva pelo pluviômetro.</p></li>
<li><p>Qual a probabilidade de chuva dessa série de precipitação diária?</p></li>
<li><p>Qual a probabilidade de chover dois dias consecutivos (<code>p11</code>)? Calcule a probabilidade de chover em qualquer um de dois dias consecutivos (<code>p01 + p10</code>)?</p></li>
<li><p>Determine a duração de cada evento chuvoso (número de dias consecutivos).</p></li>
</ol>
<p>O resultado esperado é um vetor que identifique o evento e sua duração.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1">duracao &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">evento1 =</span> <span class="dv">1</span>, <span class="dt">evento2 =</span> <span class="dv">1</span>, <span class="dt">evento3 =</span> <span class="dv">1</span>, <span class="dt">evento4 =</span> <span class="dv">1</span>, <span class="dt">evento5 =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb225-2" title="2"><span class="dt">evento6 =</span> <span class="dv">1</span>, <span class="dt">evento7 =</span> <span class="dv">2</span>, <span class="dt">evento8 =</span> <span class="dv">1</span>, <span class="dt">evento9 =</span> <span class="dv">4</span>, <span class="dt">evento10 =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb225-3" title="3"><span class="dt">evento11 =</span> <span class="dv">1</span>, <span class="dt">evento12 =</span> <span class="dv">1</span>, <span class="dt">evento13 =</span> <span class="dv">1</span>, <span class="dt">evento14 =</span> <span class="dv">1</span>, <span class="dt">evento15 =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb225-4" title="4"><span class="dt">evento16 =</span> <span class="dv">1</span>, <span class="dt">evento17 =</span> <span class="dv">1</span>, <span class="dt">evento18 =</span> <span class="dv">1</span>, <span class="dt">evento19 =</span> <span class="dv">2</span>, <span class="dt">evento20 =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb225-5" title="5"><span class="dt">evento21 =</span> <span class="dv">1</span>, <span class="dt">evento22 =</span> <span class="dv">1</span>, <span class="dt">evento23 =</span> <span class="dv">2</span>, <span class="dt">evento24 =</span> <span class="dv">3</span>, <span class="dt">evento25 =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb225-6" title="6"><span class="dt">evento26 =</span> <span class="dv">1</span>, <span class="dt">evento27 =</span> <span class="dv">2</span>, <span class="dt">evento28 =</span> <span class="dv">1</span>, <span class="dt">evento29 =</span> <span class="dv">2</span>, <span class="dt">evento30 =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb225-7" title="7"><span class="dt">evento31 =</span> <span class="dv">2</span>, <span class="dt">evento32 =</span> <span class="dv">1</span>, <span class="dt">evento33 =</span> <span class="dv">1</span>, <span class="dt">evento34 =</span> <span class="dv">1</span>, <span class="dt">evento35 =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb225-8" title="8"><span class="dt">evento36 =</span> <span class="dv">1</span>, <span class="dt">evento37 =</span> <span class="dv">1</span>, <span class="dt">evento38 =</span> <span class="dv">1</span>, <span class="dt">evento39 =</span> <span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" title="1">duracao</a>
<a class="sourceLine" id="cb226-2" title="2"><span class="co">#&gt;  evento1  evento2  evento3  evento4  evento5  evento6  evento7  evento8 </span></a>
<a class="sourceLine" id="cb226-3" title="3"><span class="co">#&gt;        1        1        1        1        2        1        2        1 </span></a>
<a class="sourceLine" id="cb226-4" title="4"><span class="co">#&gt;  evento9 evento10 evento11 evento12 evento13 evento14 evento15 evento16 </span></a>
<a class="sourceLine" id="cb226-5" title="5"><span class="co">#&gt;        4        1        1        1        1        1        1        1 </span></a>
<a class="sourceLine" id="cb226-6" title="6"><span class="co">#&gt; evento17 evento18 evento19 evento20 evento21 evento22 evento23 evento24 </span></a>
<a class="sourceLine" id="cb226-7" title="7"><span class="co">#&gt;        1        1        2        1        1        1        2        3 </span></a>
<a class="sourceLine" id="cb226-8" title="8"><span class="co">#&gt; evento25 evento26 evento27 evento28 evento29 evento30 evento31 evento32 </span></a>
<a class="sourceLine" id="cb226-9" title="9"><span class="co">#&gt;        1        1        2        1        2        3        2        1 </span></a>
<a class="sourceLine" id="cb226-10" title="10"><span class="co">#&gt; evento33 evento34 evento35 evento36 evento37 evento38 evento39 </span></a>
<a class="sourceLine" id="cb226-11" title="11"><span class="co">#&gt;        1        1        1        1        1        1        3</span></a></code></pre></div>
<hr />
<ol start="14" style="list-style-type: decimal">
<li>Dado o vetor <code>dados</code> mostrado abaixo.</li>
</ol>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1">dados &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb227-2" title="2">  <span class="ot">NA</span>, <span class="ot">NA</span>, 27L, 7L, 4L, 0L, 26L, 15L, 25L, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, 6L,</a>
<a class="sourceLine" id="cb227-3" title="3">  29L, 18L, 17L, 23L, 20L, 1L, 30L, 13L, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb227-4" title="4">  <span class="ot">NA</span>, 19L</a>
<a class="sourceLine" id="cb227-5" title="5">)</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Como você pode codificar a obtenção de um vetor com zeros nos valores válidos e com números sequenciais dentro das falhas?</p></li>
<li><p>Como a partir do vetor resultante em <em>11.b</em> obter um vetor cujo os valores
dentro das falhas indique a ordem de ocorrência da falha.</p></li>
<li><p>Qual o tamanho de cada falha.</p></li>
<li><p>Determine o tamanho da maior falha?</p></li>
</ol>
<hr />
<ol start="15" style="list-style-type: decimal">
<li>Para os valores de velocidade (<span class="math inline">\(V_h\)</span>) e a direção do vento (<span class="math inline">\(\theta\)</span>) (na convenção meteorológica):</li>
</ol>
<p><span class="math inline">\(V_h\)</span> = (10, 10, 10, 10, 14.142, 14.142, 14.142, 14.142, 0)</p>
<p><span class="math inline">\(\theta\)</span> = (270, 180, 360, 90, 225, 315, 135, 45, 0)</p>
<ol style="list-style-type: lower-alpha">
<li>Determine as componentes zonal e meridional do vento.</li>
</ol>
<p><span class="math display">\[u = -V_{h} \cdot sin(\theta_{rad})\]</span>
<span class="math display">\[v = -V_{h} \cdot cos(\theta_{rad})\]</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Faça os cálculos necessários para reconstruir <span class="math inline">\(V_h\)</span> e <span class="math inline">\(\theta\)</span>, a partir de <span class="math inline">\(u\)</span> e <span class="math inline">\(v\)</span> determinados no item <strong>a</strong>. Por convenção, a direção do vento <span class="math inline">\(\theta\)</span> em condições calmas (<span class="math inline">\(V_h\)</span> &lt; 0.5 m s<sup>-1</sup>) é assumida como 0°.</li>
</ol>
<p><span class="math display">\[V_{h} = \sqrt{(u^2 + v^2)}\]</span>
<span class="math display">\[\theta_{mat} = {\rm atan2}(-u, -v)\cdot\frac{180}{\pi}\]</span>
<span class="math display">\[
\theta = \left\{\begin{matrix}
\theta_{mat} + 360 &amp; se &amp; \theta_{mat} &lt; 0 \\ 
0 &amp; se &amp; u = 0,\:  v = 0 \: \:  ou \: \:  V_{h} &lt; 0.5\\
\end{matrix}\right.
\]</span></p>
<p>A tabela abaixo apresenta o resultado esperado para as variáveis derivadas.</p>
<table>
<thead>
<tr class="header">
<th align="right">u</th>
<th align="right">v</th>
<th align="right">ws</th>
<th align="right">wd</th>
<th align="right">wd_uv</th>
<th align="left">dir</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">0</td>
<td align="right">10.000</td>
<td align="right">270</td>
<td align="right">270</td>
<td align="left">Oeste</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">10</td>
<td align="right">10.000</td>
<td align="right">180</td>
<td align="right">180</td>
<td align="left">Sul</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">-10</td>
<td align="right">10.000</td>
<td align="right">360</td>
<td align="right">360</td>
<td align="left">Norte</td>
</tr>
<tr class="even">
<td align="right">-10</td>
<td align="right">0</td>
<td align="right">10.000</td>
<td align="right">90</td>
<td align="right">90</td>
<td align="left">Leste</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">10</td>
<td align="right">14.142</td>
<td align="right">225</td>
<td align="right">225</td>
<td align="left">Sudoeste</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">-10</td>
<td align="right">14.142</td>
<td align="right">315</td>
<td align="right">315</td>
<td align="left">Noroeste</td>
</tr>
<tr class="odd">
<td align="right">-10</td>
<td align="right">10</td>
<td align="right">14.142</td>
<td align="right">135</td>
<td align="right">135</td>
<td align="left">Sudeste</td>
</tr>
<tr class="even">
<td align="right">-10</td>
<td align="right">-10</td>
<td align="right">14.142</td>
<td align="right">45</td>
<td align="right">45</td>
<td align="left">Nordeste</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Calmo</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Dica: ver figura abaixo.</p>
</blockquote>
<p><img src="images/wind_components.png" /></p>
<hr />
<ol start="16" style="list-style-type: decimal">
<li><p>Para as séries de <code>prec_obs</code> e <code>prec_sim</code> calcule:</p>
<ol style="list-style-type: lower-alpha">
<li><p>A proporção corretamente prevista <span class="math inline">\(PC = \frac{wc+dc}{n}\)</span></p></li>
<li><p>O índice de sucesso crítico <span class="math inline">\(CSI=\frac{wc}{wc+wi+di}\)</span>.</p></li>
</ol></li>
</ol>
<p>Onde <span class="math inline">\(wc\)</span> e <span class="math inline">\(dc\)</span> são as previsões corretas de dias úmidos (<span class="math inline">\(prec &gt; 0.25\)</span> mm dia<sup>-1</sup>) e secos respectivamente, <span class="math inline">\(wi\)</span> e <span class="math inline">\(di\)</span> são as previsões incorretas de dias úmidos e secos respectivamente. <span class="math inline">\(n\)</span> é o n° total de previsões.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" title="1">prec_obs &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb228-2" title="2">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="fl">0.2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb228-3" title="3">  <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.25</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb228-4" title="4">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb228-5" title="5">  <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">5</span></a>
<a class="sourceLine" id="cb228-6" title="6">)</a>
<a class="sourceLine" id="cb228-7" title="7">prec_sim &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb228-8" title="8">  <span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb228-9" title="9">  <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb228-10" title="10">  <span class="fl">0.25</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb228-11" title="11">  <span class="fl">0.25</span>, <span class="fl">0.2</span>, <span class="dv">0</span>, <span class="fl">0.2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span></a>
<a class="sourceLine" id="cb228-12" title="12">)</a></code></pre></div>
<hr />
<ol start="17" style="list-style-type: decimal">
<li>Escreva o código para calcular as estatísticas abaixo, entre os vetores de valores observados (<code>obs</code>) e previstos (<code>prev</code>) por um dado modelo atmosférico, em um dado local.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>O Viés relativo (%)<a href="#fn27" class="footnote-ref" id="fnref27"><sup>27</sup></a>.</li>
</ol>
<p><span class="math display">\[PBIAS = 100\frac{\sum_{i=1}^{n}(Prev_{i}-Obs_{i})}{\sum_{i=1}^{n}(Obs_{i})}\]</span>.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Coeficente de eficiência de Nash-Sutcliffe (NSE)<a href="#fn28" class="footnote-ref" id="fnref28"><sup>28</sup></a>.</li>
</ol>
<p><span class="math display">\[NSE = 1 - \frac{\sum_{i=1}^{n} (Obs_{i}-Sim_{i})^{2}}{\sum_{i = 1}^{n} (Obs_{i}-\bar{Obs}_{i})^{2}}\]</span></p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" title="1">v_obs &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb229-2" title="2">  <span class="fl">-0.49</span>, <span class="fl">0.27</span>, <span class="fl">-0.48</span>, <span class="fl">0.8</span>, <span class="dv">-1</span>, <span class="fl">0.1</span>, <span class="fl">-1.16</span>,</a>
<a class="sourceLine" id="cb229-3" title="3">  <span class="fl">0.58</span>, <span class="fl">-1.6</span>, <span class="fl">-0.31</span>, <span class="fl">0.45</span>, <span class="fl">-0.98</span>, <span class="fl">0.19</span>, <span class="fl">0.73</span>,</a>
<a class="sourceLine" id="cb229-4" title="4">  <span class="fl">-0.49</span>, <span class="fl">-0.04</span>, <span class="fl">-0.11</span>, <span class="fl">0.46</span>, <span class="fl">2.02</span>, <span class="fl">-1.05</span></a>
<a class="sourceLine" id="cb229-5" title="5">)</a>
<a class="sourceLine" id="cb229-6" title="6">v_prev &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb229-7" title="7">  <span class="ot">NA</span>, <span class="fl">-0.49</span>, <span class="fl">0.27</span>, <span class="fl">-0.48</span>, <span class="fl">0.8</span>, <span class="dv">-1</span>, <span class="fl">0.1</span>, <span class="fl">-1.16</span>,</a>
<a class="sourceLine" id="cb229-8" title="8">  <span class="fl">0.58</span>, <span class="fl">-1.6</span>, <span class="fl">-0.31</span>, <span class="fl">0.45</span>, <span class="fl">-0.98</span>, <span class="fl">0.19</span>, <span class="fl">0.73</span>,</a>
<a class="sourceLine" id="cb229-9" title="9">  <span class="fl">-0.49</span>, <span class="fl">-0.04</span>, <span class="fl">-0.11</span>, <span class="fl">0.46</span>, <span class="fl">2.02</span></a>
<a class="sourceLine" id="cb229-10" title="10">)</a></code></pre></div>
<!--chapter:end:07-manip-vetores.Rmd-->
</div>
</div>
<div id="estrutura-dados" class="section level1">
<h1><span class="header-section-number">8</span> Estrutura de dados</h1>
<p>Existem diferentes formas de armazenar dados no <img src="images/logo_r.png" width="20">. Algumas vezes os dados precisam ser armazenados de forma mais complexa do que por exemplo vetores.</p>
<p>O <img src="images/logo_r.png" width="20"> possui uma variedade de estruturas (Figura @ref(fig:fig-estrut-dados)). Dentre elas as fundamentais, ainda não vistas, são:</p>
<ul>
<li><p><em>matrix</em> (matriz)</p></li>
<li><p><em>array</em> e <em>vector</em> (vetor)</p></li>
<li><p><em>list</em> (lista)</p></li>
<li><p><em>dataframe</em> (tabela de dados)</p></li>
</ul>
<div class="figure">
<img src="images/dataStructuresR.png" alt="Principais estruturas de dados no R." width="100%" />
<p class="caption">
(#fig:fig-estrut-dados)Principais estruturas de dados no R.
</p>
</div>
<div id="matriz" class="section level2">
<h2><span class="header-section-number">8.1</span> Matriz</h2>
<p>Vetores são dados unidimensionais. Vetores multidimensionais são denominados arranjos (tradução do termo em inglês <em>array</em>). As matrizes são um caso especial de <em>array</em> em que o número de dimensões é igual a 2, uma dimensão corresponde as linhas e a outra as colunas. Os dados armazenados em uma matriz só podem ser de um tipo de dado (ou <code>numeric</code>, ou <code>character</code>, por exemplo).</p>
<div id="criação-de-matrizes" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Criação de matrizes</h3>
<div id="função-matrix" class="section level4">
<h4><span class="header-section-number">8.1.1.1</span> Função <code>matrix()</code></h4>
<p>Uma forma mais clara de se criar uma matriz é usando a função <code>matrix()</code>.</p>
<p>Ao aplicarmos a função <code>matrix()</code> a um vetor sem especificar nenhum argumento ela produz uma matriz de uma coluna.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1">vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">-2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">-5</span>)</a>
<a class="sourceLine" id="cb230-2" title="2"><span class="co"># atribuindo novas dimensões ao vetor</span></a>
<a class="sourceLine" id="cb230-3" title="3">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(vetor) <span class="co"># matriz de uma coluna</span></a>
<a class="sourceLine" id="cb230-4" title="4">m</a>
<a class="sourceLine" id="cb230-5" title="5"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb230-6" title="6"><span class="co">#&gt; [1,]    0</span></a>
<a class="sourceLine" id="cb230-7" title="7"><span class="co">#&gt; [2,]    1</span></a>
<a class="sourceLine" id="cb230-8" title="8"><span class="co">#&gt; [3,]   -1</span></a>
<a class="sourceLine" id="cb230-9" title="9"><span class="co">#&gt; [4,]   -2</span></a>
<a class="sourceLine" id="cb230-10" title="10"><span class="co">#&gt; [5,]    3</span></a>
<a class="sourceLine" id="cb230-11" title="11"><span class="co">#&gt; [6,]    5</span></a>
<a class="sourceLine" id="cb230-12" title="12"><span class="co">#&gt; [7,]   -5</span></a></code></pre></div>
<p>Se desejamos construir uma matriz com 3 linhas e 4 colunas a partir do vetor <code>vetor</code> podemos fazer da seguinte forma:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" title="1"><span class="co"># criando a matriz gerada com dim</span></a>
<a class="sourceLine" id="cb231-2" title="2">mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(vetor, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb231-3" title="3"><span class="co">#&gt; Warning in matrix(vetor, nrow = 3, ncol = 4): comprimento dos dados [7] não é um</span></a>
<a class="sourceLine" id="cb231-4" title="4"><span class="co">#&gt; submúltiplo ou múltiplo do número de linhas [3]</span></a>
<a class="sourceLine" id="cb231-5" title="5">mat</a>
<a class="sourceLine" id="cb231-6" title="6"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb231-7" title="7"><span class="co">#&gt; [1,]    0   -2   -5   -1</span></a>
<a class="sourceLine" id="cb231-8" title="8"><span class="co">#&gt; [2,]    1    3    0   -2</span></a>
<a class="sourceLine" id="cb231-9" title="9"><span class="co">#&gt; [3,]   -1    5    1    3</span></a>
<a class="sourceLine" id="cb231-10" title="10"><span class="co"># não há necessidade de especificar ambos ncol e nrow</span></a>
<a class="sourceLine" id="cb231-11" title="11">mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(vetor, <span class="dt">nrow =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb231-12" title="12"><span class="co">#&gt; Warning in matrix(vetor, nrow = 3): comprimento dos dados [7] não é um</span></a>
<a class="sourceLine" id="cb231-13" title="13"><span class="co">#&gt; submúltiplo ou múltiplo do número de linhas [3]</span></a>
<a class="sourceLine" id="cb231-14" title="14">mat</a>
<a class="sourceLine" id="cb231-15" title="15"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb231-16" title="16"><span class="co">#&gt; [1,]    0   -2   -5</span></a>
<a class="sourceLine" id="cb231-17" title="17"><span class="co">#&gt; [2,]    1    3    0</span></a>
<a class="sourceLine" id="cb231-18" title="18"><span class="co">#&gt; [3,]   -1    5    1</span></a></code></pre></div>
<p>No exemplo a seguir os dados do vetor aparecem distribuídos ao longo das linhas e não das colunas como no caso acima. Nós definimos isso com o argumento <strong><code>byrow = TRUE</code></strong> da função <code>matrix()</code>:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1">mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(vetor, <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb232-2" title="2"><span class="co">#&gt; Warning in matrix(vetor, ncol = 4, byrow = TRUE): comprimento dos dados [7] não</span></a>
<a class="sourceLine" id="cb232-3" title="3"><span class="co">#&gt; é um submúltiplo ou múltiplo do número de linhas [2]</span></a>
<a class="sourceLine" id="cb232-4" title="4">mat</a>
<a class="sourceLine" id="cb232-5" title="5"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb232-6" title="6"><span class="co">#&gt; [1,]    0    1   -1   -2</span></a>
<a class="sourceLine" id="cb232-7" title="7"><span class="co">#&gt; [2,]    3    5   -5    0</span></a></code></pre></div>
</div>
</div>
<div id="nomes-lin-col-mat" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Nomes das linhas e colunas de uma matriz</h3>
<p>Nas matrizes, assim como nos vetores, também é possível dar nomes aos elementos para tornar a leitura da informação mais clara.
Vamos usar os vetores de temperatura mensal dos anos de <code>1990:1992</code>para construir uma matriz com os meses ao longo das colunas e os anos ao longo das linhas.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" title="1"><span class="co"># temperatura do ar média mensal do ano de 1990</span></a>
<a class="sourceLine" id="cb233-2" title="2">temp90 &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb233-3" title="3">  <span class="fl">25.00</span>, <span class="fl">23.20</span>, <span class="fl">22.50</span>, <span class="fl">21.00</span>, <span class="fl">19.00</span>, <span class="fl">17.60</span>,</a>
<a class="sourceLine" id="cb233-4" title="4">  <span class="fl">18.00</span>, <span class="fl">19.70</span>, <span class="fl">21.30</span>, <span class="fl">22.00</span>, <span class="fl">24.00</span>, <span class="fl">26.80</span></a>
<a class="sourceLine" id="cb233-5" title="5">)</a>
<a class="sourceLine" id="cb233-6" title="6"><span class="co"># temperatura do ar média mensal do ano de 1991</span></a>
<a class="sourceLine" id="cb233-7" title="7">temp91 &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb233-8" title="8">  <span class="fl">24.89</span>, <span class="fl">24.07</span>, <span class="fl">23.56</span>, <span class="fl">23.11</span>, <span class="fl">18.29</span>, <span class="fl">18.22</span>,</a>
<a class="sourceLine" id="cb233-9" title="9">  <span class="fl">16.72</span>, <span class="fl">19.37</span>, <span class="fl">20.08</span>, <span class="fl">21.45</span>, <span class="fl">26.61</span>, <span class="fl">25.99</span></a>
<a class="sourceLine" id="cb233-10" title="10">)</a>
<a class="sourceLine" id="cb233-11" title="11"><span class="co"># temperatura do ar média mensal do ano de 1992</span></a>
<a class="sourceLine" id="cb233-12" title="12">temp92 &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb233-13" title="13">  <span class="fl">23.2</span>, <span class="fl">26.61</span>, <span class="dv">18</span>, <span class="fl">23.11</span>, <span class="fl">26.8</span>, <span class="fl">21.3</span>, <span class="fl">18.22</span>,</a>
<a class="sourceLine" id="cb233-14" title="14">  <span class="fl">21.45</span>, <span class="fl">19.7</span>, <span class="fl">22.5</span>, <span class="fl">24.07</span>, <span class="fl">20.08</span></a>
<a class="sourceLine" id="cb233-15" title="15">)</a>
<a class="sourceLine" id="cb233-16" title="16"><span class="co"># vetor com as temperaturas dos 3 anos</span></a>
<a class="sourceLine" id="cb233-17" title="17">vtemp &lt;-<span class="st"> </span><span class="kw">c</span>(temp90, temp91, temp92)</a>
<a class="sourceLine" id="cb233-18" title="18">vtemp</a>
<a class="sourceLine" id="cb233-19" title="19"><span class="co">#&gt;  [1] 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb233-20" title="20"><span class="co">#&gt; [13] 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb233-21" title="21"><span class="co">#&gt; [25] 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb233-22" title="22"><span class="co"># arranjar matrix com meses ao longo das colunas e anos ao longo das linhas</span></a>
<a class="sourceLine" id="cb233-23" title="23">temp_mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(vtemp, <span class="dt">ncol =</span> <span class="dv">12</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb233-24" title="24">temp_mat</a>
<a class="sourceLine" id="cb233-25" title="25"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb233-26" title="26"><span class="co">#&gt; [1,] 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb233-27" title="27"><span class="co">#&gt; [2,] 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb233-28" title="28"><span class="co">#&gt; [3,] 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb233-29" title="29"><span class="co"># cópia da matriz temp_mat (sem nomes)</span></a>
<a class="sourceLine" id="cb233-30" title="30">temp_matO &lt;-<span class="st"> </span>temp_mat</a></code></pre></div>
<p>Atribuindo nomes às linhas (<code>rownames()</code>) e colunas (<code>colnames()</code>) da matriz criada dos vetores de temperatura mensal (<code>temp_mat</code>).</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1"><span class="co"># atribuindo nomes as colunas e linhas da temp_mat</span></a>
<a class="sourceLine" id="cb234-2" title="2"><span class="kw">rownames</span>(temp_mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ano1990&quot;</span>, <span class="st">&quot;ano1991&quot;</span>, <span class="st">&quot;ano1992&quot;</span>)</a>
<a class="sourceLine" id="cb234-3" title="3"><span class="kw">colnames</span>(temp_mat) &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb234-4" title="4">  <span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Fev&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Abr&quot;</span>, <span class="st">&quot;Mai&quot;</span>,</a>
<a class="sourceLine" id="cb234-5" title="5">  <span class="st">&quot;Jun&quot;</span>, <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Ago&quot;</span>, <span class="st">&quot;Set&quot;</span>, <span class="st">&quot;Out&quot;</span>,</a>
<a class="sourceLine" id="cb234-6" title="6">  <span class="st">&quot;Nov&quot;</span>, <span class="st">&quot;Dez&quot;</span></a>
<a class="sourceLine" id="cb234-7" title="7">)</a>
<a class="sourceLine" id="cb234-8" title="8">temp_mat</a>
<a class="sourceLine" id="cb234-9" title="9"><span class="co">#&gt;           Jan   Fev   Mar   Abr   Mai   Jun   Jul   Ago   Set   Out   Nov   Dez</span></a>
<a class="sourceLine" id="cb234-10" title="10"><span class="co">#&gt; ano1990 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb234-11" title="11"><span class="co">#&gt; ano1991 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb234-12" title="12"><span class="co">#&gt; ano1992 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a></code></pre></div>
</div>
<div id="indexação-de-matrizes" class="section level3">
<h3><span class="header-section-number">8.1.3</span> Indexação de matrizes</h3>
<p>Como acessamos o valor de temperatura de maio de 1991 na matriz <code>temp_mat</code>?</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" title="1">temp_mat <span class="co"># matriz de temperaturas com nomes</span></a>
<a class="sourceLine" id="cb235-2" title="2"><span class="co">#&gt;           Jan   Fev   Mar   Abr   Mai   Jun   Jul   Ago   Set   Out   Nov   Dez</span></a>
<a class="sourceLine" id="cb235-3" title="3"><span class="co">#&gt; ano1990 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb235-4" title="4"><span class="co">#&gt; ano1991 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb235-5" title="5"><span class="co">#&gt; ano1992 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb235-6" title="6">temp_matO <span class="co"># matriz de temperaturas sem nomes</span></a>
<a class="sourceLine" id="cb235-7" title="7"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb235-8" title="8"><span class="co">#&gt; [1,] 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb235-9" title="9"><span class="co">#&gt; [2,] 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb235-10" title="10"><span class="co">#&gt; [3,] 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb235-11" title="11"><span class="co"># qual a linha do ano de 1991</span></a>
<a class="sourceLine" id="cb235-12" title="12">linha &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb235-13" title="13"><span class="co"># qual a coluna do mês de maio</span></a>
<a class="sourceLine" id="cb235-14" title="14">coluna &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb235-15" title="15"><span class="co"># extraindo</span></a>
<a class="sourceLine" id="cb235-16" title="16">temp_mat[linha, coluna]</a>
<a class="sourceLine" id="cb235-17" title="17"><span class="co">#&gt; [1] 18.29</span></a>
<a class="sourceLine" id="cb235-18" title="18"><span class="co"># ou usando os nomes</span></a>
<a class="sourceLine" id="cb235-19" title="19">temp_mat[<span class="st">&quot;ano1991&quot;</span>, <span class="st">&quot;Mai&quot;</span>]</a>
<a class="sourceLine" id="cb235-20" title="20"><span class="co">#&gt; [1] 18.29</span></a></code></pre></div>
<p>Com o operador <code>[</code> podemos usar todos os esquemas de indexação vistos em vetores.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1"><span class="co"># temperaturas de todos janeiros</span></a>
<a class="sourceLine" id="cb236-2" title="2">temp_mat[, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb236-3" title="3"><span class="co">#&gt; ano1990 ano1991 ano1992 </span></a>
<a class="sourceLine" id="cb236-4" title="4"><span class="co">#&gt;   25.00   24.89   23.20</span></a>
<a class="sourceLine" id="cb236-5" title="5">temp_mat[, <span class="st">&quot;Jan&quot;</span>]</a>
<a class="sourceLine" id="cb236-6" title="6"><span class="co">#&gt; ano1990 ano1991 ano1992 </span></a>
<a class="sourceLine" id="cb236-7" title="7"><span class="co">#&gt;   25.00   24.89   23.20</span></a>
<a class="sourceLine" id="cb236-8" title="8"><span class="co"># só as temperaturas de 1990 e 1993</span></a>
<a class="sourceLine" id="cb236-9" title="9">temp_mat[ <span class="dv">-2</span>, ]</a>
<a class="sourceLine" id="cb236-10" title="10"><span class="co">#&gt;          Jan   Fev  Mar   Abr  Mai  Jun   Jul   Ago  Set  Out   Nov   Dez</span></a>
<a class="sourceLine" id="cb236-11" title="11"><span class="co">#&gt; ano1990 25.0 23.20 22.5 21.00 19.0 17.6 18.00 19.70 21.3 22.0 24.00 26.80</span></a>
<a class="sourceLine" id="cb236-12" title="12"><span class="co">#&gt; ano1992 23.2 26.61 18.0 23.11 26.8 21.3 18.22 21.45 19.7 22.5 24.07 20.08</span></a>
<a class="sourceLine" id="cb236-13" title="13"><span class="co"># só as temperaturas dos verões</span></a>
<a class="sourceLine" id="cb236-14" title="14">temp_mat[, <span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">2</span>)]</a>
<a class="sourceLine" id="cb236-15" title="15"><span class="co">#&gt;           Dez   Jan   Fev</span></a>
<a class="sourceLine" id="cb236-16" title="16"><span class="co">#&gt; ano1990 26.80 25.00 23.20</span></a>
<a class="sourceLine" id="cb236-17" title="17"><span class="co">#&gt; ano1991 25.99 24.89 24.07</span></a>
<a class="sourceLine" id="cb236-18" title="18"><span class="co">#&gt; ano1992 20.08 23.20 26.61</span></a>
<a class="sourceLine" id="cb236-19" title="19"><span class="co"># invertendo ordem das colunas</span></a>
<a class="sourceLine" id="cb236-20" title="20">temp_mat[, <span class="kw">ncol</span>(temp_mat)<span class="op">:</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb236-21" title="21"><span class="co">#&gt;           Dez   Nov   Out   Set   Ago   Jul   Jun   Mai   Abr   Mar   Fev   Jan</span></a>
<a class="sourceLine" id="cb236-22" title="22"><span class="co">#&gt; ano1990 26.80 24.00 22.00 21.30 19.70 18.00 17.60 19.00 21.00 22.50 23.20 25.00</span></a>
<a class="sourceLine" id="cb236-23" title="23"><span class="co">#&gt; ano1991 25.99 26.61 21.45 20.08 19.37 16.72 18.22 18.29 23.11 23.56 24.07 24.89</span></a>
<a class="sourceLine" id="cb236-24" title="24"><span class="co">#&gt; ano1992 20.08 24.07 22.50 19.70 21.45 18.22 21.30 26.80 23.11 18.00 26.61 23.20</span></a>
<a class="sourceLine" id="cb236-25" title="25"><span class="co"># invertendo ordem das colunas e das linhas</span></a>
<a class="sourceLine" id="cb236-26" title="26">temp_mat[ <span class="dv">3</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">12</span><span class="op">:</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb236-27" title="27"><span class="co">#&gt;           Dez   Nov   Out   Set   Ago   Jul   Jun   Mai   Abr   Mar   Fev   Jan</span></a>
<a class="sourceLine" id="cb236-28" title="28"><span class="co">#&gt; ano1992 20.08 24.07 22.50 19.70 21.45 18.22 21.30 26.80 23.11 18.00 26.61 23.20</span></a>
<a class="sourceLine" id="cb236-29" title="29"><span class="co">#&gt; ano1991 25.99 26.61 21.45 20.08 19.37 16.72 18.22 18.29 23.11 23.56 24.07 24.89</span></a>
<a class="sourceLine" id="cb236-30" title="30"><span class="co">#&gt; ano1990 26.80 24.00 22.00 21.30 19.70 18.00 17.60 19.00 21.00 22.50 23.20 25.00</span></a>
<a class="sourceLine" id="cb236-31" title="31"><span class="co"># invertendo ordem das colunas e das linhas</span></a>
<a class="sourceLine" id="cb236-32" title="32">temp_mat[ <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">12</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">8</span>)]</a>
<a class="sourceLine" id="cb236-33" title="33"><span class="co">#&gt;           Jun   Mai   Abr   Mar   Fev   Jan   Dez   Out   Set   Ago</span></a>
<a class="sourceLine" id="cb236-34" title="34"><span class="co">#&gt; ano1991 18.22 18.29 23.11 23.56 24.07 24.89 25.99 21.45 20.08 19.37</span></a>
<a class="sourceLine" id="cb236-35" title="35"><span class="co">#&gt; ano1990 17.60 19.00 21.00 22.50 23.20 25.00 26.80 22.00 21.30 19.70</span></a>
<a class="sourceLine" id="cb236-36" title="36"><span class="co">#&gt; ano1992 21.30 26.80 23.11 18.00 26.61 23.20 20.08 22.50 19.70 21.45</span></a>
<a class="sourceLine" id="cb236-37" title="37"><span class="co"># só as temperaturas dos invernos</span></a>
<a class="sourceLine" id="cb236-38" title="38">temp_mat[, <span class="kw">colnames</span>(temp_mat) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Jun&quot;</span>, <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Ago&quot;</span>) ]</a>
<a class="sourceLine" id="cb236-39" title="39"><span class="co">#&gt;           Jun   Jul   Ago</span></a>
<a class="sourceLine" id="cb236-40" title="40"><span class="co">#&gt; ano1990 17.60 18.00 19.70</span></a>
<a class="sourceLine" id="cb236-41" title="41"><span class="co">#&gt; ano1991 18.22 16.72 19.37</span></a>
<a class="sourceLine" id="cb236-42" title="42"><span class="co">#&gt; ano1992 21.30 18.22 21.45</span></a>
<a class="sourceLine" id="cb236-43" title="43"><span class="co"># exceto as temperaturas dos invernos</span></a>
<a class="sourceLine" id="cb236-44" title="44">temp_mat[, <span class="op">-</span><span class="kw">which</span>(<span class="kw">colnames</span>(temp_mat) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Jun&quot;</span>, <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Ago&quot;</span>)) ]</a>
<a class="sourceLine" id="cb236-45" title="45"><span class="co">#&gt;           Jan   Fev   Mar   Abr   Mai   Set   Out   Nov   Dez</span></a>
<a class="sourceLine" id="cb236-46" title="46"><span class="co">#&gt; ano1990 25.00 23.20 22.50 21.00 19.00 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb236-47" title="47"><span class="co">#&gt; ano1991 24.89 24.07 23.56 23.11 18.29 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb236-48" title="48"><span class="co">#&gt; ano1992 23.20 26.61 18.00 23.11 26.80 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb236-49" title="49"><span class="co"># seleção de colunas intercaladas da matriz: mês sim, mês nao</span></a>
<a class="sourceLine" id="cb236-50" title="50">temp_mat[, <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)]</a>
<a class="sourceLine" id="cb236-51" title="51"><span class="co">#&gt;           Jan   Mar   Mai   Jul   Set   Nov</span></a>
<a class="sourceLine" id="cb236-52" title="52"><span class="co">#&gt; ano1990 25.00 22.50 19.00 18.00 21.30 24.00</span></a>
<a class="sourceLine" id="cb236-53" title="53"><span class="co">#&gt; ano1991 24.89 23.56 18.29 16.72 20.08 26.61</span></a>
<a class="sourceLine" id="cb236-54" title="54"><span class="co">#&gt; ano1992 23.20 18.00 26.80 18.22 19.70 24.07</span></a>
<a class="sourceLine" id="cb236-55" title="55"><span class="co"># 2 meses sim, 1 mes não</span></a>
<a class="sourceLine" id="cb236-56" title="56">temp_mat[, <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)]</a>
<a class="sourceLine" id="cb236-57" title="57"><span class="co">#&gt;           Jan   Fev   Abr   Mai   Jul   Ago   Out   Nov</span></a>
<a class="sourceLine" id="cb236-58" title="58"><span class="co">#&gt; ano1990 25.00 23.20 21.00 19.00 18.00 19.70 22.00 24.00</span></a>
<a class="sourceLine" id="cb236-59" title="59"><span class="co">#&gt; ano1991 24.89 24.07 23.11 18.29 16.72 19.37 21.45 26.61</span></a>
<a class="sourceLine" id="cb236-60" title="60"><span class="co">#&gt; ano1992 23.20 26.61 23.11 26.80 18.22 21.45 22.50 24.07</span></a></code></pre></div>
<p>Podemos fazer uso do operador <code>[</code> de forma aninhada:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" title="1">temp_mat</a>
<a class="sourceLine" id="cb237-2" title="2"><span class="co">#&gt;           Jan   Fev   Mar   Abr   Mai   Jun   Jul   Ago   Set   Out   Nov   Dez</span></a>
<a class="sourceLine" id="cb237-3" title="3"><span class="co">#&gt; ano1990 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb237-4" title="4"><span class="co">#&gt; ano1991 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb237-5" title="5"><span class="co">#&gt; ano1992 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb237-6" title="6">temp_mat[, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb237-7" title="7"><span class="co">#&gt;           Jan   Fev   Mar   Abr   Mai   Jun</span></a>
<a class="sourceLine" id="cb237-8" title="8"><span class="co">#&gt; ano1990 25.00 23.20 22.50 21.00 19.00 17.60</span></a>
<a class="sourceLine" id="cb237-9" title="9"><span class="co">#&gt; ano1991 24.89 24.07 23.56 23.11 18.29 18.22</span></a>
<a class="sourceLine" id="cb237-10" title="10"><span class="co">#&gt; ano1992 23.20 26.61 18.00 23.11 26.80 21.30</span></a>
<a class="sourceLine" id="cb237-11" title="11">temp_mat[, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>][<span class="st">&quot;ano1991&quot;</span>, ]</a>
<a class="sourceLine" id="cb237-12" title="12"><span class="co">#&gt;   Jan   Fev   Mar   Abr   Mai   Jun </span></a>
<a class="sourceLine" id="cb237-13" title="13"><span class="co">#&gt; 24.89 24.07 23.56 23.11 18.29 18.22</span></a>
<a class="sourceLine" id="cb237-14" title="14">temp_mat[, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>][<span class="st">&quot;ano1991&quot;</span>, ][<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>]</a>
<a class="sourceLine" id="cb237-15" title="15"><span class="co">#&gt;   Fev   Mar   Abr </span></a>
<a class="sourceLine" id="cb237-16" title="16"><span class="co">#&gt; 24.07 23.56 23.11</span></a></code></pre></div>
<p>Podemos substituir valores de uma submatriz da matriz:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1">M &lt;-<span class="st"> </span>temp_mat</a>
<a class="sourceLine" id="cb238-2" title="2">M</a>
<a class="sourceLine" id="cb238-3" title="3"><span class="co">#&gt;           Jan   Fev   Mar   Abr   Mai   Jun   Jul   Ago   Set   Out   Nov   Dez</span></a>
<a class="sourceLine" id="cb238-4" title="4"><span class="co">#&gt; ano1990 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb238-5" title="5"><span class="co">#&gt; ano1991 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb238-6" title="6"><span class="co">#&gt; ano1992 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb238-7" title="7"><span class="co"># 1990 e 1992 os meses de jan e dez</span></a>
<a class="sourceLine" id="cb238-8" title="8">M[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">12</span>)]</a>
<a class="sourceLine" id="cb238-9" title="9"><span class="co">#&gt;          Jan   Dez</span></a>
<a class="sourceLine" id="cb238-10" title="10"><span class="co">#&gt; ano1990 25.0 26.80</span></a>
<a class="sourceLine" id="cb238-11" title="11"><span class="co">#&gt; ano1992 23.2 20.08</span></a>
<a class="sourceLine" id="cb238-12" title="12"><span class="co"># matriz com novos valores</span></a>
<a class="sourceLine" id="cb238-13" title="13"><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb238-14" title="14"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb238-15" title="15"><span class="co">#&gt; [1,]   21   23</span></a>
<a class="sourceLine" id="cb238-16" title="16"><span class="co">#&gt; [2,]   22   24</span></a>
<a class="sourceLine" id="cb238-17" title="17"><span class="co"># substituindo</span></a>
<a class="sourceLine" id="cb238-18" title="18">M[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">12</span>)] &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb238-19" title="19">M</a>
<a class="sourceLine" id="cb238-20" title="20"><span class="co">#&gt;           Jan   Fev   Mar   Abr   Mai   Jun   Jul   Ago   Set   Out   Nov   Dez</span></a>
<a class="sourceLine" id="cb238-21" title="21"><span class="co">#&gt; ano1990 21.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 23.00</span></a>
<a class="sourceLine" id="cb238-22" title="22"><span class="co">#&gt; ano1991 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb238-23" title="23"><span class="co">#&gt; ano1992 22.00 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 24.00</span></a></code></pre></div>
</div>
<div id="número-de-linhas-e-colunas-de-uma-matriz" class="section level3">
<h3><span class="header-section-number">8.1.4</span> Número de linhas e colunas de uma matriz</h3>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" title="1">M</a>
<a class="sourceLine" id="cb239-2" title="2"><span class="co">#&gt;           Jan   Fev   Mar   Abr   Mai   Jun   Jul   Ago   Set   Out   Nov   Dez</span></a>
<a class="sourceLine" id="cb239-3" title="3"><span class="co">#&gt; ano1990 21.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 23.00</span></a>
<a class="sourceLine" id="cb239-4" title="4"><span class="co">#&gt; ano1991 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb239-5" title="5"><span class="co">#&gt; ano1992 22.00 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 24.00</span></a>
<a class="sourceLine" id="cb239-6" title="6"><span class="kw">ncol</span>(temp_mat)</a>
<a class="sourceLine" id="cb239-7" title="7"><span class="co">#&gt; [1] 12</span></a>
<a class="sourceLine" id="cb239-8" title="8"><span class="kw">nrow</span>(temp_mat)</a>
<a class="sourceLine" id="cb239-9" title="9"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb239-10" title="10"><span class="kw">dim</span>(temp_mat)</a>
<a class="sourceLine" id="cb239-11" title="11"><span class="co">#&gt; [1]  3 12</span></a></code></pre></div>
<p>Existem funções específicas para saber a coluna e a linha de cada elemento de uma matriz.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1"><span class="co"># colunas de cada elemento da matriz</span></a>
<a class="sourceLine" id="cb240-2" title="2"><span class="kw">col</span>(temp_mat)</a>
<a class="sourceLine" id="cb240-3" title="3"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb240-4" title="4"><span class="co">#&gt; [1,]    1    2    3    4    5    6    7    8    9    10    11    12</span></a>
<a class="sourceLine" id="cb240-5" title="5"><span class="co">#&gt; [2,]    1    2    3    4    5    6    7    8    9    10    11    12</span></a>
<a class="sourceLine" id="cb240-6" title="6"><span class="co">#&gt; [3,]    1    2    3    4    5    6    7    8    9    10    11    12</span></a>
<a class="sourceLine" id="cb240-7" title="7"><span class="co"># linhas de cada elemento da matriz</span></a>
<a class="sourceLine" id="cb240-8" title="8"><span class="kw">row</span>(temp_mat)</a>
<a class="sourceLine" id="cb240-9" title="9"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb240-10" title="10"><span class="co">#&gt; [1,]    1    1    1    1    1    1    1    1    1     1     1     1</span></a>
<a class="sourceLine" id="cb240-11" title="11"><span class="co">#&gt; [2,]    2    2    2    2    2    2    2    2    2     2     2     2</span></a>
<a class="sourceLine" id="cb240-12" title="12"><span class="co">#&gt; [3,]    3    3    3    3    3    3    3    3    3     3     3     3</span></a></code></pre></div>
</div>
<div id="adição-de-linhas-e-colunas-a-uma-matriz" class="section level3">
<h3><span class="header-section-number">8.1.5</span> Adição de linhas e colunas a uma matriz</h3>
<p>Na construção de um vetor concatenaram-se valores com a função <code>c()</code>. A concatenação por linhas ou colunas em uma matriz pode ser feita com as funções <code>rbind()</code> e <code>cbind()</code>, respectivamente. No exemplo abaixo concatenam-se vetores de temperaturas mensais de 3 anos (ver seção @ref(nomes-lin-col-mat)), primeiro por linhas e depois por colunas.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" title="1">(temp_mat_lin &lt;-<span class="st"> </span><span class="kw">rbind</span>(temp90, temp91, temp92))</a>
<a class="sourceLine" id="cb241-2" title="2"><span class="co">#&gt;         [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb241-3" title="3"><span class="co">#&gt; temp90 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb241-4" title="4"><span class="co">#&gt; temp91 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb241-5" title="5"><span class="co">#&gt; temp92 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb241-6" title="6">(temp_mat_col &lt;-<span class="st"> </span><span class="kw">cbind</span>(temp90, temp91, temp92))</a>
<a class="sourceLine" id="cb241-7" title="7"><span class="co">#&gt;       temp90 temp91 temp92</span></a>
<a class="sourceLine" id="cb241-8" title="8"><span class="co">#&gt;  [1,]   25.0  24.89  23.20</span></a>
<a class="sourceLine" id="cb241-9" title="9"><span class="co">#&gt;  [2,]   23.2  24.07  26.61</span></a>
<a class="sourceLine" id="cb241-10" title="10"><span class="co">#&gt;  [3,]   22.5  23.56  18.00</span></a>
<a class="sourceLine" id="cb241-11" title="11"><span class="co">#&gt;  [4,]   21.0  23.11  23.11</span></a>
<a class="sourceLine" id="cb241-12" title="12"><span class="co">#&gt;  [5,]   19.0  18.29  26.80</span></a>
<a class="sourceLine" id="cb241-13" title="13"><span class="co">#&gt;  [6,]   17.6  18.22  21.30</span></a>
<a class="sourceLine" id="cb241-14" title="14"><span class="co">#&gt;  [7,]   18.0  16.72  18.22</span></a>
<a class="sourceLine" id="cb241-15" title="15"><span class="co">#&gt;  [8,]   19.7  19.37  21.45</span></a>
<a class="sourceLine" id="cb241-16" title="16"><span class="co">#&gt;  [9,]   21.3  20.08  19.70</span></a>
<a class="sourceLine" id="cb241-17" title="17"><span class="co">#&gt; [10,]   22.0  21.45  22.50</span></a>
<a class="sourceLine" id="cb241-18" title="18"><span class="co">#&gt; [11,]   24.0  26.61  24.07</span></a>
<a class="sourceLine" id="cb241-19" title="19"><span class="co">#&gt; [12,]   26.8  25.99  20.08</span></a></code></pre></div>
</div>
<div id="matriz-transposta-e-diagonal" class="section level3">
<h3><span class="header-section-number">8.1.6</span> Matriz transposta e diagonal</h3>
<p>A primeira entre as diversas funções de álgebra matricial no R é a transposta <code>t()</code>.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1">temp_mat</a>
<a class="sourceLine" id="cb242-2" title="2"><span class="co">#&gt;           Jan   Fev   Mar   Abr   Mai   Jun   Jul   Ago   Set   Out   Nov   Dez</span></a>
<a class="sourceLine" id="cb242-3" title="3"><span class="co">#&gt; ano1990 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb242-4" title="4"><span class="co">#&gt; ano1991 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb242-5" title="5"><span class="co">#&gt; ano1992 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb242-6" title="6"><span class="kw">t</span>(temp_mat)</a>
<a class="sourceLine" id="cb242-7" title="7"><span class="co">#&gt;     ano1990 ano1991 ano1992</span></a>
<a class="sourceLine" id="cb242-8" title="8"><span class="co">#&gt; Jan    25.0   24.89   23.20</span></a>
<a class="sourceLine" id="cb242-9" title="9"><span class="co">#&gt; Fev    23.2   24.07   26.61</span></a>
<a class="sourceLine" id="cb242-10" title="10"><span class="co">#&gt; Mar    22.5   23.56   18.00</span></a>
<a class="sourceLine" id="cb242-11" title="11"><span class="co">#&gt; Abr    21.0   23.11   23.11</span></a>
<a class="sourceLine" id="cb242-12" title="12"><span class="co">#&gt; Mai    19.0   18.29   26.80</span></a>
<a class="sourceLine" id="cb242-13" title="13"><span class="co">#&gt; Jun    17.6   18.22   21.30</span></a>
<a class="sourceLine" id="cb242-14" title="14"><span class="co">#&gt; Jul    18.0   16.72   18.22</span></a>
<a class="sourceLine" id="cb242-15" title="15"><span class="co">#&gt; Ago    19.7   19.37   21.45</span></a>
<a class="sourceLine" id="cb242-16" title="16"><span class="co">#&gt; Set    21.3   20.08   19.70</span></a>
<a class="sourceLine" id="cb242-17" title="17"><span class="co">#&gt; Out    22.0   21.45   22.50</span></a>
<a class="sourceLine" id="cb242-18" title="18"><span class="co">#&gt; Nov    24.0   26.61   24.07</span></a>
<a class="sourceLine" id="cb242-19" title="19"><span class="co">#&gt; Dez    26.8   25.99   20.08</span></a>
<a class="sourceLine" id="cb242-20" title="20"><span class="co"># diagonal </span></a>
<a class="sourceLine" id="cb242-21" title="21"><span class="kw">diag</span>(temp_mat)</a>
<a class="sourceLine" id="cb242-22" title="22"><span class="co">#&gt; [1] 25.00 24.07 18.00</span></a></code></pre></div>
<p>Operações matriciais adicionais são apresentadas no Apêndice @ref(oper-mat).</p>
</div>
<div id="conversão-de-matriz-para-vetor" class="section level3">
<h3><span class="header-section-number">8.1.7</span> Conversão de matriz para vetor</h3>
<p>Frequentemente é mais conveniente trabalhar com um vetor do que com uma matriz, por isso precisamos saber como fazer o caminho inverso. Quando criamos uma matriz (p. ex.: <code>temp_mat</code>) no início da seção ela foi baseada em um vetor (<code>vtemp</code>). Como fazemos para voltar aquele vetor original a partir da matriz?</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb243-1" title="1">temp_mat[<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(temp_mat) <span class="op">*</span><span class="st"> </span><span class="kw">ncol</span>(temp_mat) ]</a>
<a class="sourceLine" id="cb243-2" title="2"><span class="co">#&gt; [1] 23.11 21.45 20.08</span></a>
<a class="sourceLine" id="cb243-3" title="3"><span class="co"># vetor de temperaturas</span></a>
<a class="sourceLine" id="cb243-4" title="4">vtemp &lt;-<span class="st"> </span>temp_mat[<span class="dv">1</span><span class="op">:</span>(<span class="kw">ncol</span>(temp_mat) <span class="op">*</span><span class="st"> </span><span class="kw">nrow</span>(temp_mat))]</a>
<a class="sourceLine" id="cb243-5" title="5">vtemp</a>
<a class="sourceLine" id="cb243-6" title="6"><span class="co">#&gt;  [1] 25.00 24.89 23.20 23.20 24.07 26.61 22.50 23.56 18.00 21.00 23.11 23.11</span></a>
<a class="sourceLine" id="cb243-7" title="7"><span class="co">#&gt; [13] 19.00 18.29 26.80 17.60 18.22 21.30 18.00 16.72 18.22 19.70 19.37 21.45</span></a>
<a class="sourceLine" id="cb243-8" title="8"><span class="co">#&gt; [25] 21.30 20.08 19.70 22.00 21.45 22.50 24.00 26.61 24.07 26.80 25.99 20.08</span></a>
<a class="sourceLine" id="cb243-9" title="9"><span class="co"># outra forma de converte temp_mat para vetor</span></a>
<a class="sourceLine" id="cb243-10" title="10"><span class="kw">c</span>(temp_mat)</a>
<a class="sourceLine" id="cb243-11" title="11"><span class="co">#&gt;  [1] 25.00 24.89 23.20 23.20 24.07 26.61 22.50 23.56 18.00 21.00 23.11 23.11</span></a>
<a class="sourceLine" id="cb243-12" title="12"><span class="co">#&gt; [13] 19.00 18.29 26.80 17.60 18.22 21.30 18.00 16.72 18.22 19.70 19.37 21.45</span></a>
<a class="sourceLine" id="cb243-13" title="13"><span class="co">#&gt; [25] 21.30 20.08 19.70 22.00 21.45 22.50 24.00 26.61 24.07 26.80 25.99 20.08</span></a>
<a class="sourceLine" id="cb243-14" title="14"><span class="co"># função formal para converter</span></a>
<a class="sourceLine" id="cb243-15" title="15"><span class="kw">as.vector</span>(temp_mat)</a>
<a class="sourceLine" id="cb243-16" title="16"><span class="co">#&gt;  [1] 25.00 24.89 23.20 23.20 24.07 26.61 22.50 23.56 18.00 21.00 23.11 23.11</span></a>
<a class="sourceLine" id="cb243-17" title="17"><span class="co">#&gt; [13] 19.00 18.29 26.80 17.60 18.22 21.30 18.00 16.72 18.22 19.70 19.37 21.45</span></a>
<a class="sourceLine" id="cb243-18" title="18"><span class="co">#&gt; [25] 21.30 20.08 19.70 22.00 21.45 22.50 24.00 26.61 24.07 26.80 25.99 20.08</span></a>
<a class="sourceLine" id="cb243-19" title="19"><span class="co"># para desmanchar a matriz com os elementos seguindo a ordem das linhas</span></a>
<a class="sourceLine" id="cb243-20" title="20"><span class="kw">c</span>(<span class="kw">t</span>(temp_mat))</a>
<a class="sourceLine" id="cb243-21" title="21"><span class="co">#&gt;  [1] 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb243-22" title="22"><span class="co">#&gt; [13] 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb243-23" title="23"><span class="co">#&gt; [25] 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb243-24" title="24"><span class="kw">as.vector</span>(<span class="kw">t</span>(temp_mat))</a>
<a class="sourceLine" id="cb243-25" title="25"><span class="co">#&gt;  [1] 25.00 23.20 22.50 21.00 19.00 17.60 18.00 19.70 21.30 22.00 24.00 26.80</span></a>
<a class="sourceLine" id="cb243-26" title="26"><span class="co">#&gt; [13] 24.89 24.07 23.56 23.11 18.29 18.22 16.72 19.37 20.08 21.45 26.61 25.99</span></a>
<a class="sourceLine" id="cb243-27" title="27"><span class="co">#&gt; [25] 23.20 26.61 18.00 23.11 26.80 21.30 18.22 21.45 19.70 22.50 24.07 20.08</span></a>
<a class="sourceLine" id="cb243-28" title="28"><span class="co"># serie temporal de temp_mat</span></a>
<a class="sourceLine" id="cb243-29" title="29">stemp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">t</span>(temp_mat))</a>
<a class="sourceLine" id="cb243-30" title="30"><span class="kw">plot</span>(stemp, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>)</a></code></pre></div>
<p><img src="images/Chunk171-1.png" width="672" /></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1"><span class="co"># criar matriz com colunas temp e meses 1:12</span></a>
<a class="sourceLine" id="cb244-2" title="2"><span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">nrow</span>(temp_mat)), stemp)</a>
<a class="sourceLine" id="cb244-3" title="3"><span class="co">#&gt;          stemp</span></a>
<a class="sourceLine" id="cb244-4" title="4"><span class="co">#&gt;  [1,]  1 25.00</span></a>
<a class="sourceLine" id="cb244-5" title="5"><span class="co">#&gt;  [2,]  2 23.20</span></a>
<a class="sourceLine" id="cb244-6" title="6"><span class="co">#&gt;  [3,]  3 22.50</span></a>
<a class="sourceLine" id="cb244-7" title="7"><span class="co">#&gt;  [4,]  4 21.00</span></a>
<a class="sourceLine" id="cb244-8" title="8"><span class="co">#&gt;  [5,]  5 19.00</span></a>
<a class="sourceLine" id="cb244-9" title="9"><span class="co">#&gt;  [6,]  6 17.60</span></a>
<a class="sourceLine" id="cb244-10" title="10"><span class="co">#&gt;  [7,]  7 18.00</span></a>
<a class="sourceLine" id="cb244-11" title="11"><span class="co">#&gt;  [8,]  8 19.70</span></a>
<a class="sourceLine" id="cb244-12" title="12"><span class="co">#&gt;  [9,]  9 21.30</span></a>
<a class="sourceLine" id="cb244-13" title="13"><span class="co">#&gt; [10,] 10 22.00</span></a>
<a class="sourceLine" id="cb244-14" title="14"><span class="co">#&gt; [11,] 11 24.00</span></a>
<a class="sourceLine" id="cb244-15" title="15"><span class="co">#&gt; [12,] 12 26.80</span></a>
<a class="sourceLine" id="cb244-16" title="16"><span class="co">#&gt; [13,]  1 24.89</span></a>
<a class="sourceLine" id="cb244-17" title="17"><span class="co">#&gt; [14,]  2 24.07</span></a>
<a class="sourceLine" id="cb244-18" title="18"><span class="co">#&gt; [15,]  3 23.56</span></a>
<a class="sourceLine" id="cb244-19" title="19"><span class="co">#&gt; [16,]  4 23.11</span></a>
<a class="sourceLine" id="cb244-20" title="20"><span class="co">#&gt; [17,]  5 18.29</span></a>
<a class="sourceLine" id="cb244-21" title="21"><span class="co">#&gt; [18,]  6 18.22</span></a>
<a class="sourceLine" id="cb244-22" title="22"><span class="co">#&gt; [19,]  7 16.72</span></a>
<a class="sourceLine" id="cb244-23" title="23"><span class="co">#&gt; [20,]  8 19.37</span></a>
<a class="sourceLine" id="cb244-24" title="24"><span class="co">#&gt; [21,]  9 20.08</span></a>
<a class="sourceLine" id="cb244-25" title="25"><span class="co">#&gt; [22,] 10 21.45</span></a>
<a class="sourceLine" id="cb244-26" title="26"><span class="co">#&gt; [23,] 11 26.61</span></a>
<a class="sourceLine" id="cb244-27" title="27"><span class="co">#&gt; [24,] 12 25.99</span></a>
<a class="sourceLine" id="cb244-28" title="28"><span class="co">#&gt; [25,]  1 23.20</span></a>
<a class="sourceLine" id="cb244-29" title="29"><span class="co">#&gt; [26,]  2 26.61</span></a>
<a class="sourceLine" id="cb244-30" title="30"><span class="co">#&gt; [27,]  3 18.00</span></a>
<a class="sourceLine" id="cb244-31" title="31"><span class="co">#&gt; [28,]  4 23.11</span></a>
<a class="sourceLine" id="cb244-32" title="32"><span class="co">#&gt; [29,]  5 26.80</span></a>
<a class="sourceLine" id="cb244-33" title="33"><span class="co">#&gt; [30,]  6 21.30</span></a>
<a class="sourceLine" id="cb244-34" title="34"><span class="co">#&gt; [31,]  7 18.22</span></a>
<a class="sourceLine" id="cb244-35" title="35"><span class="co">#&gt; [32,]  8 21.45</span></a>
<a class="sourceLine" id="cb244-36" title="36"><span class="co">#&gt; [33,]  9 19.70</span></a>
<a class="sourceLine" id="cb244-37" title="37"><span class="co">#&gt; [34,] 10 22.50</span></a>
<a class="sourceLine" id="cb244-38" title="38"><span class="co">#&gt; [35,] 11 24.07</span></a>
<a class="sourceLine" id="cb244-39" title="39"><span class="co">#&gt; [36,] 12 20.08</span></a>
<a class="sourceLine" id="cb244-40" title="40"><span class="co"># dados de temp e meses</span></a>
<a class="sourceLine" id="cb244-41" title="41">tempdat &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, stemp)</a>
<a class="sourceLine" id="cb244-42" title="42"><span class="co"># plot da temperatura pelos meses (os meses repetem)</span></a>
<a class="sourceLine" id="cb244-43" title="43"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb244-44" title="44">  tempdat,</a>
<a class="sourceLine" id="cb244-45" title="45">  <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="co"># tipo de grafico: pontos</span></a>
<a class="sourceLine" id="cb244-46" title="46">  <span class="dt">pch =</span> <span class="dv">20</span>, <span class="co"># codigo numérico do simbolo do ponto</span></a>
<a class="sourceLine" id="cb244-47" title="47">  <span class="dt">col =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each =</span> <span class="kw">ncol</span>(temp_mat)), <span class="co"># cores dos pontos</span></a>
<a class="sourceLine" id="cb244-48" title="48">  <span class="dt">cex =</span> <span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dt">by =</span> <span class="fl">0.5</span>), <span class="dt">each =</span> <span class="kw">ncol</span>(temp_mat)), <span class="co"># aumenta tamanho dos pontos</span></a>
<a class="sourceLine" id="cb244-49" title="49">  <span class="dt">las =</span> <span class="dv">1</span>, <span class="co"># orientação dos labels dos eixos perpendiculares ao eixo</span></a>
<a class="sourceLine" id="cb244-50" title="50">  <span class="dt">ylab =</span> <span class="kw">expression</span>(Tar <span class="op">~</span><span class="st"> </span>(degree <span class="op">~</span><span class="st"> </span>C)), <span class="co"># label da variável y</span></a>
<a class="sourceLine" id="cb244-51" title="51">  <span class="dt">xlab =</span> <span class="st">&quot;meses&quot;</span>, <span class="co"># label da variavel x</span></a>
<a class="sourceLine" id="cb244-52" title="52">  <span class="dt">main =</span> <span class="st">&quot;Temperatura mensal (1990-1992)&quot;</span> <span class="co"># título</span></a>
<a class="sourceLine" id="cb244-53" title="53">) <span class="co"># end plot</span></a></code></pre></div>
<p><img src="images/Chunk171-2.png" width="672" /></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb245-1" title="1"><span class="co"># para entender a variação nas cores e símbolos usadas no gráfico</span></a>
<a class="sourceLine" id="cb245-2" title="2"><span class="kw">cbind</span>(</a>
<a class="sourceLine" id="cb245-3" title="3">  <span class="dt">meses =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">temp =</span> stemp,</a>
<a class="sourceLine" id="cb245-4" title="4">  <span class="dt">cores =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each =</span> <span class="kw">ncol</span>(temp_mat)), <span class="co"># cores</span></a>
<a class="sourceLine" id="cb245-5" title="5">  <span class="dt">simb_tam =</span> <span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dt">by =</span> <span class="fl">0.5</span>), <span class="dt">each =</span> <span class="kw">ncol</span>(temp_mat))</a>
<a class="sourceLine" id="cb245-6" title="6">) <span class="co"># tamanho dos símbolos</span></a>
<a class="sourceLine" id="cb245-7" title="7"><span class="co">#&gt;       meses  temp cores simb_tam</span></a>
<a class="sourceLine" id="cb245-8" title="8"><span class="co">#&gt;  [1,]     1 25.00     1      1.0</span></a>
<a class="sourceLine" id="cb245-9" title="9"><span class="co">#&gt;  [2,]     2 23.20     1      1.0</span></a>
<a class="sourceLine" id="cb245-10" title="10"><span class="co">#&gt;  [3,]     3 22.50     1      1.0</span></a>
<a class="sourceLine" id="cb245-11" title="11"><span class="co">#&gt;  [4,]     4 21.00     1      1.0</span></a>
<a class="sourceLine" id="cb245-12" title="12"><span class="co">#&gt;  [5,]     5 19.00     1      1.0</span></a>
<a class="sourceLine" id="cb245-13" title="13"><span class="co">#&gt;  [6,]     6 17.60     1      1.0</span></a>
<a class="sourceLine" id="cb245-14" title="14"><span class="co">#&gt;  [7,]     7 18.00     1      1.0</span></a>
<a class="sourceLine" id="cb245-15" title="15"><span class="co">#&gt;  [8,]     8 19.70     1      1.0</span></a>
<a class="sourceLine" id="cb245-16" title="16"><span class="co">#&gt;  [9,]     9 21.30     1      1.0</span></a>
<a class="sourceLine" id="cb245-17" title="17"><span class="co">#&gt; [10,]    10 22.00     1      1.0</span></a>
<a class="sourceLine" id="cb245-18" title="18"><span class="co">#&gt; [11,]    11 24.00     1      1.0</span></a>
<a class="sourceLine" id="cb245-19" title="19"><span class="co">#&gt; [12,]    12 26.80     1      1.0</span></a>
<a class="sourceLine" id="cb245-20" title="20"><span class="co">#&gt; [13,]     1 24.89     2      1.5</span></a>
<a class="sourceLine" id="cb245-21" title="21"><span class="co">#&gt; [14,]     2 24.07     2      1.5</span></a>
<a class="sourceLine" id="cb245-22" title="22"><span class="co">#&gt; [15,]     3 23.56     2      1.5</span></a>
<a class="sourceLine" id="cb245-23" title="23"><span class="co">#&gt; [16,]     4 23.11     2      1.5</span></a>
<a class="sourceLine" id="cb245-24" title="24"><span class="co">#&gt; [17,]     5 18.29     2      1.5</span></a>
<a class="sourceLine" id="cb245-25" title="25"><span class="co">#&gt; [18,]     6 18.22     2      1.5</span></a>
<a class="sourceLine" id="cb245-26" title="26"><span class="co">#&gt; [19,]     7 16.72     2      1.5</span></a>
<a class="sourceLine" id="cb245-27" title="27"><span class="co">#&gt; [20,]     8 19.37     2      1.5</span></a>
<a class="sourceLine" id="cb245-28" title="28"><span class="co">#&gt; [21,]     9 20.08     2      1.5</span></a>
<a class="sourceLine" id="cb245-29" title="29"><span class="co">#&gt; [22,]    10 21.45     2      1.5</span></a>
<a class="sourceLine" id="cb245-30" title="30"><span class="co">#&gt; [23,]    11 26.61     2      1.5</span></a>
<a class="sourceLine" id="cb245-31" title="31"><span class="co">#&gt; [24,]    12 25.99     2      1.5</span></a>
<a class="sourceLine" id="cb245-32" title="32"><span class="co">#&gt; [25,]     1 23.20     3      2.0</span></a>
<a class="sourceLine" id="cb245-33" title="33"><span class="co">#&gt; [26,]     2 26.61     3      2.0</span></a>
<a class="sourceLine" id="cb245-34" title="34"><span class="co">#&gt; [27,]     3 18.00     3      2.0</span></a>
<a class="sourceLine" id="cb245-35" title="35"><span class="co">#&gt; [28,]     4 23.11     3      2.0</span></a>
<a class="sourceLine" id="cb245-36" title="36"><span class="co">#&gt; [29,]     5 26.80     3      2.0</span></a>
<a class="sourceLine" id="cb245-37" title="37"><span class="co">#&gt; [30,]     6 21.30     3      2.0</span></a>
<a class="sourceLine" id="cb245-38" title="38"><span class="co">#&gt; [31,]     7 18.22     3      2.0</span></a>
<a class="sourceLine" id="cb245-39" title="39"><span class="co">#&gt; [32,]     8 21.45     3      2.0</span></a>
<a class="sourceLine" id="cb245-40" title="40"><span class="co">#&gt; [33,]     9 19.70     3      2.0</span></a>
<a class="sourceLine" id="cb245-41" title="41"><span class="co">#&gt; [34,]    10 22.50     3      2.0</span></a>
<a class="sourceLine" id="cb245-42" title="42"><span class="co">#&gt; [35,]    11 24.07     3      2.0</span></a>
<a class="sourceLine" id="cb245-43" title="43"><span class="co">#&gt; [36,]    12 20.08     3      2.0</span></a></code></pre></div>
</div>
</div>
<div id="arranjo" class="section level2">
<h2><span class="header-section-number">8.2</span> Arranjo</h2>
<p>Arranjo é uma estrutura de dados multidimensional. A matriz é um caso particular de arranjo com 2 dimensões: linhas e colunas. Mas podemos ter dados com <em>n</em> dimensões.</p>
<p>Por exemplo, imagine o campo espacial representado por uma grade de espaçamento horizontal regular de uma variável meteorológica. Nessa situação podemos usar uma matriz com valores de temperatura, onde as colunas representam as longitudes e as linhas as latitudes dos pontos da grade. Em um dados tempo, a matriz da variável com valores de temperatura do ar, por exemplo, representa o estado térmico espacial daquele momento. Então podemos dizer que esse arranjo possui 3 dimensões: latitude (linha), longitude (coluna) e tempo (camadas).</p>
<div id="criação" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Criação</h3>
<p>Suponha que os campos espaciais médios mensais de temperatura sejam dados pelo vetor <code>temp_vetor</code> abaixo.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" title="1">temp_vetor &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb246-2" title="2">  <span class="dv">18</span>, <span class="dv">24</span>, <span class="dv">19</span>, <span class="dv">23</span>, <span class="dv">19</span>, <span class="dv">27</span>, <span class="dv">24</span>, <span class="dv">18</span>, <span class="dv">13</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">19</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">17</span>,</a>
<a class="sourceLine" id="cb246-3" title="3">  <span class="dv">9</span>, <span class="dv">17</span>, <span class="dv">22</span>, <span class="dv">13</span>, <span class="dv">19</span>, <span class="dv">29</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">18</span>, <span class="dv">11</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">13</span>, <span class="dv">17</span>, <span class="dv">26</span>,</a>
<a class="sourceLine" id="cb246-4" title="4">  <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">20</span>, <span class="dv">14</span>, <span class="dv">17</span></a>
<a class="sourceLine" id="cb246-5" title="5">)</a></code></pre></div>
<p>O vetor <code>temp_vetor</code> pode ser convertido em um arranjo dos campos espaciais usando a função <code>array()</code>, com o argumento <code>dim</code> especificando as dimensões.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" title="1">temp_array &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">data =</span> temp_vetor, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb247-2" title="2">temp_array</a>
<a class="sourceLine" id="cb247-3" title="3"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb247-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb247-5" title="5"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb247-6" title="6"><span class="co">#&gt; [1,]   18   23   24   20</span></a>
<a class="sourceLine" id="cb247-7" title="7"><span class="co">#&gt; [2,]   24   19   18   25</span></a>
<a class="sourceLine" id="cb247-8" title="8"><span class="co">#&gt; [3,]   19   27   13   19</span></a>
<a class="sourceLine" id="cb247-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb247-10" title="10"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb247-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb247-12" title="12"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb247-13" title="13"><span class="co">#&gt; [1,]   18    9   13   18</span></a>
<a class="sourceLine" id="cb247-14" title="14"><span class="co">#&gt; [2,]   22   17   19   19</span></a>
<a class="sourceLine" id="cb247-15" title="15"><span class="co">#&gt; [3,]   17   22   29   18</span></a>
<a class="sourceLine" id="cb247-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb247-17" title="17"><span class="co">#&gt; , , 3</span></a>
<a class="sourceLine" id="cb247-18" title="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb247-19" title="19"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb247-20" title="20"><span class="co">#&gt; [1,]   11   17   26   20</span></a>
<a class="sourceLine" id="cb247-21" title="21"><span class="co">#&gt; [2,]   18   13   21   14</span></a>
<a class="sourceLine" id="cb247-22" title="22"><span class="co">#&gt; [3,]   19   17   22   17</span></a>
<a class="sourceLine" id="cb247-23" title="23"><span class="kw">dim</span>(temp_array)</a>
<a class="sourceLine" id="cb247-24" title="24"><span class="co">#&gt; [1] 3 4 3</span></a>
<a class="sourceLine" id="cb247-25" title="25"><span class="kw">class</span>(temp_array)</a>
<a class="sourceLine" id="cb247-26" title="26"><span class="co">#&gt; [1] &quot;array&quot;</span></a></code></pre></div>
<p>O arranjo também pode ter atributos, como o nomes das linhas, colunas e camadas.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" title="1"><span class="kw">colnames</span>(temp_array) &lt;-<span class="st"> </span><span class="op">-</span>(<span class="dv">45</span><span class="op">:</span><span class="dv">42</span>)</a>
<a class="sourceLine" id="cb248-2" title="2"><span class="kw">rownames</span>(temp_array) &lt;-<span class="st"> </span><span class="op">-</span>(<span class="dv">19</span><span class="op">:</span><span class="dv">21</span>)</a>
<a class="sourceLine" id="cb248-3" title="3"><span class="co"># nomes das dimensões</span></a>
<a class="sourceLine" id="cb248-4" title="4"><span class="kw">dimnames</span>(temp_array)</a>
<a class="sourceLine" id="cb248-5" title="5"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb248-6" title="6"><span class="co">#&gt; [1] &quot;-19&quot; &quot;-20&quot; &quot;-21&quot;</span></a>
<a class="sourceLine" id="cb248-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb248-8" title="8"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb248-9" title="9"><span class="co">#&gt; [1] &quot;-45&quot; &quot;-44&quot; &quot;-43&quot; &quot;-42&quot;</span></a>
<a class="sourceLine" id="cb248-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb248-11" title="11"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb248-12" title="12"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb248-13" title="13"><span class="co"># nomes para camadas</span></a>
<a class="sourceLine" id="cb248-14" title="14"><span class="kw">dimnames</span>(temp_array)[[<span class="dv">3</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Fev&quot;</span>, <span class="st">&quot;Mar&quot;</span>)</a>
<a class="sourceLine" id="cb248-15" title="15">temp_array</a>
<a class="sourceLine" id="cb248-16" title="16"><span class="co">#&gt; , , Jan</span></a>
<a class="sourceLine" id="cb248-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb248-18" title="18"><span class="co">#&gt;     -45 -44 -43 -42</span></a>
<a class="sourceLine" id="cb248-19" title="19"><span class="co">#&gt; -19  18  23  24  20</span></a>
<a class="sourceLine" id="cb248-20" title="20"><span class="co">#&gt; -20  24  19  18  25</span></a>
<a class="sourceLine" id="cb248-21" title="21"><span class="co">#&gt; -21  19  27  13  19</span></a>
<a class="sourceLine" id="cb248-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb248-23" title="23"><span class="co">#&gt; , , Fev</span></a>
<a class="sourceLine" id="cb248-24" title="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb248-25" title="25"><span class="co">#&gt;     -45 -44 -43 -42</span></a>
<a class="sourceLine" id="cb248-26" title="26"><span class="co">#&gt; -19  18   9  13  18</span></a>
<a class="sourceLine" id="cb248-27" title="27"><span class="co">#&gt; -20  22  17  19  19</span></a>
<a class="sourceLine" id="cb248-28" title="28"><span class="co">#&gt; -21  17  22  29  18</span></a>
<a class="sourceLine" id="cb248-29" title="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb248-30" title="30"><span class="co">#&gt; , , Mar</span></a>
<a class="sourceLine" id="cb248-31" title="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb248-32" title="32"><span class="co">#&gt;     -45 -44 -43 -42</span></a>
<a class="sourceLine" id="cb248-33" title="33"><span class="co">#&gt; -19  11  17  26  20</span></a>
<a class="sourceLine" id="cb248-34" title="34"><span class="co">#&gt; -20  18  13  21  14</span></a>
<a class="sourceLine" id="cb248-35" title="35"><span class="co">#&gt; -21  19  17  22  17</span></a></code></pre></div>
</div>
<div id="indexação" class="section level3">
<h3><span class="header-section-number">8.2.2</span> Indexação</h3>
<p>Os mesmo procedimentos de indexação usados para matriz são aplicados a um arranjo (A), mas com a seguinte convenção de índices <code>A[linha, coluna, camada]</code>.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" title="1"><span class="co"># serie temporal do 1º ponto</span></a>
<a class="sourceLine" id="cb249-2" title="2">temp_array[<span class="dv">1</span>, <span class="dv">1</span>, ]</a>
<a class="sourceLine" id="cb249-3" title="3"><span class="co">#&gt; Jan Fev Mar </span></a>
<a class="sourceLine" id="cb249-4" title="4"><span class="co">#&gt;  18  18  11</span></a>
<a class="sourceLine" id="cb249-5" title="5">temp_array[<span class="st">&quot;-19&quot;</span>, <span class="st">&quot;-45&quot;</span>, ]</a>
<a class="sourceLine" id="cb249-6" title="6"><span class="co">#&gt; Jan Fev Mar </span></a>
<a class="sourceLine" id="cb249-7" title="7"><span class="co">#&gt;  18  18  11</span></a>
<a class="sourceLine" id="cb249-8" title="8"><span class="co"># para 1a faixa de latitude (-19),</span></a>
<a class="sourceLine" id="cb249-9" title="9"><span class="co"># os valores de temp das longitudes em todos tempos</span></a>
<a class="sourceLine" id="cb249-10" title="10">temp_array[<span class="dv">1</span>, , ]</a>
<a class="sourceLine" id="cb249-11" title="11"><span class="co">#&gt;     Jan Fev Mar</span></a>
<a class="sourceLine" id="cb249-12" title="12"><span class="co">#&gt; -45  18  18  11</span></a>
<a class="sourceLine" id="cb249-13" title="13"><span class="co">#&gt; -44  23   9  17</span></a>
<a class="sourceLine" id="cb249-14" title="14"><span class="co">#&gt; -43  24  13  26</span></a>
<a class="sourceLine" id="cb249-15" title="15"><span class="co">#&gt; -42  20  18  20</span></a>
<a class="sourceLine" id="cb249-16" title="16"><span class="co"># para 2a faixa de longitude (-44), todas longitudes e tempos</span></a>
<a class="sourceLine" id="cb249-17" title="17">temp_array[, <span class="dv">2</span>, ]</a>
<a class="sourceLine" id="cb249-18" title="18"><span class="co">#&gt;     Jan Fev Mar</span></a>
<a class="sourceLine" id="cb249-19" title="19"><span class="co">#&gt; -19  23   9  17</span></a>
<a class="sourceLine" id="cb249-20" title="20"><span class="co">#&gt; -20  19  17  13</span></a>
<a class="sourceLine" id="cb249-21" title="21"><span class="co">#&gt; -21  27  22  17</span></a>
<a class="sourceLine" id="cb249-22" title="22"><span class="co"># média meridional</span></a>
<a class="sourceLine" id="cb249-23" title="23"><span class="kw">colMeans</span>(temp_array[, <span class="dv">2</span>, ])</a>
<a class="sourceLine" id="cb249-24" title="24"><span class="co">#&gt;      Jan      Fev      Mar </span></a>
<a class="sourceLine" id="cb249-25" title="25"><span class="co">#&gt; 23.00000 16.00000 15.66667</span></a>
<a class="sourceLine" id="cb249-26" title="26"><span class="co"># subdominio &quot;espacial&quot;</span></a>
<a class="sourceLine" id="cb249-27" title="27">temp_array[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, ]</a>
<a class="sourceLine" id="cb249-28" title="28"><span class="co">#&gt; , , Jan</span></a>
<a class="sourceLine" id="cb249-29" title="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb249-30" title="30"><span class="co">#&gt;     -44 -43</span></a>
<a class="sourceLine" id="cb249-31" title="31"><span class="co">#&gt; -20  19  18</span></a>
<a class="sourceLine" id="cb249-32" title="32"><span class="co">#&gt; -21  27  13</span></a>
<a class="sourceLine" id="cb249-33" title="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb249-34" title="34"><span class="co">#&gt; , , Fev</span></a>
<a class="sourceLine" id="cb249-35" title="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb249-36" title="36"><span class="co">#&gt;     -44 -43</span></a>
<a class="sourceLine" id="cb249-37" title="37"><span class="co">#&gt; -20  17  19</span></a>
<a class="sourceLine" id="cb249-38" title="38"><span class="co">#&gt; -21  22  29</span></a>
<a class="sourceLine" id="cb249-39" title="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb249-40" title="40"><span class="co">#&gt; , , Mar</span></a>
<a class="sourceLine" id="cb249-41" title="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb249-42" title="42"><span class="co">#&gt;     -44 -43</span></a>
<a class="sourceLine" id="cb249-43" title="43"><span class="co">#&gt; -20  13  21</span></a>
<a class="sourceLine" id="cb249-44" title="44"><span class="co">#&gt; -21  17  22</span></a>
<a class="sourceLine" id="cb249-45" title="45"><span class="co"># média espacial do 1o mês</span></a>
<a class="sourceLine" id="cb249-46" title="46"><span class="kw">mean</span>(temp_array[, , <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb249-47" title="47"><span class="co">#&gt; [1] 20.75</span></a>
<a class="sourceLine" id="cb249-48" title="48"><span class="co"># média espacial do segundo mês</span></a>
<a class="sourceLine" id="cb249-49" title="49"><span class="kw">mean</span>(temp_array[, , <span class="st">&quot;Jan&quot;</span>])</a>
<a class="sourceLine" id="cb249-50" title="50"><span class="co">#&gt; [1] 20.75</span></a>
<a class="sourceLine" id="cb249-51" title="51"><span class="co"># demanchando o arranjo (conversão para vetor)</span></a>
<a class="sourceLine" id="cb249-52" title="52"><span class="kw">c</span>(temp_array)</a>
<a class="sourceLine" id="cb249-53" title="53"><span class="co">#&gt;  [1] 18 24 19 23 19 27 24 18 13 20 25 19 18 22 17  9 17 22 13 19 29 18 19 18 11</span></a>
<a class="sourceLine" id="cb249-54" title="54"><span class="co">#&gt; [26] 18 19 17 13 17 26 21 22 20 14 17</span></a>
<a class="sourceLine" id="cb249-55" title="55"><span class="kw">c</span>(temp_array[, , <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb249-56" title="56"><span class="co">#&gt;  [1] 18 24 19 23 19 27 24 18 13 20 25 19</span></a>
<a class="sourceLine" id="cb249-57" title="57"><span class="co"># para entender a forma como a matriz é convertida para vetor</span></a>
<a class="sourceLine" id="cb249-58" title="58">mat_temp &lt;-<span class="st"> </span><span class="kw">cbind</span>(</a>
<a class="sourceLine" id="cb249-59" title="59">  <span class="dt">mes =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb249-60" title="60">  <span class="dt">elemat =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">times =</span> <span class="dv">6</span>),</a>
<a class="sourceLine" id="cb249-61" title="61">  <span class="dt">valores =</span> <span class="kw">c</span>(temp_array),</a>
<a class="sourceLine" id="cb249-62" title="62">  <span class="dt">elearr =</span> <span class="dv">1</span><span class="op">:</span>(<span class="kw">cumprod</span>(<span class="kw">dim</span>(temp_array))[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb249-63" title="63">)</a>
<a class="sourceLine" id="cb249-64" title="64"><span class="co">#&gt; Warning in cbind(mes = rep(1:3, each = 20), elemat = rep(1:20, times = 6), :</span></a>
<a class="sourceLine" id="cb249-65" title="65"><span class="co">#&gt; number of rows of result is not a multiple of vector length (arg 3)</span></a>
<a class="sourceLine" id="cb249-66" title="66">mat_temp</a>
<a class="sourceLine" id="cb249-67" title="67"><span class="co">#&gt;        mes elemat valores elearr</span></a>
<a class="sourceLine" id="cb249-68" title="68"><span class="co">#&gt;   [1,]   1      1      18      1</span></a>
<a class="sourceLine" id="cb249-69" title="69"><span class="co">#&gt;   [2,]   1      2      24      2</span></a>
<a class="sourceLine" id="cb249-70" title="70"><span class="co">#&gt;   [3,]   1      3      19      3</span></a>
<a class="sourceLine" id="cb249-71" title="71"><span class="co">#&gt;   [4,]   1      4      23      4</span></a>
<a class="sourceLine" id="cb249-72" title="72"><span class="co">#&gt;   [5,]   1      5      19      5</span></a>
<a class="sourceLine" id="cb249-73" title="73"><span class="co">#&gt;   [6,]   1      6      27      6</span></a>
<a class="sourceLine" id="cb249-74" title="74"><span class="co">#&gt;   [7,]   1      7      24      7</span></a>
<a class="sourceLine" id="cb249-75" title="75"><span class="co">#&gt;   [8,]   1      8      18      8</span></a>
<a class="sourceLine" id="cb249-76" title="76"><span class="co">#&gt;   [9,]   1      9      13      9</span></a>
<a class="sourceLine" id="cb249-77" title="77"><span class="co">#&gt;  [10,]   1     10      20     10</span></a>
<a class="sourceLine" id="cb249-78" title="78"><span class="co">#&gt;  [11,]   1     11      25     11</span></a>
<a class="sourceLine" id="cb249-79" title="79"><span class="co">#&gt;  [12,]   1     12      19     12</span></a>
<a class="sourceLine" id="cb249-80" title="80"><span class="co">#&gt;  [13,]   1     13      18     13</span></a>
<a class="sourceLine" id="cb249-81" title="81"><span class="co">#&gt;  [14,]   1     14      22     14</span></a>
<a class="sourceLine" id="cb249-82" title="82"><span class="co">#&gt;  [15,]   1     15      17     15</span></a>
<a class="sourceLine" id="cb249-83" title="83"><span class="co">#&gt;  [16,]   1     16       9     16</span></a>
<a class="sourceLine" id="cb249-84" title="84"><span class="co">#&gt;  [17,]   1     17      17     17</span></a>
<a class="sourceLine" id="cb249-85" title="85"><span class="co">#&gt;  [18,]   1     18      22     18</span></a>
<a class="sourceLine" id="cb249-86" title="86"><span class="co">#&gt;  [19,]   1     19      13     19</span></a>
<a class="sourceLine" id="cb249-87" title="87"><span class="co">#&gt;  [20,]   1     20      19     20</span></a>
<a class="sourceLine" id="cb249-88" title="88"><span class="co">#&gt;  [21,]   2      1      29     21</span></a>
<a class="sourceLine" id="cb249-89" title="89"><span class="co">#&gt;  [22,]   2      2      18     22</span></a>
<a class="sourceLine" id="cb249-90" title="90"><span class="co">#&gt;  [23,]   2      3      19     23</span></a>
<a class="sourceLine" id="cb249-91" title="91"><span class="co">#&gt;  [24,]   2      4      18     24</span></a>
<a class="sourceLine" id="cb249-92" title="92"><span class="co">#&gt;  [25,]   2      5      11     25</span></a>
<a class="sourceLine" id="cb249-93" title="93"><span class="co">#&gt;  [26,]   2      6      18     26</span></a>
<a class="sourceLine" id="cb249-94" title="94"><span class="co">#&gt;  [27,]   2      7      19     27</span></a>
<a class="sourceLine" id="cb249-95" title="95"><span class="co">#&gt;  [28,]   2      8      17     28</span></a>
<a class="sourceLine" id="cb249-96" title="96"><span class="co">#&gt;  [29,]   2      9      13     29</span></a>
<a class="sourceLine" id="cb249-97" title="97"><span class="co">#&gt;  [30,]   2     10      17     30</span></a>
<a class="sourceLine" id="cb249-98" title="98"><span class="co">#&gt;  [31,]   2     11      26     31</span></a>
<a class="sourceLine" id="cb249-99" title="99"><span class="co">#&gt;  [32,]   2     12      21     32</span></a>
<a class="sourceLine" id="cb249-100" title="100"><span class="co">#&gt;  [33,]   2     13      22     33</span></a>
<a class="sourceLine" id="cb249-101" title="101"><span class="co">#&gt;  [34,]   2     14      20     34</span></a>
<a class="sourceLine" id="cb249-102" title="102"><span class="co">#&gt;  [35,]   2     15      14     35</span></a>
<a class="sourceLine" id="cb249-103" title="103"><span class="co">#&gt;  [36,]   2     16      17     36</span></a>
<a class="sourceLine" id="cb249-104" title="104"><span class="co">#&gt;  [37,]   2     17      18      1</span></a>
<a class="sourceLine" id="cb249-105" title="105"><span class="co">#&gt;  [38,]   2     18      24      2</span></a>
<a class="sourceLine" id="cb249-106" title="106"><span class="co">#&gt;  [39,]   2     19      19      3</span></a>
<a class="sourceLine" id="cb249-107" title="107"><span class="co">#&gt;  [40,]   2     20      23      4</span></a>
<a class="sourceLine" id="cb249-108" title="108"><span class="co">#&gt;  [41,]   3      1      19      5</span></a>
<a class="sourceLine" id="cb249-109" title="109"><span class="co">#&gt;  [42,]   3      2      27      6</span></a>
<a class="sourceLine" id="cb249-110" title="110"><span class="co">#&gt;  [43,]   3      3      24      7</span></a>
<a class="sourceLine" id="cb249-111" title="111"><span class="co">#&gt;  [44,]   3      4      18      8</span></a>
<a class="sourceLine" id="cb249-112" title="112"><span class="co">#&gt;  [45,]   3      5      13      9</span></a>
<a class="sourceLine" id="cb249-113" title="113"><span class="co">#&gt;  [46,]   3      6      20     10</span></a>
<a class="sourceLine" id="cb249-114" title="114"><span class="co">#&gt;  [47,]   3      7      25     11</span></a>
<a class="sourceLine" id="cb249-115" title="115"><span class="co">#&gt;  [48,]   3      8      19     12</span></a>
<a class="sourceLine" id="cb249-116" title="116"><span class="co">#&gt;  [49,]   3      9      18     13</span></a>
<a class="sourceLine" id="cb249-117" title="117"><span class="co">#&gt;  [50,]   3     10      22     14</span></a>
<a class="sourceLine" id="cb249-118" title="118"><span class="co">#&gt;  [51,]   3     11      17     15</span></a>
<a class="sourceLine" id="cb249-119" title="119"><span class="co">#&gt;  [52,]   3     12       9     16</span></a>
<a class="sourceLine" id="cb249-120" title="120"><span class="co">#&gt;  [53,]   3     13      17     17</span></a>
<a class="sourceLine" id="cb249-121" title="121"><span class="co">#&gt;  [54,]   3     14      22     18</span></a>
<a class="sourceLine" id="cb249-122" title="122"><span class="co">#&gt;  [55,]   3     15      13     19</span></a>
<a class="sourceLine" id="cb249-123" title="123"><span class="co">#&gt;  [56,]   3     16      19     20</span></a>
<a class="sourceLine" id="cb249-124" title="124"><span class="co">#&gt;  [57,]   3     17      29     21</span></a>
<a class="sourceLine" id="cb249-125" title="125"><span class="co">#&gt;  [58,]   3     18      18     22</span></a>
<a class="sourceLine" id="cb249-126" title="126"><span class="co">#&gt;  [59,]   3     19      19     23</span></a>
<a class="sourceLine" id="cb249-127" title="127"><span class="co">#&gt;  [60,]   3     20      18     24</span></a>
<a class="sourceLine" id="cb249-128" title="128"><span class="co">#&gt;  [61,]   1      1      11     25</span></a>
<a class="sourceLine" id="cb249-129" title="129"><span class="co">#&gt;  [62,]   1      2      18     26</span></a>
<a class="sourceLine" id="cb249-130" title="130"><span class="co">#&gt;  [63,]   1      3      19     27</span></a>
<a class="sourceLine" id="cb249-131" title="131"><span class="co">#&gt;  [64,]   1      4      17     28</span></a>
<a class="sourceLine" id="cb249-132" title="132"><span class="co">#&gt;  [65,]   1      5      13     29</span></a>
<a class="sourceLine" id="cb249-133" title="133"><span class="co">#&gt;  [66,]   1      6      17     30</span></a>
<a class="sourceLine" id="cb249-134" title="134"><span class="co">#&gt;  [67,]   1      7      26     31</span></a>
<a class="sourceLine" id="cb249-135" title="135"><span class="co">#&gt;  [68,]   1      8      21     32</span></a>
<a class="sourceLine" id="cb249-136" title="136"><span class="co">#&gt;  [69,]   1      9      22     33</span></a>
<a class="sourceLine" id="cb249-137" title="137"><span class="co">#&gt;  [70,]   1     10      20     34</span></a>
<a class="sourceLine" id="cb249-138" title="138"><span class="co">#&gt;  [71,]   1     11      14     35</span></a>
<a class="sourceLine" id="cb249-139" title="139"><span class="co">#&gt;  [72,]   1     12      17     36</span></a>
<a class="sourceLine" id="cb249-140" title="140"><span class="co">#&gt;  [73,]   1     13      18      1</span></a>
<a class="sourceLine" id="cb249-141" title="141"><span class="co">#&gt;  [74,]   1     14      24      2</span></a>
<a class="sourceLine" id="cb249-142" title="142"><span class="co">#&gt;  [75,]   1     15      19      3</span></a>
<a class="sourceLine" id="cb249-143" title="143"><span class="co">#&gt;  [76,]   1     16      23      4</span></a>
<a class="sourceLine" id="cb249-144" title="144"><span class="co">#&gt;  [77,]   1     17      19      5</span></a>
<a class="sourceLine" id="cb249-145" title="145"><span class="co">#&gt;  [78,]   1     18      27      6</span></a>
<a class="sourceLine" id="cb249-146" title="146"><span class="co">#&gt;  [79,]   1     19      24      7</span></a>
<a class="sourceLine" id="cb249-147" title="147"><span class="co">#&gt;  [80,]   1     20      18      8</span></a>
<a class="sourceLine" id="cb249-148" title="148"><span class="co">#&gt;  [81,]   2      1      13      9</span></a>
<a class="sourceLine" id="cb249-149" title="149"><span class="co">#&gt;  [82,]   2      2      20     10</span></a>
<a class="sourceLine" id="cb249-150" title="150"><span class="co">#&gt;  [83,]   2      3      25     11</span></a>
<a class="sourceLine" id="cb249-151" title="151"><span class="co">#&gt;  [84,]   2      4      19     12</span></a>
<a class="sourceLine" id="cb249-152" title="152"><span class="co">#&gt;  [85,]   2      5      18     13</span></a>
<a class="sourceLine" id="cb249-153" title="153"><span class="co">#&gt;  [86,]   2      6      22     14</span></a>
<a class="sourceLine" id="cb249-154" title="154"><span class="co">#&gt;  [87,]   2      7      17     15</span></a>
<a class="sourceLine" id="cb249-155" title="155"><span class="co">#&gt;  [88,]   2      8       9     16</span></a>
<a class="sourceLine" id="cb249-156" title="156"><span class="co">#&gt;  [89,]   2      9      17     17</span></a>
<a class="sourceLine" id="cb249-157" title="157"><span class="co">#&gt;  [90,]   2     10      22     18</span></a>
<a class="sourceLine" id="cb249-158" title="158"><span class="co">#&gt;  [91,]   2     11      13     19</span></a>
<a class="sourceLine" id="cb249-159" title="159"><span class="co">#&gt;  [92,]   2     12      19     20</span></a>
<a class="sourceLine" id="cb249-160" title="160"><span class="co">#&gt;  [93,]   2     13      29     21</span></a>
<a class="sourceLine" id="cb249-161" title="161"><span class="co">#&gt;  [94,]   2     14      18     22</span></a>
<a class="sourceLine" id="cb249-162" title="162"><span class="co">#&gt;  [95,]   2     15      19     23</span></a>
<a class="sourceLine" id="cb249-163" title="163"><span class="co">#&gt;  [96,]   2     16      18     24</span></a>
<a class="sourceLine" id="cb249-164" title="164"><span class="co">#&gt;  [97,]   2     17      11     25</span></a>
<a class="sourceLine" id="cb249-165" title="165"><span class="co">#&gt;  [98,]   2     18      18     26</span></a>
<a class="sourceLine" id="cb249-166" title="166"><span class="co">#&gt;  [99,]   2     19      19     27</span></a>
<a class="sourceLine" id="cb249-167" title="167"><span class="co">#&gt; [100,]   2     20      17     28</span></a>
<a class="sourceLine" id="cb249-168" title="168"><span class="co">#&gt; [101,]   3      1      13     29</span></a>
<a class="sourceLine" id="cb249-169" title="169"><span class="co">#&gt; [102,]   3      2      17     30</span></a>
<a class="sourceLine" id="cb249-170" title="170"><span class="co">#&gt; [103,]   3      3      26     31</span></a>
<a class="sourceLine" id="cb249-171" title="171"><span class="co">#&gt; [104,]   3      4      21     32</span></a>
<a class="sourceLine" id="cb249-172" title="172"><span class="co">#&gt; [105,]   3      5      22     33</span></a>
<a class="sourceLine" id="cb249-173" title="173"><span class="co">#&gt; [106,]   3      6      20     34</span></a>
<a class="sourceLine" id="cb249-174" title="174"><span class="co">#&gt; [107,]   3      7      14     35</span></a>
<a class="sourceLine" id="cb249-175" title="175"><span class="co">#&gt; [108,]   3      8      17     36</span></a>
<a class="sourceLine" id="cb249-176" title="176"><span class="co">#&gt; [109,]   3      9      18      1</span></a>
<a class="sourceLine" id="cb249-177" title="177"><span class="co">#&gt; [110,]   3     10      24      2</span></a>
<a class="sourceLine" id="cb249-178" title="178"><span class="co">#&gt; [111,]   3     11      19      3</span></a>
<a class="sourceLine" id="cb249-179" title="179"><span class="co">#&gt; [112,]   3     12      23      4</span></a>
<a class="sourceLine" id="cb249-180" title="180"><span class="co">#&gt; [113,]   3     13      19      5</span></a>
<a class="sourceLine" id="cb249-181" title="181"><span class="co">#&gt; [114,]   3     14      27      6</span></a>
<a class="sourceLine" id="cb249-182" title="182"><span class="co">#&gt; [115,]   3     15      24      7</span></a>
<a class="sourceLine" id="cb249-183" title="183"><span class="co">#&gt; [116,]   3     16      18      8</span></a>
<a class="sourceLine" id="cb249-184" title="184"><span class="co">#&gt; [117,]   3     17      13      9</span></a>
<a class="sourceLine" id="cb249-185" title="185"><span class="co">#&gt; [118,]   3     18      20     10</span></a>
<a class="sourceLine" id="cb249-186" title="186"><span class="co">#&gt; [119,]   3     19      25     11</span></a>
<a class="sourceLine" id="cb249-187" title="187"><span class="co">#&gt; [120,]   3     20      19     12</span></a></code></pre></div>
</div>
</div>
<div id="listas" class="section level2">
<h2><span class="header-section-number">8.3</span> Lista</h2>
<p>Listas são o segundo tipo de vetor. O primeiro tipo nós já vimos, são os <strong>vetores atômicos</strong>, nos quais todos os elementos devem ser de uma mesma classe de objeto. Listas são uma estrutura de dados muito versátil por pelo menos 3 razões:</p>
<ol style="list-style-type: decimal">
<li>Os elementos podem ser de diferentes classes de objetos (p.ex.: um elemento <code>numeric</code>, outro <code>character</code>);</li>
<li>Cada elemento pode ter um tamanho diferente;</li>
<li>Os elementos podem conter diferentes estrutura de dados (p.ex.: um elemento <code>matrix</code>, outro <code>vector</code>);</li>
</ol>
<p>Dentro da lista o conjunto de objetos são ordenados e cada elemento pode conter sub-elementos.</p>
<div id="criação-1" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Criação</h3>
<p>As vezes precisamos de um <em>container</em> para armazenar diferentes tipos de dados do R e com diferente tamanhos. As <em>listas</em> servem para isso e permitem armazenar qualquer número de itens de qualquer tipo. Uma lista pode conter números, caracteres ou uma mistura de <em>dataframes</em>, sub-listas, matrizes e vetores.</p>
<p>Listas podem ser criadas com a função <code>list()</code>. A especificação do conteúdo de uma lista é muito similar a da função <code>c()</code> vista anteriormente. Nós simplesmente listamos os elementos da lista separados por uma vírgula dentro da função <code>list()</code>.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1"><span class="co"># lista de dados heterogêneos</span></a>
<a class="sourceLine" id="cb250-2" title="2">lst &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">2.3</span>, <span class="fl">5.9</span>), <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), <span class="st">&quot;R&quot;</span>, <span class="kw">list</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb250-3" title="3">lst</a>
<a class="sourceLine" id="cb250-4" title="4"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb250-5" title="5"><span class="co">#&gt; [1] 1 2 3 4</span></a>
<a class="sourceLine" id="cb250-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb250-7" title="7"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb250-8" title="8"><span class="co">#&gt; [1] 1.1 2.3 5.9</span></a>
<a class="sourceLine" id="cb250-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb250-10" title="10"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb250-11" title="11"><span class="co">#&gt; [1]  TRUE FALSE</span></a>
<a class="sourceLine" id="cb250-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb250-13" title="13"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb250-14" title="14"><span class="co">#&gt; [1] &quot;R&quot;</span></a>
<a class="sourceLine" id="cb250-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb250-16" title="16"><span class="co">#&gt; [[5]]</span></a>
<a class="sourceLine" id="cb250-17" title="17"><span class="co">#&gt; [[5]][[1]]</span></a>
<a class="sourceLine" id="cb250-18" title="18"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb250-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb250-20" title="20"><span class="co">#&gt; [[5]][[2]]</span></a>
<a class="sourceLine" id="cb250-21" title="21"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb250-22" title="22"><span class="co"># estrutura da lista</span></a>
<a class="sourceLine" id="cb250-23" title="23"><span class="kw">str</span>(lst)</a>
<a class="sourceLine" id="cb250-24" title="24"><span class="co">#&gt; List of 5</span></a>
<a class="sourceLine" id="cb250-25" title="25"><span class="co">#&gt;  $ : int [1:4] 1 2 3 4</span></a>
<a class="sourceLine" id="cb250-26" title="26"><span class="co">#&gt;  $ : num [1:3] 1.1 2.3 5.9</span></a>
<a class="sourceLine" id="cb250-27" title="27"><span class="co">#&gt;  $ : logi [1:2] TRUE FALSE</span></a>
<a class="sourceLine" id="cb250-28" title="28"><span class="co">#&gt;  $ : chr &quot;R&quot;</span></a>
<a class="sourceLine" id="cb250-29" title="29"><span class="co">#&gt;  $ :List of 2</span></a>
<a class="sourceLine" id="cb250-30" title="30"><span class="co">#&gt;   ..$ : num 0</span></a>
<a class="sourceLine" id="cb250-31" title="31"><span class="co">#&gt;   ..$ : num 1</span></a>
<a class="sourceLine" id="cb250-32" title="32"><span class="co"># tamanho da lista (num. de componentes ou elementos)</span></a>
<a class="sourceLine" id="cb250-33" title="33"><span class="kw">length</span>(lst)</a>
<a class="sourceLine" id="cb250-34" title="34"><span class="co">#&gt; [1] 5</span></a>
<a class="sourceLine" id="cb250-35" title="35"><span class="co"># atribuindo nomes a lista</span></a>
<a class="sourceLine" id="cb250-36" title="36"><span class="kw">names</span>(lst)</a>
<a class="sourceLine" id="cb250-37" title="37"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb250-38" title="38"><span class="kw">names</span>(lst) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;vetor_int&quot;</span>, <span class="st">&quot;vetor_dbl&quot;</span>, <span class="st">&quot;logico&quot;</span>, <span class="st">&quot;char&quot;</span>, <span class="st">&quot;lista&quot;</span>)</a></code></pre></div>
<p>Os índices em colchetes duplos <code>[[]]</code> identificam o elemento ou a componente da lista. Os índices em colchete simples <code>[]</code> indicam qual sub-elemento da lista está sendo mostrado. Por exemplo <code>1.1</code> é o primeiro sub-elemento do segundo elemento da lista <code>lst</code>. Desse aninhamento de elementos surge o sistema de indexação de listas. A estrutura de uma lista pode se tornar complicada com o aumento do grau de sub-elementos. Mas essa flexibilidade, faz das listas uma ferramenta de armazenamento de dados para todos propósitos.</p>
<div class="rmdtip">
<p>
Veremos que no R, listas são frequentemente usadas para armazenar a saída de funções com diversos resultados. Como por exemplo a saída das funções <code>rle()</code>.
</p>
</div>
<p>Para verificar se uma lista é aninhada usamos a função <code>is.recursive()</code>.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" title="1"><span class="kw">is.recursive</span>(lst)</a>
<a class="sourceLine" id="cb251-2" title="2"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Vamos ver um exemplo onde criamos uma lista com informações de duas estações meteorológicas.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" title="1"><span class="co"># matriz de dados meteorológicos da estação de Santa Maria</span></a>
<a class="sourceLine" id="cb252-2" title="2">dados_sm &lt;-<span class="st"> </span><span class="kw">cbind</span>(</a>
<a class="sourceLine" id="cb252-3" title="3">  <span class="dt">tar =</span> <span class="kw">c</span>(<span class="dv">31</span>, <span class="dv">35</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">33</span>, <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb252-4" title="4">  <span class="dt">prec =</span> <span class="kw">c</span>(<span class="dv">300</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">120</span>, <span class="dv">210</span>, <span class="dv">110</span>)</a>
<a class="sourceLine" id="cb252-5" title="5">)</a>
<a class="sourceLine" id="cb252-6" title="6">dados_sm</a>
<a class="sourceLine" id="cb252-7" title="7"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb252-8" title="8"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb252-9" title="9"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb252-10" title="10"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb252-11" title="11"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb252-12" title="12"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb252-13" title="13"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb252-14" title="14"><span class="co"># lista com informações da estação de santa maria</span></a>
<a class="sourceLine" id="cb252-15" title="15">sm_l &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb252-16" title="16">  <span class="kw">c</span>(<span class="op">-</span><span class="dv">45</span>, <span class="dv">-23</span>),</a>
<a class="sourceLine" id="cb252-17" title="17">  <span class="st">&quot;Santa Maria&quot;</span>,</a>
<a class="sourceLine" id="cb252-18" title="18">  dados_sm</a>
<a class="sourceLine" id="cb252-19" title="19">)</a>
<a class="sourceLine" id="cb252-20" title="20">sm_l</a>
<a class="sourceLine" id="cb252-21" title="21"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb252-22" title="22"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb252-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb252-24" title="24"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb252-25" title="25"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb252-26" title="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb252-27" title="27"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb252-28" title="28"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb252-29" title="29"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb252-30" title="30"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb252-31" title="31"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb252-32" title="32"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb252-33" title="33"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb252-34" title="34"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb252-35" title="35"><span class="co"># adicionar nomes aos elementos</span></a>
<a class="sourceLine" id="cb252-36" title="36"><span class="kw">names</span>(sm_l) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;coords&quot;</span>, <span class="st">&quot;cidade&quot;</span>, <span class="st">&quot;dados&quot;</span>)</a>
<a class="sourceLine" id="cb252-37" title="37">sm_l</a>
<a class="sourceLine" id="cb252-38" title="38"><span class="co">#&gt; $coords</span></a>
<a class="sourceLine" id="cb252-39" title="39"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb252-40" title="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb252-41" title="41"><span class="co">#&gt; $cidade</span></a>
<a class="sourceLine" id="cb252-42" title="42"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb252-43" title="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb252-44" title="44"><span class="co">#&gt; $dados</span></a>
<a class="sourceLine" id="cb252-45" title="45"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb252-46" title="46"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb252-47" title="47"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb252-48" title="48"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb252-49" title="49"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb252-50" title="50"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb252-51" title="51"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb252-52" title="52"><span class="co"># matriz de dados meteorológicos da estação de Júlio de Castilhos</span></a>
<a class="sourceLine" id="cb252-53" title="53">dados_jc &lt;-<span class="st"> </span><span class="kw">cbind</span>(</a>
<a class="sourceLine" id="cb252-54" title="54">  <span class="dt">tar =</span> <span class="kw">c</span>(<span class="fl">22.5</span>, <span class="dv">20</span>, <span class="fl">18.75</span>, <span class="dv">18</span>, <span class="fl">20.25</span>, <span class="fl">17.75</span>),</a>
<a class="sourceLine" id="cb252-55" title="55">  <span class="dt">prec =</span> <span class="kw">c</span>(<span class="dv">360</span>, <span class="dv">310</span>, <span class="dv">285</span>, <span class="dv">270</span>, <span class="dv">315</span>, <span class="dv">265</span>)</a>
<a class="sourceLine" id="cb252-56" title="56">)</a>
<a class="sourceLine" id="cb252-57" title="57"><span class="co"># criando lista de JC, mas nomeando de forma diferente</span></a>
<a class="sourceLine" id="cb252-58" title="58">jc_l &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb252-59" title="59">  <span class="dt">coords =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">45.1</span>, <span class="fl">-23.2</span>),</a>
<a class="sourceLine" id="cb252-60" title="60">  <span class="dt">cidade =</span> <span class="st">&quot;Júlio de Castilhos&quot;</span>,</a>
<a class="sourceLine" id="cb252-61" title="61">  <span class="dt">dados =</span> dados_jc</a>
<a class="sourceLine" id="cb252-62" title="62">)</a>
<a class="sourceLine" id="cb252-63" title="63"><span class="co"># adicionar nomes as componentes</span></a>
<a class="sourceLine" id="cb252-64" title="64"><span class="kw">names</span>(jc_l) &lt;-<span class="st"> </span><span class="kw">names</span>(sm_l)</a>
<a class="sourceLine" id="cb252-65" title="65">jc_l</a>
<a class="sourceLine" id="cb252-66" title="66"><span class="co">#&gt; $coords</span></a>
<a class="sourceLine" id="cb252-67" title="67"><span class="co">#&gt; [1] -45.1 -23.2</span></a>
<a class="sourceLine" id="cb252-68" title="68"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb252-69" title="69"><span class="co">#&gt; $cidade</span></a>
<a class="sourceLine" id="cb252-70" title="70"><span class="co">#&gt; [1] &quot;Júlio de Castilhos&quot;</span></a>
<a class="sourceLine" id="cb252-71" title="71"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb252-72" title="72"><span class="co">#&gt; $dados</span></a>
<a class="sourceLine" id="cb252-73" title="73"><span class="co">#&gt;        tar prec</span></a>
<a class="sourceLine" id="cb252-74" title="74"><span class="co">#&gt; [1,] 22.50  360</span></a>
<a class="sourceLine" id="cb252-75" title="75"><span class="co">#&gt; [2,] 20.00  310</span></a>
<a class="sourceLine" id="cb252-76" title="76"><span class="co">#&gt; [3,] 18.75  285</span></a>
<a class="sourceLine" id="cb252-77" title="77"><span class="co">#&gt; [4,] 18.00  270</span></a>
<a class="sourceLine" id="cb252-78" title="78"><span class="co">#&gt; [5,] 20.25  315</span></a>
<a class="sourceLine" id="cb252-79" title="79"><span class="co">#&gt; [6,] 17.75  265</span></a></code></pre></div>
<p>As informações de cada estação estão armazenadas em 2 listas. Mas é mais prático termos todas estações em um única lista:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1"><span class="co"># combinando listas mantendo os elementos separadamente</span></a>
<a class="sourceLine" id="cb253-2" title="2">dados_l &lt;-<span class="st"> </span><span class="kw">list</span>(sm_l, jc_l)</a>
<a class="sourceLine" id="cb253-3" title="3">dados_l</a>
<a class="sourceLine" id="cb253-4" title="4"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb253-5" title="5"><span class="co">#&gt; [[1]]$coords</span></a>
<a class="sourceLine" id="cb253-6" title="6"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb253-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-8" title="8"><span class="co">#&gt; [[1]]$cidade</span></a>
<a class="sourceLine" id="cb253-9" title="9"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb253-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-11" title="11"><span class="co">#&gt; [[1]]$dados</span></a>
<a class="sourceLine" id="cb253-12" title="12"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb253-13" title="13"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb253-14" title="14"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb253-15" title="15"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb253-16" title="16"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb253-17" title="17"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb253-18" title="18"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb253-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-21" title="21"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb253-22" title="22"><span class="co">#&gt; [[2]]$coords</span></a>
<a class="sourceLine" id="cb253-23" title="23"><span class="co">#&gt; [1] -45.1 -23.2</span></a>
<a class="sourceLine" id="cb253-24" title="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-25" title="25"><span class="co">#&gt; [[2]]$cidade</span></a>
<a class="sourceLine" id="cb253-26" title="26"><span class="co">#&gt; [1] &quot;Júlio de Castilhos&quot;</span></a>
<a class="sourceLine" id="cb253-27" title="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-28" title="28"><span class="co">#&gt; [[2]]$dados</span></a>
<a class="sourceLine" id="cb253-29" title="29"><span class="co">#&gt;        tar prec</span></a>
<a class="sourceLine" id="cb253-30" title="30"><span class="co">#&gt; [1,] 22.50  360</span></a>
<a class="sourceLine" id="cb253-31" title="31"><span class="co">#&gt; [2,] 20.00  310</span></a>
<a class="sourceLine" id="cb253-32" title="32"><span class="co">#&gt; [3,] 18.75  285</span></a>
<a class="sourceLine" id="cb253-33" title="33"><span class="co">#&gt; [4,] 18.00  270</span></a>
<a class="sourceLine" id="cb253-34" title="34"><span class="co">#&gt; [5,] 20.25  315</span></a>
<a class="sourceLine" id="cb253-35" title="35"><span class="co">#&gt; [6,] 17.75  265</span></a>
<a class="sourceLine" id="cb253-36" title="36"><span class="kw">names</span>(dados_l)</a>
<a class="sourceLine" id="cb253-37" title="37"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb253-38" title="38"><span class="kw">names</span>(dados_l) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sm&quot;</span>, <span class="st">&quot;jc&quot;</span>)</a>
<a class="sourceLine" id="cb253-39" title="39">dados_l</a>
<a class="sourceLine" id="cb253-40" title="40"><span class="co">#&gt; $sm</span></a>
<a class="sourceLine" id="cb253-41" title="41"><span class="co">#&gt; $sm$coords</span></a>
<a class="sourceLine" id="cb253-42" title="42"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb253-43" title="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-44" title="44"><span class="co">#&gt; $sm$cidade</span></a>
<a class="sourceLine" id="cb253-45" title="45"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb253-46" title="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-47" title="47"><span class="co">#&gt; $sm$dados</span></a>
<a class="sourceLine" id="cb253-48" title="48"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb253-49" title="49"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb253-50" title="50"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb253-51" title="51"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb253-52" title="52"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb253-53" title="53"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb253-54" title="54"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb253-55" title="55"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-56" title="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-57" title="57"><span class="co">#&gt; $jc</span></a>
<a class="sourceLine" id="cb253-58" title="58"><span class="co">#&gt; $jc$coords</span></a>
<a class="sourceLine" id="cb253-59" title="59"><span class="co">#&gt; [1] -45.1 -23.2</span></a>
<a class="sourceLine" id="cb253-60" title="60"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-61" title="61"><span class="co">#&gt; $jc$cidade</span></a>
<a class="sourceLine" id="cb253-62" title="62"><span class="co">#&gt; [1] &quot;Júlio de Castilhos&quot;</span></a>
<a class="sourceLine" id="cb253-63" title="63"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb253-64" title="64"><span class="co">#&gt; $jc$dados</span></a>
<a class="sourceLine" id="cb253-65" title="65"><span class="co">#&gt;        tar prec</span></a>
<a class="sourceLine" id="cb253-66" title="66"><span class="co">#&gt; [1,] 22.50  360</span></a>
<a class="sourceLine" id="cb253-67" title="67"><span class="co">#&gt; [2,] 20.00  310</span></a>
<a class="sourceLine" id="cb253-68" title="68"><span class="co">#&gt; [3,] 18.75  285</span></a>
<a class="sourceLine" id="cb253-69" title="69"><span class="co">#&gt; [4,] 18.00  270</span></a>
<a class="sourceLine" id="cb253-70" title="70"><span class="co">#&gt; [5,] 20.25  315</span></a>
<a class="sourceLine" id="cb253-71" title="71"><span class="co">#&gt; [6,] 17.75  265</span></a>
<a class="sourceLine" id="cb253-72" title="72"><span class="co"># como a lista é um tipo vetor, a função length()</span></a>
<a class="sourceLine" id="cb253-73" title="73"><span class="co"># fornece o número de elementos da lista</span></a>
<a class="sourceLine" id="cb253-74" title="74"><span class="kw">length</span>(dados_l)</a>
<a class="sourceLine" id="cb253-75" title="75"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<p>Para resumir a estrutura de uma lista (ou <em>dataframe</em>) podemos usar a função <code>str()</code>:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" title="1"><span class="kw">str</span>(dados_l)</a>
<a class="sourceLine" id="cb254-2" title="2"><span class="co">#&gt; List of 2</span></a>
<a class="sourceLine" id="cb254-3" title="3"><span class="co">#&gt;  $ sm:List of 3</span></a>
<a class="sourceLine" id="cb254-4" title="4"><span class="co">#&gt;   ..$ coords: num [1:2] -45 -23</span></a>
<a class="sourceLine" id="cb254-5" title="5"><span class="co">#&gt;   ..$ cidade: chr &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb254-6" title="6"><span class="co">#&gt;   ..$ dados : num [1:6, 1:2] 31 35 21 23 33 17 300 200 150 120 ...</span></a>
<a class="sourceLine" id="cb254-7" title="7"><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></a>
<a class="sourceLine" id="cb254-8" title="8"><span class="co">#&gt;   .. .. ..$ : NULL</span></a>
<a class="sourceLine" id="cb254-9" title="9"><span class="co">#&gt;   .. .. ..$ : chr [1:2] &quot;tar&quot; &quot;prec&quot;</span></a>
<a class="sourceLine" id="cb254-10" title="10"><span class="co">#&gt;  $ jc:List of 3</span></a>
<a class="sourceLine" id="cb254-11" title="11"><span class="co">#&gt;   ..$ coords: num [1:2] -45.1 -23.2</span></a>
<a class="sourceLine" id="cb254-12" title="12"><span class="co">#&gt;   ..$ cidade: chr &quot;Júlio de Castilhos&quot;</span></a>
<a class="sourceLine" id="cb254-13" title="13"><span class="co">#&gt;   ..$ dados : num [1:6, 1:2] 22.5 20 18.8 18 20.2 ...</span></a>
<a class="sourceLine" id="cb254-14" title="14"><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></a>
<a class="sourceLine" id="cb254-15" title="15"><span class="co">#&gt;   .. .. ..$ : NULL</span></a>
<a class="sourceLine" id="cb254-16" title="16"><span class="co">#&gt;   .. .. ..$ : chr [1:2] &quot;tar&quot; &quot;prec&quot;</span></a></code></pre></div>
<p>As listas também poderiam ser combinadas com função concatena ou combina <code>c()</code>.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" title="1">dados_l2 &lt;-<span class="st"> </span><span class="kw">c</span>(sm_l, jc_l)</a>
<a class="sourceLine" id="cb255-2" title="2">dados_l2</a>
<a class="sourceLine" id="cb255-3" title="3"><span class="co">#&gt; $coords</span></a>
<a class="sourceLine" id="cb255-4" title="4"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb255-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb255-6" title="6"><span class="co">#&gt; $cidade</span></a>
<a class="sourceLine" id="cb255-7" title="7"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb255-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb255-9" title="9"><span class="co">#&gt; $dados</span></a>
<a class="sourceLine" id="cb255-10" title="10"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb255-11" title="11"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb255-12" title="12"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb255-13" title="13"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb255-14" title="14"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb255-15" title="15"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb255-16" title="16"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb255-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb255-18" title="18"><span class="co">#&gt; $coords</span></a>
<a class="sourceLine" id="cb255-19" title="19"><span class="co">#&gt; [1] -45.1 -23.2</span></a>
<a class="sourceLine" id="cb255-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb255-21" title="21"><span class="co">#&gt; $cidade</span></a>
<a class="sourceLine" id="cb255-22" title="22"><span class="co">#&gt; [1] &quot;Júlio de Castilhos&quot;</span></a>
<a class="sourceLine" id="cb255-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb255-24" title="24"><span class="co">#&gt; $dados</span></a>
<a class="sourceLine" id="cb255-25" title="25"><span class="co">#&gt;        tar prec</span></a>
<a class="sourceLine" id="cb255-26" title="26"><span class="co">#&gt; [1,] 22.50  360</span></a>
<a class="sourceLine" id="cb255-27" title="27"><span class="co">#&gt; [2,] 20.00  310</span></a>
<a class="sourceLine" id="cb255-28" title="28"><span class="co">#&gt; [3,] 18.75  285</span></a>
<a class="sourceLine" id="cb255-29" title="29"><span class="co">#&gt; [4,] 18.00  270</span></a>
<a class="sourceLine" id="cb255-30" title="30"><span class="co">#&gt; [5,] 20.25  315</span></a>
<a class="sourceLine" id="cb255-31" title="31"><span class="co">#&gt; [6,] 17.75  265</span></a>
<a class="sourceLine" id="cb255-32" title="32"><span class="kw">str</span>(dados_l2)</a>
<a class="sourceLine" id="cb255-33" title="33"><span class="co">#&gt; List of 6</span></a>
<a class="sourceLine" id="cb255-34" title="34"><span class="co">#&gt;  $ coords: num [1:2] -45 -23</span></a>
<a class="sourceLine" id="cb255-35" title="35"><span class="co">#&gt;  $ cidade: chr &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb255-36" title="36"><span class="co">#&gt;  $ dados : num [1:6, 1:2] 31 35 21 23 33 17 300 200 150 120 ...</span></a>
<a class="sourceLine" id="cb255-37" title="37"><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></a>
<a class="sourceLine" id="cb255-38" title="38"><span class="co">#&gt;   .. ..$ : NULL</span></a>
<a class="sourceLine" id="cb255-39" title="39"><span class="co">#&gt;   .. ..$ : chr [1:2] &quot;tar&quot; &quot;prec&quot;</span></a>
<a class="sourceLine" id="cb255-40" title="40"><span class="co">#&gt;  $ coords: num [1:2] -45.1 -23.2</span></a>
<a class="sourceLine" id="cb255-41" title="41"><span class="co">#&gt;  $ cidade: chr &quot;Júlio de Castilhos&quot;</span></a>
<a class="sourceLine" id="cb255-42" title="42"><span class="co">#&gt;  $ dados : num [1:6, 1:2] 22.5 20 18.8 18 20.2 ...</span></a>
<a class="sourceLine" id="cb255-43" title="43"><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></a>
<a class="sourceLine" id="cb255-44" title="44"><span class="co">#&gt;   .. ..$ : NULL</span></a>
<a class="sourceLine" id="cb255-45" title="45"><span class="co">#&gt;   .. ..$ : chr [1:2] &quot;tar&quot; &quot;prec&quot;</span></a></code></pre></div>
</div>
<div id="indexação-1" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Indexação</h3>
<div id="operador" class="section level4">
<h4><span class="header-section-number">8.3.2.1</span> Operador <code>[</code></h4>
<p>Assim como em vetores, podemos acessar os elementos de uma lista usando os colchetes <code>[</code> com índices numéricos positivos, negativos, caracteres (nomes dos elementos) e lógicos. As expressões abaixo, ilustram o uso dessas diferentes formas de seleção de elementos e produzem o mesmo resultado.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" title="1">sm_l[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb256-2" title="2"><span class="co">#&gt; $coords</span></a>
<a class="sourceLine" id="cb256-3" title="3"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb256-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb256-5" title="5"><span class="co">#&gt; $cidade</span></a>
<a class="sourceLine" id="cb256-6" title="6"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb256-7" title="7">sm_l[<span class="kw">c</span>(<span class="st">&quot;coords&quot;</span>, <span class="st">&quot;alt&quot;</span>)]</a>
<a class="sourceLine" id="cb256-8" title="8"><span class="co">#&gt; $coords</span></a>
<a class="sourceLine" id="cb256-9" title="9"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb256-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb256-11" title="11"><span class="co">#&gt; $&lt;NA&gt;</span></a>
<a class="sourceLine" id="cb256-12" title="12"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>O resultado da seleção do 1º e 2º elemento é uma lista menor que a original. Isso não é muito útil, uma vez que muitas funções do R não lidam com listas. Por exemplo, se quiséssemos calcular a soma do vetor contido do primeiro elemento da lista <code>lst</code> obtém-se um erro.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" title="1"><span class="co"># seleção do 1º elemento da lst</span></a>
<a class="sourceLine" id="cb257-2" title="2">lst[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb257-3" title="3"><span class="co">#&gt; $vetor_int</span></a>
<a class="sourceLine" id="cb257-4" title="4"><span class="co">#&gt; [1] 1 2 3 4</span></a>
<a class="sourceLine" id="cb257-5" title="5"><span class="co"># o resultado da seleção é uma lista</span></a>
<a class="sourceLine" id="cb257-6" title="6"><span class="kw">mode</span>(lst[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb257-7" title="7"><span class="co">#&gt; [1] &quot;list&quot;</span></a>
<a class="sourceLine" id="cb257-8" title="8"><span class="co"># a função sum() espera como entrada um vetor</span></a>
<a class="sourceLine" id="cb257-9" title="9"><span class="kw">sum</span>(lst[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb257-10" title="10"><span class="co">#&gt; Error in sum(lst[1]): &#39;type&#39; inválido (list) do argumento</span></a>
<a class="sourceLine" id="cb257-11" title="11"><span class="co"># acessando elemento inexistente</span></a>
<a class="sourceLine" id="cb257-12" title="12">lst[<span class="dv">6</span>]</a>
<a class="sourceLine" id="cb257-13" title="13"><span class="co">#&gt; $&lt;NA&gt;</span></a>
<a class="sourceLine" id="cb257-14" title="14"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>Então ao selecionar elementos de uma lista com o operador <code>[</code> o resultado preserva a estrutura original do objeto. <code>lst</code> é uma lista e o resultado da seleção <code>lst[1]</code> também é uma lista.
<strong>Portanto, a seleção de elementos com o operador <code>[</code> preserva a estrutura do objeto original</strong>.</p>
</div>
<div id="operador-e" class="section level4">
<h4><span class="header-section-number">8.3.2.2</span> Operador <code>[[</code> e <code>$</code></h4>
<p>Entretanto na maioria das vezes estamos interessados no conteúdo dos elementos de uma lista. Para fazer isso há dois operadores: o duplo colchetes <code>[[</code> e o <code>$</code>. Para acessar elementos individuais de uma lista usamos o duplo colchetes <code>[[</code> especificando o número do elemento ou o nome. Essa forma de seleção de dados permite o acesso a um elemento por vez.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" title="1"><span class="co"># 1º elemento de sm_l</span></a>
<a class="sourceLine" id="cb258-2" title="2">sm_l[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb258-3" title="3"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb258-4" title="4">sm_l[[<span class="st">&quot;coords&quot;</span>]]</a>
<a class="sourceLine" id="cb258-5" title="5"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb258-6" title="6"><span class="co"># modo de sm_l</span></a>
<a class="sourceLine" id="cb258-7" title="7"><span class="kw">mode</span>(sm_l)</a>
<a class="sourceLine" id="cb258-8" title="8"><span class="co">#&gt; [1] &quot;list&quot;</span></a>
<a class="sourceLine" id="cb258-9" title="9"><span class="co"># ultimo elemento de sm_l</span></a>
<a class="sourceLine" id="cb258-10" title="10">sm_l[[<span class="kw">length</span>(sm_l)]]</a>
<a class="sourceLine" id="cb258-11" title="11"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb258-12" title="12"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb258-13" title="13"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb258-14" title="14"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb258-15" title="15"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb258-16" title="16"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb258-17" title="17"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb258-18" title="18">sm_l[[<span class="st">&quot;dados&quot;</span>]]</a>
<a class="sourceLine" id="cb258-19" title="19"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb258-20" title="20"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb258-21" title="21"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb258-22" title="22"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb258-23" title="23"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb258-24" title="24"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb258-25" title="25"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb258-26" title="26"><span class="co"># subelementos</span></a>
<a class="sourceLine" id="cb258-27" title="27">dados_l[[<span class="st">&quot;sm&quot;</span>]][[<span class="st">&quot;cidade&quot;</span>]]</a>
<a class="sourceLine" id="cb258-28" title="28"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a></code></pre></div>
<p>Para acessar o conteúdo de elementos de uma lista que possui nomes podemos também usar o operador <code>$</code>. Ele funciona de forma similar ao duplo colchetes usado com o nome do elemento da lista. Mas esse operador tem duas vantagens: a IDE RStudio autocompleta o nome do elemento (usando a tecla <code>&lt;tab&gt;</code>) e o R aceita o nome parcial dos nomes dos elementos.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" title="1"><span class="co"># seleção de dados por nomes usando o símbolo $</span></a>
<a class="sourceLine" id="cb259-2" title="2">dados_l<span class="op">$</span>s</a>
<a class="sourceLine" id="cb259-3" title="3"><span class="co">#&gt; $coords</span></a>
<a class="sourceLine" id="cb259-4" title="4"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb259-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb259-6" title="6"><span class="co">#&gt; $cidade</span></a>
<a class="sourceLine" id="cb259-7" title="7"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb259-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb259-9" title="9"><span class="co">#&gt; $dados</span></a>
<a class="sourceLine" id="cb259-10" title="10"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb259-11" title="11"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb259-12" title="12"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb259-13" title="13"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb259-14" title="14"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb259-15" title="15"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb259-16" title="16"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb259-17" title="17">dados_l<span class="op">$</span>j</a>
<a class="sourceLine" id="cb259-18" title="18"><span class="co">#&gt; $coords</span></a>
<a class="sourceLine" id="cb259-19" title="19"><span class="co">#&gt; [1] -45.1 -23.2</span></a>
<a class="sourceLine" id="cb259-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb259-21" title="21"><span class="co">#&gt; $cidade</span></a>
<a class="sourceLine" id="cb259-22" title="22"><span class="co">#&gt; [1] &quot;Júlio de Castilhos&quot;</span></a>
<a class="sourceLine" id="cb259-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb259-24" title="24"><span class="co">#&gt; $dados</span></a>
<a class="sourceLine" id="cb259-25" title="25"><span class="co">#&gt;        tar prec</span></a>
<a class="sourceLine" id="cb259-26" title="26"><span class="co">#&gt; [1,] 22.50  360</span></a>
<a class="sourceLine" id="cb259-27" title="27"><span class="co">#&gt; [2,] 20.00  310</span></a>
<a class="sourceLine" id="cb259-28" title="28"><span class="co">#&gt; [3,] 18.75  285</span></a>
<a class="sourceLine" id="cb259-29" title="29"><span class="co">#&gt; [4,] 18.00  270</span></a>
<a class="sourceLine" id="cb259-30" title="30"><span class="co">#&gt; [5,] 20.25  315</span></a>
<a class="sourceLine" id="cb259-31" title="31"><span class="co">#&gt; [6,] 17.75  265</span></a>
<a class="sourceLine" id="cb259-32" title="32">dados_l<span class="op">$</span>sm<span class="op">$</span>dados</a>
<a class="sourceLine" id="cb259-33" title="33"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb259-34" title="34"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb259-35" title="35"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb259-36" title="36"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb259-37" title="37"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb259-38" title="38"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb259-39" title="39"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb259-40" title="40">dados_l<span class="op">$</span>sm<span class="op">$</span>dados[<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb259-41" title="41"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb259-42" title="42"><span class="co">#&gt; [1,]  21  150</span></a>
<a class="sourceLine" id="cb259-43" title="43"><span class="co">#&gt; [2,]  23  120</span></a>
<a class="sourceLine" id="cb259-44" title="44"><span class="co">#&gt; [3,]  33  210</span></a>
<a class="sourceLine" id="cb259-45" title="45">dados_l<span class="op">$</span>sm<span class="op">$</span>dados[, <span class="st">&quot;tar&quot;</span>]</a>
<a class="sourceLine" id="cb259-46" title="46"><span class="co">#&gt; [1] 31 35 21 23 33 17</span></a>
<a class="sourceLine" id="cb259-47" title="47">dados_l<span class="op">$</span>sm<span class="op">$</span>dados[, <span class="st">&quot;tar&quot;</span>, drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb259-48" title="48"><span class="co">#&gt;      tar</span></a>
<a class="sourceLine" id="cb259-49" title="49"><span class="co">#&gt; [1,]  31</span></a>
<a class="sourceLine" id="cb259-50" title="50"><span class="co">#&gt; [2,]  35</span></a>
<a class="sourceLine" id="cb259-51" title="51"><span class="co">#&gt; [3,]  21</span></a>
<a class="sourceLine" id="cb259-52" title="52"><span class="co">#&gt; [4,]  23</span></a>
<a class="sourceLine" id="cb259-53" title="53"><span class="co">#&gt; [5,]  33</span></a>
<a class="sourceLine" id="cb259-54" title="54"><span class="co">#&gt; [6,]  17</span></a></code></pre></div>
</div>
<div id="lista-de-condimentos" class="section level4">
<h4><span class="header-section-number">8.3.2.3</span> Lista de condimentos</h4>
<p>É fácil de confundir quando usar <code>]</code> e <code>]]</code>. A tabela abaixo ajuda lembrar da diferença entre eles.</p>
<table>
<colgroup>
<col width="41%" />
<col width="24%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">descriÃ§Ã£o</th>
<th align="center">cÃ³digo</th>
<th align="center">resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">frasco de pimenta</td>
<td align="center">frasco</td>
<td align="center"><img src="images/pepper.jpg" /></td>
</tr>
<tr class="even">
<td align="center">frasco de pimenta com apenas 1
pacote de pimenta</td>
<td align="center">frasco[1]</td>
<td align="center"><img src="images/pepper-1.jpg" /></td>
</tr>
<tr class="odd">
<td align="center">1 pacote de pimenta</td>
<td align="center">frasco[[1]]</td>
<td align="center"><img src="images/pepper-2.jpg" /></td>
</tr>
<tr class="even">
<td align="center">conteÃºdo de um pacote de
pimenta</td>
<td align="center">frasco[[1]][[1]]</td>
<td align="center"><img src="images/pepper-3.jpg" /></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="conversão-de-lista-para-vetor-e-vice-versa." class="section level3">
<h3><span class="header-section-number">8.3.3</span> Conversão de lista para vetor e vice-versa.</h3>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" title="1">vet &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb260-2" title="2">vet</a>
<a class="sourceLine" id="cb260-3" title="3"><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></a>
<a class="sourceLine" id="cb260-4" title="4">vet.list &lt;-<span class="st"> </span><span class="kw">as.list</span>(vet)</a>
<a class="sourceLine" id="cb260-5" title="5">vet.list</a>
<a class="sourceLine" id="cb260-6" title="6"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb260-7" title="7"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb260-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-9" title="9"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb260-10" title="10"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb260-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-12" title="12"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb260-13" title="13"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb260-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-15" title="15"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb260-16" title="16"><span class="co">#&gt; [1] 4</span></a>
<a class="sourceLine" id="cb260-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-18" title="18"><span class="co">#&gt; [[5]]</span></a>
<a class="sourceLine" id="cb260-19" title="19"><span class="co">#&gt; [1] 5</span></a>
<a class="sourceLine" id="cb260-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-21" title="21"><span class="co">#&gt; [[6]]</span></a>
<a class="sourceLine" id="cb260-22" title="22"><span class="co">#&gt; [1] 6</span></a>
<a class="sourceLine" id="cb260-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-24" title="24"><span class="co">#&gt; [[7]]</span></a>
<a class="sourceLine" id="cb260-25" title="25"><span class="co">#&gt; [1] 7</span></a>
<a class="sourceLine" id="cb260-26" title="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-27" title="27"><span class="co">#&gt; [[8]]</span></a>
<a class="sourceLine" id="cb260-28" title="28"><span class="co">#&gt; [1] 8</span></a>
<a class="sourceLine" id="cb260-29" title="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-30" title="30"><span class="co">#&gt; [[9]]</span></a>
<a class="sourceLine" id="cb260-31" title="31"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb260-32" title="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-33" title="33"><span class="co">#&gt; [[10]]</span></a>
<a class="sourceLine" id="cb260-34" title="34"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb260-35" title="35"><span class="co"># desmanchando a lista</span></a>
<a class="sourceLine" id="cb260-36" title="36"><span class="kw">unlist</span>(vet.list)</a>
<a class="sourceLine" id="cb260-37" title="37"><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></a>
<a class="sourceLine" id="cb260-38" title="38"><span class="co"># deletando um elemento de uma lista</span></a>
<a class="sourceLine" id="cb260-39" title="39"><span class="kw">length</span>(vet.list)</a>
<a class="sourceLine" id="cb260-40" title="40"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb260-41" title="41">vet.list[<span class="dv">8</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb260-42" title="42">vet.list</a>
<a class="sourceLine" id="cb260-43" title="43"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb260-44" title="44"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb260-45" title="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-46" title="46"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb260-47" title="47"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb260-48" title="48"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-49" title="49"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb260-50" title="50"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb260-51" title="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-52" title="52"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb260-53" title="53"><span class="co">#&gt; [1] 4</span></a>
<a class="sourceLine" id="cb260-54" title="54"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-55" title="55"><span class="co">#&gt; [[5]]</span></a>
<a class="sourceLine" id="cb260-56" title="56"><span class="co">#&gt; [1] 5</span></a>
<a class="sourceLine" id="cb260-57" title="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-58" title="58"><span class="co">#&gt; [[6]]</span></a>
<a class="sourceLine" id="cb260-59" title="59"><span class="co">#&gt; [1] 6</span></a>
<a class="sourceLine" id="cb260-60" title="60"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-61" title="61"><span class="co">#&gt; [[7]]</span></a>
<a class="sourceLine" id="cb260-62" title="62"><span class="co">#&gt; [1] 7</span></a>
<a class="sourceLine" id="cb260-63" title="63"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-64" title="64"><span class="co">#&gt; [[8]]</span></a>
<a class="sourceLine" id="cb260-65" title="65"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb260-66" title="66"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb260-67" title="67"><span class="co">#&gt; [[9]]</span></a>
<a class="sourceLine" id="cb260-68" title="68"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb260-69" title="69"><span class="kw">length</span>(vet.list)</a>
<a class="sourceLine" id="cb260-70" title="70"><span class="co">#&gt; [1] 9</span></a></code></pre></div>
</div>
<div id="conversão-de-list-para-data.frame" class="section level3">
<h3><span class="header-section-number">8.3.4</span> Conversão de <code>list</code> para <code>data.frame</code></h3>
<p>Vamos modificar a lista <code>sm_l</code> para convertê-la em um <em>dataframe</em>.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" title="1">sm_l</a>
<a class="sourceLine" id="cb261-2" title="2"><span class="co">#&gt; $coords</span></a>
<a class="sourceLine" id="cb261-3" title="3"><span class="co">#&gt; [1] -45 -23</span></a>
<a class="sourceLine" id="cb261-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb261-5" title="5"><span class="co">#&gt; $cidade</span></a>
<a class="sourceLine" id="cb261-6" title="6"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb261-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb261-8" title="8"><span class="co">#&gt; $dados</span></a>
<a class="sourceLine" id="cb261-9" title="9"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb261-10" title="10"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb261-11" title="11"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb261-12" title="12"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb261-13" title="13"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb261-14" title="14"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb261-15" title="15"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb261-16" title="16"><span class="co"># ao invés da componente coords, criamos uma lon e lat</span></a>
<a class="sourceLine" id="cb261-17" title="17">sm_l<span class="op">$</span>lon &lt;-<span class="st"> </span>sm_l<span class="op">$</span>coords[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb261-18" title="18">sm_l<span class="op">$</span>lat &lt;-<span class="st"> </span>sm_l<span class="op">$</span>coords[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb261-19" title="19">sm_l<span class="op">$</span>coords &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb261-20" title="20">sm_l</a>
<a class="sourceLine" id="cb261-21" title="21"><span class="co">#&gt; $cidade</span></a>
<a class="sourceLine" id="cb261-22" title="22"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb261-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb261-24" title="24"><span class="co">#&gt; $dados</span></a>
<a class="sourceLine" id="cb261-25" title="25"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb261-26" title="26"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb261-27" title="27"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb261-28" title="28"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb261-29" title="29"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb261-30" title="30"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb261-31" title="31"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb261-32" title="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb261-33" title="33"><span class="co">#&gt; $lon</span></a>
<a class="sourceLine" id="cb261-34" title="34"><span class="co">#&gt; [1] -45</span></a>
<a class="sourceLine" id="cb261-35" title="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb261-36" title="36"><span class="co">#&gt; $lat</span></a>
<a class="sourceLine" id="cb261-37" title="37"><span class="co">#&gt; [1] -23</span></a>
<a class="sourceLine" id="cb261-38" title="38"><span class="co"># converter para dataframe</span></a>
<a class="sourceLine" id="cb261-39" title="39">sm_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sm_l)</a>
<a class="sourceLine" id="cb261-40" title="40">sm_df</a>
<a class="sourceLine" id="cb261-41" title="41"><span class="co">#&gt;        cidade dados.tar dados.prec lon lat</span></a>
<a class="sourceLine" id="cb261-42" title="42"><span class="co">#&gt; 1 Santa Maria        31        300 -45 -23</span></a>
<a class="sourceLine" id="cb261-43" title="43"><span class="co">#&gt; 2 Santa Maria        35        200 -45 -23</span></a>
<a class="sourceLine" id="cb261-44" title="44"><span class="co">#&gt; 3 Santa Maria        21        150 -45 -23</span></a>
<a class="sourceLine" id="cb261-45" title="45"><span class="co">#&gt; 4 Santa Maria        23        120 -45 -23</span></a>
<a class="sourceLine" id="cb261-46" title="46"><span class="co">#&gt; 5 Santa Maria        33        210 -45 -23</span></a>
<a class="sourceLine" id="cb261-47" title="47"><span class="co">#&gt; 6 Santa Maria        17        110 -45 -23</span></a></code></pre></div>
</div>
</div>
<div id="dataframe" class="section level2">
<h2><span class="header-section-number">8.4</span> Dataframe</h2>
<p>Um dataframe é o objeto mais usado para guardar conjunto de dados na forma de tabela (tabulares ou planos).</p>
<p>A estrutura de um <em>dataframe</em> é retangular como a de uma matriz. Mas tem a vantagem de armazenar vetores de diferentes tipos (<code>character</code>, <code>numeric</code>, <code>logical</code> e etc) nas suas colunas. O que não é possível em uma matriz. Ou seja é uma estrutura de armazenamento de dados heterogênea. <em>Matrix</em>, <em>arrays</em> e <em>vector</em> só armazenam dados homogêneos.</p>
<p>Cada linha do <em>dataframe</em> corresponde a um registro da tabela. Cada coluna corresponde a uma variável a ser armazenada para cada registro da tabela.</p>
<div id="criação-2" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Criação</h3>
<p>Uma das formas mais simples de se criar um <em>dataframe</em> é através da função <code>data.frame()</code>.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" title="1"><span class="co"># criando um dataframe</span></a>
<a class="sourceLine" id="cb262-2" title="2">dados &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb262-3" title="3">  <span class="dt">datas =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb262-4" title="4">    <span class="st">&quot;2013-01-01&quot;</span>, <span class="st">&quot;2013-01-02&quot;</span>, <span class="st">&quot;2013-01-03&quot;</span>, <span class="st">&quot;2013-01-04&quot;</span>, <span class="st">&quot;2013-01-05&quot;</span>,</a>
<a class="sourceLine" id="cb262-5" title="5">    <span class="st">&quot;2013-01-06&quot;</span>, <span class="st">&quot;2013-01-07&quot;</span>, <span class="st">&quot;2013-01-08&quot;</span>, <span class="st">&quot;2013-01-09&quot;</span>, <span class="st">&quot;2013-01-10&quot;</span>,</a>
<a class="sourceLine" id="cb262-6" title="6">    <span class="st">&quot;2013-01-11&quot;</span>, <span class="st">&quot;2013-01-12&quot;</span>, <span class="st">&quot;2013-01-13&quot;</span>, <span class="st">&quot;2013-01-14&quot;</span>, <span class="st">&quot;2013-01-15&quot;</span></a>
<a class="sourceLine" id="cb262-7" title="7">  ),</a>
<a class="sourceLine" id="cb262-8" title="8">  <span class="dt">cidade =</span> <span class="kw">rep</span>(<span class="st">&quot;Santa Maria&quot;</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb262-9" title="9">  <span class="dt">tar =</span> <span class="kw">c</span>(<span class="dv">31</span>, <span class="dv">35</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">33</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">34</span>, <span class="dv">27</span>, <span class="dv">15</span>, <span class="dv">28</span>, <span class="dv">22</span>, <span class="dv">29</span>, <span class="dv">32</span>)</a>
<a class="sourceLine" id="cb262-10" title="10">)</a>
<a class="sourceLine" id="cb262-11" title="11">dados</a>
<a class="sourceLine" id="cb262-12" title="12"><span class="co">#&gt;         datas      cidade tar</span></a>
<a class="sourceLine" id="cb262-13" title="13"><span class="co">#&gt; 1  2013-01-01 Santa Maria  31</span></a>
<a class="sourceLine" id="cb262-14" title="14"><span class="co">#&gt; 2  2013-01-02 Santa Maria  35</span></a>
<a class="sourceLine" id="cb262-15" title="15"><span class="co">#&gt; 3  2013-01-03 Santa Maria  21</span></a>
<a class="sourceLine" id="cb262-16" title="16"><span class="co">#&gt; 4  2013-01-04 Santa Maria  23</span></a>
<a class="sourceLine" id="cb262-17" title="17"><span class="co">#&gt; 5  2013-01-05 Santa Maria  33</span></a>
<a class="sourceLine" id="cb262-18" title="18"><span class="co">#&gt; 6  2013-01-06 Santa Maria  17</span></a>
<a class="sourceLine" id="cb262-19" title="19"><span class="co">#&gt; 7  2013-01-07 Santa Maria  18</span></a>
<a class="sourceLine" id="cb262-20" title="20"><span class="co">#&gt; 8  2013-01-08 Santa Maria  16</span></a>
<a class="sourceLine" id="cb262-21" title="21"><span class="co">#&gt; 9  2013-01-09 Santa Maria  34</span></a>
<a class="sourceLine" id="cb262-22" title="22"><span class="co">#&gt; 10 2013-01-10 Santa Maria  27</span></a>
<a class="sourceLine" id="cb262-23" title="23"><span class="co">#&gt; 11 2013-01-11 Santa Maria  15</span></a>
<a class="sourceLine" id="cb262-24" title="24"><span class="co">#&gt; 12 2013-01-12 Santa Maria  28</span></a>
<a class="sourceLine" id="cb262-25" title="25"><span class="co">#&gt; 13 2013-01-13 Santa Maria  22</span></a>
<a class="sourceLine" id="cb262-26" title="26"><span class="co">#&gt; 14 2013-01-14 Santa Maria  29</span></a>
<a class="sourceLine" id="cb262-27" title="27"><span class="co">#&gt; 15 2013-01-15 Santa Maria  32</span></a>
<a class="sourceLine" id="cb262-28" title="28"><span class="kw">class</span>(dados)</a>
<a class="sourceLine" id="cb262-29" title="29"><span class="co">#&gt; [1] &quot;data.frame&quot;</span></a>
<a class="sourceLine" id="cb262-30" title="30"><span class="kw">is.data.frame</span>(dados)</a>
<a class="sourceLine" id="cb262-31" title="31"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Para um diagnóstico rápido das variáveis de um <code>dataframe</code> usamos a função <code>str()</code>:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" title="1"><span class="co"># descrição geral do conjunto de dados</span></a>
<a class="sourceLine" id="cb263-2" title="2"><span class="kw">str</span>(dados)</a>
<a class="sourceLine" id="cb263-3" title="3"><span class="co">#&gt; &#39;data.frame&#39;:    15 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb263-4" title="4"><span class="co">#&gt;  $ datas : Factor w/ 15 levels &quot;2013-01-01&quot;,&quot;2013-01-02&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...</span></a>
<a class="sourceLine" id="cb263-5" title="5"><span class="co">#&gt;  $ cidade: Factor w/ 1 level &quot;Santa Maria&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb263-6" title="6"><span class="co">#&gt;  $ tar   : num  31 35 21 23 33 17 18 16 34 27 ...</span></a></code></pre></div>
<p>A saída da função <code>str()</code>indica que há duas variáveis da classe <code>factor</code>.
Em um <em>dataframe</em> vetores do tipo <code>character</code> são automaticamente convertidos em <code>factor</code>. Este é o comportamento <em>default</em> da função <code>data.frame()</code>. Para desabilitar essa conversão você precisa definir o parâmetro <code>stringsAsFactors = FALSE</code> na função <code>data.frame()</code>. Vamos recriar o <em>dataframe</em> <code>dados</code> sem a conversão de <code>character</code> para <code>factor</code>.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" title="1"><span class="co"># criando um dataframe</span></a>
<a class="sourceLine" id="cb264-2" title="2">dados &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb264-3" title="3">  <span class="dt">datas =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb264-4" title="4">    <span class="st">&quot;2013-01-01&quot;</span>, <span class="st">&quot;2013-01-02&quot;</span>, <span class="st">&quot;2013-01-03&quot;</span>, <span class="st">&quot;2013-01-04&quot;</span>, <span class="st">&quot;2013-01-05&quot;</span>,</a>
<a class="sourceLine" id="cb264-5" title="5">    <span class="st">&quot;2013-01-06&quot;</span>, <span class="st">&quot;2013-01-07&quot;</span>, <span class="st">&quot;2013-01-08&quot;</span>, <span class="st">&quot;2013-01-09&quot;</span>, <span class="st">&quot;2013-01-10&quot;</span>,</a>
<a class="sourceLine" id="cb264-6" title="6">    <span class="st">&quot;2013-01-11&quot;</span>, <span class="st">&quot;2013-01-12&quot;</span>, <span class="st">&quot;2013-01-13&quot;</span>, <span class="st">&quot;2013-01-14&quot;</span>, <span class="st">&quot;2013-01-15&quot;</span></a>
<a class="sourceLine" id="cb264-7" title="7">  ),</a>
<a class="sourceLine" id="cb264-8" title="8">  <span class="dt">cidade =</span> <span class="kw">rep</span>(<span class="st">&quot;Santa Maria&quot;</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb264-9" title="9">  <span class="dt">tar =</span> <span class="kw">c</span>(<span class="dv">31</span>, <span class="dv">35</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">33</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">34</span>, <span class="dv">27</span>, <span class="dv">15</span>, <span class="dv">28</span>, <span class="dv">22</span>, <span class="dv">29</span>, <span class="dv">32</span>),</a>
<a class="sourceLine" id="cb264-10" title="10">  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb264-11" title="11">)</a>
<a class="sourceLine" id="cb264-12" title="12"><span class="kw">str</span>(dados)</a>
<a class="sourceLine" id="cb264-13" title="13"><span class="co">#&gt; &#39;data.frame&#39;:    15 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb264-14" title="14"><span class="co">#&gt;  $ datas : chr  &quot;2013-01-01&quot; &quot;2013-01-02&quot; &quot;2013-01-03&quot; &quot;2013-01-04&quot; ...</span></a>
<a class="sourceLine" id="cb264-15" title="15"><span class="co">#&gt;  $ cidade: chr  &quot;Santa Maria&quot; &quot;Santa Maria&quot; &quot;Santa Maria&quot; &quot;Santa Maria&quot; ...</span></a>
<a class="sourceLine" id="cb264-16" title="16"><span class="co">#&gt;  $ tar   : num  31 35 21 23 33 17 18 16 34 27 ...</span></a></code></pre></div>
<p>A função <code>summary()</code> fornece um resumo estatístico das variáveis (colunas) de um <em>dataframe</em>.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" title="1"><span class="co"># resumo estatístico dos dados</span></a>
<a class="sourceLine" id="cb265-2" title="2"><span class="kw">summary</span>(dados)</a>
<a class="sourceLine" id="cb265-3" title="3"><span class="co">#&gt;     datas              cidade               tar      </span></a>
<a class="sourceLine" id="cb265-4" title="4"><span class="co">#&gt;  Length:15          Length:15          Min.   :15.0  </span></a>
<a class="sourceLine" id="cb265-5" title="5"><span class="co">#&gt;  Class :character   Class :character   1st Qu.:19.5  </span></a>
<a class="sourceLine" id="cb265-6" title="6"><span class="co">#&gt;  Mode  :character   Mode  :character   Median :27.0  </span></a>
<a class="sourceLine" id="cb265-7" title="7"><span class="co">#&gt;                                        Mean   :25.4  </span></a>
<a class="sourceLine" id="cb265-8" title="8"><span class="co">#&gt;                                        3rd Qu.:31.5  </span></a>
<a class="sourceLine" id="cb265-9" title="9"><span class="co">#&gt;                                        Max.   :35.0</span></a></code></pre></div>
</div>
<div id="atributos-de-um-dataframe" class="section level3">
<h3><span class="header-section-number">8.4.2</span> Atributos de um <em>dataframe</em></h3>
<p><em>dataframe</em> é uma estrutura de dados avançada e possui diversos atributos.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" title="1"><span class="co"># atributos</span></a>
<a class="sourceLine" id="cb266-2" title="2"><span class="kw">attributes</span>(dados)</a>
<a class="sourceLine" id="cb266-3" title="3"><span class="co">#&gt; $names</span></a>
<a class="sourceLine" id="cb266-4" title="4"><span class="co">#&gt; [1] &quot;datas&quot;  &quot;cidade&quot; &quot;tar&quot;   </span></a>
<a class="sourceLine" id="cb266-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb266-6" title="6"><span class="co">#&gt; $class</span></a>
<a class="sourceLine" id="cb266-7" title="7"><span class="co">#&gt; [1] &quot;data.frame&quot;</span></a>
<a class="sourceLine" id="cb266-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb266-9" title="9"><span class="co">#&gt; $row.names</span></a>
<a class="sourceLine" id="cb266-10" title="10"><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</span></a>
<a class="sourceLine" id="cb266-11" title="11"><span class="co"># atributos armazenados em uma lista</span></a>
<a class="sourceLine" id="cb266-12" title="12"><span class="kw">str</span>(<span class="kw">attributes</span>(dados))</a>
<a class="sourceLine" id="cb266-13" title="13"><span class="co">#&gt; List of 3</span></a>
<a class="sourceLine" id="cb266-14" title="14"><span class="co">#&gt;  $ names    : chr [1:3] &quot;datas&quot; &quot;cidade&quot; &quot;tar&quot;</span></a>
<a class="sourceLine" id="cb266-15" title="15"><span class="co">#&gt;  $ class    : chr &quot;data.frame&quot;</span></a>
<a class="sourceLine" id="cb266-16" title="16"><span class="co">#&gt;  $ row.names: int [1:15] 1 2 3 4 5 6 7 8 9 10 ...</span></a>
<a class="sourceLine" id="cb266-17" title="17"><span class="co"># número de colunas</span></a>
<a class="sourceLine" id="cb266-18" title="18"><span class="kw">ncol</span>(dados)</a>
<a class="sourceLine" id="cb266-19" title="19"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb266-20" title="20"><span class="co"># número de linhas</span></a>
<a class="sourceLine" id="cb266-21" title="21"><span class="kw">nrow</span>(dados)</a>
<a class="sourceLine" id="cb266-22" title="22"><span class="co">#&gt; [1] 15</span></a>
<a class="sourceLine" id="cb266-23" title="23"><span class="co"># dimensões</span></a>
<a class="sourceLine" id="cb266-24" title="24"><span class="kw">dim</span>(dados)</a>
<a class="sourceLine" id="cb266-25" title="25"><span class="co">#&gt; [1] 15  3</span></a>
<a class="sourceLine" id="cb266-26" title="26"><span class="co"># nomes podem ser atribuídos as linhas e as colunas</span></a>
<a class="sourceLine" id="cb266-27" title="27"><span class="kw">rownames</span>(dados)</a>
<a class="sourceLine" id="cb266-28" title="28"><span class="co">#&gt;  [1] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot; &quot;11&quot; &quot;12&quot; &quot;13&quot; &quot;14&quot; &quot;15&quot;</span></a>
<a class="sourceLine" id="cb266-29" title="29"><span class="co"># novos nomes para as linhas de dados</span></a>
<a class="sourceLine" id="cb266-30" title="30"><span class="kw">rownames</span>(dados) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;linha&quot;</span>, <span class="kw">rownames</span>(dados))</a>
<a class="sourceLine" id="cb266-31" title="31">dados</a>
<a class="sourceLine" id="cb266-32" title="32"><span class="co">#&gt;              datas      cidade tar</span></a>
<a class="sourceLine" id="cb266-33" title="33"><span class="co">#&gt; linha1  2013-01-01 Santa Maria  31</span></a>
<a class="sourceLine" id="cb266-34" title="34"><span class="co">#&gt; linha2  2013-01-02 Santa Maria  35</span></a>
<a class="sourceLine" id="cb266-35" title="35"><span class="co">#&gt; linha3  2013-01-03 Santa Maria  21</span></a>
<a class="sourceLine" id="cb266-36" title="36"><span class="co">#&gt; linha4  2013-01-04 Santa Maria  23</span></a>
<a class="sourceLine" id="cb266-37" title="37"><span class="co">#&gt; linha5  2013-01-05 Santa Maria  33</span></a>
<a class="sourceLine" id="cb266-38" title="38"><span class="co">#&gt; linha6  2013-01-06 Santa Maria  17</span></a>
<a class="sourceLine" id="cb266-39" title="39"><span class="co">#&gt; linha7  2013-01-07 Santa Maria  18</span></a>
<a class="sourceLine" id="cb266-40" title="40"><span class="co">#&gt; linha8  2013-01-08 Santa Maria  16</span></a>
<a class="sourceLine" id="cb266-41" title="41"><span class="co">#&gt; linha9  2013-01-09 Santa Maria  34</span></a>
<a class="sourceLine" id="cb266-42" title="42"><span class="co">#&gt; linha10 2013-01-10 Santa Maria  27</span></a>
<a class="sourceLine" id="cb266-43" title="43"><span class="co">#&gt; linha11 2013-01-11 Santa Maria  15</span></a>
<a class="sourceLine" id="cb266-44" title="44"><span class="co">#&gt; linha12 2013-01-12 Santa Maria  28</span></a>
<a class="sourceLine" id="cb266-45" title="45"><span class="co">#&gt; linha13 2013-01-13 Santa Maria  22</span></a>
<a class="sourceLine" id="cb266-46" title="46"><span class="co">#&gt; linha14 2013-01-14 Santa Maria  29</span></a>
<a class="sourceLine" id="cb266-47" title="47"><span class="co">#&gt; linha15 2013-01-15 Santa Maria  32</span></a>
<a class="sourceLine" id="cb266-48" title="48"><span class="co"># removendo nomes das linhas</span></a>
<a class="sourceLine" id="cb266-49" title="49"><span class="kw">rownames</span>(dados) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb266-50" title="50">dados</a>
<a class="sourceLine" id="cb266-51" title="51"><span class="co">#&gt;         datas      cidade tar</span></a>
<a class="sourceLine" id="cb266-52" title="52"><span class="co">#&gt; 1  2013-01-01 Santa Maria  31</span></a>
<a class="sourceLine" id="cb266-53" title="53"><span class="co">#&gt; 2  2013-01-02 Santa Maria  35</span></a>
<a class="sourceLine" id="cb266-54" title="54"><span class="co">#&gt; 3  2013-01-03 Santa Maria  21</span></a>
<a class="sourceLine" id="cb266-55" title="55"><span class="co">#&gt; 4  2013-01-04 Santa Maria  23</span></a>
<a class="sourceLine" id="cb266-56" title="56"><span class="co">#&gt; 5  2013-01-05 Santa Maria  33</span></a>
<a class="sourceLine" id="cb266-57" title="57"><span class="co">#&gt; 6  2013-01-06 Santa Maria  17</span></a>
<a class="sourceLine" id="cb266-58" title="58"><span class="co">#&gt; 7  2013-01-07 Santa Maria  18</span></a>
<a class="sourceLine" id="cb266-59" title="59"><span class="co">#&gt; 8  2013-01-08 Santa Maria  16</span></a>
<a class="sourceLine" id="cb266-60" title="60"><span class="co">#&gt; 9  2013-01-09 Santa Maria  34</span></a>
<a class="sourceLine" id="cb266-61" title="61"><span class="co">#&gt; 10 2013-01-10 Santa Maria  27</span></a>
<a class="sourceLine" id="cb266-62" title="62"><span class="co">#&gt; 11 2013-01-11 Santa Maria  15</span></a>
<a class="sourceLine" id="cb266-63" title="63"><span class="co">#&gt; 12 2013-01-12 Santa Maria  28</span></a>
<a class="sourceLine" id="cb266-64" title="64"><span class="co">#&gt; 13 2013-01-13 Santa Maria  22</span></a>
<a class="sourceLine" id="cb266-65" title="65"><span class="co">#&gt; 14 2013-01-14 Santa Maria  29</span></a>
<a class="sourceLine" id="cb266-66" title="66"><span class="co">#&gt; 15 2013-01-15 Santa Maria  32</span></a>
<a class="sourceLine" id="cb266-67" title="67"><span class="co"># mesmo que names(dados)</span></a>
<a class="sourceLine" id="cb266-68" title="68"><span class="kw">colnames</span>(dados)</a>
<a class="sourceLine" id="cb266-69" title="69"><span class="co">#&gt; [1] &quot;datas&quot;  &quot;cidade&quot; &quot;tar&quot;</span></a>
<a class="sourceLine" id="cb266-70" title="70"><span class="co"># ou simplesmente</span></a>
<a class="sourceLine" id="cb266-71" title="71"><span class="kw">names</span>(dados)</a>
<a class="sourceLine" id="cb266-72" title="72"><span class="co">#&gt; [1] &quot;datas&quot;  &quot;cidade&quot; &quot;tar&quot;</span></a></code></pre></div>
</div>
<div id="acesso-as-variáveis-de-um-dataframe" class="section level3">
<h3><span class="header-section-number">8.4.3</span> Acesso as variáveis de um <em>dataframe</em></h3>
<p>Existem várias formas de acessar as variáveis de um <em>dataframe</em>. Os operadores para extração de elementos são os mesmos utilizados para extração de elementos de uma lista: <code>[</code>, <code>[[</code> e <code>$</code>. Mas observe a diferença nos resultados extraídos com cada operador.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" title="1"><span class="co"># variáveis do dataframe</span></a>
<a class="sourceLine" id="cb267-2" title="2"><span class="kw">names</span>(dados)</a>
<a class="sourceLine" id="cb267-3" title="3"><span class="co">#&gt; [1] &quot;datas&quot;  &quot;cidade&quot; &quot;tar&quot;</span></a>
<a class="sourceLine" id="cb267-4" title="4"><span class="co"># acessando os dados de temperatura</span></a>
<a class="sourceLine" id="cb267-5" title="5">dados[, <span class="dv">3</span>]</a>
<a class="sourceLine" id="cb267-6" title="6"><span class="co">#&gt;  [1] 31 35 21 23 33 17 18 16 34 27 15 28 22 29 32</span></a>
<a class="sourceLine" id="cb267-7" title="7"><span class="co"># ou</span></a>
<a class="sourceLine" id="cb267-8" title="8">dados[, <span class="st">&quot;tar&quot;</span>]</a>
<a class="sourceLine" id="cb267-9" title="9"><span class="co">#&gt;  [1] 31 35 21 23 33 17 18 16 34 27 15 28 22 29 32</span></a>
<a class="sourceLine" id="cb267-10" title="10"><span class="co"># ou</span></a>
<a class="sourceLine" id="cb267-11" title="11">dados<span class="op">$</span>tar</a>
<a class="sourceLine" id="cb267-12" title="12"><span class="co">#&gt;  [1] 31 35 21 23 33 17 18 16 34 27 15 28 22 29 32</span></a>
<a class="sourceLine" id="cb267-13" title="13"><span class="kw">is.vector</span>(dados<span class="op">$</span>tar)</a>
<a class="sourceLine" id="cb267-14" title="14"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb267-15" title="15"><span class="co"># note a diferença no resultado da extração</span></a>
<a class="sourceLine" id="cb267-16" title="16">dados[<span class="st">&quot;tar&quot;</span>]</a>
<a class="sourceLine" id="cb267-17" title="17"><span class="co">#&gt;    tar</span></a>
<a class="sourceLine" id="cb267-18" title="18"><span class="co">#&gt; 1   31</span></a>
<a class="sourceLine" id="cb267-19" title="19"><span class="co">#&gt; 2   35</span></a>
<a class="sourceLine" id="cb267-20" title="20"><span class="co">#&gt; 3   21</span></a>
<a class="sourceLine" id="cb267-21" title="21"><span class="co">#&gt; 4   23</span></a>
<a class="sourceLine" id="cb267-22" title="22"><span class="co">#&gt; 5   33</span></a>
<a class="sourceLine" id="cb267-23" title="23"><span class="co">#&gt; 6   17</span></a>
<a class="sourceLine" id="cb267-24" title="24"><span class="co">#&gt; 7   18</span></a>
<a class="sourceLine" id="cb267-25" title="25"><span class="co">#&gt; 8   16</span></a>
<a class="sourceLine" id="cb267-26" title="26"><span class="co">#&gt; 9   34</span></a>
<a class="sourceLine" id="cb267-27" title="27"><span class="co">#&gt; 10  27</span></a>
<a class="sourceLine" id="cb267-28" title="28"><span class="co">#&gt; 11  15</span></a>
<a class="sourceLine" id="cb267-29" title="29"><span class="co">#&gt; 12  28</span></a>
<a class="sourceLine" id="cb267-30" title="30"><span class="co">#&gt; 13  22</span></a>
<a class="sourceLine" id="cb267-31" title="31"><span class="co">#&gt; 14  29</span></a>
<a class="sourceLine" id="cb267-32" title="32"><span class="co">#&gt; 15  32</span></a>
<a class="sourceLine" id="cb267-33" title="33"><span class="kw">class</span>(dados[<span class="st">&quot;tar&quot;</span>])</a>
<a class="sourceLine" id="cb267-34" title="34"><span class="co">#&gt; [1] &quot;data.frame&quot;</span></a>
<a class="sourceLine" id="cb267-35" title="35">dados[[<span class="st">&quot;tar&quot;</span>]]</a>
<a class="sourceLine" id="cb267-36" title="36"><span class="co">#&gt;  [1] 31 35 21 23 33 17 18 16 34 27 15 28 22 29 32</span></a>
<a class="sourceLine" id="cb267-37" title="37"><span class="kw">class</span>(dados[[<span class="st">&quot;tar&quot;</span>]])</a>
<a class="sourceLine" id="cb267-38" title="38"><span class="co">#&gt; [1] &quot;numeric&quot;</span></a>
<a class="sourceLine" id="cb267-39" title="39">dados[, <span class="st">&quot;tar&quot;</span>]</a>
<a class="sourceLine" id="cb267-40" title="40"><span class="co">#&gt;  [1] 31 35 21 23 33 17 18 16 34 27 15 28 22 29 32</span></a>
<a class="sourceLine" id="cb267-41" title="41"><span class="kw">class</span>(dados[, <span class="st">&quot;tar&quot;</span>])</a>
<a class="sourceLine" id="cb267-42" title="42"><span class="co">#&gt; [1] &quot;numeric&quot;</span></a></code></pre></div>
<p>Portanto <em>dataframes</em> tem estrutura retangular similar a das matrizes e algumas de listas (diferentes colunas podem conter diferentes tipos de objetos).</p>
<div id="função-with" class="section level4">
<h4><span class="header-section-number">8.4.3.1</span> Função <code>with()</code></h4>
<p>O acesso as variáveis de um <em>dataframe</em> também é possível com a função <code>with(data, expr)</code>.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" title="1"><span class="co"># acesso a variáveis de um dataframe</span></a>
<a class="sourceLine" id="cb268-2" title="2"><span class="kw">with</span>(<span class="dt">data =</span> dados, <span class="dt">expr =</span> tar)</a>
<a class="sourceLine" id="cb268-3" title="3"><span class="co">#&gt;  [1] 31 35 21 23 33 17 18 16 34 27 15 28 22 29 32</span></a>
<a class="sourceLine" id="cb268-4" title="4">tarK &lt;-<span class="st"> </span><span class="kw">with</span>(<span class="dt">data =</span> dados, <span class="dt">expr =</span> tar <span class="op">+</span><span class="st"> </span><span class="fl">273.15</span>)</a>
<a class="sourceLine" id="cb268-5" title="5">tarK</a>
<a class="sourceLine" id="cb268-6" title="6"><span class="co">#&gt;  [1] 304.15 308.15 294.15 296.15 306.15 290.15 291.15 289.15 307.15 300.15</span></a>
<a class="sourceLine" id="cb268-7" title="7"><span class="co">#&gt; [11] 288.15 301.15 295.15 302.15 305.15</span></a>
<a class="sourceLine" id="cb268-8" title="8"><span class="co"># gráfico de uma variável usando with()</span></a>
<a class="sourceLine" id="cb268-9" title="9"><span class="kw">with</span>(<span class="dt">data =</span> dados, </a>
<a class="sourceLine" id="cb268-10" title="10">     <span class="co"># parâmetro expr geralmente não é mostrado</span></a>
<a class="sourceLine" id="cb268-11" title="11">       <span class="kw">plot</span>(tar <span class="op">+</span><span class="st"> </span><span class="fl">273.15</span>, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>)</a>
<a class="sourceLine" id="cb268-12" title="12">     )</a></code></pre></div>
<p><img src="images/Chunk5310-1.png" width="672" /></p>
<p>O argumento pode ser substituído por qualquer expressão ou conjunto de expressões que envolvam as variáveis do <em>dataframe</em> de entrada.</p>
<p>Quando houver uma expressão com mais de uma linha você agrupa o código usando chaves <code>{}</code>.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1"><span class="kw">with</span>(dados, </a>
<a class="sourceLine" id="cb269-2" title="2">     {</a>
<a class="sourceLine" id="cb269-3" title="3">       dates &lt;-<span class="st"> </span><span class="kw">as.Date</span>(datas)</a>
<a class="sourceLine" id="cb269-4" title="4">       <span class="kw">plot</span>(dates, tar)</a>
<a class="sourceLine" id="cb269-5" title="5">     }</a>
<a class="sourceLine" id="cb269-6" title="6">)</a></code></pre></div>
<p><img src="images/unnamed-chunk-5-1.png" width="672" /></p>
</div>
</div>
<div id="indexação-seleção-e-substituição" class="section level3">
<h3><span class="header-section-number">8.4.4</span> Indexação, seleção e substituição</h3>
<p>Todos esquemas de indexação usados para matrizes (seleção por índices, nomes, vetores lógicos - <em>ver Aula9</em>) podem ser usados com <em>dataframes</em>.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" title="1"><span class="co"># exclui a primeiro e a última observação para todas variáveis</span></a>
<a class="sourceLine" id="cb270-2" title="2">dados[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(dados)), ]</a>
<a class="sourceLine" id="cb270-3" title="3"><span class="co">#&gt;         datas      cidade tar</span></a>
<a class="sourceLine" id="cb270-4" title="4"><span class="co">#&gt; 2  2013-01-02 Santa Maria  35</span></a>
<a class="sourceLine" id="cb270-5" title="5"><span class="co">#&gt; 3  2013-01-03 Santa Maria  21</span></a>
<a class="sourceLine" id="cb270-6" title="6"><span class="co">#&gt; 4  2013-01-04 Santa Maria  23</span></a>
<a class="sourceLine" id="cb270-7" title="7"><span class="co">#&gt; 5  2013-01-05 Santa Maria  33</span></a>
<a class="sourceLine" id="cb270-8" title="8"><span class="co">#&gt; 6  2013-01-06 Santa Maria  17</span></a>
<a class="sourceLine" id="cb270-9" title="9"><span class="co">#&gt; 7  2013-01-07 Santa Maria  18</span></a>
<a class="sourceLine" id="cb270-10" title="10"><span class="co">#&gt; 8  2013-01-08 Santa Maria  16</span></a>
<a class="sourceLine" id="cb270-11" title="11"><span class="co">#&gt; 9  2013-01-09 Santa Maria  34</span></a>
<a class="sourceLine" id="cb270-12" title="12"><span class="co">#&gt; 10 2013-01-10 Santa Maria  27</span></a>
<a class="sourceLine" id="cb270-13" title="13"><span class="co">#&gt; 11 2013-01-11 Santa Maria  15</span></a>
<a class="sourceLine" id="cb270-14" title="14"><span class="co">#&gt; 12 2013-01-12 Santa Maria  28</span></a>
<a class="sourceLine" id="cb270-15" title="15"><span class="co">#&gt; 13 2013-01-13 Santa Maria  22</span></a>
<a class="sourceLine" id="cb270-16" title="16"><span class="co">#&gt; 14 2013-01-14 Santa Maria  29</span></a>
<a class="sourceLine" id="cb270-17" title="17"><span class="co"># temperatura dos primeiros 5 dias</span></a>
<a class="sourceLine" id="cb270-18" title="18">dados[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">3</span>]</a>
<a class="sourceLine" id="cb270-19" title="19"><span class="co">#&gt; [1] 31 35 21 23 33</span></a>
<a class="sourceLine" id="cb270-20" title="20"><span class="co"># temperatura no dia 2013-01-09</span></a>
<a class="sourceLine" id="cb270-21" title="21">dados[dados<span class="op">$</span>datas <span class="op">==</span><span class="st"> &quot;2013-01-09&quot;</span>, <span class="st">&quot;tar&quot;</span>]</a>
<a class="sourceLine" id="cb270-22" title="22"><span class="co">#&gt; [1] 34</span></a>
<a class="sourceLine" id="cb270-23" title="23"><span class="co"># acrescentar uma nova variavel</span></a>
<a class="sourceLine" id="cb270-24" title="24">dados<span class="op">$</span>prec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="dv">10</span>, <span class="dv">18</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb270-25" title="25">dados</a>
<a class="sourceLine" id="cb270-26" title="26"><span class="co">#&gt;         datas      cidade tar prec</span></a>
<a class="sourceLine" id="cb270-27" title="27"><span class="co">#&gt; 1  2013-01-01 Santa Maria  31    0</span></a>
<a class="sourceLine" id="cb270-28" title="28"><span class="co">#&gt; 2  2013-01-02 Santa Maria  35    0</span></a>
<a class="sourceLine" id="cb270-29" title="29"><span class="co">#&gt; 3  2013-01-03 Santa Maria  21    0</span></a>
<a class="sourceLine" id="cb270-30" title="30"><span class="co">#&gt; 4  2013-01-04 Santa Maria  23    0</span></a>
<a class="sourceLine" id="cb270-31" title="31"><span class="co">#&gt; 5  2013-01-05 Santa Maria  33    0</span></a>
<a class="sourceLine" id="cb270-32" title="32"><span class="co">#&gt; 6  2013-01-06 Santa Maria  17   10</span></a>
<a class="sourceLine" id="cb270-33" title="33"><span class="co">#&gt; 7  2013-01-07 Santa Maria  18   18</span></a>
<a class="sourceLine" id="cb270-34" title="34"><span class="co">#&gt; 8  2013-01-08 Santa Maria  16    4</span></a>
<a class="sourceLine" id="cb270-35" title="35"><span class="co">#&gt; 9  2013-01-09 Santa Maria  34    0</span></a>
<a class="sourceLine" id="cb270-36" title="36"><span class="co">#&gt; 10 2013-01-10 Santa Maria  27    0</span></a>
<a class="sourceLine" id="cb270-37" title="37"><span class="co">#&gt; 11 2013-01-11 Santa Maria  15    5</span></a>
<a class="sourceLine" id="cb270-38" title="38"><span class="co">#&gt; 12 2013-01-12 Santa Maria  28    0</span></a>
<a class="sourceLine" id="cb270-39" title="39"><span class="co">#&gt; 13 2013-01-13 Santa Maria  22    0</span></a>
<a class="sourceLine" id="cb270-40" title="40"><span class="co">#&gt; 14 2013-01-14 Santa Maria  29    2</span></a>
<a class="sourceLine" id="cb270-41" title="41"><span class="co">#&gt; 15 2013-01-15 Santa Maria  32    0</span></a></code></pre></div>
<p>Uma função específica para gerar subconjunto de dados em <em>dataframes</em> é a <code>subset()</code>.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1"><span class="co"># subconjunto baseado em condição lógica</span></a>
<a class="sourceLine" id="cb271-2" title="2">ss1 &lt;-<span class="st"> </span><span class="kw">subset</span>(dados, datas <span class="op">==</span><span class="st"> &quot;2013-01-09&quot;</span>, <span class="dt">select =</span> <span class="st">&quot;tar&quot;</span>)</a>
<a class="sourceLine" id="cb271-3" title="3">ss1</a>
<a class="sourceLine" id="cb271-4" title="4"><span class="co">#&gt;   tar</span></a>
<a class="sourceLine" id="cb271-5" title="5"><span class="co">#&gt; 9  34</span></a>
<a class="sourceLine" id="cb271-6" title="6"><span class="co"># subconjunto baseado em condição lógica</span></a>
<a class="sourceLine" id="cb271-7" title="7">ss2 &lt;-<span class="st"> </span><span class="kw">subset</span>(dados, tar <span class="op">&gt;</span><span class="st"> </span><span class="dv">26</span> <span class="op">&amp;</span><span class="st"> </span>prec <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb271-8" title="8">ss2</a>
<a class="sourceLine" id="cb271-9" title="9"><span class="co">#&gt;         datas      cidade tar prec</span></a>
<a class="sourceLine" id="cb271-10" title="10"><span class="co">#&gt; 14 2013-01-14 Santa Maria  29    2</span></a>
<a class="sourceLine" id="cb271-11" title="11"><span class="co"># subconjunto baseado em condição lógica</span></a>
<a class="sourceLine" id="cb271-12" title="12">ss3 &lt;-<span class="st"> </span><span class="kw">subset</span>(dados, tar <span class="op">&gt;</span><span class="st"> </span><span class="dv">26</span> <span class="op">|</span><span class="st"> </span>prec <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb271-13" title="13">ss3</a>
<a class="sourceLine" id="cb271-14" title="14"><span class="co">#&gt;         datas      cidade tar prec</span></a>
<a class="sourceLine" id="cb271-15" title="15"><span class="co">#&gt; 1  2013-01-01 Santa Maria  31    0</span></a>
<a class="sourceLine" id="cb271-16" title="16"><span class="co">#&gt; 2  2013-01-02 Santa Maria  35    0</span></a>
<a class="sourceLine" id="cb271-17" title="17"><span class="co">#&gt; 5  2013-01-05 Santa Maria  33    0</span></a>
<a class="sourceLine" id="cb271-18" title="18"><span class="co">#&gt; 6  2013-01-06 Santa Maria  17   10</span></a>
<a class="sourceLine" id="cb271-19" title="19"><span class="co">#&gt; 7  2013-01-07 Santa Maria  18   18</span></a>
<a class="sourceLine" id="cb271-20" title="20"><span class="co">#&gt; 8  2013-01-08 Santa Maria  16    4</span></a>
<a class="sourceLine" id="cb271-21" title="21"><span class="co">#&gt; 9  2013-01-09 Santa Maria  34    0</span></a>
<a class="sourceLine" id="cb271-22" title="22"><span class="co">#&gt; 10 2013-01-10 Santa Maria  27    0</span></a>
<a class="sourceLine" id="cb271-23" title="23"><span class="co">#&gt; 11 2013-01-11 Santa Maria  15    5</span></a>
<a class="sourceLine" id="cb271-24" title="24"><span class="co">#&gt; 12 2013-01-12 Santa Maria  28    0</span></a>
<a class="sourceLine" id="cb271-25" title="25"><span class="co">#&gt; 14 2013-01-14 Santa Maria  29    2</span></a>
<a class="sourceLine" id="cb271-26" title="26"><span class="co">#&gt; 15 2013-01-15 Santa Maria  32    0</span></a>
<a class="sourceLine" id="cb271-27" title="27"><span class="co"># subconjunto baseado em condição lógica</span></a>
<a class="sourceLine" id="cb271-28" title="28">ss4 &lt;-<span class="st"> </span><span class="kw">subset</span>(dados,</a>
<a class="sourceLine" id="cb271-29" title="29">  datas <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;2013-01-09&quot;</span>, <span class="st">&quot;2013-01-13&quot;</span>, <span class="st">&quot;2013-01-15&quot;</span>),</a>
<a class="sourceLine" id="cb271-30" title="30">  <span class="dt">select =</span> <span class="op">-</span>cidade</a>
<a class="sourceLine" id="cb271-31" title="31">)</a>
<a class="sourceLine" id="cb271-32" title="32">ss4</a>
<a class="sourceLine" id="cb271-33" title="33"><span class="co">#&gt;         datas tar prec</span></a>
<a class="sourceLine" id="cb271-34" title="34"><span class="co">#&gt; 9  2013-01-09  34    0</span></a>
<a class="sourceLine" id="cb271-35" title="35"><span class="co">#&gt; 13 2013-01-13  22    0</span></a>
<a class="sourceLine" id="cb271-36" title="36"><span class="co">#&gt; 15 2013-01-15  32    0</span></a>
<a class="sourceLine" id="cb271-37" title="37"><span class="co"># subconjunto baseado em condição lógica</span></a>
<a class="sourceLine" id="cb271-38" title="38">ss4 &lt;-<span class="st"> </span><span class="kw">subset</span>(dados,</a>
<a class="sourceLine" id="cb271-39" title="39">  <span class="op">!</span>datas <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;2013-01-09&quot;</span>, <span class="st">&quot;2013-01-13&quot;</span>, <span class="st">&quot;2013-01-15&quot;</span>),</a>
<a class="sourceLine" id="cb271-40" title="40">  <span class="dt">select =</span> <span class="op">-</span>cidade</a>
<a class="sourceLine" id="cb271-41" title="41">)</a>
<a class="sourceLine" id="cb271-42" title="42">ss4</a>
<a class="sourceLine" id="cb271-43" title="43"><span class="co">#&gt;         datas tar prec</span></a>
<a class="sourceLine" id="cb271-44" title="44"><span class="co">#&gt; 1  2013-01-01  31    0</span></a>
<a class="sourceLine" id="cb271-45" title="45"><span class="co">#&gt; 2  2013-01-02  35    0</span></a>
<a class="sourceLine" id="cb271-46" title="46"><span class="co">#&gt; 3  2013-01-03  21    0</span></a>
<a class="sourceLine" id="cb271-47" title="47"><span class="co">#&gt; 4  2013-01-04  23    0</span></a>
<a class="sourceLine" id="cb271-48" title="48"><span class="co">#&gt; 5  2013-01-05  33    0</span></a>
<a class="sourceLine" id="cb271-49" title="49"><span class="co">#&gt; 6  2013-01-06  17   10</span></a>
<a class="sourceLine" id="cb271-50" title="50"><span class="co">#&gt; 7  2013-01-07  18   18</span></a>
<a class="sourceLine" id="cb271-51" title="51"><span class="co">#&gt; 8  2013-01-08  16    4</span></a>
<a class="sourceLine" id="cb271-52" title="52"><span class="co">#&gt; 10 2013-01-10  27    0</span></a>
<a class="sourceLine" id="cb271-53" title="53"><span class="co">#&gt; 11 2013-01-11  15    5</span></a>
<a class="sourceLine" id="cb271-54" title="54"><span class="co">#&gt; 12 2013-01-12  28    0</span></a>
<a class="sourceLine" id="cb271-55" title="55"><span class="co">#&gt; 14 2013-01-14  29    2</span></a></code></pre></div>
<p>Uma função específica para alteração, remoção e inclusão de variáveis em um <em>dataframe</em> é a <code>transform()</code>. Essa função é mais indicada para alteração de mais de uma variável (ao mesmo tempo) de um <em>dataframe</em>.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1"><span class="co"># mudança do dataframe, alteração de várias variáveis</span></a>
<a class="sourceLine" id="cb272-2" title="2">dados &lt;-<span class="st"> </span><span class="kw">transform</span>(dados,</a>
<a class="sourceLine" id="cb272-3" title="3">  <span class="dt">cidade =</span> <span class="kw">ifelse</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(dados) <span class="op">&gt;</span><span class="st"> </span><span class="dv">8</span>, <span class="st">&quot;Sao Sepe&quot;</span>, cidade),</a>
<a class="sourceLine" id="cb272-4" title="4">  <span class="dt">datas =</span> <span class="kw">c</span>(datas[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>], datas[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>]),</a>
<a class="sourceLine" id="cb272-5" title="5">  <span class="dt">anomalias =</span> <span class="kw">ifelse</span>(cidade <span class="op">==</span><span class="st"> &quot;Santa Maria&quot;</span>,</a>
<a class="sourceLine" id="cb272-6" title="6">    tar <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(tar[cidade <span class="op">==</span><span class="st"> &quot;Santa Maria&quot;</span>]),</a>
<a class="sourceLine" id="cb272-7" title="7">    tar <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(tar[cidade <span class="op">==</span><span class="st"> &quot;Sao Sepe&quot;</span>])</a>
<a class="sourceLine" id="cb272-8" title="8">  )</a>
<a class="sourceLine" id="cb272-9" title="9">)</a>
<a class="sourceLine" id="cb272-10" title="10">dados</a>
<a class="sourceLine" id="cb272-11" title="11"><span class="co">#&gt;         datas      cidade tar prec anomalias</span></a>
<a class="sourceLine" id="cb272-12" title="12"><span class="co">#&gt; 1  2013-01-01 Santa Maria  31    0       5.6</span></a>
<a class="sourceLine" id="cb272-13" title="13"><span class="co">#&gt; 2  2013-01-02 Santa Maria  35    0       9.6</span></a>
<a class="sourceLine" id="cb272-14" title="14"><span class="co">#&gt; 3  2013-01-03 Santa Maria  21    0      -4.4</span></a>
<a class="sourceLine" id="cb272-15" title="15"><span class="co">#&gt; 4  2013-01-04 Santa Maria  23    0      -2.4</span></a>
<a class="sourceLine" id="cb272-16" title="16"><span class="co">#&gt; 5  2013-01-05 Santa Maria  33    0       7.6</span></a>
<a class="sourceLine" id="cb272-17" title="17"><span class="co">#&gt; 6  2013-01-06 Santa Maria  17   10      -8.4</span></a>
<a class="sourceLine" id="cb272-18" title="18"><span class="co">#&gt; 7  2013-01-07 Santa Maria  18   18      -7.4</span></a>
<a class="sourceLine" id="cb272-19" title="19"><span class="co">#&gt; 8  2013-01-08 Santa Maria  16    4      -9.4</span></a>
<a class="sourceLine" id="cb272-20" title="20"><span class="co">#&gt; 9  2013-01-01    Sao Sepe  34    0       8.6</span></a>
<a class="sourceLine" id="cb272-21" title="21"><span class="co">#&gt; 10 2013-01-02    Sao Sepe  27    0       1.6</span></a>
<a class="sourceLine" id="cb272-22" title="22"><span class="co">#&gt; 11 2013-01-03    Sao Sepe  15    5     -10.4</span></a>
<a class="sourceLine" id="cb272-23" title="23"><span class="co">#&gt; 12 2013-01-04    Sao Sepe  28    0       2.6</span></a>
<a class="sourceLine" id="cb272-24" title="24"><span class="co">#&gt; 13 2013-01-05    Sao Sepe  22    0      -3.4</span></a>
<a class="sourceLine" id="cb272-25" title="25"><span class="co">#&gt; 14 2013-01-06    Sao Sepe  29    2       3.6</span></a>
<a class="sourceLine" id="cb272-26" title="26"><span class="co">#&gt; 15 2013-01-07    Sao Sepe  32    0       6.6</span></a>
<a class="sourceLine" id="cb272-27" title="27"><span class="co"># alterar só uma variavel, anomalia normalizada</span></a>
<a class="sourceLine" id="cb272-28" title="28">dados<span class="op">$</span>anomalias.norm &lt;-<span class="st"> </span><span class="kw">ifelse</span>(dados<span class="op">$</span>cidade <span class="op">==</span><span class="st"> &quot;Santa Maria&quot;</span>,</a>
<a class="sourceLine" id="cb272-29" title="29">  dados<span class="op">$</span>anomalias <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(dados<span class="op">$</span>anomalias[dados<span class="op">$</span>cidade <span class="op">==</span><span class="st"> &quot;Santa Maria&quot;</span>]),</a>
<a class="sourceLine" id="cb272-30" title="30">  dados<span class="op">$</span>anomalias <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(dados<span class="op">$</span>anomalias[dados<span class="op">$</span>cidade <span class="op">==</span><span class="st"> &quot;Sao Sepe&quot;</span>])</a>
<a class="sourceLine" id="cb272-31" title="31">)</a>
<a class="sourceLine" id="cb272-32" title="32">dados</a>
<a class="sourceLine" id="cb272-33" title="33"><span class="co">#&gt;         datas      cidade tar prec anomalias anomalias.norm</span></a>
<a class="sourceLine" id="cb272-34" title="34"><span class="co">#&gt; 1  2013-01-01 Santa Maria  31    0       5.6      0.7321669</span></a>
<a class="sourceLine" id="cb272-35" title="35"><span class="co">#&gt; 2  2013-01-02 Santa Maria  35    0       9.6      1.2551433</span></a>
<a class="sourceLine" id="cb272-36" title="36"><span class="co">#&gt; 3  2013-01-03 Santa Maria  21    0      -4.4     -0.5752740</span></a>
<a class="sourceLine" id="cb272-37" title="37"><span class="co">#&gt; 4  2013-01-04 Santa Maria  23    0      -2.4     -0.3137858</span></a>
<a class="sourceLine" id="cb272-38" title="38"><span class="co">#&gt; 5  2013-01-05 Santa Maria  33    0       7.6      0.9936551</span></a>
<a class="sourceLine" id="cb272-39" title="39"><span class="co">#&gt; 6  2013-01-06 Santa Maria  17   10      -8.4     -1.0982504</span></a>
<a class="sourceLine" id="cb272-40" title="40"><span class="co">#&gt; 7  2013-01-07 Santa Maria  18   18      -7.4     -0.9675063</span></a>
<a class="sourceLine" id="cb272-41" title="41"><span class="co">#&gt; 8  2013-01-08 Santa Maria  16    4      -9.4     -1.2289944</span></a>
<a class="sourceLine" id="cb272-42" title="42"><span class="co">#&gt; 9  2013-01-01    Sao Sepe  34    0       8.6      1.3392114</span></a>
<a class="sourceLine" id="cb272-43" title="43"><span class="co">#&gt; 10 2013-01-02    Sao Sepe  27    0       1.6      0.2491556</span></a>
<a class="sourceLine" id="cb272-44" title="44"><span class="co">#&gt; 11 2013-01-03    Sao Sepe  15    5     -10.4     -1.6195115</span></a>
<a class="sourceLine" id="cb272-45" title="45"><span class="co">#&gt; 12 2013-01-04    Sao Sepe  28    0       2.6      0.4048779</span></a>
<a class="sourceLine" id="cb272-46" title="46"><span class="co">#&gt; 13 2013-01-05    Sao Sepe  22    0      -3.4     -0.5294557</span></a>
<a class="sourceLine" id="cb272-47" title="47"><span class="co">#&gt; 14 2013-01-06    Sao Sepe  29    2       3.6      0.5606001</span></a>
<a class="sourceLine" id="cb272-48" title="48"><span class="co">#&gt; 15 2013-01-07    Sao Sepe  32    0       6.6      1.0277669</span></a></code></pre></div>
</div>
<div id="combinando-dataframes" class="section level3">
<h3><span class="header-section-number">8.4.5</span> Combinando <em>dataframes</em></h3>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" title="1">coords_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb273-2" title="2">  <span class="dt">lon =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">45</span>, <span class="dv">8</span>), <span class="kw">rep</span>(<span class="op">-</span><span class="fl">45.1</span>, <span class="dv">7</span>)), <span class="co"># longitudes</span></a>
<a class="sourceLine" id="cb273-3" title="3">  <span class="dt">lat =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">23</span>, <span class="dv">8</span>), <span class="kw">rep</span>(<span class="op">-</span><span class="fl">23.1</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb273-4" title="4">) <span class="co"># latitudes</span></a>
<a class="sourceLine" id="cb273-5" title="5">d &lt;-<span class="st"> </span><span class="kw">cbind</span>(dados, coords_df)</a>
<a class="sourceLine" id="cb273-6" title="6">d</a>
<a class="sourceLine" id="cb273-7" title="7"><span class="co">#&gt;         datas      cidade tar prec anomalias anomalias.norm   lon   lat</span></a>
<a class="sourceLine" id="cb273-8" title="8"><span class="co">#&gt; 1  2013-01-01 Santa Maria  31    0       5.6      0.7321669 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-9" title="9"><span class="co">#&gt; 2  2013-01-02 Santa Maria  35    0       9.6      1.2551433 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-10" title="10"><span class="co">#&gt; 3  2013-01-03 Santa Maria  21    0      -4.4     -0.5752740 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-11" title="11"><span class="co">#&gt; 4  2013-01-04 Santa Maria  23    0      -2.4     -0.3137858 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-12" title="12"><span class="co">#&gt; 5  2013-01-05 Santa Maria  33    0       7.6      0.9936551 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-13" title="13"><span class="co">#&gt; 6  2013-01-06 Santa Maria  17   10      -8.4     -1.0982504 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-14" title="14"><span class="co">#&gt; 7  2013-01-07 Santa Maria  18   18      -7.4     -0.9675063 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-15" title="15"><span class="co">#&gt; 8  2013-01-08 Santa Maria  16    4      -9.4     -1.2289944 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-16" title="16"><span class="co">#&gt; 9  2013-01-01    Sao Sepe  34    0       8.6      1.3392114 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-17" title="17"><span class="co">#&gt; 10 2013-01-02    Sao Sepe  27    0       1.6      0.2491556 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-18" title="18"><span class="co">#&gt; 11 2013-01-03    Sao Sepe  15    5     -10.4     -1.6195115 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-19" title="19"><span class="co">#&gt; 12 2013-01-04    Sao Sepe  28    0       2.6      0.4048779 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-20" title="20"><span class="co">#&gt; 13 2013-01-05    Sao Sepe  22    0      -3.4     -0.5294557 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-21" title="21"><span class="co">#&gt; 14 2013-01-06    Sao Sepe  29    2       3.6      0.5606001 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-22" title="22"><span class="co">#&gt; 15 2013-01-07    Sao Sepe  32    0       6.6      1.0277669 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-23" title="23"><span class="co"># usando a própria função data.frame()</span></a>
<a class="sourceLine" id="cb273-24" title="24">d2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(dados, coords_df, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb273-25" title="25">d2</a>
<a class="sourceLine" id="cb273-26" title="26"><span class="co">#&gt;         datas      cidade tar prec anomalias anomalias.norm   lon   lat</span></a>
<a class="sourceLine" id="cb273-27" title="27"><span class="co">#&gt; 1  2013-01-01 Santa Maria  31    0       5.6      0.7321669 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-28" title="28"><span class="co">#&gt; 2  2013-01-02 Santa Maria  35    0       9.6      1.2551433 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-29" title="29"><span class="co">#&gt; 3  2013-01-03 Santa Maria  21    0      -4.4     -0.5752740 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-30" title="30"><span class="co">#&gt; 4  2013-01-04 Santa Maria  23    0      -2.4     -0.3137858 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-31" title="31"><span class="co">#&gt; 5  2013-01-05 Santa Maria  33    0       7.6      0.9936551 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-32" title="32"><span class="co">#&gt; 6  2013-01-06 Santa Maria  17   10      -8.4     -1.0982504 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-33" title="33"><span class="co">#&gt; 7  2013-01-07 Santa Maria  18   18      -7.4     -0.9675063 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-34" title="34"><span class="co">#&gt; 8  2013-01-08 Santa Maria  16    4      -9.4     -1.2289944 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-35" title="35"><span class="co">#&gt; 9  2013-01-01    Sao Sepe  34    0       8.6      1.3392114 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-36" title="36"><span class="co">#&gt; 10 2013-01-02    Sao Sepe  27    0       1.6      0.2491556 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-37" title="37"><span class="co">#&gt; 11 2013-01-03    Sao Sepe  15    5     -10.4     -1.6195115 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-38" title="38"><span class="co">#&gt; 12 2013-01-04    Sao Sepe  28    0       2.6      0.4048779 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-39" title="39"><span class="co">#&gt; 13 2013-01-05    Sao Sepe  22    0      -3.4     -0.5294557 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-40" title="40"><span class="co">#&gt; 14 2013-01-06    Sao Sepe  29    2       3.6      0.5606001 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-41" title="41"><span class="co">#&gt; 15 2013-01-07    Sao Sepe  32    0       6.6      1.0277669 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-42" title="42"><span class="co"># verificando se os dois dataframes são idênticos</span></a>
<a class="sourceLine" id="cb273-43" title="43"><span class="kw">identical</span>(d, d2)</a>
<a class="sourceLine" id="cb273-44" title="44"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb273-45" title="45"><span class="co"># dados de Caçapava</span></a>
<a class="sourceLine" id="cb273-46" title="46">cacapava &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb273-47" title="47">  <span class="dt">datas =</span> <span class="st">&quot;2013-01-01&quot;</span>,</a>
<a class="sourceLine" id="cb273-48" title="48">  <span class="dt">cidade =</span> <span class="st">&quot;Cacapava&quot;</span>,</a>
<a class="sourceLine" id="cb273-49" title="49">  <span class="dt">tar =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb273-50" title="50">  <span class="dt">prec =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb273-51" title="51">  <span class="dt">anomalias =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb273-52" title="52">  <span class="dt">anomalias.norm =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb273-53" title="53">  <span class="dt">lon =</span> <span class="fl">-45.1</span>,</a>
<a class="sourceLine" id="cb273-54" title="54">  <span class="dt">lat =</span> <span class="fl">-23.2</span></a>
<a class="sourceLine" id="cb273-55" title="55">)</a>
<a class="sourceLine" id="cb273-56" title="56">d &lt;-<span class="st"> </span><span class="kw">rbind</span>(d, cacapava)</a>
<a class="sourceLine" id="cb273-57" title="57">d</a>
<a class="sourceLine" id="cb273-58" title="58"><span class="co">#&gt;         datas      cidade tar prec anomalias anomalias.norm   lon   lat</span></a>
<a class="sourceLine" id="cb273-59" title="59"><span class="co">#&gt; 1  2013-01-01 Santa Maria  31    0       5.6      0.7321669 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-60" title="60"><span class="co">#&gt; 2  2013-01-02 Santa Maria  35    0       9.6      1.2551433 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-61" title="61"><span class="co">#&gt; 3  2013-01-03 Santa Maria  21    0      -4.4     -0.5752740 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-62" title="62"><span class="co">#&gt; 4  2013-01-04 Santa Maria  23    0      -2.4     -0.3137858 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-63" title="63"><span class="co">#&gt; 5  2013-01-05 Santa Maria  33    0       7.6      0.9936551 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-64" title="64"><span class="co">#&gt; 6  2013-01-06 Santa Maria  17   10      -8.4     -1.0982504 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-65" title="65"><span class="co">#&gt; 7  2013-01-07 Santa Maria  18   18      -7.4     -0.9675063 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-66" title="66"><span class="co">#&gt; 8  2013-01-08 Santa Maria  16    4      -9.4     -1.2289944 -45.0 -23.0</span></a>
<a class="sourceLine" id="cb273-67" title="67"><span class="co">#&gt; 9  2013-01-01    Sao Sepe  34    0       8.6      1.3392114 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-68" title="68"><span class="co">#&gt; 10 2013-01-02    Sao Sepe  27    0       1.6      0.2491556 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-69" title="69"><span class="co">#&gt; 11 2013-01-03    Sao Sepe  15    5     -10.4     -1.6195115 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-70" title="70"><span class="co">#&gt; 12 2013-01-04    Sao Sepe  28    0       2.6      0.4048779 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-71" title="71"><span class="co">#&gt; 13 2013-01-05    Sao Sepe  22    0      -3.4     -0.5294557 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-72" title="72"><span class="co">#&gt; 14 2013-01-06    Sao Sepe  29    2       3.6      0.5606001 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-73" title="73"><span class="co">#&gt; 15 2013-01-07    Sao Sepe  32    0       6.6      1.0277669 -45.1 -23.1</span></a>
<a class="sourceLine" id="cb273-74" title="74"><span class="co">#&gt; 16 2013-01-01    Cacapava  19    0        NA             NA -45.1 -23.2</span></a></code></pre></div>
</div>
<div id="teste-e-coerção" class="section level3">
<h3><span class="header-section-number">8.4.6</span> Teste e Coerção</h3>
<p>Podemos converter um objeto para <em>dataframe</em> com <code>as.data.frame()</code>:</p>
<ul>
<li><p>Um vetor é transformado em um <em>dataframe</em> de uma coluna;</p></li>
<li><p>Uma lista terá uma coluna para elemento, se os elementos não forem de mesmo tamanho haverá um erro;</p></li>
<li><p>Uma matriz cria um <em>dataframe</em> com mesma estrutura de uma matriz;</p></li>
</ul>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1"><span class="co"># convertendo lista para dataframe</span></a>
<a class="sourceLine" id="cb274-2" title="2">sm_l</a>
<a class="sourceLine" id="cb274-3" title="3"><span class="co">#&gt; $cidade</span></a>
<a class="sourceLine" id="cb274-4" title="4"><span class="co">#&gt; [1] &quot;Santa Maria&quot;</span></a>
<a class="sourceLine" id="cb274-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb274-6" title="6"><span class="co">#&gt; $dados</span></a>
<a class="sourceLine" id="cb274-7" title="7"><span class="co">#&gt;      tar prec</span></a>
<a class="sourceLine" id="cb274-8" title="8"><span class="co">#&gt; [1,]  31  300</span></a>
<a class="sourceLine" id="cb274-9" title="9"><span class="co">#&gt; [2,]  35  200</span></a>
<a class="sourceLine" id="cb274-10" title="10"><span class="co">#&gt; [3,]  21  150</span></a>
<a class="sourceLine" id="cb274-11" title="11"><span class="co">#&gt; [4,]  23  120</span></a>
<a class="sourceLine" id="cb274-12" title="12"><span class="co">#&gt; [5,]  33  210</span></a>
<a class="sourceLine" id="cb274-13" title="13"><span class="co">#&gt; [6,]  17  110</span></a>
<a class="sourceLine" id="cb274-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb274-15" title="15"><span class="co">#&gt; $lon</span></a>
<a class="sourceLine" id="cb274-16" title="16"><span class="co">#&gt; [1] -45</span></a>
<a class="sourceLine" id="cb274-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb274-18" title="18"><span class="co">#&gt; $lat</span></a>
<a class="sourceLine" id="cb274-19" title="19"><span class="co">#&gt; [1] -23</span></a>
<a class="sourceLine" id="cb274-20" title="20">sm_l_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(sm_l)</a>
<a class="sourceLine" id="cb274-21" title="21">sm_l_df</a>
<a class="sourceLine" id="cb274-22" title="22"><span class="co">#&gt;        cidade dados.tar dados.prec lon lat</span></a>
<a class="sourceLine" id="cb274-23" title="23"><span class="co">#&gt; 1 Santa Maria        31        300 -45 -23</span></a>
<a class="sourceLine" id="cb274-24" title="24"><span class="co">#&gt; 2 Santa Maria        35        200 -45 -23</span></a>
<a class="sourceLine" id="cb274-25" title="25"><span class="co">#&gt; 3 Santa Maria        21        150 -45 -23</span></a>
<a class="sourceLine" id="cb274-26" title="26"><span class="co">#&gt; 4 Santa Maria        23        120 -45 -23</span></a>
<a class="sourceLine" id="cb274-27" title="27"><span class="co">#&gt; 5 Santa Maria        33        210 -45 -23</span></a>
<a class="sourceLine" id="cb274-28" title="28"><span class="co">#&gt; 6 Santa Maria        17        110 -45 -23</span></a>
<a class="sourceLine" id="cb274-29" title="29"><span class="co"># convertendo array para dataframe</span></a>
<a class="sourceLine" id="cb274-30" title="30">v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">100</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb274-31" title="31">v_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(v)</a>
<a class="sourceLine" id="cb274-32" title="32"><span class="co"># convertendo vetor para dataframe</span></a>
<a class="sourceLine" id="cb274-33" title="33">temp90_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(temp90)</a>
<a class="sourceLine" id="cb274-34" title="34"><span class="co"># convertendo matrix para dataframe</span></a>
<a class="sourceLine" id="cb274-35" title="35">mat</a>
<a class="sourceLine" id="cb274-36" title="36"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb274-37" title="37"><span class="co">#&gt; [1,]    0    1   -1   -2</span></a>
<a class="sourceLine" id="cb274-38" title="38"><span class="co">#&gt; [2,]    3    5   -5    0</span></a>
<a class="sourceLine" id="cb274-39" title="39">mat_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(mat)</a>
<a class="sourceLine" id="cb274-40" title="40"><span class="kw">names</span>(mat_df)</a>
<a class="sourceLine" id="cb274-41" title="41"><span class="co">#&gt; [1] &quot;V1&quot; &quot;V2&quot; &quot;V3&quot; &quot;V4&quot;</span></a>
<a class="sourceLine" id="cb274-42" title="42">mat_df</a>
<a class="sourceLine" id="cb274-43" title="43"><span class="co">#&gt;   V1 V2 V3 V4</span></a>
<a class="sourceLine" id="cb274-44" title="44"><span class="co">#&gt; 1  0  1 -1 -2</span></a>
<a class="sourceLine" id="cb274-45" title="45"><span class="co">#&gt; 2  3  5 -5  0</span></a>
<a class="sourceLine" id="cb274-46" title="46"><span class="co"># testes</span></a>
<a class="sourceLine" id="cb274-47" title="47"><span class="kw">is.data.frame</span>(mat_df)</a>
<a class="sourceLine" id="cb274-48" title="48"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb274-49" title="49"><span class="kw">class</span>(v_df)</a>
<a class="sourceLine" id="cb274-50" title="50"><span class="co">#&gt; [1] &quot;data.frame&quot;</span></a></code></pre></div>
</div>
</div>
<div id="exercícios-2" class="section level2">
<h2><span class="header-section-number">8.5</span> Exercícios</h2>
<ol style="list-style-type: decimal">
<li>Crie um vetor com os valores de <span class="math inline">\(e^{x}cos{x}\)</span> para os valores de <span class="math inline">\(x = (3, 3.1, 3.2, ..., 6\)</span>).</li>
</ol>
<hr />
<ol start="2" style="list-style-type: decimal">
<li>Crie os seguintes vetores.
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\((0.1^{3}\times0.2^{1}, 0.1^{6}\times0.2^{4}, ..., 0.1^{36}\times0.2^{34})\)</span></p></li>
<li><p><span class="math inline">\((2, \frac{2^{2}}{2}, \frac{2^{3}}{3}, ..., \frac{2^{25}}{25})\)</span></p></li>
</ol></li>
</ol>
<hr />
<ol start="3" style="list-style-type: decimal">
<li>Reproduza a criação do vetor dias da semana (<code>dds</code>) mostrado abaixo.</li>
</ol>
<pre><code>      Domingo Segunda-feira   Terca-feira  Quarta-feira  Quinta-feira 
            1             2             3             4             5 
  Sexta-feira        Sabado 
            6             7 </code></pre>
<hr />
<ol start="4" style="list-style-type: decimal">
<li>Escreva os códigos necessários para determinar:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>o vetor lógico indicando quais números são pares na sequência de valores 85, 79, 70, 6, 32, 8, 17, 93, 81, 76. Calcule o total de números ímpares.</p></li>
<li><p>Se um ano é bissexto. Verifique os resultados de seu código para os anos 1974, 1968, 1959, 1895, 1921, 1897, 1906, 1982, 1970, 1965. Calcule o total de anos com 365 dias.</p></li>
</ol>
<hr />
<ol start="5" style="list-style-type: decimal">
<li>Quais códigos para gerar os seguintes dados:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre><code>[1] -20   0  10  20  30  40</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre><code>[1] -1.00 -0.75 -0.50 -0.25  0.00  0.25  0.50  0.75  1.00</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre><code> [1] -3.1415927 -2.5703940 -1.9991953 -1.4279967 -0.8567980 -0.2855993
 [7]  0.2855993  0.8567980  1.4279967  1.9991953  2.5703940  3.1415927</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre><code> [1] 1 1 1 1 1 2 2 2 2 3 3 3 4 4 5</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre><code> [1] 1 1 1 1 1 2 2 2 2 3 3 3 4 4 5 4 4 3 3 3 2 2 2 2 1 1 1 1 1</code></pre>
<ol start="6" style="list-style-type: lower-alpha">
<li>Dica: lembre da função <code>rep()</code> e seus argumentos <code>each</code> e <code>times</code>. Experimente usar vetores nesses argumentos.</li>
</ol>
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    1    2    2
[2,]    1    1    2    2
[3,]    3    3    4    4
[4,]    3    3    4    4</code></pre>
<ol start="7" style="list-style-type: lower-alpha">
<li>Como a partir da matriz gerada na letra <em>f</em> você pode obter a matriz abaixo?</li>
</ol>
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    1    3    3
[2,]    1    1    3    3
[3,]    2    2    4    4
[4,]    2    2    4    4</code></pre>
<ol start="8" style="list-style-type: lower-alpha">
<li>Qual o código para converter a matriz gerada na letra <em>g</em> no vetor abaixo?</li>
</ol>
<pre><code> [1] 1 1 3 3 1 1 3 3 2 2 4 4 2 2 4 4</code></pre>
<hr />
<ol start="6" style="list-style-type: decimal">
<li><p>Como obter as seguintes sequências a partir dos vetores fornecidos usando a mesma solução para todos casos?</p>
<ol style="list-style-type: lower-alpha">
<li>v3 = (10, 0.5, 8, 4)</li>
</ol></li>
</ol>
<pre><code>[1] 1 2 3 4</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>v2 = (10, 0.5)</li>
</ol>
<pre><code>[1] 1 2</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>v1 = (10)</li>
</ol>
<pre><code>[1] 1</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>v0 = ()</li>
</ol>
<pre><code>integer(0)</code></pre>
<hr />
<ol start="7" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>Calcule a soma cumulativa dos números 2, 3, 4, 5, 6. Dica: ver a função <code>cumsum()</code>. (b) Calcule a soma cumulativa destes números mas na ordem reversa. Dica: ver a função <code>rev()</code>.</li>
</ol></li>
</ol>
<hr />
<ol start="8" style="list-style-type: decimal">
<li>Os dados abaixo são de precipitação horária de um evento severo ocorrido em 03/12/2012 em Santa Maria-RS.</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="center">hora</th>
<th align="center">prec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">9</td>
<td align="center">0.0</td>
</tr>
<tr class="even">
<td align="center">10</td>
<td align="center">0.0</td>
</tr>
<tr class="odd">
<td align="center">11</td>
<td align="center">0.0</td>
</tr>
<tr class="even">
<td align="center">12</td>
<td align="center">0.0</td>
</tr>
<tr class="odd">
<td align="center">13</td>
<td align="center">0.0</td>
</tr>
<tr class="even">
<td align="center">14</td>
<td align="center">0.0</td>
</tr>
<tr class="odd">
<td align="center">15</td>
<td align="center">0.0</td>
</tr>
<tr class="even">
<td align="center">16</td>
<td align="center">21.4</td>
</tr>
<tr class="odd">
<td align="center">17</td>
<td align="center">41.2</td>
</tr>
<tr class="even">
<td align="center">18</td>
<td align="center">2.6</td>
</tr>
<tr class="odd">
<td align="center">19</td>
<td align="center">1.0</td>
</tr>
<tr class="even">
<td align="center">20</td>
<td align="center">0.4</td>
</tr>
<tr class="odd">
<td align="center">21</td>
<td align="center">0.0</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li><p>Como seria o código para determinar a soma cumulativa da precipitação horária? Salve seu resultado em um vetor chamado <code>prec_acum</code>. Interprete o resultado <code>c(NA, diff(prec_acum))</code>.</p></li>
<li><p>Mostre o código para encontrar o horário de ocorrência da precipitação máxima?</p></li>
<li><p>Mostre o código para obter a hora de início e fim do evento de precipitação severa. Qual foi a duração do evento?</p></li>
<li><p>Qual foi a precipitação total do evento? Quanto da precipitação total do evento, em %, ocorreu até às 17 h?</p></li>
</ol>
<hr />
<ol start="9" style="list-style-type: decimal">
<li>EXERCÍCIO RESOLVIDO. Considere o vetor <code>x</code> definido pelos números descritos abaixo. Mostre como encontrar o primeiro número positivo localizado após o último número negativo. Por exemplo, seja o vetor <code>z</code> definido pelos valores (11, 10, 15, 2, 6, -15, -10, -22, -8, 5, 7, 2, 12, 8, 4, 1, 3, -3, -1, 30, 14). Os valores selecionados seriam 5 e 30.</li>
</ol>
<p>Um possível código para chegar a esse resultado seria:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb288-2" title="2">  <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">-15</span>, <span class="dv">-10</span>, <span class="dv">-22</span>, <span class="dv">-8</span>,  <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb288-3" title="3">   <span class="dv">7</span>,  <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">8</span>, <span class="dv">4</span>,   <span class="dv">1</span>,   <span class="dv">3</span>,  <span class="dv">-3</span>, <span class="dv">-1</span>, <span class="dv">30</span>, <span class="dv">14</span></a>
<a class="sourceLine" id="cb288-4" title="4">)</a>
<a class="sourceLine" id="cb288-5" title="5"><span class="co"># x1 &lt;- ifelse(x &gt; 0, 1, 0)</span></a>
<a class="sourceLine" id="cb288-6" title="6"><span class="co"># cópia de x</span></a>
<a class="sourceLine" id="cb288-7" title="7">x01 &lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb288-8" title="8"><span class="co"># substituo x positivo por 1 e x negativo por 0</span></a>
<a class="sourceLine" id="cb288-9" title="9">x01[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb288-10" title="10">x01[<span class="op">!</span>x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb288-11" title="11">res &lt;-<span class="st"> </span>x[<span class="kw">which</span>(<span class="kw">diff</span>(x01) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb288-12" title="12">res</a>
<a class="sourceLine" id="cb288-13" title="13"><span class="co">#&gt; [1]  5 30</span></a></code></pre></div>
<hr />
<ol start="10" style="list-style-type: decimal">
<li>Mostre o código para resolver as seguintes tarefas. Considere o vetor <code>prec</code> com valores de precipitação diária indicado abaixo.</li>
</ol>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1">prec &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb289-2" title="2">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.8</span>, <span class="dv">0</span>, <span class="fl">0.01</span>, <span class="fl">0.75</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb289-3" title="3">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.35</span>, <span class="fl">0.08</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.31</span>, <span class="dv">0</span>, <span class="fl">3.57</span>, <span class="fl">12.17</span>, <span class="dv">0</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb289-4" title="4">  <span class="dv">0</span>, <span class="fl">0.04</span>, <span class="fl">3.16</span>, <span class="dv">0</span>, <span class="fl">0.95</span>, <span class="fl">0.79</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">3.51</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.16</span>,</a>
<a class="sourceLine" id="cb289-5" title="5">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">8.16</span>, <span class="fl">0.54</span>, <span class="fl">4.39</span>, <span class="fl">1.24</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.43</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb289-6" title="6">  <span class="dv">0</span>, <span class="fl">7.18</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.26</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.28</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.09</span>, <span class="fl">0.38</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb289-7" title="7">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.51</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.67</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.15</span>, <span class="dv">0</span>, <span class="fl">0.82</span>,</a>
<a class="sourceLine" id="cb289-8" title="8">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.37</span>, <span class="dv">0</span>, <span class="fl">0.58</span>, <span class="fl">4.95</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">7.68</span>,</a>
<a class="sourceLine" id="cb289-9" title="9">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.37</span>, <span class="dv">0</span>, <span class="fl">1.56</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.34</span>, <span class="fl">0.48</span>, <span class="dv">0</span>, <span class="fl">4.21</span>, <span class="fl">2.28</span>, <span class="fl">4.3</span>,</a>
<a class="sourceLine" id="cb289-10" title="10">  <span class="dv">0</span>, <span class="fl">3.38</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">7.28</span>, <span class="dv">0</span>, <span class="fl">4.89</span>, <span class="fl">3.91</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.93</span>,</a>
<a class="sourceLine" id="cb289-11" title="11">  <span class="dv">0</span>, <span class="fl">2.49</span>, <span class="fl">0.77</span>, <span class="dv">0</span>, <span class="fl">2.9</span>, <span class="fl">3.53</span>, <span class="fl">0.83</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.94</span>, <span class="fl">0.59</span>, <span class="dv">0</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb289-12" title="12">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.04</span>, <span class="dv">0</span>, <span class="fl">0.65</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">6.23</span>, <span class="fl">0.09</span>, <span class="dv">0</span>, <span class="fl">0.66</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">4.42</span>,</a>
<a class="sourceLine" id="cb289-13" title="13">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.84</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.09</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.08</span>, <span class="dv">0</span>, <span class="fl">0.66</span>, <span class="dv">0</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb289-14" title="14">  <span class="dv">0</span>, <span class="fl">0.06</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">3.28</span>, <span class="dv">0</span>, <span class="fl">0.8</span>, <span class="fl">5.69</span>, <span class="fl">0.8</span>, <span class="dv">0</span></a>
<a class="sourceLine" id="cb289-15" title="15">)</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Quantos dias ocorreram no intervalo 0 &lt; prec &lt; 0.25?</p></li>
<li><p>Substitua os valores de chuva registrados no intervalo 0 &lt; prec &lt; 0.25 por 0.</p></li>
<li><p>Crie um vetor denominado <code>prec01</code> indicando o estado da precipitação (chuvoso = 1, seco = 0) baseado no limiar de 0.25 mm para detecção de chuva pelo pluviômetro.</p></li>
<li><p>Qual a probabilidade de chuva dessa série de precipitação diária?</p></li>
<li><p>Qual a probabilidade de chover dois dias consecutivos (<code>p11</code>)? Calcule a probabilidade de chover em qualquer um de dois dias consecutivos (<code>p01 + p10</code>)?</p></li>
<li><p>Determine a duração de cada evento chuvoso (número de dias consecutivos).</p></li>
</ol>
<blockquote>
<p>Dica: comece encontrando a posição do início do evento e depois a posição final do envento. A diferença entre as posições fornece a duração do evento. O exercício resolvido (9) é análogo a esse exercício.</p>
</blockquote>
<p>O resultado esperado é um vetor que identifique o evento e sua duração.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" title="1">duracao</a>
<a class="sourceLine" id="cb290-2" title="2"><span class="co">#&gt;  evento1  evento2  evento3  evento4  evento5  evento6  evento7  evento8 </span></a>
<a class="sourceLine" id="cb290-3" title="3"><span class="co">#&gt;        1        1        1        1        2        1        2        1 </span></a>
<a class="sourceLine" id="cb290-4" title="4"><span class="co">#&gt;  evento9 evento10 evento11 evento12 evento13 evento14 evento15 evento16 </span></a>
<a class="sourceLine" id="cb290-5" title="5"><span class="co">#&gt;        4        1        1        1        1        1        1        1 </span></a>
<a class="sourceLine" id="cb290-6" title="6"><span class="co">#&gt; evento17 evento18 evento19 evento20 evento21 evento22 evento23 evento24 </span></a>
<a class="sourceLine" id="cb290-7" title="7"><span class="co">#&gt;        1        1        2        1        1        1        2        3 </span></a>
<a class="sourceLine" id="cb290-8" title="8"><span class="co">#&gt; evento25 evento26 evento27 evento28 evento29 evento30 evento31 evento32 </span></a>
<a class="sourceLine" id="cb290-9" title="9"><span class="co">#&gt;        1        1        2        1        2        3        2        1 </span></a>
<a class="sourceLine" id="cb290-10" title="10"><span class="co">#&gt; evento33 evento34 evento35 evento36 evento37 evento38 evento39 </span></a>
<a class="sourceLine" id="cb290-11" title="11"><span class="co">#&gt;        1        1        1        1        1        1        3</span></a></code></pre></div>
<hr />
<ol start="11" style="list-style-type: decimal">
<li>EXERCÍCIO RESOLVIDO. Dado o vetor <code>temp</code> mostrado abaixo.</li>
</ol>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1">temp &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb291-2" title="2">  <span class="ot">NA</span>, <span class="ot">NA</span>, 27L, 7L, 4L, 0L, 26L, 15L, 25L, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, 6L,</a>
<a class="sourceLine" id="cb291-3" title="3">  29L, 18L, 17L, 23L, 20L, 1L, 30L, 13L, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb291-4" title="4">  <span class="ot">NA</span>, 19L</a>
<a class="sourceLine" id="cb291-5" title="5">)</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Como você pode codificar a obtenção de um vetor com zeros nos valores válidos e com números sequenciais dentro das falhas?</li>
</ol>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" title="1"><span class="co"># vetor lógico de falhas</span></a>
<a class="sourceLine" id="cb292-2" title="2">eh_falha &lt;-<span class="st"> </span><span class="kw">is.na</span>(temp)</a>
<a class="sourceLine" id="cb292-3" title="3"><span class="co"># soma cumulativa de falhas</span></a>
<a class="sourceLine" id="cb292-4" title="4">acum_falhas &lt;-<span class="st"> </span><span class="kw">cumsum</span>(eh_falha)</a>
<a class="sourceLine" id="cb292-5" title="5"><span class="co"># calculando soma a partir do início da falha</span></a>
<a class="sourceLine" id="cb292-6" title="6">seq_falhas &lt;-<span class="st"> </span>acum_falhas <span class="op">-</span><span class="st"> </span><span class="kw">cummax</span>((<span class="op">!</span>eh_falha) <span class="op">*</span><span class="st"> </span>acum_falhas)</a>
<a class="sourceLine" id="cb292-7" title="7">seq_falhas</a>
<a class="sourceLine" id="cb292-8" title="8"><span class="co">#&gt;  [1] 1 2 0 0 0 0 0 0 0 1 2 3 4 0 0 0 0 0 0 0 0 0 1 2 3 4 5 6 7 0</span></a></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Como a partir do vetor resultante em <em>11.b</em> obter um vetor cujo os valores
dentro das falhas indique a ordem de ocorrência da falha.</li>
</ol>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1">(ordem_falhas &lt;-<span class="st"> </span><span class="kw">cumsum</span>(seq_falhas <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">as.integer</span>(eh_falha <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb293-2" title="2"><span class="co">#&gt;  [1] 1 1 0 0 0 0 0 0 0 2 2 2 2 0 0 0 0 0 0 0 0 0 3 3 3 3 3 3 3 0</span></a></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Qual o tamanho de cada falha.</li>
</ol>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" title="1">pos_fim_falha &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">c</span>(<span class="ot">NA</span>, <span class="kw">diff</span>(ordem_falhas)) <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb294-2" title="2">(tamanho_falhas &lt;-<span class="st"> </span>seq_falhas[pos_fim_falha])</a>
<a class="sourceLine" id="cb294-3" title="3"><span class="co">#&gt; [1] 2 4 7</span></a>
<a class="sourceLine" id="cb294-4" title="4"><span class="co"># names(tamanho_falhas) &lt;- paste0(&quot;falha&quot;, unique(ordem_falhas[ordem_falhas &gt; 0]))</span></a>
<a class="sourceLine" id="cb294-5" title="5"><span class="kw">names</span>(tamanho_falhas) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;falha&quot;</span>, <span class="kw">seq_along</span>(tamanho_falhas))</a>
<a class="sourceLine" id="cb294-6" title="6">tamanho_falhas</a>
<a class="sourceLine" id="cb294-7" title="7"><span class="co">#&gt; falha1 falha2 falha3 </span></a>
<a class="sourceLine" id="cb294-8" title="8"><span class="co">#&gt;      2      4      7</span></a></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Determine o tamanho da maior falha?</li>
</ol>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1">(max_falha &lt;-<span class="st"> </span><span class="kw">max</span>(tamanho_falhas))</a>
<a class="sourceLine" id="cb295-2" title="2"><span class="co">#&gt; [1] 7</span></a></code></pre></div>
<hr />
<ol start="12" style="list-style-type: decimal">
<li>Para os valores de velocidade (<span class="math inline">\(V_h\)</span>) e a direção do vento (<span class="math inline">\(\theta\)</span>) (na convenção meteorológica):</li>
</ol>
<p><span class="math inline">\(V_h\)</span> = (10, 10, 10, 10, 14.142, 14.142, 14.142, 14.142, 0)</p>
<p><span class="math inline">\(\theta\)</span> = (270, 180, 360, 90, 225, 315, 135, 45, 0)</p>
<ol style="list-style-type: lower-alpha">
<li>Determine as componentes zonal e meridional do vento.</li>
</ol>
<p><span class="math display">\[u = -V_{h} \cdot sin(\theta_{rad})\]</span>
<span class="math display">\[v = -V_{h} \cdot cos(\theta_{rad})\]</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Faça os cálculos necessários para reconstruir <span class="math inline">\(V_h\)</span> e <span class="math inline">\(\theta\)</span> a partir de <span class="math inline">\(u\)</span> e <span class="math inline">\(v\)</span> determinados no item <strong>a</strong>. Por convenção, a direção do vento <span class="math inline">\(\theta\)</span> em condições calmas (<span class="math inline">\(V_h\)</span> &lt; 0.5 m s<sup>-1</sup>) é assumida como 0°.</li>
</ol>
<p><span class="math display">\[V_{h} = \sqrt{(u^2 + v^2)}\]</span>
<span class="math display">\[\theta_{mat} = {\rm atan2}(-u, -v)\cdot\frac{180}{\pi}\]</span>
<span class="math display">\[
\theta = \left\{\begin{matrix}
\theta_{mat} + 360 &amp; se &amp; \theta_{mat} &lt; 0 \\ 
0 &amp; se &amp; u = 0,\:  v = 0 \: \:  ou \: \:  V_{h} &lt; 0.5\\
\end{matrix}\right.
\]</span></p>
<p>Como resultado monte um dataframe com todas variáveis derivadas.</p>
<table>
<thead>
<tr class="header">
<th align="right">u</th>
<th align="right">v</th>
<th align="right">ws</th>
<th align="right">wd</th>
<th align="right">wd_uv</th>
<th align="left">dir</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">0</td>
<td align="right">10.000</td>
<td align="right">270</td>
<td align="right">270</td>
<td align="left">Oeste</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">10</td>
<td align="right">10.000</td>
<td align="right">180</td>
<td align="right">180</td>
<td align="left">Sul</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">-10</td>
<td align="right">10.000</td>
<td align="right">360</td>
<td align="right">360</td>
<td align="left">Norte</td>
</tr>
<tr class="even">
<td align="right">-10</td>
<td align="right">0</td>
<td align="right">10.000</td>
<td align="right">90</td>
<td align="right">90</td>
<td align="left">Leste</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">10</td>
<td align="right">14.142</td>
<td align="right">225</td>
<td align="right">225</td>
<td align="left">Sudoeste</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">-10</td>
<td align="right">14.142</td>
<td align="right">315</td>
<td align="right">315</td>
<td align="left">Noroeste</td>
</tr>
<tr class="odd">
<td align="right">-10</td>
<td align="right">10</td>
<td align="right">14.142</td>
<td align="right">135</td>
<td align="right">135</td>
<td align="left">Sudeste</td>
</tr>
<tr class="even">
<td align="right">-10</td>
<td align="right">-10</td>
<td align="right">14.142</td>
<td align="right">45</td>
<td align="right">45</td>
<td align="left">Nordeste</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Calmo</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Dica: ver figura abaixo.</p>
</blockquote>
<p><img src="images/wind_components.png" /></p>
<hr />
<ol start="13" style="list-style-type: decimal">
<li>Para as séries de <code>prec_obs</code> e <code>prec_sim</code> calcule:</li>
</ol>
<ul>
<li>a proporção corretamente prevista <span class="math inline">\(PC = \frac{wc+dc}{n}\)</span></li>
<li>o índice de sucesso crítico <span class="math inline">\(CSI=\frac{wc}{wc+wi+di}\)</span>.</li>
</ul>
<p>Onde <span class="math inline">\(wc\)</span> e <span class="math inline">\(dc\)</span> são as previsões corretas de dias úmidos (<span class="math inline">\(prec &gt; 0.25\)</span> mm dia<sup>-1</sup>) e secos respectivamente, <span class="math inline">\(wi\)</span> e <span class="math inline">\(di\)</span> são as previsões incorretas de dias úmidos e secos respectivamente. <span class="math inline">\(n\)</span> é o n° total de previsões.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" title="1">prec_obs &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb296-2" title="2">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="fl">0.2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb296-3" title="3">  <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.25</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb296-4" title="4">  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb296-5" title="5">  <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">5</span></a>
<a class="sourceLine" id="cb296-6" title="6">)</a>
<a class="sourceLine" id="cb296-7" title="7">prec_sim &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb296-8" title="8">  <span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb296-9" title="9">  <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb296-10" title="10">  <span class="fl">0.25</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb296-11" title="11">  <span class="fl">0.25</span>, <span class="fl">0.2</span>, <span class="dv">0</span>, <span class="fl">0.2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span></a>
<a class="sourceLine" id="cb296-12" title="12">)</a></code></pre></div>
<hr />
<ol start="14" style="list-style-type: decimal">
<li>Escreva o código para calcular o coeficiente de correlação de Pearson (<code>r</code>) entre os vetores <code>obs</code> e <code>prev</code>.</li>
</ol>
<p><img src="images/correlation-formula.gif" /></p>
<p>Confira seu resultado com a saída da função <code>cor(obs, prev)</code>.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" title="1">obs &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb297-2" title="2">  <span class="fl">-0.49</span>, <span class="fl">0.27</span>, <span class="fl">-0.48</span>, <span class="fl">0.8</span>, <span class="dv">-1</span>, <span class="fl">0.1</span>, <span class="fl">-1.16</span>,</a>
<a class="sourceLine" id="cb297-3" title="3">  <span class="fl">0.58</span>, <span class="fl">-1.6</span>, <span class="fl">-0.31</span>, <span class="fl">0.45</span>, <span class="fl">-0.98</span>, <span class="fl">0.19</span>, <span class="fl">0.73</span>,</a>
<a class="sourceLine" id="cb297-4" title="4">  <span class="fl">-0.49</span>, <span class="fl">-0.04</span>, <span class="fl">-0.11</span>, <span class="fl">0.46</span>, <span class="fl">2.02</span>, <span class="fl">-1.05</span></a>
<a class="sourceLine" id="cb297-5" title="5">)</a>
<a class="sourceLine" id="cb297-6" title="6">prev &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb297-7" title="7">  <span class="ot">NA</span>, <span class="fl">-0.49</span>, <span class="fl">0.27</span>, <span class="fl">-0.48</span>, <span class="fl">0.8</span>, <span class="dv">-1</span>, <span class="fl">0.1</span>, <span class="fl">-1.16</span>,</a>
<a class="sourceLine" id="cb297-8" title="8">  <span class="fl">0.58</span>, <span class="fl">-1.6</span>, <span class="fl">-0.31</span>, <span class="fl">0.45</span>, <span class="fl">-0.98</span>, <span class="fl">0.19</span>, <span class="fl">0.73</span>,</a>
<a class="sourceLine" id="cb297-9" title="9">  <span class="fl">-0.49</span>, <span class="fl">-0.04</span>, <span class="fl">-0.11</span>, <span class="fl">0.46</span>, <span class="fl">2.02</span></a>
<a class="sourceLine" id="cb297-10" title="10">)</a></code></pre></div>
<hr />
<ol start="15" style="list-style-type: decimal">
<li>Construa uma função para converter valores de temperatura em K para °C e outra para converter ângulos de radianos para graus. Utilize dois exemplos para mostrar que suas funções funcionam corretamente.</li>
</ol>
<!--chapter:end:08-estrutura-dados.Rmd-->
</div>
</div>
<div id="io" class="section level1">
<h1><span class="header-section-number">9</span> Entrada e saída de dados</h1>
<p>O <img src="images/logo_r.png" width="20"> é capaz de importar dados de uma diversidade de fontes, formatos e
tamanhos. Neste capítulo será visto como importar e exportar dados nos formatos
mais comuns em aplicações ambientais, como:</p>
<ul>
<li>dados retangulares armazenados em arquivos de texto puro</li>
<li>dados binários e NetCDF</li>
<li>dados espaciais em formato GIS</li>
</ul>
<p>Nesta era digital, a quantidade de dados disponíveis na internet está aumentando
monstruosamente. Para você estar preparado para o futuro, além de aprender como
importar arquivos locais, veremos também como baixar e importar dados da <em>web</em>.</p>
<p>Diversos pacotes permitem lidar com diferentes formatos de dados. Começaremos
com o pacote <strong>rio</strong> que permite importar uma diversidade de tipos de dados com
muita facilidade.</p>
<p>Arquivos texto com valores separados por vírgula (<em>CSV</em>) serão tratados com os
pacotes <strong>readr</strong> e <strong>data.table</strong>. Dados em formato texto puro tem desvantagens
e por isso também veremos formatos binários, entre eles, as funções nativas do
<img src="images/logo_r.png" width="20"> (<code>readRDS()</code>, <code>load()</code>) e funções de pacotes específicos para importar
arquivos no formato NetCDF.</p>
<div id="pré-requisitos-1" class="section level2">
<h2><span class="header-section-number">9.1</span> Pré-requisitos</h2>
<p>Para reproduzir os códigos deste capítulo você precisará dos seguintes pacotes:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" title="1">pacotes &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb298-2" title="2">  <span class="st">&quot;easypackages&quot;</span>,</a>
<a class="sourceLine" id="cb298-3" title="3">  <span class="st">&quot;rio&quot;</span>,</a>
<a class="sourceLine" id="cb298-4" title="4">  <span class="st">&quot;readr&quot;</span>,</a>
<a class="sourceLine" id="cb298-5" title="5">  <span class="st">&quot;feather&quot;</span>,</a>
<a class="sourceLine" id="cb298-6" title="6">  <span class="st">&quot;readxl&quot;</span>,</a>
<a class="sourceLine" id="cb298-7" title="7">  <span class="st">&quot;writexl&quot;</span>,</a>
<a class="sourceLine" id="cb298-8" title="8">  <span class="st">&quot;dplyr&quot;</span>,</a>
<a class="sourceLine" id="cb298-9" title="9">  <span class="st">&quot;microbenchmark&quot;</span>,</a>
<a class="sourceLine" id="cb298-10" title="10">  <span class="st">&quot;openxlsx&quot;</span></a>
<a class="sourceLine" id="cb298-11" title="11">)</a></code></pre></div>
<p>Para instalá-los já com as dependências utilize a instrução abaixo:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" title="1"><span class="kw">install.packages</span>(pacotes)</a></code></pre></div>
<p>Agora você pode carregar os pacotes.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" title="1"><span class="kw">library</span>(<span class="st">&quot;easypackages&quot;</span>)</a>
<a class="sourceLine" id="cb300-2" title="2"><span class="kw">library</span>(<span class="st">&quot;rio&quot;</span>)</a>
<a class="sourceLine" id="cb300-3" title="3"><span class="kw">library</span>(<span class="st">&quot;readr&quot;</span>)</a>
<a class="sourceLine" id="cb300-4" title="4"><span class="kw">library</span>(<span class="st">&quot;writexl&quot;</span>)</a>
<a class="sourceLine" id="cb300-5" title="5"><span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)</a>
<a class="sourceLine" id="cb300-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb300-7" title="7"><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></a>
<a class="sourceLine" id="cb300-8" title="8"><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></a>
<a class="sourceLine" id="cb300-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb300-10" title="10"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb300-11" title="11"><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></a>
<a class="sourceLine" id="cb300-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb300-13" title="13"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb300-14" title="14"><span class="kw">library</span>(<span class="st">&quot;microbenchmark&quot;</span>)</a>
<a class="sourceLine" id="cb300-15" title="15"><span class="kw">library</span>(<span class="st">&quot;openxlsx&quot;</span>)</a></code></pre></div>
<div class="rmdtip">
<p>
Para carregar diversos pacotes de uma vez só, você pode usar a função <code>libraries()</code> do pacote <strong>easypackages</strong>. Então o trecho de código anterior poderia ser substituído por:
</p>
<p>
<code>library(easypackages)</code>
</p>
<p>
<code>libraries(pacotes)</code>
</p>
<p>
ou simplesmente
</p>
<p>
<code>easypackages::libraries(pacotes)</code>
</p>
</div>
<p>Para ter acesso a todos pacotes suportados pelo pacote <strong>rio</strong>, após sua
instalação precisamos executar o comando abaixo.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" title="1"><span class="kw">install_formats</span>()</a></code></pre></div>
</div>
<div id="diretório-de-trabalho" class="section level2">
<h2><span class="header-section-number">9.2</span> Diretório de trabalho</h2>
<p>Antes de lidar com arquivos locais, você precisa conhecer o seu diretório de
trabalho; o local para o qual sua sessão do R importará ou exportará dados por <em>default</em>.</p>
<p>O <img src="images/logo_r.png" width="20"> possui uma variedade de funções para se obter informações do
sistema, como arquivos, diretórios, e etc. Uma informação importante é diretório
de trabalho atual.</p>
<p>Importar ou exportar dados é mais fácil quando você não precisa digitar caminhos
longos de diretórios para os arquivos. Por isso, quando abrimos uma sessão no
<img src="images/logo_r.png" width="20">, ela é vinculada a um diretório de trabalho
(<em>working directory</em>, <code>wd</code>). A função <code>getwd()</code> retorna o diretório de trabalho
da sua sessão do <img src="images/logo_r.png" width="20">.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" title="1"><span class="kw">getwd</span>()</a></code></pre></div>
<p>O local <em>default</em> geralmente é o home do usuário "/home/usuario" no linux
e "C:\Users\usuario\" no Windows. Você obtém essa informação com a instrução
abaixo:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" title="1"><span class="kw">Sys.getenv</span>(<span class="st">&quot;HOME&quot;</span>)</a></code></pre></div>
<p>É neste local onde o <img src="images/logo_r.png" width="20"> e o RStudio irão salvar gráficos, documentos,
ler e escrever dados, quando você não especificar o caminho completo para o
arquivo de saída.</p>
<p>Ocasionalmente pode ser conveniente alterar seu <code>wd</code> e para isso você pode
usar a função <code>setwd()</code>.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" title="1">wd &lt;-<span class="st"> </span><span class="kw">getwd</span>()</a>
<a class="sourceLine" id="cb304-2" title="2"><span class="co"># define o wd em &quot;/home/user&quot;</span></a>
<a class="sourceLine" id="cb304-3" title="3"><span class="kw">setwd</span>(<span class="st">&quot;~/Documents&quot;</span>)</a>
<a class="sourceLine" id="cb304-4" title="4"><span class="kw">getwd</span>()</a>
<a class="sourceLine" id="cb304-5" title="5"><span class="co"># volta para o wd original</span></a>
<a class="sourceLine" id="cb304-6" title="6"><span class="kw">setwd</span>(wd)</a>
<a class="sourceLine" id="cb304-7" title="7"><span class="kw">getwd</span>()</a></code></pre></div>
<div class="rmdtip">
<p>
Você pode configurar o diretório de trabalho pelo menu do Rstudio <em><code>Session ▶ Set Working Directory</code></em>. Você terá as opções:
</p>
<ul>
<li>
<p>
<code><em>To Source File Location</em></code>: definirá o diretório de trabalho como o mesmo do arquivo atualmente aberto no RStudio
</p>
</li>
<li>
<p>
<code><em>To Files Pane Location</em></code>: definirá o diretório de trabalho como aquele atualmente aberto no painel de arquivos
</p>
</li>
<li>
<p>
<code><em>To Files Pane Location</em></code>: definirá o diretório de trabalho como o mesmo do projeto atualmente aberto no RStudio
</p>
</li>
<li>
<p>
<code><em>Choose Directory</em></code>: permite você navegar até o diretório de interesse
</p>
</li>
</ul>
</div>
<p>O conteúdo de um diretório pode ser listado com a função <code>dir()</code>, ou se estiver
usando o Rstudio você pode clicar na aba <code>*Files*</code> do painel de direito inferior
e depois em <code>*More  ▶  Go To Working Directory*</code>.</p>
</div>
<div id="boas-práticas-para-importação-e-exportação-de-dados" class="section level2">
<h2><span class="header-section-number">9.3</span> Boas práticas para importação e exportação de dados</h2>
<p>Para uma importação e exportação eficiente de dados recomenda-se <span class="citation">(Gillespie and Lovelace <a href="#ref-Gillespie2017" role="doc-biblioref">2017</a>)</span>:</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>Mantenha o nome original dos arquivos locais baixados da internet ou
copiados da fonte provedora. Isso o ajudará a rastrear a proveniência dos dados
no futuro.<br />
</li>
<li>Para um armazenamento eficinte utilize o formato binário nativo do R <em>.Rds</em>
para importar (<code>readRDS()</code>) e exportar (<code>saveRDS()</code>) dados processados.<br />
</li>
<li>Use funções equivalentes a read.table() dos pacotes <strong>readr</strong> ou
<strong>data.table</strong> para importar arquivos de texto grandes.</li>
<li>Use as funções <code>file.size()</code> e <code>object.size()</code> para saber o tamanho de
arquivos e objetos no R e analisar como proceder se eles ficarem muito grandes.</li>
</ol>
</blockquote>
</div>
<div id="arquivos-texto" class="section level2">
<h2><span class="header-section-number">9.4</span> Arquivos texto</h2>
<p>Dados armazenados em um arquivo de
<a href="https://pt.wikipedia.org/wiki/Texto_simples">texto puro ou simples</a> podem ser
facilmente importados no <img src="images/logo_r.png" width="20">.</p>
<p>O formato mais comum de armazenar dados é o retangular, ou seja, uma tabela de
dados com as observações ao longo das linhas e as variáveis ao longo das
colunas. As vezes as variáveis são referentes a locais diferentes em cada linha.</p>
<p>Os valores de cada coluna de uma linha são separados por um caractere separador:
vírgula, espaço, tab e etc; as linhas são separadas por quebras de linha (<code>\n</code>
no Linux, <code>\r\n</code> no Windows).</p>
<p>Dados em arquivo texto podem conter caracteres latinos, como palavras com
acentos no caso do Português. Para lidar com esta peculiaridade, as funções de
importação de dados, possuem um argumento relacionado a codificação (<em>encoding</em>)
dos caracteres. Arquivos texto em Português geralmente usam a codificação <a href="https://pt.wikipedia.org/wiki/ISO/IEC_8859-1">ISO 8859-1</a> ou equivalente <em>Latin1</em>.
Portanto, para importação com formatação correta de caracteres latinos a
especificação com esta codificação deve ser explícita.</p>
<p>O R utiliza o alfabeto <a href="https://pt.wikipedia.org/wiki/Unicode">Unicode</a> para
identificação de caracteres. Para associação unívoca de cada caractere (de mais
1 milhão de caracteres do alfabeto Unicode) a uma sequência de bits, o R usa o
esquema de codificação <a href="https://pt.wikipedia.org/wiki/UTF-8">UTF-8</a>. Assim,
recomenda-se utilizar essa codificação de caracteres como padrão em seus códigos
e na construção e aquisição de dados. No RStudio a especificação da codificação
de caracteres pode ser feita através do menu:
<code>*Tools  ▶  Global Options  ▶  Code  ▶  Saving  ▶  Default Text Encoding*</code>.</p>
<!---
#ABOUT Encoding
# Como o computador só armazena bits, o texto do arquivo que está na nossa linguagem escrita precisa ser convertido em [bits](https://pt.wikipedia.org/wiki/Bit). Essa conversão é feita por meio de um esquema codificação ou simplesmente codificação. Tradicionalmente a codificação mais usada era o [ASCII](http://pt.wikipedia.org/wiki/ASCII]) (Padrão Americano de Codificação para Intercâmbio de Informação) de 8 bits (ou 1 *byte*) que codifica um conjunto de 128 símbolos (letras, números, sinais de pontuação e símbolos matemáticos) da língua Inglesa. Por exemplo a letra R corresponde a seguinte sequência r pryr::bits("R").
# 
# Da necessidade de representar caracteres de outras linguagens surgiram [várias outras codificações](http://en.wikipedia.org/wiki/Character_encoding#Common_character_encodings). O [ISO 8859-1](https://en.wikipedia.org/wiki/ISO/IEC_8859-1) ou *Latin1* é um exemplo de codificação de 8 bits que permite representar 256 símbolos diferentes, sendo usada nas Americas, Oeste da Europa, Oceania e grande parte da África. 
# 
# Com advento da internet, a troca de informação entre computadores de diferentes países exigiu a criação de um conjunto de caracteres (únicos) que suportasse todas as linguagens do mundo. Para isso foi criado o [Unicode](https://pt.wikipedia.org/wiki/Unicode). Cada caractere é referido ao seu ponto de código, o carácter "é" pode ser representado por "U+00E9". O U+ significa Unicode e os números são em hexadecimal.
# 
# O Unicode define dois métodos de mapeamento de códigos Unicode em esquemas de codificação: UTF (Formato de Transformação Unicode, do inglês *Unicode Transformation Format*) e UCS (Conjunto Universal de Caracteres, do inglês *Universal Character Set*). Os números associados aos nomes dos mapeamentos indicam o número de bits por código (no caso de UTF) ou o número de bytes por código (no caso de UCS). UTF-8 e UTF-16 são possivelmente as mais usadas.
# 
# https://leb-fmvz-usp.gitbooks.io/manipulacao-e-visualizacao-de-dados-no-r/content/04-arquivos.html
# Embora seja possível especificar a **codificação latin1** para reconhecer caracteres do português, é preferível evitar caracteres especiais nos bancos de dados.

# REFS
# http://kunststube.net/encoding/
# https://integrada.minhabiblioteca.com.br/books/9788577808625/pageid/271
# 
-->
<div id="Rio" class="section level3">
<h3><span class="header-section-number">9.4.1</span> <strong>rio</strong></h3>
<p>O pacote <a href="https://cran.r-project.org/web/packages/rio/vignettes/rio.html">rio</a>,
nas palavras do próprio autor do pacote é "um canivete suíço para entrada e
saída de dados" nos formatos mais frequentemente usados.</p>
<p>A grande funcionalidade do <strong>rio</strong> é simplificar estes processos que podem
confundir a cabeça de quem está aprendendo R, devido a vastidão de opções
disponíveis no <img src="images/logo_r.png" width="20"> (veja o <a href="https://cran.r-project.org/doc/manuals/r-release/R-data.htmlpara%20ter%20noção">Manual de Importação e Exportação do R</a>).</p>
<p>Esta facilidade deve-se as premissas feitas pelo <strong>rio</strong> sobre o formato do
arquivo. Ao importar um arquivo o pacote descobre o formato (pela extensão)
e então aplica a função apropriada para ler aquele formato.</p>
<p>Desta forma, com o <strong>rio</strong>, você precisa saber duas funções para ler e escrever
uma variedade de formatos de arquivos (Tabela @ref(tab:rio-table)): <code>import()</code>
e <code>export()</code>, respectivamente.</p>
<p>Os formatos importados e exportados pelo <strong>rio</strong> são apresentados na Tabela
@ref(tab:rio-table). Para uma versão completa desta tabela confira a
<a href="https://cran.r-project.org/web/packages/rio/vignettes/rio.html">vinheta do pacote</a>.</p>
<table>
<caption>(#tab:rio-table)Versão resumida da tabela com os formatos suportados pelo pacote <strong>rio</strong>.</caption>
<thead>
<tr class="header">
<th align="center">Formato</th>
<th align="center">Extensão</th>
<th align="center">Pacote.de.importação</th>
<th align="center">Pacote.de.exportação</th>
<th align="center">Instalado.por..default.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Valores separados por vírgula</td>
<td align="center">.csv</td>
<td align="center"><a href="https://cran.r-project.org/package=data.table"><strong>data.table</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=data.table"><strong>data.table</strong></a></td>
<td align="center">Sim</td>
</tr>
<tr class="even">
<td align="center">dados separados por tab</td>
<td align="center">.tsv</td>
<td align="center"><a href="https://cran.r-project.org/package=data.table"><strong>data.table</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=data.table"><strong>data.table</strong></a></td>
<td align="center">Sim</td>
</tr>
<tr class="odd">
<td align="center">Excel</td>
<td align="center">.xls</td>
<td align="center"><a href="https://cran.r-project.org/package=readxl"><strong>readxl</strong></a></td>
<td align="center"></td>
<td align="center">Sim</td>
</tr>
<tr class="even">
<td align="center">Excel</td>
<td align="center">.xlsx</td>
<td align="center"><a href="https://cran.r-project.org/package=readxl"><strong>readxl</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=openxlsx"><strong>openxlsx</strong></a></td>
<td align="center">Sim</td>
</tr>
<tr class="odd">
<td align="center">objetos salvos no R</td>
<td align="center">.RData, .rda</td>
<td align="center"><strong>base</strong></td>
<td align="center"><strong>base</strong></td>
<td align="center">Sim</td>
</tr>
<tr class="even">
<td align="center">objetos do R serializados</td>
<td align="center">.rds</td>
<td align="center"><strong>base</strong></td>
<td align="center"><strong>base</strong></td>
<td align="center">Sim</td>
</tr>
<tr class="odd">
<td align="center">dados Fortran</td>
<td align="center">Sem extensão reconhecida</td>
<td align="center"><strong>utils</strong></td>
<td align="center"></td>
<td align="center">Sim</td>
</tr>
<tr class="even">
<td align="center">Formato de dados com largura fixa</td>
<td align="center">.fwf</td>
<td align="center"><strong>utils</strong></td>
<td align="center"><strong>utils</strong></td>
<td align="center">Sim</td>
</tr>
<tr class="odd">
<td align="center">Feather R/Python interchange format</td>
<td align="center">.feather</td>
<td align="center"><a href="https://cran.r-project.org/package=feather"><strong>feather</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=feather"><strong>feather</strong></a></td>
<td align="center">Não</td>
</tr>
<tr class="even">
<td align="center">Armazenamento rápido (Fast Storage)</td>
<td align="center">.fst</td>
<td align="center"><a href="https://cran.r-project.org/package=fst"><strong>fst</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=fst"><strong>fst</strong></a></td>
<td align="center">Não</td>
</tr>
<tr class="odd">
<td align="center">JSON</td>
<td align="center">.json</td>
<td align="center"><a href="https://cran.r-project.org/package=jsonlite"><strong>jsonlite</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=jsonlite"><strong>jsonlite</strong></a></td>
<td align="center">Não</td>
</tr>
<tr class="even">
<td align="center">Matlab</td>
<td align="center">.mat</td>
<td align="center"><a href="https://cran.r-project.org/package=rmatio"><strong>rmatio</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=rmatio"><strong>rmatio</strong></a></td>
<td align="center">Não</td>
</tr>
<tr class="odd">
<td align="center">Planilha OpenDocument</td>
<td align="center">.ods</td>
<td align="center"><a href="https://cran.r-project.org/package=readODS"><strong>readODS</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=readODS"><strong>readODS</strong></a></td>
<td align="center">Não</td>
</tr>
<tr class="even">
<td align="center">tabelas HTML</td>
<td align="center">.html</td>
<td align="center"><a href="https://cran.r-project.org/package=xml2"><strong>xml2</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=xml2"><strong>xml2</strong></a></td>
<td align="center">Não</td>
</tr>
<tr class="odd">
<td align="center">documentos XML</td>
<td align="center">.xml</td>
<td align="center"><a href="https://cran.r-project.org/package=xml2"><strong>xml2</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=xml2"><strong>xml2</strong></a></td>
<td align="center">Não</td>
</tr>
<tr class="even">
<td align="center">Área de transferência</td>
<td align="center"><em>default</em> é tsv</td>
<td align="center"><a href="https://cran.r-project.org/package=clipr"><strong>clipr</strong></a></td>
<td align="center"><a href="https://cran.r-project.org/package=clipr"><strong>clipr</strong></a></td>
<td align="center">Não</td>
</tr>
</tbody>
</table>
<div id="como-usar" class="section level4">
<h4><span class="header-section-number">9.4.1.1</span> Como usar</h4>
<p>Vamos baixar um arquivo de dados em formato texto para importá-lo com o pacote
<strong>rio</strong>. Os dados são de precipitação diária e foram obtidos no sistema <a href="http://www.snirh.gov.br/hidroweb/publico/medicoes_historicas_abas.jsf">hidroweb</a>
da <a href="http://www.ana.gov.br/">Agência Nacional das Águas</a>.</p>
<p>A extensão do arquivo é <code>.TXT</code> e não se encaixa em nenhuma das extensões
esperadas pelo <strong>rio</strong>. Mas se você visualizar o arquivo no navegador (<code>browseURL(url="https://raw.github.com/lhmet/adar-ufsm/master/data/CHUVAS.TXT")</code>)
perceberá que os dados estão estruturados como CSV2, ou seja, com valores
delimitados por ";" e o separador decimal ",".</p>
<p>Vamos então baixar o arquivo e salvá-lo em diretório temporário do computador.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" title="1"><span class="co"># arquivo de exemplo disponível no GitHub</span></a>
<a class="sourceLine" id="cb305-2" title="2">hw_url &lt;-<span class="st"> &quot;https://raw.github.com/lhmet/adar-ufsm/master/data/CHUVAS.TXT&quot;</span></a>
<a class="sourceLine" id="cb305-3" title="3"><span class="co"># arquivo temporário para salvar o aquivo baixado</span></a>
<a class="sourceLine" id="cb305-4" title="4">(hw_file &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.csv&quot;</span>))</a>
<a class="sourceLine" id="cb305-5" title="5"><span class="co"># você pode substituir tempfile() por um caminho do seu</span></a>
<a class="sourceLine" id="cb305-6" title="6"><span class="co"># computador, p.ex. &quot;~/Downloads/CHUVAS.TXT&quot;</span></a>
<a class="sourceLine" id="cb305-7" title="7"><span class="kw">download.file</span>(</a>
<a class="sourceLine" id="cb305-8" title="8">  <span class="dt">url =</span> hw_url_file, </a>
<a class="sourceLine" id="cb305-9" title="9">  <span class="dt">destfile =</span> hw_file</a>
<a class="sourceLine" id="cb305-10" title="10">)</a>
<a class="sourceLine" id="cb305-11" title="11">hw_file</a></code></pre></div>
<p>Agora podemos importar os dados de precipitação baixados.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1"><span class="co"># Importa o arquivo </span></a>
<a class="sourceLine" id="cb306-2" title="2">dprec &lt;-<span class="st"> </span><span class="kw">import</span>(hw_file, </a>
<a class="sourceLine" id="cb306-3" title="3">                <span class="co"># se fread = TRUE (default usa função fread do pacote data.table)</span></a>
<a class="sourceLine" id="cb306-4" title="4">                <span class="dt">fread =</span> <span class="ot">FALSE</span>,  </a>
<a class="sourceLine" id="cb306-5" title="5">                <span class="dt">skip =</span> <span class="dv">15</span>, <span class="co"># pula linhas com metadados</span></a>
<a class="sourceLine" id="cb306-6" title="6">                <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="co"># com cabeçalho</span></a>
<a class="sourceLine" id="cb306-7" title="7">                <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="co"># delimitador entre os valores</span></a>
<a class="sourceLine" id="cb306-8" title="8">                <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>, <span class="co"># separador decimal</span></a>
<a class="sourceLine" id="cb306-9" title="9">                <span class="dt">na.strings =</span> <span class="st">&quot;&quot;</span>) <span class="co"># rótulo para dados faltantes</span></a>
<a class="sourceLine" id="cb306-10" title="10"><span class="co"># primeiras 10 colunas e linhas dos dados</span></a>
<a class="sourceLine" id="cb306-11" title="11"><span class="kw">head</span>(dprec[, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</a></code></pre></div>
<p>Para saber quais argumentos devem ser especificados na função <code>import()</code> você
precisar ler a documentação de ajuda da função (<code>?import</code>), principalmente a
sessão <em>Details</em>. Os argumentos usados no exemplo acima, estão implícitos no a
rgumento da função <code>import()</code> representado pela reticência (<code>...</code>). Conforme
descrito na sessão <em>Details</em>, o parâmetro <code>fread = FALSE</code> implica no uso da
função <code>read.table()</code> da base do R (descrita no Apêndice @ref(readtable))
para importar o arquivo; então a descrição dos argumentos especificados
encontra-se na ajuda da função <code>read.table()</code>, facilmente acessada pelo <em>link</em>
na ajuda da função <code>import</code>.</p>
<p>Quando os nomes dos arquivos incluem uma extensão reconhecida pelo <strong>rio</strong>
(Tabela @ref(tab:rio-table)), não há necessidade de especificar o argumento
<code>format</code> nas funções <code>import()</code> e <code>export()</code>. O formato dos arquivos é inferido
da extensão do arquivo (csv, no exemplo acima). No exemplo acima, a extensão do
arquivo original do <em>site</em> é desconhecida (ex.: ".TXT", ".dat", etc). Nesta
situação você deve especificar o formato do arquivo através do argumento
<code>format</code> da <code>import()</code>.</p>
<p>Para exportar os dados importados anteriormente, vamos criar um nome para
salvar o arquivo com a função <code>export()</code>. Vamos salvá-lo usando um formato
diferente do original, como <em>tsv</em> (valores separados por <em>tab</em>), para explorar
a funcionalidade do <strong>rio</strong>.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" title="1"><span class="co"># exporta para arquivo texto separado por tab</span></a>
<a class="sourceLine" id="cb307-2" title="2">(arq_temp &lt;-<span class="st"> </span><span class="kw">tempfile</span>())</a>
<a class="sourceLine" id="cb307-3" title="3">(dprec_file &lt;-<span class="st"> </span><span class="kw">paste0</span>(arq_temp, <span class="st">&quot;.tsv&quot;</span>))</a>
<a class="sourceLine" id="cb307-4" title="4"><span class="kw">export</span>(dprec, <span class="dt">file =</span> dprec_file, <span class="dt">na =</span> <span class="st">&quot;-999&quot;</span>)</a></code></pre></div>
</div>
<div id="arquivos-fwf" class="section level4">
<h4><span class="header-section-number">9.4.1.2</span> Arquivos formatados com largura fixa</h4>
<p>Alguns arquivos texto com dados tabulares podem não conter separadores para
economizar espaço de disco. Outros arquivos podem ser formatados usando largura
fixa para reservar o espaço de cada variável, o que facilita a legibilidade
dos dados.</p>
<p>Vamos usar como exemplo o arquivo de dados do Índice de Oscilação Sul (SOI)
obtido no site do
<a href="http://www.cpc.ncep.noaa.gov">National Weather Service - Climate Prediction Center (NWS-CPC)</a>.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1"><span class="co"># link para os dados do SOI</span></a>
<a class="sourceLine" id="cb308-2" title="2">link_soi &lt;-<span class="st"> &quot;http://www.cpc.ncep.noaa.gov/data/indices/soi&quot;</span></a></code></pre></div>
<p>Vamos visualizar os dados SOI no navegador para reconhecer o formato.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" title="1"><span class="kw">browseURL</span>(<span class="dt">url =</span> link_soi)</a></code></pre></div>
<p>Ao inspecionar cuidadosamente os dados até o fim da página no navegador,
percebe-se os seguintes aspectos sobre estes dados:</p>
<ul>
<li><p>temos duas tabelas de dados do SOI, uma de anomalias absolutas
(da linha 4 até 74) e outra de anomalias normalizadas (da linha 79 à 148);</p></li>
<li><p>os valores da coluna <code>YEAR</code> ocupam 4 campos (ou espaços), ou seja, vão desde
a 1ª até a 4 coluna; os valores da coluna <code>JAN</code> ocupam os campos da 5ª à 10ª
coluna e este padrão é repetido para as colunas restantes.</p></li>
<li><p>dados faltantes são representados pelo rótulo <code>-999.9</code></p></li>
<li><p>os dados incluem os nomes das variáveis (cabeçalho)</p></li>
<li><p>o cabeçalho ocupa um número de campos diferentes daqueles ocupados pelos
valores de SOI (note o sinal de menos que antecede os valores)</p></li>
</ul>
<p>Nosso interesse é na 1ª tabela de dados. Uma estratégia possível de importar
estes dados é começar lendo o cabeçalho.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1">nome_vars &lt;-<span class="st"> </span><span class="kw">scan</span>(</a>
<a class="sourceLine" id="cb310-2" title="2">    link_soi, <span class="co"># varredura do arquivo</span></a>
<a class="sourceLine" id="cb310-3" title="3">    <span class="dt">what =</span> <span class="st">&quot;character&quot;</span>, <span class="co"># tipo dos dados</span></a>
<a class="sourceLine" id="cb310-4" title="4">    <span class="dt">skip =</span> <span class="dv">3</span>, <span class="co"># pula 3 linhas</span></a>
<a class="sourceLine" id="cb310-5" title="5">    <span class="dt">nmax =</span> <span class="dv">13</span> <span class="co"># num. max. de campos a serem lidos</span></a>
<a class="sourceLine" id="cb310-6" title="6">)</a>
<a class="sourceLine" id="cb310-7" title="7">nome_vars</a></code></pre></div>
<p>A seguir, podemos usar o cabeçalho obtido acima, como argumento na <code>import()</code>
através do argumento <code>col.names</code>. As informações da inspeção dos dados são
utilizadas para definir os outros argumentos.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" title="1">soi &lt;-<span class="st"> </span><span class="kw">import</span>(</a>
<a class="sourceLine" id="cb311-2" title="2">  <span class="dt">file =</span> link_soi,</a>
<a class="sourceLine" id="cb311-3" title="3">  <span class="dt">format =</span> <span class="st">&quot;fwf&quot;</span>, <span class="co"># formato de largura fixa</span></a>
<a class="sourceLine" id="cb311-4" title="4">  <span class="dt">skip =</span> <span class="dv">4</span>, <span class="co"># pula 4 linhas</span></a>
<a class="sourceLine" id="cb311-5" title="5">  <span class="dt">header =</span> <span class="ot">FALSE</span>, <span class="co"># sem cabeçalho</span></a>
<a class="sourceLine" id="cb311-6" title="6">  <span class="dt">nrows =</span> <span class="dv">70</span>, <span class="co"># num. de linhas</span></a>
<a class="sourceLine" id="cb311-7" title="7">  <span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="kw">rep</span>(<span class="dv">6</span>, <span class="dv">12</span>)), <span class="co"># largura dos campos das variáveis</span></a>
<a class="sourceLine" id="cb311-8" title="8">  <span class="dt">na.strings =</span> <span class="st">&quot;-999.9&quot;</span>, <span class="co"># string para dados faltantes</span></a>
<a class="sourceLine" id="cb311-9" title="9">  <span class="dt">col.names =</span> nome_vars</a>
<a class="sourceLine" id="cb311-10" title="10">)</a>
<a class="sourceLine" id="cb311-11" title="11"><span class="kw">str</span>(soi)</a>
<a class="sourceLine" id="cb311-12" title="12"><span class="kw">tail</span>(soi)</a></code></pre></div>
<p>A documentação de ajuda da função <code>import()</code> do <strong>rio</strong> nos diz que no arquivo
acima foi usada a função <code>read.fwf()</code> do <img src="images/logo_r.png" width="20"> para ler os dados. Os
argumentos usados foram:</p>
<ul>
<li><code>format = "fwf"</code> significa formato de largura fixa</li>
<li><code>skip = 4</code> especifica que os dados iniciam após as 4 primeiras linhas do
arquivo</li>
<li><code>header = FALSE</code> especifica que estamos lendo diretamente os dados</li>
<li><code>nrows = 70</code> é o número de linhas lidas desde o começo dos dados, isto
é, <code>74 - 4</code>.</li>
<li><code>widths = c(4, rep(6, 12))</code> especifica a largura dos campos das variáveis;
4 campos para 1ª coluna e 6 campos para as 12 colunas seguintes;</li>
<li><code>na.strings = "-999.9"</code> indica o rótulo para os dados faltantes</li>
<li><code>col.names = nome_vars</code> especifica o nome das variáveis que será usado
no <em>data frame</em>.</li>
</ul>
<p>Por fim, salvaremos as anomalias absolutas do SOI em um arquivo CSV.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1"><span class="co"># nome para o arquivo CSV</span></a>
<a class="sourceLine" id="cb312-2" title="2">(soi_file &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;SOI.csv&quot;</span>))</a>
<a class="sourceLine" id="cb312-3" title="3"><span class="co"># exportação com rio</span></a>
<a class="sourceLine" id="cb312-4" title="4"><span class="kw">export</span>(soi,</a>
<a class="sourceLine" id="cb312-5" title="5">  <span class="dt">file =</span> soi_file,</a>
<a class="sourceLine" id="cb312-6" title="6">  <span class="dt">na =</span> <span class="st">&quot;-999.9&quot;</span></a>
<a class="sourceLine" id="cb312-7" title="7">)</a>
<a class="sourceLine" id="cb312-8" title="8"><span class="co"># verificar se o arquivo foi gerado</span></a>
<a class="sourceLine" id="cb312-9" title="9"><span class="kw">file.exists</span>(soi_file)</a></code></pre></div>
<p>Vamos importar o arquivo <code>SOI.csv</code> através da função <code>file.choose()</code>
(ou <code>choose.file()</code> no Windows) que permite selecionar o arquivo de
forma iterativa.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" title="1"><span class="co"># leitura de dados com escolha interativa do arquivo</span></a>
<a class="sourceLine" id="cb313-2" title="2">soi.df &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="kw">file.choose</span>(),</a>
<a class="sourceLine" id="cb313-3" title="3">  <span class="co"># file.choose só é válido em sistema *unix</span></a>
<a class="sourceLine" id="cb313-4" title="4">  <span class="co"># no windows é choose.file()</span></a>
<a class="sourceLine" id="cb313-5" title="5">  <span class="dt">header =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb313-6" title="6">  <span class="dt">na.strings =</span> <span class="st">&quot;-999.9&quot;</span></a>
<a class="sourceLine" id="cb313-7" title="7">)</a></code></pre></div>
<p>Navegue até o diretório do arquivo <code>SOI.csv</code> e clique duas vezes sobre o
arquivo ele.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" title="1"><span class="kw">head</span>(soi.df)</a></code></pre></div>
</div>
</div>
<div id="arquivos-texto-não-estruturados" class="section level3">
<h3><span class="header-section-number">9.4.2</span> Arquivos texto não estruturados</h3>
<p>Em alguns casos é necessário ler arquivos textos sem uma estrutura definida
como no caso de arquivos delimitados. Se o arquivo não é bem estruturado é mais
fácil ler cada linha de texto separadamente e depois decompor e manipular o
conteúdo do texto.
A função <code>readLines()</code> é adequada para isso. Cada linha é tratada como um
elemento de um vetor do tipo <code>character</code>.</p>
<p>Vamos importar os dados do INMET, mas dessa vez vamos focar no cabeçalho, onde
estão as informações da estação meteorológica.</p>
<p>Obtendo os dados</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" title="1"><span class="co"># arquivo de exemplo disponível no GitHub</span></a>
<a class="sourceLine" id="cb315-2" title="2">bdmep_url_file &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/lhmet/adar-ufsm/master/data/83004.txt&quot;</span></a>
<a class="sourceLine" id="cb315-3" title="3"><span class="co"># leitura do cabecalho do arquivo de dados de uma estação do inmet</span></a>
<a class="sourceLine" id="cb315-4" title="4">cab &lt;-<span class="st"> </span><span class="kw">readLines</span>(bdmep_url_file)</a>
<a class="sourceLine" id="cb315-5" title="5"><span class="kw">head</span>(cab)</a>
<a class="sourceLine" id="cb315-6" title="6"><span class="co"># somente linhas com coordenadas da estação</span></a>
<a class="sourceLine" id="cb315-7" title="7">cab[<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>]</a>
<a class="sourceLine" id="cb315-8" title="8"><span class="kw">is.vector</span>(cab[<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>])</a>
<a class="sourceLine" id="cb315-9" title="9"><span class="co"># arranjando em coluna</span></a>
<a class="sourceLine" id="cb315-10" title="10"><span class="kw">cbind</span>(cab[<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>])</a>
<a class="sourceLine" id="cb315-11" title="11"><span class="co"># selecionando somente os dados e o nome das variáveis</span></a>
<a class="sourceLine" id="cb315-12" title="12">cab[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>)][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a></code></pre></div>
<p>A função <code>writeLines()</code> escreve os elementos do vetor de caracteres em um
arquivo texto. Essa é uma forma de escrever os dados mantendo a formatação
original dos dados.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" title="1"><span class="co"># dados sem as linhas com metadados</span></a>
<a class="sourceLine" id="cb316-2" title="2">dados_limpos &lt;-<span class="st"> </span>cab[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>)]</a>
<a class="sourceLine" id="cb316-3" title="3"><span class="co"># arquivo para salvar os dados limpos</span></a>
<a class="sourceLine" id="cb316-4" title="4">file_<span class="dv">83004</span>_limpo &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">tempfile</span>(), <span class="st">&quot;.txt&quot;</span>)</a>
<a class="sourceLine" id="cb316-5" title="5"><span class="co"># escrevendo dados limpos</span></a>
<a class="sourceLine" id="cb316-6" title="6"><span class="kw">writeLines</span>(</a>
<a class="sourceLine" id="cb316-7" title="7">  <span class="dt">text =</span>  dados_limpos, </a>
<a class="sourceLine" id="cb316-8" title="8">  <span class="dt">con =</span> file_<span class="dv">83004</span>_limpo</a>
<a class="sourceLine" id="cb316-9" title="9">)</a></code></pre></div>
</div>
</div>
<div id="arquivos-binários" class="section level2">
<h2><span class="header-section-number">9.5</span> Arquivos binários</h2>
<p>Arquivo texto favorecem a legibilidade humana dos dados mas tem precisão
numérica limitada. Formatos binários diminuem substancialmente o tamanho,
o tempo de leitura e escrita de arquivos. Por isso, vários softwares armazenam dados no formato binário.</p>
<p>Após a leitura e o processamento de dados brutos você provavelmente os salvará
para uso futuro. Este procedimento é recomendado para evitar de ter que repetir
todo processamento novamente. Para dados que ocupam espaço significativo (por
exemplo com mais de 1 milhão de linhas) é mais eficiente salvar os dados em um
formato binário, uma vez que dessa forma os tempos de escrita e leitura são
menores.</p>
<div id="formatos-binários-nativos-do-r" class="section level3">
<h3><span class="header-section-number">9.5.1</span> Formatos binários nativos do R</h3>
<div id="rddata" class="section level4">
<h4><span class="header-section-number">9.5.1.1</span> RDdata</h4>
<p>Para mostrar como usar as funções <code>save()</code> e <code>load()</code> vamos utilizar os dados
pluviométricos lidos anteriormente (<code>dprec</code>) e selecionar as colunas de
interesse. O <em>data frame</em> será salvo em um arquivo binário do R com a extensão
<code>.RData</code>.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" title="1"><span class="co"># início dos dados dprec</span></a>
<a class="sourceLine" id="cb317-2" title="2"><span class="kw">head</span>(dprec[, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</a>
<a class="sourceLine" id="cb317-3" title="3"><span class="co"># colunas referentes do dia 1 a 31 de cada ano</span></a>
<a class="sourceLine" id="cb317-4" title="4">chuva_df &lt;-<span class="st"> </span>dprec[, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">14</span><span class="op">:</span><span class="dv">44</span>)]</a>
<a class="sourceLine" id="cb317-5" title="5"><span class="co"># gerando arquivo em um diretório temporário</span></a>
<a class="sourceLine" id="cb317-6" title="6">arq_chuva &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.RData&quot;</span>)</a>
<a class="sourceLine" id="cb317-7" title="7"><span class="kw">save</span>(chuva_df, <span class="dt">file =</span> arq_chuva)</a>
<a class="sourceLine" id="cb317-8" title="8"><span class="co"># verificando se arquivo foi salvo no diretório</span></a>
<a class="sourceLine" id="cb317-9" title="9"><span class="kw">file.exists</span>(arq_chuva)</a></code></pre></div>
<p>Como o objeto <code>chuva_df</code> foi salvo em um arquivo, vamos removê-lo e então
recuperá-lo carregando os dados armazenado no arquivo <code>chuva_df.RData</code>.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" title="1"><span class="co"># apagando chuva_df do ambiente de trabalho</span></a>
<a class="sourceLine" id="cb318-2" title="2"><span class="kw">rm</span>(chuva_df)</a>
<a class="sourceLine" id="cb318-3" title="3"><span class="co"># verifica existência de objeto</span></a>
<a class="sourceLine" id="cb318-4" title="4"><span class="kw">exists</span>(chuva_df)</a>
<a class="sourceLine" id="cb318-5" title="5"><span class="co"># carregando chuva_df</span></a>
<a class="sourceLine" id="cb318-6" title="6"><span class="kw">load</span>(<span class="dt">file =</span> arq_chuva)</a>
<a class="sourceLine" id="cb318-7" title="7"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb318-8" title="8"><span class="co"># para carregar os dados e saber o nome com que foram salvos</span></a>
<a class="sourceLine" id="cb318-9" title="9"><span class="kw">print</span>(<span class="kw">load</span>(<span class="dt">file =</span> arq_chuva))</a>
<a class="sourceLine" id="cb318-10" title="10"><span class="kw">head</span>(chuva_df[, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</a></code></pre></div>
<p>Um <strong>vantagem desse formato</strong> é que os objetos criados podem ser lidos pelo
<img src="images/logo_r.png" width="20"> independente do sistema operacional e da arquitetura do computador,
tornando muito prático o acesso aos dados.
Cada vez que uma sessão do R é finalizada, uma janela surge perguntando se
deseja salvar o espaço de trabalho (<code>save the workspace image</code>), que nada mais
é do que um arquivo binário chamado <code>.RData</code> no diretório de trabalho. Assim
quando iniciar a sessão se o arquivo <code>.RData</code> estiver no diretório de trabalho
ele será automaticamente carregado tornando todos os objetos da última sessão
disponíveis novamente.
Se você deseja salvar o espaço de trabalho em outro momento use a função
<code>save.image()</code>.</p>
<p>Quando desejamos salvar só uma parte dos dados uma opção é usar a função <code>rm()</code>
(uma abreviação de <strong>remove</strong>) para remover objetos que não são de interesse
antes de finalizar a sessão do R. A função <code>save()</code>permite salvar <em>mais de um
objeto</em> em um mesmo arquivo.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" title="1">file_dados_prec &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.Rdata&quot;</span>) </a>
<a class="sourceLine" id="cb319-2" title="2"><span class="kw">save</span>(cab, chuva_df, <span class="dt">file =</span> file_dados_prec)</a>
<a class="sourceLine" id="cb319-3" title="3"><span class="co">#save(cab, chuva_df, file = &quot;../output-adar/dados_prec.RData&quot;)</span></a>
<a class="sourceLine" id="cb319-4" title="4"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb319-5" title="5"><span class="kw">rm</span>(cab, chuva_df)</a>
<a class="sourceLine" id="cb319-6" title="6"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb319-7" title="7"><span class="co"># carrega e imprime na tela nome dos dados carregados</span></a>
<a class="sourceLine" id="cb319-8" title="8"><span class="kw">print</span>(<span class="kw">load</span>(file_dados_prec))</a>
<a class="sourceLine" id="cb319-9" title="9"><span class="kw">ls</span>()</a></code></pre></div>
</div>
<div id="rds" class="section level4">
<h4><span class="header-section-number">9.5.1.2</span> RDS</h4>
<p>As funções <code>readRDS()</code> e <code>writeRDS()</code> são similares a <code>load()</code> e <code>save()</code>,
respectivamente, exceto que elas lidam com <strong>um único objeto</strong>. Em
contrapartida elas possuem a flexibilidade nomear o objeto lido com um nome
diferente do qual ele foi salvo.
Vamos alterar o formato da data do <em>dataframe</em> <code>chuva_df</code> e salvá-lo no
arquivo <code>chuva_df.rds</code>.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" title="1"><span class="co"># salvar dados em um arquivo rds</span></a>
<a class="sourceLine" id="cb320-2" title="2"><span class="kw">head</span>(chuva_df[, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</a>
<a class="sourceLine" id="cb320-3" title="3"><span class="co"># alterando formato de datas da coluna Data</span></a>
<a class="sourceLine" id="cb320-4" title="4">chuva_df<span class="op">$</span>Data &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="dt">x =</span> chuva_df<span class="op">$</span>Data, <span class="dt">format =</span> <span class="st">&quot;%d/%m/%Y&quot;</span>)</a>
<a class="sourceLine" id="cb320-5" title="5">file_rds_chuva_df &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb320-6" title="6"><span class="kw">saveRDS</span>(<span class="dt">object =</span> chuva_df, <span class="dt">file =</span> file_rds_chuva_df)</a>
<a class="sourceLine" id="cb320-7" title="7"><span class="kw">file.exists</span>(file_rds_chuva_df)</a></code></pre></div>
<p>Após salvar o <em>dataframe</em> <code>chuva_df</code> vamos removê-lo do ambiente da sessão
e recuperá-lo com a função <code>readRDS()</code>.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" title="1"><span class="co"># removendo chuva_df do ambiente</span></a>
<a class="sourceLine" id="cb321-2" title="2"><span class="kw">rm</span>(chuva_df)</a>
<a class="sourceLine" id="cb321-3" title="3"><span class="co"># recuperando dados do arquivo em uma variável com nome diferente do original</span></a>
<a class="sourceLine" id="cb321-4" title="4">prec_ana &lt;-<span class="st"> </span><span class="kw">readRDS</span>(file_rds_chuva_df)</a>
<a class="sourceLine" id="cb321-5" title="5"><span class="kw">head</span>(prec_ana[, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</a></code></pre></div>
</div>
</div>
<div id="netcdf-network-common-data-form" class="section level3">
<h3><span class="header-section-number">9.5.2</span> NetCDF (Network Common Data Form)</h3>
<p>NetCDF é um formato binário, auto-descritivo e independente do SO criado para
criar e distribuir arranjos multidimensionais de dados gradeados.
Originalmente foi desenvolvido para o armazenamento e distribuição de dados
climáticos, tais como os gerados por modelos climáticos e sistemas de
assimilação de dados como as
<a href="http://en.wikipedia.org/wiki/Meteorological_reanalysis">reanálises</a>.</p>
<p>As bibliotecas NetCDF são mantidas pelo
<a href="http://www.unidata.ucar.edu/software/netcdf/">Unidata</a>. Dados no formato
NetCDF são acessíveis no R pelos pacotes
<a href="http://cran.r-project.org/web/packages/ncdf4/index.html">ncdf4</a> <span class="citation">(Pierce <a href="#ref-Pierce2017" role="doc-biblioref">2017</a>)</span> e <a href="http://cran.r-project.org/web/packages/raster/index.html">raster</a>
<span class="citation">(Hijmans <a href="#ref-Hijmans2017" role="doc-biblioref">2017</a>)</span>. Esses pacotes fornecem o suporte necessário para leitura e
escrita de arquivos NetCDF.</p>
<p>O pacote <a href="https://cran.r-project.org/src/contrib/Archive/ncdf/">ncdf</a> foi um
dos primeiros pacotes de interface com dados NetCDF, mas com suporte somente
para versão 3. O pacote que o substituiu foi o
<a href="https://cran.r-project.org/web/packages/ncdf4/index.html">ncdf4</a> e suporta
tanto arquivos no formato NetCDF 3 como 4. O pacote <strong>raster</strong> baseia-se no
<strong>ncdf4</strong> para fornecer através da função <code>brick()</code> uma importação e exportação
fácil de dados NetCDF com o R.</p>
<div id="pré-requisitos-2" class="section level4">
<h4><span class="header-section-number">9.5.2.1</span> Pré-requisitos</h4>
<p>Para utilizar o pacote <code>ncdf4</code> é necessário instalar os pacotes linux mostrados
abaixo.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb322-1" title="1"><span class="co">## Install pacotes NetCDF</span></a>
<a class="sourceLine" id="cb322-2" title="2">$ <span class="fu">sudo</span> apt-get install libnetcdf-dev libudunits2-dev</a></code></pre></div>
<p>Pacotes necessários:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" title="1"><span class="kw">library</span>(ncdf4)</a></code></pre></div>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" title="1"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb324-2" title="2"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb324-3" title="3"><span class="kw">library</span>(fields)</a></code></pre></div>
</div>
<div id="arquivo-exemplo" class="section level4">
<h4><span class="header-section-number">9.5.2.2</span> Arquivo exemplo</h4>
<p>Os exemplos a seguir usam o pacote
<a href="https://cran.r-project.org/web/packages/ncdf4/index.html">ncdf4</a> para ler
arquivo NetCDF com dados climáticos do
<em>Climate Research Unit <a href="http://www.cru.uea.ac.uk/data">CRU</a></em>, consistindo de
valores médios de longo prazo (1961-1990) da temperatura do ar próximo à
superfície com resolução espacial de 0,5 º na área continental.
As dimensões da <em>array</em> são: 720 (longitudes) x 360 (latitudes) x 12 (meses).</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" title="1">dados_cru_url &lt;-<span class="st"> &quot;https://www.dropbox.com/s/ynp9i42is1flg43/cru10min30_tmp.nc?dl=1&quot;</span></a>
<a class="sourceLine" id="cb325-2" title="2">dest_file_nc &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;cru10min30_tmp.nc&quot;</span>)</a>
<a class="sourceLine" id="cb325-3" title="3"><span class="kw">download.file</span>(dados_cru_url, dest_file_nc)</a></code></pre></div>
<p>Abrindo arquivo NetCDF e obtendo informações básicas.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" title="1">dest_file_nc</a>
<a class="sourceLine" id="cb326-2" title="2"><span class="kw">file.exists</span>(dest_file_nc)</a></code></pre></div>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" title="1"><span class="co"># variável de interesse, tmp: temperatura do ar</span></a>
<a class="sourceLine" id="cb327-2" title="2">dname &lt;-<span class="st"> &quot;tmp&quot;</span>  </a>
<a class="sourceLine" id="cb327-3" title="3"><span class="co"># abre o arquivo NetCDF</span></a>
<a class="sourceLine" id="cb327-4" title="4">ncin &lt;-<span class="st"> </span><span class="kw">nc_open</span>(dest_file_nc)</a>
<a class="sourceLine" id="cb327-5" title="5"><span class="kw">print</span>(ncin)</a>
<a class="sourceLine" id="cb327-6" title="6"><span class="co"># estrutura dos dados</span></a>
<a class="sourceLine" id="cb327-7" title="7"><span class="co">#str(ncin)</span></a>
<a class="sourceLine" id="cb327-8" title="8"><span class="co"># classe</span></a>
<a class="sourceLine" id="cb327-9" title="9"><span class="kw">class</span>(ncin)</a>
<a class="sourceLine" id="cb327-10" title="10"><span class="co"># modo</span></a>
<a class="sourceLine" id="cb327-11" title="11"><span class="kw">mode</span>(ncin)</a></code></pre></div>
<p>Agora, vamos ler as coordenadas de longitude e latitude.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" title="1">lon &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(ncin, <span class="st">&quot;lon&quot;</span>)</a>
<a class="sourceLine" id="cb328-2" title="2">nlon &lt;-<span class="st"> </span><span class="kw">dim</span>(lon)</a>
<a class="sourceLine" id="cb328-3" title="3"><span class="kw">head</span>(lon)</a>
<a class="sourceLine" id="cb328-4" title="4">lat &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(ncin, <span class="st">&quot;lat&quot;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb328-5" title="5">nlat &lt;-<span class="st"> </span><span class="kw">dim</span>(lat)</a>
<a class="sourceLine" id="cb328-6" title="6"><span class="kw">head</span>(lat)</a>
<a class="sourceLine" id="cb328-7" title="7"><span class="kw">c</span>(nlon, nlat)</a></code></pre></div>
<p>Vamos obter a variável temporal e seus atributos usando as funções <code>ncvarget()</code>
e <code>ncatt_get</code>. Depois fechamos o acesso ao arquivo NetCDF.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" title="1">tempo &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(ncin, <span class="st">&quot;time&quot;</span>)</a>
<a class="sourceLine" id="cb329-2" title="2">(tunits &lt;-<span class="st"> </span><span class="kw">ncatt_get</span>(ncin, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;units&quot;</span>))</a>
<a class="sourceLine" id="cb329-3" title="3">(nt &lt;-<span class="st"> </span><span class="kw">dim</span>(tempo))</a>
<a class="sourceLine" id="cb329-4" title="4">tmp.array &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(ncin, dname)</a>
<a class="sourceLine" id="cb329-5" title="5"><span class="co"># resumo da estrutura dos dados</span></a>
<a class="sourceLine" id="cb329-6" title="6"><span class="kw">str</span>(tmp.array)</a>
<a class="sourceLine" id="cb329-7" title="7"><span class="co"># nome longo da variável</span></a>
<a class="sourceLine" id="cb329-8" title="8">(dlname &lt;-<span class="st"> </span><span class="kw">ncatt_get</span>(ncin, dname, <span class="st">&quot;long_name&quot;</span>))</a>
<a class="sourceLine" id="cb329-9" title="9"><span class="co"># unidades da variável</span></a>
<a class="sourceLine" id="cb329-10" title="10">(dunits &lt;-<span class="st"> </span><span class="kw">ncatt_get</span>(ncin, dname, <span class="st">&quot;units&quot;</span>))</a>
<a class="sourceLine" id="cb329-11" title="11"><span class="co"># valor definido para valores faltantes</span></a>
<a class="sourceLine" id="cb329-12" title="12">(fillvalue &lt;-<span class="st"> </span><span class="kw">ncatt_get</span>(ncin, dname, <span class="st">&quot;_FillValue&quot;</span>))</a>
<a class="sourceLine" id="cb329-13" title="13"><span class="co"># fechando arquivo</span></a>
<a class="sourceLine" id="cb329-14" title="14"><span class="kw">nc_close</span>(ncin)</a></code></pre></div>
<p>As variáveis do arquivo NetCDF são lidas e escritas como vetores (p.ex.:
longitudes), <em>arrays</em> bidimensionais (matrizes, campo espacial de um momento),
ou <em>arrays</em> multidimensionais (campos espaciais de uma variável em diversos
tempos).</p>
<p>Vamos extrair o campo espacial de um passo de tempo (1 dia), criar um
<em>data frame</em> onde cada linha será um ponto de grade e a coluna representa
uma variável, por exemplo: longitude, latitude e temperatura.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" title="1">m &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb330-2" title="2"><span class="co"># campo espacial do primeiro dia de dados</span></a>
<a class="sourceLine" id="cb330-3" title="3">tmp.slice &lt;-<span class="st"> </span>tmp.array[, , m]</a>
<a class="sourceLine" id="cb330-4" title="4"><span class="kw">str</span>(tmp.slice)</a>
<a class="sourceLine" id="cb330-5" title="5"><span class="co"># outra função para visualizar dados com 3D</span></a>
<a class="sourceLine" id="cb330-6" title="6"><span class="kw">image.plot</span>(lon, lat, tmp.slice, <span class="dt">col =</span> <span class="kw">rev</span>(<span class="kw">brewer.pal</span>(<span class="dv">10</span>, <span class="st">&quot;RdBu&quot;</span>)))</a></code></pre></div>
<div id="forma-fácil-de-importar-netcdf" class="section level5">
<h5><span class="header-section-number">9.5.2.2.1</span> Forma fácil de importar NetCDF</h5>
<p>O pacote <a href="https://cran.r-project.org/web/packages/raster/index.html">raster</a>
fornece uma função para fácil importação de arquivos NetCDF. Os dados
importados são retornados no formato específico do pacote (classe de dados
<em>RasterBrick</em>). Esta classe de dados, corresponde a uma estrutura de dados
espaciais gradeados, regularmente espaçados, podendo ter uma ou mais dimensões.</p>
<p>Quando o dados gradeados possuem somente uma variável em um único tempo, como
por exemplo a altitude do terreno (z), temos 2 dimensões espaciais <em>x</em>
(longitude), <em>y</em> (latitude) e <em>z</em>. Neste caso, o dado é um <a href="https://docs.qgis.org/2.8/pt_BR/docs/gentle_gis_introduction/raster_data.html">raster</a>
e sua classe de dados é denominada <code>RasterLayer</code> no pacote <strong>raster</strong>, ou seja
os dados possuem somente uma camada. Quando os dados possuem mais de uma camada,
como no casos de campos espaciais de temperatura em diferentes meses (cada mês
é uma camada) a classe de dados é denominada <code>Rasterbrick</code>.</p>
<p>Para importar dados em formato NetCDF que tenham mais uma camada no R, usamos
a função <code>brick()</code> do pacote <strong>raster</strong>.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb331-1" title="1">brick_tar_cru &lt;-<span class="st"> </span><span class="kw">brick</span>(dest_file_nc)</a>
<a class="sourceLine" id="cb331-2" title="2">brick_tar_cru</a></code></pre></div>
<p>O resultado da importação de um <code>RasterBrick</code> mostra no console do R informações
sobre as dimensões dos dados, a resolução espacial, os limites do domínio
espacial, o sistema de coordenadas de referência, o arquivo fonte dos dados,
o nome das camadas, eventualmente as datas e nome da variável importada do
arquivo NetCDF.</p>
<p>Quando o arquivo NetCDF possui mais de uma variável é necessário definir o nome
da variável de interesse através do argumento <code>varname</code>. No exemplo acima
poderíamos ter chamado a função <code>raster::brick()</code> com
<code>brick(dest_file_nc, varname = "tmp")</code>. Mas como há somente uma variável no
arquivo NetCDF deste exemplo a especificação deste argumento é opcional.</p>
<p>Os nomes das camadas, são acessados e alterados com função <code>names()</code>, da mesma
forma que em <em>data frames</em>.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" title="1"><span class="co"># substituindo a letra &quot;X&quot; dos nomes por &quot;Mes_&quot;</span></a>
<a class="sourceLine" id="cb332-2" title="2"><span class="kw">names</span>(brick_tar_cru) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Mes_&quot;</span>, <span class="kw">names</span>(brick_tar_cru))</a>
<a class="sourceLine" id="cb332-3" title="3"><span class="kw">names</span>(brick_tar_cru)</a></code></pre></div>
<p>Um gráfico pode ser gerado através da funções <code>plot()</code>. Por default são
mostrados no máximo 16 camadas de um <code>RasteBrick</code>.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb333-1" title="1"><span class="kw">plot</span>(brick_tar_cru, <span class="dt">col =</span> <span class="kw">rev</span>(<span class="kw">brewer.pal</span>(<span class="dv">10</span>, <span class="st">&quot;RdBu&quot;</span>)))</a></code></pre></div>
<p>Os dados em formato <code>RasterBrick</code>, <code>RasterStack</code> ou <code>RasterLayer</code> podem ser
convertidos para <code>data frame</code> por meio da função <code>raster::as.data.frame()</code>.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" title="1">df_tar_cru &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(</a>
<a class="sourceLine" id="cb334-2" title="2">  <span class="dt">x =</span> brick_tar_cru,</a>
<a class="sourceLine" id="cb334-3" title="3">  <span class="dt">xy =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb334-4" title="4">  <span class="dt">na.rm =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb334-5" title="5">  <span class="co">#long = TRUE</span></a>
<a class="sourceLine" id="cb334-6" title="6">)</a>
<a class="sourceLine" id="cb334-7" title="7"><span class="kw">str</span>(df_tar_cru)</a>
<a class="sourceLine" id="cb334-8" title="8"><span class="kw">head</span>(df_tar_cru)</a></code></pre></div>
<p>Os argumentos usados na função <code>as.dataframe()</code> correspondem a:</p>
<ul>
<li><p><code>x</code> é o objeto <code>Raster*</code> (onde * significa <code>RasterBrick</code>, <code>RasterStack</code>
ou <code>RasterLayer</code>)</p></li>
<li><p><code>xy</code> é um argumento lógico, se <code>TRUE</code> (verdadeiro) inclui as coordenadas
espaciais (longitude e altitude) das células do <em>raster</em> como colunas no
<em>data frame</em> de saída</p></li>
<li><p><code>na.rm</code> é um argumento opcional lógico, tal que se for <code>TRUE</code> remove linhas
com valores <code>NA</code>. Isto é particularmente útil para grandes conjuntos de dados
com muitos valores <code>NA</code>s e em regiões oceânicas, como no arquivo de exemplo,
onde não há dados medidos. Note que se <code>na.rm = FALSE</code> (<code>TRUE</code>) o <em>data frame</em>
resultante terá (poderá ter) um número de linhas igual ao (menor que o) número
de células do <code>RasterBrick</code>.</p></li>
</ul>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb335-1" title="1"><span class="kw">nrow</span>(df_tar_cru) <span class="op">&lt;</span><span class="st"> </span><span class="kw">ncell</span>(brick_tar_cru)</a></code></pre></div>
<ul>
<li><code>long</code> é um argumento opcional lógico. Se for <code>TRUE</code> (verdadeiro) os valores
são reestruturados de um formato amplo para um formato longo (veja a seção
@ref(formatos-dados) para definição de dados no formato longo e amplo).</li>
</ul>
<p>Como exercício, rode novamente o trecho de código anterior, mudando os valores
dos argumentos lógicos e observe as mudanças nas dimensões do <code>data frame</code>
resultante.</p>
</div>
</div>
</div>
</div>
<div id="arquivos-excel" class="section level2">
<h2><span class="header-section-number">9.6</span> Arquivos Excel</h2>
<p>O armazenamento de dados em formato Excel (arquivos com extensões <code>.xls</code> e
<code>.xlsx</code>) é uma prática muito popular, principalmente em empresas privadas.
Entretanto, arquivos em formato Excel tem problemas de interação com
<a href="https://pt.wikipedia.org/wiki/Sistema_de_controle_de_vers%C3%B5es">sistemas de controle de versões</a>.
Se a rastreabilidade das mudanças em seus dados é importante, trabalhar com
arquivo texto é uma boa opção. O formato CSV é facilmente importado no Excel
e por isso é um formato texto amplamente utilizado. Uma solução é converter as
planilhas Excel para <code>csv</code> usando algum programa.</p>
<p>Mas caso isso não seja viável, você verá as opções mais eficientes para
processar arquivos Excel no R.</p>
<p>Importar ou exportar dados neste formato para o R era trabalhoso devido a
dependências dos pacotes em programas externos (Excel, Java, Perl, etc). Mas
nos últimos esta tarefa deixou de ser um obstáculo.</p>
<p>Há uma variedade de pacotes para processar dados em Excel, entre eles estão:
<a href="https://cran.r-project.org/web/packages/gdata/index.html">gdata</a>,
<a href="https://cran.r-project.org/web/packages/XLConnect/index.html">XLConnect</a>, <a href="https://cran.r-project.org/web/packages/xlsx/index.html">xlsx</a>, <a href="https://cran.r-project.org/web/packages/openxlsx/index.html">openxlsx</a>,
<a href="https://readxl.tidyverse.org/">readxl</a>, <a href="https://github.com/ropensci/writexl">writexl</a>
e <a href="https://cran.r-project.org/web/packages/WriteXLS/index.html">WriteXLS</a>.</p>
<p>Na seção @ref(Rio) vimos que o pacote <strong>rio</strong> importa diversos formatos de
arquivos, inclusive Excel (Tabela @ref(tab:rio-table)). A função <code>import()</code>
utiliza a função <code>read_excel()</code>do pacote <strong>readr</strong> para importar arquivos
Excel. A função <code>export()</code>, por outro lado, utiliza a função <code>write.xlsx()</code>
do pacote <strong>openxlsx</strong>.</p>
<p>Além do uso do pacote <strong>rio</strong> para exportar arquivos <code>xlsx</code>, veremos também
o pacote <a href="https://github.com/ropensci/writexl">writexl</a> por ter uma exportação
mais rápida que a usada no pacote <strong>rio</strong>.</p>
<div id="como-usar-1" class="section level3">
<h3><span class="header-section-number">9.6.1</span> Como usar</h3>
<p>Vamos baixar um arquivo <code>.xls</code> para usar com a função <code>import()</code> do pacote
<strong>rio</strong>.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" title="1">excel_file_url &lt;-<span class="st"> &quot;https://github.com/lhmet/adar-ufsm/blob/master/data/Esta%C3%A7%C3%B5es%20Normal%20Climato%C3%B3gica%201981-2010.xls?raw=true&quot;</span></a>
<a class="sourceLine" id="cb336-2" title="2">dest_file_excel &lt;-<span class="st"> </span><span class="kw">file.path</span>(</a>
<a class="sourceLine" id="cb336-3" title="3">  <span class="kw">tempdir</span>(), </a>
<a class="sourceLine" id="cb336-4" title="4">  <span class="st">&quot;Estacoes-Normal-Climatologica-1981-2010.xls&quot;</span></a>
<a class="sourceLine" id="cb336-5" title="5">  )</a>
<a class="sourceLine" id="cb336-6" title="6"><span class="kw">download.file</span>(excel_file_url, dest_file_excel)</a></code></pre></div>
<p>Agora podemos importar o arquivo baixado com o pacote <strong>rio</strong>.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb337-1" title="1">inmet_estacoes &lt;-<span class="st"> </span><span class="kw">import</span>(</a>
<a class="sourceLine" id="cb337-2" title="2">  <span class="dt">file =</span> dest_file_excel,</a>
<a class="sourceLine" id="cb337-3" title="3">  <span class="dt">col_names =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb337-4" title="4">  <span class="dt">skip =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb337-5" title="5"><span class="kw">head</span>(inmet_estacoes)</a></code></pre></div>
</div>
<div id="export-xls" class="section level3">
<h3><span class="header-section-number">9.6.2</span> Escrita de arquivos excel no formato <code>.xls</code></h3>
<p>Vamos alterar os nomes das variáveis para minúsculo e escrever o <em>data frame</em>
em novo arquivo <code>.xls</code>.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb338-1" title="1"><span class="kw">names</span>(inmet_estacoes) &lt;-<span class="st"> </span><span class="kw">tolower</span>(<span class="kw">names</span>(inmet_estacoes))</a>
<a class="sourceLine" id="cb338-2" title="2"><span class="kw">head</span>(inmet_estacoes)</a></code></pre></div>
<p>Peraí! Mas o <strong>rio</strong> não suporta a opção de exportar arquivos no formato
<code>.xls</code> (confira na Tabela @ref(tab:rio-table)). Uma alternativa, caso você
ainda realmente precise escrever os dados no formato <code>xls</code>, é o pacote <a href="https://cran.r-project.org/web/packages/WriteXLS/index.html">WriteXLS</a>, no
entanto ele possui dependência da linguagem <a href="https://www.perl.org/">PERL</a>.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb339-1" title="1"><span class="kw">library</span>(WriteXLS)</a>
<a class="sourceLine" id="cb339-2" title="2">arq_xls_temp &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="kw">basename</span>(dest_file_excel))</a>
<a class="sourceLine" id="cb339-3" title="3"><span class="kw">WriteXLS</span>(<span class="dt">x =</span> inmet_estacoes, <span class="dt">ExcelFileName =</span> arq_xls_temp)</a>
<a class="sourceLine" id="cb339-4" title="4"><span class="kw">file.exists</span>(arq_xls_temp)</a>
<a class="sourceLine" id="cb339-5" title="5"><span class="co"># conferindo</span></a>
<a class="sourceLine" id="cb339-6" title="6"><span class="kw">head</span>(</a>
<a class="sourceLine" id="cb339-7" title="7">  <span class="kw">import</span>(</a>
<a class="sourceLine" id="cb339-8" title="8">    <span class="dt">file =</span> arq_xls_temp,</a>
<a class="sourceLine" id="cb339-9" title="9">    <span class="dt">col_names =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb339-10" title="10">  )</a>
<a class="sourceLine" id="cb339-11" title="11">)</a></code></pre></div>
</div>
<div id="escrita-de-arquivos-excel-no-formato-.xlsx" class="section level3">
<h3><span class="header-section-number">9.6.3</span> Escrita de arquivos excel no formato <code>.xlsx</code></h3>
<p>Se algum dia, você precisa entregar uma penca de arquivos em formato Excel,
então valerá a pena saber qual das opções de escrita de arquivos <code>xlsx</code> é mais
eficiente.</p>
<p>No trecho de código abaixo vamos fazer essa comparação usando os mesmos dados
da seção @ref(export-xls)m <code>inmet_estacoes</code>. As funções avaliadas são a
<code>writexl::write_xlsx</code> e a <code>openxlsx::write.xlsx</code>.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" title="1">tempos_escrita_xlsx &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb340-2" title="2">  <span class="dt">writexl =</span> <span class="kw">write_xlsx</span>(inmet_estacoes, <span class="kw">tempfile</span>()),</a>
<a class="sourceLine" id="cb340-3" title="3">  <span class="dt">openxlsx =</span> <span class="kw">write.xlsx</span>(inmet_estacoes, <span class="kw">tempfile</span>()),</a>
<a class="sourceLine" id="cb340-4" title="4">  <span class="dt">times =</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb340-5" title="5">)</a>
<a class="sourceLine" id="cb340-6" title="6">tempos_escrita_xlsx</a></code></pre></div>
<p>A função <code>microbenckmar::microbenckmark</code> usada acima toma os tempos das
expressões que foram avaliadas arbitrariamente 5 vezes.</p>
<!---
# substituição para teste +rápido de construção do livro no travis
O resultado é que a `writexl::write_xlsx()` foi cerca de r mais_rapido vezes
mais rápida na escrita dos dados que a `openxlsx::write.xlsx`.
--->
<p>O resultado é que a <code>writexl::write_xlsx()</code> foi cerca de 5 vezes mais rápida
na escrita dos dados que a <code>openxlsx::write.xlsx</code>.</p>
</div>
<div id="estrutura-de-dados-não-tabulares" class="section level3">
<h3><span class="header-section-number">9.6.4</span> Estrutura de dados não tabulares</h3>
<p>Dados em arquivos Excel estão geralmente sujeitos a manipulação mais frequente
de forma que sua estrutura pode não ser tabular, com mais de uma tabela por
planilha, comentários em células vizinhas aos valores, células aninhadas,
células formatadas e etc. Se você precisa arrumar dados nessas condições, vale
a pena conferir os pacotes
<a href="https://cran.r-project.org/web/packages/tidyxl/index.html">tidyxl</a> e
<a href="https://cran.r-project.org/web/packages/unpivotr/index.html">unpivotr</a>.</p>
</div>
</div>
<div id="para-saber-mais" class="section level2">
<h2><span class="header-section-number">9.7</span> Para saber mais</h2>
<p>Para uma descrição mais abrangente sobre importação e exportação de dados no
<img src="images/logo_r.png" width="20"> usando as funções da base do R, consulte o manual <a href="http://cran.r-project.org/doc/manuals/r-release/R-data.html">R Data Import/Export</a> e
a documentação de ajuda das funções citadas naquele documento.</p>
</div>
<div id="exercícios-3" class="section level2">
<h2><span class="header-section-number">9.8</span> Exercícios</h2>
<ol style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li><p>Importe da <em>web</em> diretamente para o <img src="images/logo_r.png" width="20"> os dados do índice
multivariado em tempo real da Oscilação de Madden-Julian disponível em <a href="http://www.bom.gov.au/climate/mjo/graphics/rmm.74toRealtime.txt" class="uri">http://www.bom.gov.au/climate/mjo/graphics/rmm.74toRealtime.txt</a>.</p></li>
<li><p>Defina o nome das variáveis como: <code>year, month, day, RMM1, RMM2, phase,   amplitude, status</code>. Tente obter os nomes das variáveis do próprio link para
os dados (Releia a seção @ref(arquivos-fwf) e a
seção @ref(scan) para detalhes). Mostre os 10 primeiros valores da
variável <code>RMM1</code>.</p></li>
<li><p>Escreva os dados importados em um arquivo excel no <strong>formato <code>xls</code></strong>
e nomeado <code>mjo.xls</code>. Dê uma olhada na seção @ref(export-xls).</p></li>
<li><p>Importe no R o arquivo excel nomeado <code>mjo.xls</code> e mostre qual a classe
dos dados importados.</p></li>
<li><p>Mostre as primeiras e as últimas 10 linhas dos dados.</p></li>
<li><p>Qual o código para mostrar quantas linhas e colunas possui a tabela
de dados.</p></li>
<li><p>Interprete a saída da <code>tibble::glimpse()</code> do pacote <strong>dplyr</strong> aplicada
aos dados importados. O resultado parece com o de alguma outra função que
você já conhece, qual?</p></li>
</ol></li>
<li><p>Importe as anomalias padronizadas dos dados do
<a href="%22http://www.cpc.ncep.noaa.gov/data/indices/soi%22">SOI</a> (2ª tabela ou a tabela
mais abaixo na página do <em>link</em>). Veja a seção @ref(arquivos-fwf) para
detalhes. Mostre as últimas linhas dos dados importados.</p></li>
<li><p>Importe no R o arquivo Excel com a climatologia das temperaturas mínimas do
INMET no período de 1981-2010, disponível neste
<a href="http://www.inmet.gov.br/webcdp/climatologia/normais2/imagens/normais/planilhas/1961-1990/Temperatura-Minima_NCB_1961-1990.xls">link</a>. Mostre a estrutura dos dados e certifique-se de as colunas
dos meses e ano são numéricas.</p></li>
<li><p>Faça <em>download</em> de dados gradeados de precipitação diário para todo Brasil
com resolução horizontal de 0,25°
(arquivo <code>prec_daily_UT_Brazil_v2.2_20100101_20151231.nc</code>), disponível em <a href="https://utexas.app.box.com/v/Xavier-etal-IJOC-DATA" class="uri">https://utexas.app.box.com/v/Xavier-etal-IJOC-DATA</a>. Navegue pelas páginas
até encontrar o arquivo NetCDF.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Importe os dados para o R. Converta-os para <em>data frame</em> incluindo
as coordenadas espaciais e verifique o número de colunas e linhas
resultantes.</p></li>
<li><p>Compare as dimensões do <em>data frame</em> com as dimensões do objeto
importado, o número de linhas e de colunas do <em>data frame</em> correspondem a
quais propriedades ou dimensões do objeto importado? Faça essa comparação
usando os diferentes valores lógicos para os argumentos <code>na.rm</code> e <code>xy</code>.</p></li>
</ol></li>
</ol>
<!--chapter:end:09-entrada-dados.Rmd-->
</div>
</div>
<div id="part-ferramentas-modernas-do-r" class="section level1 unnumbered">
<h1>(PART) Ferramentas modernas do R</h1>
</div>
<div id="data-wrangle" class="section level1">
<h1><span class="header-section-number">10</span> Processamento de dados</h1>
<!-- 

https://moderndive.com/preface.html

Package for handling multiple imputations in a tidy format
https://github.com/njtierney/mputr 


https://blog.rstudio.com/2020/05/05/wrangling-unruly-data/?utm_content=buffer24dbf&utm_medium=social&utm_source=linkedin&utm_campaign=buffer

https://rstudio.com/resources/webinars/reproducibility-in-production/

-->
<p>Neste capítulo veremos:</p>
<ul>
<li><p>um <em>data frame</em> aperfeiçoado, denominado <em>tibble</em></p></li>
<li><p>como arrumar seus dados em uma estrutura conveniente para a análise e visualização de dados</p></li>
<li><p>como reestruturar os dados de uma forma versátil e fácil de entender</p></li>
<li><p>como manipular os dados com uma ferramenta intuitiva e padronizada</p></li>
</ul>
<p>Existem diversas ferramentas da base do <img src="images/logo_r.png" width="20"> para realizar as operações listadas acima. Entretanto, elas não foram construídas para um objetivo comum e foram feitas por diferentes desenvolvedores e em diferentes fases da evolução do R. Por isso, elas podem parecer confusas, não seguem uma codificação consistente e não foram construídas pensando em uma interface integrada para o processamento de dados. Conseqüentemente, para usá-las é necessários um esforço significativo para entender a estrutura de dados de entrada de cada uma. A seguir, precisamos padronizar suas saídas para que sirvam de entrada para outra função (às vezes de outro pacote) que facilita a realização de uma próxima etapa do fluxo de trabalho.</p>
<p>Muitas coisas no <img src="images/logo_r.png" width="20"> que foram desenvolvidas há 20 anos atrás são úteis até hoje. Mas as mesmas ferramentas podem não ser a melhor solução para os problemas contemporâneos. Alterar os códigos da base do <img src="images/logo_r.png" width="20"> é uma tarefa complicada devido a cadeia de dependências do código fonte e dos pacotes dos milhares de contribuidores. Então, grande parte das inovações no <img src="images/logo_r.png" width="20"> estão ocorrendo na forma de pacotes. Um exemplo é o conjunto de pacotes <a href="https://www.tidyverse.org/"><em>tidyverse</em></a> desenvolvido para suprir a necessidade de ferramentas efetivas e integradas para ciência de dados (Figura @ref(fig:tidy-workflow)).</p>
<!---
#A nossa capacidade tecnológica de coletar e armazenar uma quantidade massiva de dados digitalmente demanda ferramentas pragmáticas e acessíveis.
--->
<div class="figure">
<img src="images/workflowtidy.png" alt="Modelo de ferramentas empregadas em ciência de dados. Adaptado de @Wickham2017." width="100%" />
<p class="caption">
(#fig:tidy-workflow)Modelo de ferramentas empregadas em ciência de dados. Adaptado de <span class="citation">H. Wickham and Grolemund (<a href="#ref-Wickham2017" role="doc-biblioref">2017</a>)</span>.
</p>
</div>
<p>O termo <em>tidyverse</em> pode ser traduzido como ‘universo arrumado’ e consiste em um pacote do <img src="images/logo_r.png" width="20"> que agrupa pacotes (Figura @ref(fig:tidyverse-components)) que compartilham uma filosofia comum de <em>design</em>, gramática <span class="citation">(H. Wickham et al. <a href="#ref-Wickham-dplyr" role="doc-biblioref">2017</a>)</span> e estrutura de dados <span class="citation">(Wickham <a href="#ref-Wickham2014" role="doc-biblioref">2014</a>)</span>. Consequentemente, o <em>tidyverse</em> tem sido amplamente utilizado pela comunidade de usuários e desenvolvedores do <img src="images/logo_r.png" width="20">. Além de uma abordagem mais coesa e consistente para realizar as tarefas envolvidas no processamento de dados, os códigos são mais eficientes (que a base do <img src="images/logo_r.png" width="20">), legíveis e com sintaxe mais fácil de lembrar.</p>
<div class="figure">
<img src="images/tidyverse_components.png" alt="Coleção de pacotes do *tidyverse*." width="80%" />
<p class="caption">
(#fig:tidyverse-components)Coleção de pacotes do <em>tidyverse</em>.
</p>
</div>
<div id="pré-requisitos-3" class="section level2">
<h2><span class="header-section-number">10.1</span> Pré-requisitos</h2>
<p>O pacote <strong>tidyverse</strong> torna fácil de instalar e carregar os pacotes do <em>tidyverse</em> com apenas uma chamada à função:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb341-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</a></code></pre></div>
<p>E da mesma forma carregamos o conjunto de pacotes com:</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb342-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb342-2" title="2"><span class="co">#&gt; -- Attaching packages ------------------------------------------------ tidyverse 1.3.0 --</span></a>
<a class="sourceLine" id="cb342-3" title="3"><span class="co">#&gt; v ggplot2 3.3.0     v purrr   0.3.4</span></a>
<a class="sourceLine" id="cb342-4" title="4"><span class="co">#&gt; v tibble  3.0.1     v dplyr   0.8.5</span></a>
<a class="sourceLine" id="cb342-5" title="5"><span class="co">#&gt; v tidyr   1.0.2     v stringr 1.4.0</span></a>
<a class="sourceLine" id="cb342-6" title="6"><span class="co">#&gt; v readr   1.3.1     v forcats 0.5.0</span></a>
<a class="sourceLine" id="cb342-7" title="7"><span class="co">#&gt; -- Conflicts --------------------------------------------------- tidyverse_conflicts() --</span></a>
<a class="sourceLine" id="cb342-8" title="8"><span class="co">#&gt; x dplyr::filter() masks stats::filter()</span></a>
<a class="sourceLine" id="cb342-9" title="9"><span class="co">#&gt; x dplyr::lag()    masks stats::lag()</span></a></code></pre></div>
<div class="rmdnote">
<p>
Ao carregar o pacote <strong>tidyverse</strong> é mostrado no console os pacotes que foram carregados. À direita são mostradas as configurações e informações sobre o seu sistema operacional. Na parte inferior, há uma mensagem sobre os conflitos entre as funções da base do R (ou de outros pacotes) que tem mesmo nome que as de algum pacote do <em>tidyverse</em>. A função do pacote carregado mais recentemente terá prioridade de uso. No caso acima, a função <code>filter()</code> do <strong>dplyr</strong> sobrepôs a função <code>filter()</code> do pacote <strong>stats</strong> da base do R. Em situações como esta é melhor deixar explícito no seu código a chamada à função usando <code>pacote::funcao()</code>.
</p>
</div>
<p>Neste capítulo além do <strong>tidyverse</strong> usaremos outros pacotes que já podemos instalar:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb343-1" title="1">pacotes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;openair&quot;</span>, <span class="st">&quot;lubridate&quot;</span>, <span class="st">&quot;scales&quot;</span>, <span class="st">&quot;rio&quot;</span>)</a>
<a class="sourceLine" id="cb343-2" title="2">easypackages<span class="op">::</span><span class="kw">libraries</span>(pacotes)</a></code></pre></div>
<div id="dados" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Dados</h3>
<p>Para este capítulo utilizaremos diversos conjuntos de dados para exemplificar o uso das principais ferramentas de manipulação de dados do <em>tidyverse</em>.</p>
<ol style="list-style-type: decimal">
<li>Dados climatológicos de precipitação e temperatura máxima anual de estações meteorológicas do <a href="http://www.inmet.gov.br/portal/index.php?r=bdmep/bdmep">INMET</a> localizadas no estado do Rio Grande do Sul.</li>
</ol>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb344-1" title="1">clima_file_url &lt;-<span class="st"> &quot;https://github.com/lhmet/adar-ufsm/blob/master/data/clima-rs.RDS?raw=true&quot;</span></a>
<a class="sourceLine" id="cb344-2" title="2"><span class="co"># dados de exemplo</span></a>
<a class="sourceLine" id="cb344-3" title="3">clima_rs &lt;-<span class="st"> </span><span class="kw">import</span>(clima_file_url, <span class="dt">format =</span> <span class="st">&quot;RDS&quot;</span>)</a>
<a class="sourceLine" id="cb344-4" title="4">clima_rs</a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Metadados das estações meteorológicas do <a href="http://www.inmet.gov.br/portal/index.php?r=bdmep/bdmep">INMET</a> relacionadas a tabela de dados <code>clima_rs</code>.</li>
</ol>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb345-1" title="1">metadados_url &lt;-<span class="st"> &quot;https://github.com/lhmet/adar-ufsm/blob/master/data/clima_rs_metadata_61_90.rds?raw=true&quot;</span></a>
<a class="sourceLine" id="cb345-2" title="2"><span class="co"># dados de exemplo</span></a>
<a class="sourceLine" id="cb345-3" title="3">metadados_rs &lt;-<span class="st"> </span><span class="kw">import</span>(metadados_url, <span class="dt">format =</span> <span class="st">&quot;RDS&quot;</span>)</a>
<a class="sourceLine" id="cb345-4" title="4">metadados_rs</a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Um exemplo minimalista de dados referentes a séries temporais de precipitação anual observada em estações meteorológicas.</li>
</ol>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" title="1">prec_anual &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb346-2" title="2">  <span class="dt">site =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb346-3" title="3">    <span class="st">&quot;A001&quot;</span>, <span class="st">&quot;A001&quot;</span>, <span class="st">&quot;A002&quot;</span>, <span class="st">&quot;A002&quot;</span>, <span class="st">&quot;A002&quot;</span>, <span class="st">&quot;A003&quot;</span>, <span class="st">&quot;A803&quot;</span>, <span class="st">&quot;A803&quot;</span></a>
<a class="sourceLine" id="cb346-4" title="4">  ),</a>
<a class="sourceLine" id="cb346-5" title="5">  <span class="dt">ano =</span> <span class="kw">c</span>(<span class="dv">2000</span><span class="op">:</span><span class="dv">2001</span>, <span class="dv">2000</span><span class="op">:</span><span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2005</span>, <span class="dv">2006</span>),</a>
<a class="sourceLine" id="cb346-6" title="6">  <span class="dt">prec =</span> <span class="kw">c</span>(<span class="dv">1800</span>, <span class="dv">1400</span>, <span class="dv">1750</span>, <span class="dv">1470</span>, <span class="dv">1630</span>, <span class="dv">1300</span>, <span class="dv">1950</span>, <span class="dv">1100</span>)</a>
<a class="sourceLine" id="cb346-7" title="7">)</a>
<a class="sourceLine" id="cb346-8" title="8">prec_anual</a></code></pre></div>
</div>
</div>
<div id="tibble-um-data-frame-aperfeiçoado" class="section level2">
<h2><span class="header-section-number">10.2</span> <em>tibble</em>: um <em>data frame</em> aperfeiçoado</h2>
<p><em>Data frames</em> são a unidade fundamental de armazenamento de dados retangulares no R. O pacote <strong>tibble</strong> estende a classe <em>data frame</em> da base do <img src="images/logo_r.png" width="20"> com aperfeiçoamentos relacionados a impressão de dados (mais amigável e versátil), a seleção de dados e a manipulação de dados do tipo <em>factor</em>. O novo objeto é chamado de <em>tibble</em> e sua classe de <code>tbl_df</code>.</p>
<div id="funcionalidades-do-tibble" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Funcionalidades do <em>tibble</em></h3>
<p>Para ilustrar algumas vantagens do <em>tibble</em>, vamos usar o <em>data frame</em> <code>prec_anual</code>. A criação destes dados como <em>tibble</em> é feita com a função de mesmo nome do pacote: <code>tibble::tibble()</code>.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb347-1" title="1">prec_anual_tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb347-2" title="2">  <span class="dt">site =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb347-3" title="3">    <span class="st">&quot;A001&quot;</span>, <span class="st">&quot;A001&quot;</span>, <span class="st">&quot;A002&quot;</span>, <span class="st">&quot;A002&quot;</span>, <span class="st">&quot;A002&quot;</span>, <span class="st">&quot;A003&quot;</span>, <span class="st">&quot;A803&quot;</span>, <span class="st">&quot;A803&quot;</span></a>
<a class="sourceLine" id="cb347-4" title="4">  ),</a>
<a class="sourceLine" id="cb347-5" title="5">  <span class="dt">ano =</span> <span class="kw">c</span>(<span class="dv">2000</span><span class="op">:</span><span class="dv">2001</span>, <span class="dv">2000</span><span class="op">:</span><span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2005</span>, <span class="dv">2006</span>),</a>
<a class="sourceLine" id="cb347-6" title="6">  <span class="dt">prec =</span> <span class="kw">c</span>(<span class="dv">1800</span>, <span class="dv">1400</span>, <span class="dv">1750</span>, <span class="dv">1470</span>, <span class="dv">1630</span>, <span class="dv">1300</span>, <span class="dv">1950</span>, <span class="dv">1100</span>)</a>
<a class="sourceLine" id="cb347-7" title="7">)</a></code></pre></div>
<p>O exemplo acima é ilustrativo, pois um <em>data frame</em> pode ser convertido em um <em>tibble</em> simplesmente com a função <code>tibble::as_tibble()</code>:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb348-1" title="1">prec_anual_tbl &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(prec_anual)</a>
<a class="sourceLine" id="cb348-2" title="2">prec_anual_tbl</a></code></pre></div>
<p>Com o <em>tibble</em> acima, as principais diferenças entre um <em>tibble</em> e um <em>data frame</em> podem ser enfatizadas.</p>
<ul>
<li><p>quando impresso no console do R, o <em>tibble</em> já mostra a classe de cada variável.</p></li>
<li><p>vetores caracteres não são interpretados como <em>factors</em> em um <em>tibble</em>, em contraste a <code>base::data.frame()</code> que faz a coerção para <em>factor</em> e não conserva o nome das variáveis. Este comportamento padrão pode causar problemas aos usuários desavisados em análises posteriores.</p></li>
</ul>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb349-1" title="1"><span class="kw">str</span>(<span class="kw">data.frame</span>(<span class="st">&quot;temp. do ar&quot;</span> =<span class="st"> &quot;18&quot;</span>))</a></code></pre></div>
<ul>
<li>permite usar seus próprios argumentos prévios para definir variáveis durante a criação do <em>tibble</em>; veja o exemplo abaixo, onde a <code>int prec</code>(intensidade da precipitação) é baseada na razão da precipitação (<code>prec</code>) pelo número de dias no ano.</li>
</ul>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" title="1">prec_anual_tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb350-2" title="2">  <span class="dt">site =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb350-3" title="3">    <span class="st">&quot;A001&quot;</span>, <span class="st">&quot;A001&quot;</span>, <span class="st">&quot;A002&quot;</span>, <span class="st">&quot;A002&quot;</span>, <span class="st">&quot;A002&quot;</span>, <span class="st">&quot;A003&quot;</span>, <span class="st">&quot;A803&quot;</span>, <span class="st">&quot;A803&quot;</span></a>
<a class="sourceLine" id="cb350-4" title="4">  ),</a>
<a class="sourceLine" id="cb350-5" title="5">  <span class="dt">ano =</span> <span class="kw">c</span>(<span class="dv">2000</span><span class="op">:</span><span class="dv">2001</span>, <span class="dv">2000</span><span class="op">:</span><span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2005</span>, <span class="dv">2006</span>),</a>
<a class="sourceLine" id="cb350-6" title="6">  <span class="dt">prec =</span> <span class="kw">c</span>(<span class="dv">1800</span>, <span class="dv">1400</span>, <span class="dv">1750</span>, <span class="dv">1470</span>, <span class="dv">1630</span>, <span class="dv">1300</span>, <span class="dv">1950</span>, <span class="dv">1100</span>),</a>
<a class="sourceLine" id="cb350-7" title="7">  <span class="st">&quot;int prec&quot;</span> =<span class="st"> </span>prec <span class="op">/</span><span class="st"> </span><span class="fl">365.25</span></a>
<a class="sourceLine" id="cb350-8" title="8">)</a>
<a class="sourceLine" id="cb350-9" title="9">prec_anual_tbl</a></code></pre></div>
<ul>
<li>nunca adiciona nomes às linhas (<code>row.names</code>)</li>
</ul>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb351-1" title="1"><span class="co"># nomes das linhas de um data frame são carregados adiante</span></a>
<a class="sourceLine" id="cb351-2" title="2"><span class="kw">subset</span>(prec_anual, ano <span class="op">==</span><span class="st"> </span><span class="dv">2001</span>)</a>
<a class="sourceLine" id="cb351-3" title="3"><span class="co"># tibble não possui nome de linhas (rownames)</span></a>
<a class="sourceLine" id="cb351-4" title="4"><span class="kw">subset</span>(prec_anual_tbl, ano <span class="op">==</span><span class="st"> </span><span class="dv">2001</span>)</a></code></pre></div>
<ul>
<li>a impressão de um <em>tibble</em> mostra as dez primeiras linhas e a quantidade de colunas mostradas é ajustada ao tamanho da janela do console.</li>
</ul>
<p>As opções de controle <em>default</em> da impressão de <em>tibbles</em> no console pode ser configuradas através da função de opções de configuração global do R:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb352-1" title="1">m &lt;-<span class="st"> </span><span class="dv">15</span></a>
<a class="sourceLine" id="cb352-2" title="2">n &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb352-3" title="3"><span class="kw">options</span>(</a>
<a class="sourceLine" id="cb352-4" title="4">  <span class="dt">tibble.print_max =</span> m,</a>
<a class="sourceLine" id="cb352-5" title="5">  <span class="dt">tibble.print_min =</span> n</a>
<a class="sourceLine" id="cb352-6" title="6">)</a></code></pre></div>
<p>Com a configuração acima, será impresso no console do R <code>n = 3</code> linhas do <em>tibble</em> se ele tiver mais de <code>m = 15</code> linhas.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb353-1" title="1"><span class="kw">nrow</span>(clima_rs) <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span></a>
<a class="sourceLine" id="cb353-2" title="2"><span class="co"># coersão do data.frame clima_rs para tibble</span></a>
<a class="sourceLine" id="cb353-3" title="3">clima_rs_tbl &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(clima_rs)</a></code></pre></div>
<p>Para restaurar as opções <em>default</em> use:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb354-1" title="1"><span class="kw">options</span>(</a>
<a class="sourceLine" id="cb354-2" title="2">  <span class="dt">tibble.print_max =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb354-3" title="3">  <span class="dt">tibble.print_min =</span> <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb354-4" title="4">)</a>
<a class="sourceLine" id="cb354-5" title="5">clima_rs_tbl</a></code></pre></div>
<p>Uma alternativa útil para inspecionar mais detalhadamente os dados é a função <code>tibble::glimpse()</code>.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb355-1" title="1"><span class="kw">glimpse</span>(clima_rs)</a></code></pre></div>
<p>Lembre-se também, da função <code>utils::View()</code> para visualizar os dados no RStudio.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb356-1" title="1"><span class="kw">View</span>(clima_rs)</a></code></pre></div>
<p>Outros aspectos diferencias do <em>tibble</em> podem consultados na vinheta do referido pacote (<code>vignette("tibble")</code>).</p>
</div>
</div>
<div id="restruturação-de-dados-retangulares" class="section level2">
<h2><span class="header-section-number">10.3</span> Restruturação de dados retangulares</h2>
<blockquote>
<p>Até 80% do tempo da análise dados é dedicada ao processo de limpeza e preparação dos dados <span class="citation">(Dasu and Johnson <a href="#ref-Dasu-Johnson" role="doc-biblioref">2003</a>, New York Times 2014/08/18)</span>.</p>
</blockquote>
<!---
# references
#http://www.storybench.org/getting-started-with-tidyverse-in-r/
--->
<div id="dados-arrumados" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Dados arrumados</h3>
<p>O conceito "dados arrumados" foi estabelecido por <span class="citation">Wickham (<a href="#ref-Wickham2014" role="doc-biblioref">2014</a>)</span> e representa uma forma padronizada de conectar a estrutura (formato) de um conjunto de dados a sua semântica (significado).</p>
<p>Dados bem estruturados servem para:</p>
<ul>
<li><p>fornecer dados propícios para o processamento e análise de dados por <em>softwares</em>;</p></li>
<li><p>revelar informações e facilitar a percepção de padrões</p></li>
</ul>
<p>Dados no "formato arrumado" atendem as seguintes regras para dados retangulares:</p>
<ol style="list-style-type: decimal">
<li><p>cada <strong>variável</strong> está em uma coluna</p></li>
<li><p>cada <strong>observação</strong> corresponde a uma linha</p></li>
<li><p>cada <strong>valor</strong> corresponde a uma célula</p></li>
<li><p>cada tipo de unidade observacional deve compor uma tabela</p></li>
</ol>
<div class="rmdnote">
<p>
Como sinônimo de observações você pode encontrar os termos: registros, casos, exemplos, instâncias ou amostras dependendo da área de aplicação.
</p>
</div>
<div class="figure">
<img src="http://garrettgman.github.io/images/tidy-1.png" alt="Estrutura de dados padronizados" />
<p class="caption">Estrutura de dados padronizados</p>
</div>
<p>Um exemplo de dados no formato arrumado é o <em>tibble</em> <code>prec_anual_tbl</code> mostrado abaixo:</p>
<p>Os dados acima tem duas variáveis: precipitação (<code>prec</code>) e intensidade da precipitação (<code>intensidade</code>). As unidades observacionais são as colunas <code>site</code> e <code>ano</code>. A primeira unidade observacional informa o ponto de amostragem espacial e a segunda o ponto de amostragem temporal.</p>
<p>Uma <strong>variável</strong> contém todos valores que medem um mesmo atributo ao longo das unidades observacionais. Uma <strong>observação</strong> contém todos valores medidos na mesma unidade observacional ao longo dos atributos.
Cada <strong>valor</strong> (número ou caractere) pertence a uma variável e uma observação.</p>
<p>Exemplo de diferentes <strong>tipos de unidades observacionais</strong> são a tabela com a séries temporais dos elementos meteorológicos (exemplo acima) e a tabela com os metadados das estações de superfície que contém atributos das estações meteorológicas (<code>site</code> no exemplo acima), tais como: longitude, latitude, altitude, nome, município, estado e etc.</p>
<p>A estrutura de dados "arrumados" parece óbvia, mas na prática, dados neste formatos são raros de serem encontrados. As razões para isso incluem:</p>
<ul>
<li><p>quem projeta a coleta e o registro de dados nem sempre é aquele que gasta tempo trabalhando sobre os dados;</p></li>
<li><p>a organização dos dados busca tornar o registro de dados o mais fácil possível;</p></li>
</ul>
<p>Consequente, dados reais sempre precisarão ser arrumados. O primeiro passo é identificação das variáveis e das observações. O passo seguinte é resolver os seguintes problemas mais comuns <span class="citation">(H. Wickham and Grolemund <a href="#ref-Wickham2017" role="doc-biblioref">2017</a>)</span>:</p>
<ul>
<li><p>uma variável deve ser distribuída ao longo das colunas</p></li>
<li><p>uma observação deve ser distribuída ao longo das linhas</p></li>
</ul>
<p>Essas duas operações são realizadas com as principais funções do pacote <strong>tidyr</strong>:</p>
<ul>
<li><p><code>gather()</code>, que pode ser traduzida como reunir (nas linhas);</p></li>
<li><p><code>spread()</code> que pode ser traduzida como espalhar (nas colunas)</p></li>
</ul>
<!---
#O formato de dados arrumado pode ser ideal para muitas operações no R que envolvem *data frames* (agregação, visualização gráfica, ajuste de modelos estatísticos), mas pode não ser a estrutura ideal para todos os casos.
--->
</div>
<div id="formatos-de-dados-mais-comuns" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Formatos de dados mais comuns</h3>
<p>O pacote <strong>tidyr</strong> é a extensão do <img src="images/logo_r.png" width="20"> que fornece funcionalidades para reestruturar os dados entre diferentes formatos.</p>
<p>Os principais formatos de dados são:</p>
<ul>
<li><p>dados longos, são tabelas com mais valores ao longo das linhas; geralmente mistura variáveis com observações;</p></li>
<li><p>dados amplos, são tabelas com valores mais distribuídos nas colunas, geralmente contém pelo menos uma unidade observacional misturada com variáveis;</p></li>
</ul>
<div id="formatos-dados" class="section level4">
<h4><span class="header-section-number">10.3.2.1</span> Formato de dados longo</h4>
<p>Para exemplificar o formato de dados longo vamos partir dos "dados arrumados" do exemplo, <code>prec_anual_tbl</code>. Primeiro vamos renomear a variável <code>int prec</code> para <code>intensidade</code> para seguir um o padrão de nome das variáveis mais conveniente para o seu processamento no R.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb357-1" title="1">prec_anual_tbl &lt;-<span class="st"> </span><span class="kw">rename</span>(</a>
<a class="sourceLine" id="cb357-2" title="2">  prec_anual_tbl,</a>
<a class="sourceLine" id="cb357-3" title="3">  <span class="st">&quot;intensidade&quot;</span> =<span class="st"> `</span><span class="dt">int prec</span><span class="st">`</span></a>
<a class="sourceLine" id="cb357-4" title="4">) </a>
<a class="sourceLine" id="cb357-5" title="5">prec_anual_tbl</a></code></pre></div>
<p>Vamos usar a função <code>tidyr::gather()</code> para reestruturar os dados <code>prec_anual_tbl</code> em uma nova tabela de dados que chamaremos <code>prec_anual_long</code>.</p>
<p>Na nova tabela, manteremos as colunas <code>site</code>, <code>ano</code> e teremos dois novos pares de variáveis: <code>variavel</code> e <code>valor</code>. Na coluna <code>variavel</code> será distribuído o nome das variáveis <code>prec</code> e <code>intensidade</code>. A coluna <code>valor</code>reunirá os valores das variáveis <code>prec</code> e <code>intensidade</code>.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb358-1" title="1">prec_anual_long &lt;-<span class="st"> </span><span class="kw">gather</span>(</a>
<a class="sourceLine" id="cb358-2" title="2">  <span class="dt">data =</span> prec_anual_tbl,</a>
<a class="sourceLine" id="cb358-3" title="3">  <span class="dt">key =</span> variavel,</a>
<a class="sourceLine" id="cb358-4" title="4">  <span class="dt">value =</span> medida,</a>
<a class="sourceLine" id="cb358-5" title="5">  prec, intensidade</a>
<a class="sourceLine" id="cb358-6" title="6">)</a>
<a class="sourceLine" id="cb358-7" title="7">prec_anual_long</a></code></pre></div>
<p>O código acima demonstra os principais argumentos requeridos pela função <code>gather</code>:</p>
<ul>
<li><p><code>data = prec_anual_tbl</code>, o <em>data frame</em> ou <em>tibble</em> que será reestruturado;</p></li>
<li><p><code>key = variavel</code>, nome que nós escolhemos para dar à nova coluna que distribuirá os <strong>nomes das variáveis</strong> dos dados de entrada.</p></li>
<li><p><code>value = medida</code>, nome que nós escolhemos para dar à nova coluna que reunirá os <strong>valores das variáveis</strong> dos dados de entrada;</p></li>
<li><p><code>...</code>, lista com o nome das variáveis, no código acima corresponde à <code>prec, intensidade</code>;</p></li>
</ul>
<p>As demais colunas dos dados (<code>site</code> e <code>ano</code>) serão mantidas inalteradas e seus valores serão repetidos quando necessário.</p>
<p>Como em outras funções dos pacotes do <strong>tidyverse</strong> você perceberá que os argumentos <strong>não são especificados como caracteres</strong> e sim como nomes (ou seja o nome da variável sem aspas), como aqueles usados quando definimos variáveis (p.ex.: <code>nome_var &lt;- 10</code>). Os argumentos <code>key</code> e <code>value</code> podem ser especificados à gosto do usuário e não precisam ter relação com os dados existentes.</p>
<p>Se nós desejássemos que todas colunas do <em>data frame</em> fossem reunidas em uma nova coluna <code>atributo</code> e os seus valores em uma nova coluna <code>valor</code>, isso poderia ser feito simplesmente sem especificar variáveis de interesse (<code>prec, intensidade</code>) no trecho de código anterior. A tabela de dados resultante conterá todos os 32 pares de valores, formados pelas 4 colunas por 8 linhas, dos dados originais:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb359-1" title="1">prec_anual_longo &lt;-<span class="st"> </span><span class="kw">gather</span>(</a>
<a class="sourceLine" id="cb359-2" title="2">  prec_anual_tbl, </a>
<a class="sourceLine" id="cb359-3" title="3">  <span class="dt">key =</span> atributo,</a>
<a class="sourceLine" id="cb359-4" title="4">  <span class="dt">value =</span> valor</a>
<a class="sourceLine" id="cb359-5" title="5">)</a>
<a class="sourceLine" id="cb359-6" title="6">prec_anual_longo</a></code></pre></div>
<p>Se não forem especificados nomes para os argumentos <code>key</code> e <code>value</code> na chamada da função <code>tidyr::gather()</code>, serão atribuídos os valores <em>default</em>: <code>key</code> e <code>value</code>.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb360-1" title="1"><span class="kw">gather</span>(prec_anual_tbl)</a></code></pre></div>
</div>
<div id="formato-de-dados-amplo" class="section level4">
<h4><span class="header-section-number">10.3.2.2</span> Formato de dados amplo</h4>
<p>Utilizando os dados <code>meteo_long</code>, vamos reestruturá-lo no formato amplo para demostrar a funcionalidade da função <code>tidyr::spread()</code>. Esta função é complementar à <code>tidyr::gather()</code>.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb361-1" title="1">prec_anual_long</a></code></pre></div>
<p>Nosso objetivo é então gerar uma nova tabela de dados reestruturada, de forma que os nomes das variáveis (contidos na coluna <code>variavel</code>) sejam distribuídos em duas colunas. Estas colunas receberão os nomes <code>prec</code> e <code>intensidade</code> e serão preenchidas com os valores armazenados na coluna <code>medida</code>. Para fazer isso usamos o seguinte código:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb362-1" title="1">prec_anual_amplo &lt;-<span class="st"> </span><span class="kw">spread</span>(</a>
<a class="sourceLine" id="cb362-2" title="2">  <span class="dt">data =</span> prec_anual_long,</a>
<a class="sourceLine" id="cb362-3" title="3">  <span class="dt">key =</span> variavel,</a>
<a class="sourceLine" id="cb362-4" title="4">  <span class="dt">value =</span> medida</a>
<a class="sourceLine" id="cb362-5" title="5">)</a>
<a class="sourceLine" id="cb362-6" title="6">prec_anual_amplo</a></code></pre></div>
<p>Esta operação serviu para colocar os dados originais (<code>prec_anual_long</code>) no formato "arrumado" (<code>prec_anual_amplo</code>).</p>
</div>
</div>
<div id="funções-adicionais-do-tidyr" class="section level3">
<h3><span class="header-section-number">10.3.3</span> Funções adicionais do <strong>tidyr</strong></h3>
<p>Você pode unir duas colunas inserindo um separador entre elas com a função <code>tidyr::unite()</code>:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb363-1" title="1">(prec_anual_long_u &lt;-<span class="st"> </span><span class="kw">unite</span>(</a>
<a class="sourceLine" id="cb363-2" title="2">  prec_anual_long,</a>
<a class="sourceLine" id="cb363-3" title="3">  <span class="dt">col =</span> site_ano,</a>
<a class="sourceLine" id="cb363-4" title="4">  site, ano,</a>
<a class="sourceLine" id="cb363-5" title="5">  <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span></a>
<a class="sourceLine" id="cb363-6" title="6">))</a></code></pre></div>
<p>Se ao contrário, você quer separar uma coluna em duas variáveis, utilize a função <code>tidyr::separate()</code>:</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb364-1" title="1"><span class="kw">separate</span>(</a>
<a class="sourceLine" id="cb364-2" title="2">  prec_anual_long_u,</a>
<a class="sourceLine" id="cb364-3" title="3">  <span class="dt">col =</span> site_ano,</a>
<a class="sourceLine" id="cb364-4" title="4">  <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>,</a>
<a class="sourceLine" id="cb364-5" title="5">  <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;site&quot;</span>, <span class="st">&quot;ano&quot;</span>)</a>
<a class="sourceLine" id="cb364-6" title="6">)</a></code></pre></div>
<p>Para completar valores das variáveis para unidades observacionais faltantes podemos utilizar a função <code>tidyr::complete()</code>:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb365-1" title="1">prec_anual</a>
<a class="sourceLine" id="cb365-2" title="2">prec_anual_comp &lt;-<span class="st"> </span><span class="kw">complete</span>(</a>
<a class="sourceLine" id="cb365-3" title="3">  prec_anual,</a>
<a class="sourceLine" id="cb365-4" title="4">  site, ano</a>
<a class="sourceLine" id="cb365-5" title="5">)</a>
<a class="sourceLine" id="cb365-6" title="6">prec_anual_comp</a></code></pre></div>
</div>
</div>
<div id="manipulação-de-dados" class="section level2">
<h2><span class="header-section-number">10.4</span> Manipulação de dados</h2>
<p>Com os dados arrumados, a próxima etapa é a manipulação dos dados. O pacote <strong>dplyr</strong> oferece um conjunto de funções que facilita as operações mais comuns para lidar com dados retangulares de uma forma bem pensada.</p>
<p>Os verbos fundamentais desta gramática de manipulação de dados são:</p>
<ul>
<li><code>select()</code>, para selecionar variáveis;</li>
<li><code>filter()</code>, para filtrar observações;</li>
<li><code>arrange()</code>, para classificar variáveis;</li>
<li><code>mutate()</code>, para criar e transformar variáveis;</li>
<li><code>group_by()</code>, para agrupar observações;</li>
<li><code>summarise()</code>, para resumir os dados com medidas estatísticas descritivas;</li>
</ul>
<p>Estes verbos possuem uma sintaxe consistente com uma sentença gramatical:</p>
<p style="color:DodgerBlue; font-size:1.3em; font-weight: bold;text-align:center;">
<code>verbo(sujeito, complemento)</code>
</p>
traduzindo de outra forma:
<p style="color:DodgerBlue; font-size:1.3em; font-weight: bold;text-align:center;">
<code>função(dados, z = x + y)</code>
</p>
<ul>
<li>o <code>verbo</code> é a função do <strong>dplyr</strong>;</li>
<li>o <code>sujeito</code> (dados) é quem sofre a ação e é <strong>sempre o primeiro argumento</strong>, nomeado (<code>.data</code>);</li>
<li>o <code>complemento</code> são expressões que podem ser usadas como argumentos (o que é representado pela reticência <code>...</code> no segundo argumento); isso ficará mais claro nos exemplos mais a frente;</li>
</ul>
<div class="rmdtip">
<p>
Os verbos listados anteriormente possuem versões equivalentes na base do <code>r rblue</code>. Então, por que usar o <em>dplyr</em> ?
</p>
<ul>
<li>
<p>
é muito mais rápido de se aprender, com poucas funções (ou verbos) nomeadas intuitivamente;
</p>
</li>
<li>
<p>
as funções do <strong>dplyr</strong> são mais rápidas (parte dos códigos são programados em C++);
</p>
</li>
<li>
<p>
trabalha bem com dados arrumados e também com sistemas de banco de dados
</p>
</li>
<li>
<p>
as funções foram projetadas para trabalharem juntas na solução diversos problemas de processamento de dados;
</p>
</li>
</ul>
</div>
<div id="códigos-como-fluxogramas" class="section level3">
<h3><span class="header-section-number">10.4.1</span> Códigos como fluxogramas</h3>
<!-- 
In deciphering R code it is helpful to read from right to left and from inside to outside. 
-->
<p>A manipulação de dados requer uma organização apropriada do código. A medida que novas etapas do fluxo de trabalho vão sendo implementadas o código expande-se. As etapas vão sendo implementadas de forma sequencial, combinando funções que geram saídas que servirão de entrada para outras funções na cadeia de processamento.</p>
<p>Essa é justamente a ideia do operador <em>pipe</em> <code>%&gt;%</code>: passar a saída de uma função para outra função como a entrada dessa função por meio de uma seqüência de etapas. O operador <code>%&gt;%</code> está disponível no <img src="images/logo_r.png" width="20"> através do pacote <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html">magrittr</a>.</p>
<!---
#{block, pipe-linux, type='rmdtip'}
# O *pipe* pode ser familiar para quem já usou SO unix, onde o operador  é representado por `|`. No comando linux abaixo listamos os arquivos com a extensão `.txt` e o resultado é passado como entrada ao comando `wc` com o argumento `-l` que conta quantas linhas tem a lista de arquivos. Neste caso o número de linhas corresponderá ao número de arquivos com a extensão `.txt`.
# `ls *.txt | wc -l`
--->
<p>Os pacotes <strong>tidyverse</strong> integram-se muito bem com o <code>%&gt;%</code>, por isso ele é automaticamente carregado com o <strong>tidyverse</strong>. Vamos ilustrar as vantagens de uso do %&gt;% com exemplos a seguir.</p>
<div id="vantagens-do" class="section level4">
<h4><span class="header-section-number">10.4.1.1</span> Vantagens do %&gt;%</h4>
<p>O exemplo a baixo mostra uma aplicação simples do <code>%&gt;%</code> para extrair a raiz quadrada de um número com a função <code>base::sqrt()</code>e a extração do segundo elemento de um vetor com a função <code>dplyr::nth()</code> (uma função alternativa aos colchetes <code>[]</code>).</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb366-1" title="1"><span class="co"># chamada tradicional de uma função </span></a>
<a class="sourceLine" id="cb366-2" title="2"><span class="kw">sqrt</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb366-3" title="3"><span class="kw">nth</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb366-4" title="4"><span class="co"># chamada de uma função com %&gt;%</span></a>
<a class="sourceLine" id="cb366-5" title="5"><span class="dv">4</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</a>
<a class="sourceLine" id="cb366-6" title="6"><span class="dv">5</span><span class="op">:</span><span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nth</span>(<span class="dv">2</span>)</a></code></pre></div>
<p>Ambas formas realizam a mesma tarefa e com mesmo resultado e o benefício do <code>%&gt;%</code> não fica evidente. Entretanto, quando precisamos aplicar várias funções as vantagens ficam mais óbvias.</p>
<p>No código abaixo tente decifrar o objetivo das operações no vetor x.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb367-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">-3</span>)</a>
<a class="sourceLine" id="cb367-2" title="2">x</a>
<a class="sourceLine" id="cb367-3" title="3"><span class="co">#&gt; [1]  1  3 -1  1  4  2  2 -3</span></a>
<a class="sourceLine" id="cb367-4" title="4"><span class="kw">nth</span>(<span class="kw">sort</span>(<span class="kw">cos</span>(<span class="kw">unique</span>(x)), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), <span class="dt">n =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb367-5" title="5"><span class="co">#&gt; [1] 0.5403023</span></a></code></pre></div>
<p>Talvez com o código identado fique mais claro:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb368-1" title="1"><span class="kw">nth</span>(            <span class="co"># 4</span></a>
<a class="sourceLine" id="cb368-2" title="2">  <span class="kw">sort</span>(         <span class="co"># 3</span></a>
<a class="sourceLine" id="cb368-3" title="3">    <span class="kw">cos</span>(        <span class="co"># 2</span></a>
<a class="sourceLine" id="cb368-4" title="4">      <span class="kw">unique</span>(x) <span class="co"># 1</span></a>
<a class="sourceLine" id="cb368-5" title="5">    ),</a>
<a class="sourceLine" id="cb368-6" title="6">    <span class="dt">decreasing =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb368-7" title="7">  ),<span class="dt">n =</span>  <span class="dv">2</span></a>
<a class="sourceLine" id="cb368-8" title="8">)</a></code></pre></div>
<p>O código acima está aninhando funções e isso leva a uma dificuldade de ler por causa da desordem. Para interpretá-lo precisamos fazer a leitura de dentro para fora:</p>
<ol style="list-style-type: decimal">
<li>mantém somente os valores únicos de x</li>
<li>calcula o cosseno do resultado de (1)</li>
<li>coloca em ordem decrescente o resultado de (2)</li>
<li>extrai o 2° elemento do resultado de (3)</li>
</ol>
<p>Conclusão: o objetivo era obter o segundo maior número resultante do cosseno do vetor numérico x.</p>
<p>A versão usando pipe é:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb369-1" title="1">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb369-2" title="2"><span class="st">  </span><span class="kw">unique</span>() <span class="op">%&gt;%</span><span class="st">                </span><span class="co"># 1</span></a>
<a class="sourceLine" id="cb369-3" title="3"><span class="st">  </span><span class="kw">cos</span>() <span class="op">%&gt;%</span><span class="st">                   </span><span class="co"># 2</span></a>
<a class="sourceLine" id="cb369-4" title="4"><span class="st">  </span><span class="kw">sort</span>(<span class="dt">decreasing =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># 3</span></a>
<a class="sourceLine" id="cb369-5" title="5"><span class="st">  </span><span class="kw">nth</span>(<span class="dt">n =</span> <span class="dv">2</span>)                      <span class="co"># 4</span></a></code></pre></div>
<p>Dessa forma, o código fica mais simples, legível e explícito. Por isso, daqui para frente, nós utilizaremos extensivamente o operador <code>%&gt;%</code> para ilustrar os verbos do <strong>dplyr</strong> e suas combinações.</p>
<div class="rmdtip">
<p>
No exemplo anterior nós introduzimos a função <code>dplyr::nth()</code>. Ela é equivalente ao operador colchetes <code>[</code> da base do R. Se <code>a &lt;- 5:1</code> então as instruções abaixo produzem resultados equivalentes:
</p>
<p>
<code>a[2]; nth(a, 2)</code>
</p>
<p>
<code>#&gt; [1] 4</code> <code>#&gt; [1] 4</code>
</p>
</div>
</div>
<div id="o-operador-.-como-argumento" class="section level4">
<h4><span class="header-section-number">10.4.1.2</span> O operador <code>.</code> como argumento</h4>
<p>Uma representação mais explícita do código usado na cadeia de funções acima, seria com a inclusão do operador <code>.</code> e os nomes dos argumentos das funções:</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb370-1" title="1">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb370-2" title="2"><span class="st">  </span><span class="kw">unique</span>(<span class="dt">x =</span> .) <span class="op">%&gt;%</span><span class="st">                  </span><span class="co"># 1</span></a>
<a class="sourceLine" id="cb370-3" title="3"><span class="st">  </span><span class="kw">sort</span>(<span class="dt">x =</span> ., <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># 2</span></a>
<a class="sourceLine" id="cb370-4" title="4"><span class="st">  </span><span class="kw">cos</span>(<span class="dt">x =</span> .) <span class="op">%&gt;%</span><span class="st">                     </span><span class="co"># 3</span></a>
<a class="sourceLine" id="cb370-5" title="5"><span class="st">  </span><span class="kw">nth</span>(<span class="dt">x =</span> ., <span class="dt">n =</span> <span class="dv">2</span>)                  <span class="co"># 4</span></a></code></pre></div>
<p>O tempo a mais digitando é compensado posteriormente quando o você mesmo futuramente tiver que reler o código. Essa forma enfatiza com o <code>.</code> que o resultado à esquerda é usado como entrada para função à direita do <code>%&gt;%</code>.</p>
<p>Mas nem todas funções do <img src="images/logo_r.png" width="20"> foram construídas com os dados de entrada no primeiro argumento. Essa é a deixa para outra funcionalidade do <code>.</code> que é redirecionar os dados de entrada para a posição adequada naquelas funções. Uma função que se encaixa neste caso é a <code>base::grep()</code> que detecta uma expressão regular num conjunto de caracteres (<em>strings</em>).</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb371-1" title="1">adverbs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ontem&quot;</span>, <span class="st">&quot;hoje&quot;</span>, <span class="st">&quot;amanhã&quot;</span>)</a>
<a class="sourceLine" id="cb371-2" title="2"><span class="kw">grep</span>(</a>
<a class="sourceLine" id="cb371-3" title="3">  <span class="dt">pattern =</span> <span class="st">&quot;h&quot;</span>,</a>
<a class="sourceLine" id="cb371-4" title="4">  <span class="dt">x =</span> adverbs,</a>
<a class="sourceLine" id="cb371-5" title="5">  <span class="dt">value =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb371-6" title="6">)</a></code></pre></div>
<p>O código acima seve para retornar os elementos do vetor <code>dias</code> que contenham a letra <code>h</code>. No entanto os dados de entrada da <code>base::grep()</code> são esperados no 2° argumento (<code>x</code>). Para redirecioná-los para essa posição dentro de uma cadeia de funções com <code>%&gt;%</code>, colocamos o operador <code>.</code> no 2° argumento da função:</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb372-1" title="1">adverbs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb372-2" title="2"><span class="st">  </span><span class="kw">grep</span>(</a>
<a class="sourceLine" id="cb372-3" title="3">  <span class="dt">pattern =</span> <span class="st">&quot;h&quot;</span>,</a>
<a class="sourceLine" id="cb372-4" title="4">  <span class="dt">x =</span> .,</a>
<a class="sourceLine" id="cb372-5" title="5">  <span class="dt">value =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb372-6" title="6">)</a></code></pre></div>
<!---
# pipe forever?
# No. ver http://r4ds.had.co.nz/pipes.html#When%20not%20to%20use%20the%20pipe
--->
</div>
</div>
<div id="seleção-de-variáveis" class="section level3">
<h3><span class="header-section-number">10.4.2</span> Seleção de variáveis</h3>
<p><img src="images/dplyr-select.png" width="20%" height="20%" style="display: block; margin: auto;" /></p>
<p>Para selecionar somente variáveis de interesse em uma tabela de dados podemos usar a função <code>dplyr::select(.data, ...)</code>. Nos dados <code>clima_rs_tbl</code> se desejamos selecionar apenas as colunas <code>estacao</code> e <code>tmax</code> aplicamos a <code>dplyr::select()</code> com o 2° argumento listando as colunas que desejamos selecionar:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb373-1" title="1"><span class="kw">select</span>(clima_rs_tbl, estacao, tmax)</a></code></pre></div>
<p>O resultado é um subconjunto dos dados originais contendo apenas as colunas nomeadas nos argumentos seguintes aos dados de entrada.</p>
<p>A função <code>dplyr::select()</code> possui funções auxiliares para seleção de variáveis:</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb374-1" title="1">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-2" title="2"><span class="st">  </span><span class="co"># as variáveis entre uf e tmax</span></a>
<a class="sourceLine" id="cb374-3" title="3"><span class="st">  </span><span class="kw">select</span>(., uf<span class="op">:</span>tmax) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-4" title="4"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb374-5" title="5"></a>
<a class="sourceLine" id="cb374-6" title="6">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-7" title="7"><span class="st">  </span><span class="co"># todas variáveis menos as entre codigo:uf</span></a>
<a class="sourceLine" id="cb374-8" title="8"><span class="st">  </span><span class="kw">select</span>(., <span class="op">-</span>(codigo<span class="op">:</span>uf)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-9" title="9"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb374-10" title="10"></a>
<a class="sourceLine" id="cb374-11" title="11">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-12" title="12"><span class="st">  </span><span class="co"># ordem inversa das variáveis</span></a>
<a class="sourceLine" id="cb374-13" title="13"><span class="st">  </span><span class="kw">select</span>(., tmax<span class="op">:</span>codigo) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-14" title="14"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb374-15" title="15"></a>
<a class="sourceLine" id="cb374-16" title="16">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-17" title="17"><span class="st">  </span><span class="co"># nomes que contenham a letra &quot;a&quot;</span></a>
<a class="sourceLine" id="cb374-18" title="18"><span class="st">  </span><span class="kw">select</span>(., <span class="kw">contains</span>(<span class="st">&quot;a&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-19" title="19"><span class="st">  </span><span class="kw">head</span>(<span class="dt">n =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb374-20" title="20"></a>
<a class="sourceLine" id="cb374-21" title="21">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-22" title="22"><span class="st">  </span><span class="co"># variáveis que iniciam com &quot;c&quot;</span></a>
<a class="sourceLine" id="cb374-23" title="23"><span class="st">  </span><span class="kw">select</span>(., <span class="kw">starts_with</span>(<span class="st">&quot;c&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-24" title="24"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb374-25" title="25"></a>
<a class="sourceLine" id="cb374-26" title="26">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-27" title="27"><span class="st">  </span><span class="co"># usando um vetor de caracteres</span></a>
<a class="sourceLine" id="cb374-28" title="28"><span class="st">  </span><span class="kw">select</span>(., <span class="kw">one_of</span>(<span class="kw">c</span>(<span class="st">&quot;estacao&quot;</span>, <span class="st">&quot;uf&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-29" title="29"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb374-30" title="30"></a>
<a class="sourceLine" id="cb374-31" title="31">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-32" title="32"><span class="st">  </span><span class="co"># combinações</span></a>
<a class="sourceLine" id="cb374-33" title="33"><span class="st">  </span><span class="kw">select</span>(., <span class="op">-</span>uf, <span class="kw">ends_with</span>(<span class="st">&quot;o&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-34" title="34"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb374-35" title="35"></a>
<a class="sourceLine" id="cb374-36" title="36">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-37" title="37"><span class="st">  </span><span class="co"># variáveis que inciam com letras minúsculas e com 4 caracteres</span></a>
<a class="sourceLine" id="cb374-38" title="38"><span class="st">  </span><span class="kw">select</span>(., <span class="kw">matches</span>(<span class="st">&quot;^[a-z]{4}$&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-39" title="39"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a></code></pre></div>
<p>O último exemplo usa uma expressão regular (<a href="https://pt.wikipedia.org/wiki/Express%C3%A3o_regular">regex</a>). <em>Regex</em> é uma linguagem para descrever e manipular caracteres de texto. Há <a href="http://aurelio.net/regex/guia/">livros sobre este assunto</a> e diversos <a href="https://stringr.tidyverse.org/articles/regular-expressions.html">tutorias</a> sobre <em>regex</em> no R. Para saber mais sobre isso veja o capítulo sobre <a href="http://r4ds.had.co.nz/strings.html">strings</a> do livro de <span class="citation">H. Wickham and Grolemund (<a href="#ref-Wickham2017" role="doc-biblioref">2017</a>)</span>. Conhecendo o básico, você poupará tempo automatizando a formatação de caracteres de texto.</p>
<p>Veja mais funções úteis para seleção de variáveis em <code>?dplyr::select</code>.</p>
</div>
<div id="seleção-de-observações" class="section level3">
<h3><span class="header-section-number">10.4.3</span> Seleção de observações</h3>
<p><img src="images/dplyr-filter.png" width="20%" height="20%" style="display: block; margin: auto;" /></p>
<p>A filtragem de observações geralmente envolve uma expressão que retorna valores lógicos ou as posições das linhas selecionadas (como a função <code>which()</code>).</p>
<p>A função <code>dplyr::filter()</code> permite filtrar observações de um <em>data frame</em> correspondentes a alguns critérios lógicos. Estes critérios podem ser passados um de cada vez ou com um operador lógico (e: <code>&amp;</code>, ou: <code>|</code>). Veja abaixo alguns exemplos de filtragem de observações:</p>
<ul>
<li>linhas correspondentes ao <code>codigo</code> da estação 83936.</li>
</ul>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb375-1" title="1">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb375-2" title="2"><span class="st">  </span><span class="kw">filter</span>(codigo <span class="op">==</span><span class="st"> </span><span class="dv">83936</span>)</a></code></pre></div>
<ul>
<li>linhas da variável <code>estacao</code> que contenham o vetor caractere <code>litoraneas</code>.</li>
</ul>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb376-1" title="1">litoraneas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Torres&quot;</span>, </a>
<a class="sourceLine" id="cb376-2" title="2">                <span class="st">&quot;Guaporé&quot;</span>)</a>
<a class="sourceLine" id="cb376-3" title="3">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb376-4" title="4"><span class="st">  </span><span class="kw">filter</span>(estacao <span class="op">%in%</span><span class="st"> </span>litoraneas)</a></code></pre></div>
<ul>
<li>observações com <code>tmax</code> acima de 10% da média</li>
</ul>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb377-1" title="1"><span class="kw">filter</span>(clima_rs_tbl,  tmax <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.1</span><span class="op">*</span><span class="kw">mean</span>(tmax))</a></code></pre></div>
<ul>
<li>observações com <code>tmax</code> e <code>prec</code> acima de suas médias</li>
</ul>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb378-1" title="1">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb378-2" title="2"><span class="kw">filter</span>(</a>
<a class="sourceLine" id="cb378-3" title="3">  tmax <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(tmax),  </a>
<a class="sourceLine" id="cb378-4" title="4">  prec <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(prec)</a>
<a class="sourceLine" id="cb378-5" title="5">)</a>
<a class="sourceLine" id="cb378-6" title="6"><span class="co"># equivalente a</span></a>
<a class="sourceLine" id="cb378-7" title="7"><span class="co">#clima_rs %&gt;% </span></a>
<a class="sourceLine" id="cb378-8" title="8"><span class="co">#  filter(tmax &gt; mean(tmax) &amp; prec &gt; mean(prec))</span></a></code></pre></div>
<ul>
<li>observações cuja variável <code>estacao</code> tem a palavra "Sul"</li>
</ul>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb379-1" title="1"><span class="co"># estações com &quot;Sul&quot; no nome</span></a>
<a class="sourceLine" id="cb379-2" title="2">clima_rs_tbl <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb379-3" title="3"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(estacao, <span class="st">&quot;Sul&quot;</span>))</a></code></pre></div>
<div class="rmdtip">
<p>
O exemplo acima é mais uma operação com caracteres onde foi usada a função <code>stringr::str_detect()</code> para detectar os elementos da variável do tipo caractere que contenham o termo “Sul”. O pacote <strong>stringr</strong> <span class="citation"><span class="citation">(Wickham <a href="#ref-Wickham-stringr" role="doc-biblioref">2018</a>)</span></span> fornece funções para casar padrões de caracteres de texto e os nomes das funções são fáceis de lembrar. Todos começam com <code>str_</code> (de string) seguido do verbo, p.ex.:
</p>
<p>
<code>str_replace_all(</code>
</p>
<p>
<code>string = c(“abc”, “lca”),</code>
</p>
<p>
<code>pattern = “a”,</code>
</p>
<p>
<code>replacement = “A”</code>
</p>
<p>
<code>)</code>
</p>
<p>
<code>#&gt; [1] “Abc” “lcA”</code>
</p>
</div>
<p>A seleção de observações também pode ser baseada em índices passados para função <code>dplyr::slice()</code> que retorna o subconjunto de observações correspondentes. Abaixo vejamos alguns exemplos de filtragem de linhas baseada em índices ou posições:</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb380-1" title="1"><span class="co">#linhas 2 e 4 </span></a>
<a class="sourceLine" id="cb380-2" title="2">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb380-3" title="3"><span class="st">  </span><span class="kw">slice</span>(., <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb380-4" title="4"><span class="co">#última linha</span></a>
<a class="sourceLine" id="cb380-5" title="5">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb380-6" title="6"><span class="st">  </span><span class="kw">slice</span>(., <span class="kw">n</span>())</a>
<a class="sourceLine" id="cb380-7" title="7"><span class="co"># exlui da última à 3a linha</span></a>
<a class="sourceLine" id="cb380-8" title="8">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb380-9" title="9"><span class="st">  </span><span class="kw">slice</span>(., <span class="op">-</span>(<span class="kw">n</span>()<span class="op">:</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb380-10" title="10"><span class="co"># linhas com tmax &gt; 26</span></a>
<a class="sourceLine" id="cb380-11" title="11">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb380-12" title="12"><span class="st">  </span><span class="kw">slice</span>(., <span class="kw">which</span>(tmax <span class="op">&gt;</span><span class="st"> </span><span class="dv">26</span>))</a>
<a class="sourceLine" id="cb380-13" title="13"><span class="co"># linhas com tmax mais próxima a média de tmax</span></a>
<a class="sourceLine" id="cb380-14" title="14">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb380-15" title="15"><span class="st">  </span><span class="kw">slice</span>(., <span class="kw">which.min</span>(<span class="kw">abs</span>(tmax <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(tmax))))</a></code></pre></div>
</div>
<div id="reordenando-dados" class="section level3">
<h3><span class="header-section-number">10.4.4</span> Reordenando dados</h3>
<p><img src="images/dplyr-arrange.png" width="20%" height="20%" style="display: block; margin: auto;" /></p>
<p>As vezes é útil reordenar os dados segundo a ordem (crescente ou decrescente) dos valores de uma variável. Por exemplo, os dados <code>clima_rs_tbl</code> podem ser arranjados em ordem decrescente da precipitação anual, conforme abaixo.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb381-1" title="1">clima_rs_tbl <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb381-2" title="2"><span class="st">  </span><span class="kw">arrange</span>(., <span class="kw">desc</span>(prec)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb381-3" title="3"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a></code></pre></div>
<p>A função <code>dplyr::arrange()</code> por padrão ordena os dados em ordem crescente. A função <code>dplyr::desc()</code> ordena os valores da variável em ordem descendente.</p>
<p>Os dados ordenados pela <code>tmax</code>, ficam da seguinte forma:</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb382-1" title="1">clima_rs_tbl <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb382-2" title="2"><span class="st">  </span><span class="kw">arrange</span>(., tmax) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb382-3" title="3"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a></code></pre></div>
</div>
<div id="criando-e-renomeando-variáveis" class="section level3">
<h3><span class="header-section-number">10.4.5</span> Criando e renomeando variáveis</h3>
<p><img src="images/dplyr-mutate-rename.png" width="50%" height="55%" style="display: block; margin: auto;" /></p>
<p>Uma nova variável pode ser adicionada aos dados através da função <code>dplyr::mutate()</code>. A <code>tmax</code> expressa em Kelvin pode ser adicionada aos dados <code>clima_rs_tbl</code>, com:</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb383-1" title="1">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb383-2" title="2"><span class="st">  </span><span class="co"># tmax em Kelvin</span></a>
<a class="sourceLine" id="cb383-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">tmaxK =</span> tmax <span class="op">+</span><span class="st"> </span><span class="fl">273.15</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb383-4" title="4"><span class="st">  </span><span class="co"># só as colunas de interesse</span></a>
<a class="sourceLine" id="cb383-5" title="5"><span class="st">  </span><span class="kw">select</span>(., <span class="kw">contains</span>(<span class="st">&quot;tmax&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb383-6" title="6"><span class="st">  </span><span class="co"># 3 primeiras linhas</span></a>
<a class="sourceLine" id="cb383-7" title="7"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a></code></pre></div>
<p>Podemos renomear variáveis com a função <code>dplyr::rename()</code>.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb384-1" title="1">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb384-2" title="2"><span class="kw">rename</span>(., </a>
<a class="sourceLine" id="cb384-3" title="3">       <span class="st">&quot;id&quot;</span> =<span class="st"> </span>codigo,</a>
<a class="sourceLine" id="cb384-4" title="4">       <span class="st">&quot;site&quot;</span> =<span class="st"> </span>estacao,</a>
<a class="sourceLine" id="cb384-5" title="5">       <span class="st">&quot;temp_max&quot;</span> =<span class="st"> </span>tmax,</a>
<a class="sourceLine" id="cb384-6" title="6">       <span class="st">&quot;precip&quot;</span> =<span class="st"> </span>prec</a>
<a class="sourceLine" id="cb384-7" title="7">       ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb384-8" title="8"><span class="st">  </span><span class="kw">head</span>(., <span class="dt">n =</span> <span class="dv">3</span>)</a></code></pre></div>
<p>Podemos sobrescrever variáveis e recodificar seus valores, conforme o exemplo abaixo. A variável <code>site</code> será corrigida, de forma os valores iguais a “A803” sejam substituídos por “A003”.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb385-1" title="1">prec_anual_corr &lt;-<span class="st"> </span>prec_anual <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb385-2" title="2"><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb385-3" title="3">  <span class="dt">site =</span> <span class="kw">recode</span>(site, <span class="dt">A803 =</span> <span class="st">&quot;A003&quot;</span>)</a>
<a class="sourceLine" id="cb385-4" title="4">) </a>
<a class="sourceLine" id="cb385-5" title="5"><span class="kw">tail</span>(prec_anual_corr, <span class="dt">n =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Podemos preencher os valores faltantes de uma variável por um valor prescrito, por exemplo baseado na média de outras observações, ou nos valores prévios, ou posteriores. Variáveis podem ser derivadas das variáveis sendo criadas dentro da <code>dplyr::mutate()</code>.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb386-1" title="1"><span class="co"># preenchendo prec faltante pela média</span></a>
<a class="sourceLine" id="cb386-2" title="2">prec_anual_comp <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb386-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(., </a>
<a class="sourceLine" id="cb386-4" title="4">         <span class="dt">prec =</span> <span class="kw">replace_na</span>(prec,</a>
<a class="sourceLine" id="cb386-5" title="5">                           <span class="kw">mean</span>(prec, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb386-6" title="6">                           ),</a>
<a class="sourceLine" id="cb386-7" title="7">         <span class="dt">ndias =</span> <span class="kw">ifelse</span>(ano <span class="op">%%</span><span class="st"> </span><span class="dv">4</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb386-8" title="8">                      <span class="dv">366</span>, </a>
<a class="sourceLine" id="cb386-9" title="9">                      <span class="dv">365</span>),</a>
<a class="sourceLine" id="cb386-10" title="10">         <span class="co"># intensidade de ndias, criada na linha acima</span></a>
<a class="sourceLine" id="cb386-11" title="11">         <span class="dt">intensidade =</span> prec <span class="op">/</span><span class="st"> </span>ndias</a>
<a class="sourceLine" id="cb386-12" title="12">         )</a>
<a class="sourceLine" id="cb386-13" title="13"></a>
<a class="sourceLine" id="cb386-14" title="14">prec_anual_comp <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb386-15" title="15"><span class="st">  </span><span class="co"># preenche com  a observação prévia</span></a>
<a class="sourceLine" id="cb386-16" title="16"><span class="st">  </span><span class="kw">fill</span>(prec, <span class="dt">.direction =</span> <span class="st">&quot;down&quot;</span>)</a>
<a class="sourceLine" id="cb386-17" title="17"></a>
<a class="sourceLine" id="cb386-18" title="18">prec_anual_comp <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb386-19" title="19"><span class="st">  </span><span class="co"># preenche com  a observação posterior</span></a>
<a class="sourceLine" id="cb386-20" title="20"><span class="st">  </span><span class="kw">fill</span>(prec, <span class="dt">.direction =</span> <span class="st">&quot;up&quot;</span>)</a></code></pre></div>
</div>
<div id="agregando-observações" class="section level3">
<h3><span class="header-section-number">10.4.6</span> Agregando observações</h3>
<p><img src="images/dplyr-summarise-count.png" width="40%" height="50%" style="display: block; margin: auto;" /></p>
<p>A função <code>dplyr::summarise()</code> (ou <code>dplyr::sumarize()</code>) agrega valores de uma variável e os fornece para uma função que retorna um único resultado. O resultado será armazenado em um <code>data frame</code>.</p>
<p>Por exemplo, qual a <code>prec</code> média anual do RS?</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb387-1" title="1">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb387-2" title="2"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb387-3" title="3">    .,</a>
<a class="sourceLine" id="cb387-4" title="4">    <span class="dt">prec_med =</span> <span class="kw">mean</span>(prec)</a>
<a class="sourceLine" id="cb387-5" title="5">  )</a></code></pre></div>
<p>Se você só quer o valor (ou o vetor), ao invés de um <code>data frame</code>, pode usar a função <code>dplyr::pull()</code>:</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb388-1" title="1">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb388-2" title="2"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb388-3" title="3">    .,</a>
<a class="sourceLine" id="cb388-4" title="4">    <span class="dt">prec_med =</span> <span class="kw">mean</span>(prec)</a>
<a class="sourceLine" id="cb388-5" title="5">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb388-6" title="6"><span class="st">  </span><span class="kw">pull</span>()</a></code></pre></div>
<p>Podemos aplicar uma ou mais funções a mais de uma variável usando <code>dplyr::summarise_at()</code>:</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb389-1" title="1">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-2" title="2"><span class="st">  </span><span class="kw">summarise_at</span>(</a>
<a class="sourceLine" id="cb389-3" title="3">    .,</a>
<a class="sourceLine" id="cb389-4" title="4">    <span class="dt">.vars =</span> <span class="kw">vars</span>(prec, tmax),</a>
<a class="sourceLine" id="cb389-5" title="5">    <span class="dt">.funs =</span> <span class="kw">funs</span>(min, median, max),</a>
<a class="sourceLine" id="cb389-6" title="6">    <span class="dt">na.rm =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb389-7" title="7">  )</a></code></pre></div>
<p>Observações repetidas devem ser removidas dos dados antes de qualquer cálculo. Suponha os dados abaixo:</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb390-1" title="1">prec_anual_comp_rep &lt;-</a>
<a class="sourceLine" id="cb390-2" title="2"><span class="st">  </span>prec_anual_comp <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb390-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb390-4" title="4">    <span class="dt">site =</span> <span class="kw">recode</span>(site, <span class="dt">A803 =</span> <span class="st">&quot;A003&quot;</span>),</a>
<a class="sourceLine" id="cb390-5" title="5">    <span class="dt">ano =</span> <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb390-6" title="6">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb390-7" title="7"><span class="st">  </span><span class="co"># preenche com  a observação posterior</span></a>
<a class="sourceLine" id="cb390-8" title="8"><span class="st">  </span><span class="kw">fill</span>(., prec, <span class="dt">.direction =</span> <span class="st">&quot;up&quot;</span>)</a>
<a class="sourceLine" id="cb390-9" title="9">prec_anual_comp_rep</a></code></pre></div>
<p>Para desconsiderar linhas duplicadas nos dados usamos a função <code>dplyr::distinct()</code>:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb391-1" title="1"><span class="co"># remove observações repetidas</span></a>
<a class="sourceLine" id="cb391-2" title="2">prec_anual_comp_rep <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb391-3" title="3"><span class="st">  </span><span class="kw">distinct</span>(site, prec)</a></code></pre></div>
<p>A função <code>dplyr::count()</code> é útil para obter a frequência de ocorrência de uma variável ou da combinação de variáveis.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb392-1" title="1">prec_anual_comp_rep <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb392-2" title="2"><span class="st">  </span><span class="kw">count</span>(site)</a>
<a class="sourceLine" id="cb392-3" title="3">prec_anual_comp_rep <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb392-4" title="4"><span class="st">  </span><span class="kw">count</span>(site, prec)</a></code></pre></div>
</div>
<div id="agrupando-observações" class="section level3">
<h3><span class="header-section-number">10.4.7</span> Agrupando observações</h3>
<p><img src="images/dplyr-group-by-summarise.png" width="40%" height="50%" style="display: block; margin: auto;" /></p>
<p>Frequentemente temos que agrupar observações em categorias ou grupos para realizar uma análise estatística. A função
<code>dplyr::group_by()</code> é uma função silenciosa que separa (invisivelmente) as observações em categorias ou grupos.
A única mudança ao aplicar a <code>dplyr::group_by()</code> à um <em>data frame</em> é a indicação da variável agrupada e o seu número de grupos na saída do console. No exemplo a seguir vamos agrupar os dados <code>prec_anual_tbl</code> por <code>site</code> e teremos 4 grupos para esta variável.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb393-1" title="1">prec_anual_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb393-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(site)</a></code></pre></div>
<p>A grande funcionalidade da <code>dplyr::group_by()</code> surge quando combinada com a função <code>dplyr::summarise()</code>, o que nos permite obter resumos estatísticos para cada grupo da variável.</p>
<p>Por exemplo a chuva anual média por <code>site</code> é obtida com o seguinte código:</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb394-1" title="1">prec_anual_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb394-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(., site) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb394-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(., <span class="dt">prec_med =</span> <span class="kw">mean</span>(prec))</a></code></pre></div>
<p>A <code>prec</code> média para cada ano e o número de anos utilizados em seu cálculo é obtida por:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb395-1" title="1">prec_anual_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb395-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(., ano) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb395-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb395-4" title="4">    .,</a>
<a class="sourceLine" id="cb395-5" title="5">    <span class="dt">prec_med =</span> <span class="kw">mean</span>(prec),</a>
<a class="sourceLine" id="cb395-6" title="6">    <span class="dt">nobs =</span> <span class="kw">n</span>()</a>
<a class="sourceLine" id="cb395-7" title="7">  )</a></code></pre></div>
<p>A função <code>n()</code> conta quantas observações temos em um subconjunto dos dados.</p>
<p>Os grupos podem ser compostos de mais de uma variável. Para o exemplo com os dados <code>prec_anual_long</code>;</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb396-1" title="1">prec_anual_long</a></code></pre></div>
<p>podemos obter a média por <code>variavel</code> e <code>site</code>, fazendo:</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb397-1" title="1">estats_por_site_var &lt;-<span class="st"> </span>prec_anual_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb397-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(site, variavel) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb397-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb397-4" title="4">    <span class="dt">media =</span> <span class="kw">mean</span>(medida, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb397-5" title="5">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb397-6" title="6"><span class="st">  </span><span class="kw">arrange</span>(variavel, site)</a>
<a class="sourceLine" id="cb397-7" title="7">estats_por_site_var</a></code></pre></div>
<p>Com o conjunto de verbos exemplificados você agora é capaz de realizar as tarefas mais comuns de manipulação de dados tabulares de forma clara e confiável.</p>
<p>Há mais funções úteis disponíveis no pacote <strong>dplyr</strong> e você é encorajado a descubrí-las.</p>
<!---
#faltando 
# - non standard evaluation
# - ...
--->
</div>
<div id="combinação-de-dados" class="section level3">
<h3><span class="header-section-number">10.4.8</span> Combinação de dados</h3>
<p>O processamento de dados frequentemente envolve a manipulação de diversas tabelas de dados. Ás vezes precisamos juntar dados de diferentes fontes, formar uma tabela única de dados com o período em comum à elas, ou combiná-las para compará-las.</p>
<p>A combinação de 2 <em>data frames</em>, com observações similares, que tem variáveis diferentes e algumas em comum é uma tarefa muito comum na manipulação de conjuntos dados. Este tipo de operação é chamada de <strong>junção</strong> (do termo em inglês <em>join</em>) de tabelas . O pacote <strong>dplyr</strong> possui uma gama de funções do tipo <em>join</em> para combinar <em>data frames</em>, genericamente representadas por <code>&lt;tipo&gt;_join()</code>, onde <code>&lt;tipo&gt;</code> pode ser substituído por <code>dplyr::full_join()</code>, <code>dplyr::inner_join()</code>, <code>dplyr::left_join()</code>, <code>dplyr::right_join()</code>.</p>
<p>Essas funções combinam informação em dois data frames baseada na unificação de valores entre as variáveis que ambos compartilham.</p>
<p>Vamos considerar os dados <code>clima_rs_tbl</code> e <code>metadados_rs</code>. Para melhor compreensão do exemplo vamos remover algumas variáveis.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb398-1" title="1"><span class="co"># normais climatológicas das estaçõess</span></a>
<a class="sourceLine" id="cb398-2" title="2">clima_rs_tbl &lt;-<span class="st"> </span>clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb398-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>(estacao<span class="op">:</span>uf))</a>
<a class="sourceLine" id="cb398-4" title="4"><span class="kw">head</span>(clima_rs_tbl)</a>
<a class="sourceLine" id="cb398-5" title="5"><span class="co"># metadados das estações convertidos para tibble</span></a>
<a class="sourceLine" id="cb398-6" title="6">metadados_rs &lt;-<span class="st"> </span>metadados_rs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb398-7" title="7"><span class="st">  </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb398-8" title="8"><span class="kw">head</span>(metadados_rs)</a></code></pre></div>
<p>A variável comum às duas tabelas é:</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb399-1" title="1">var_comum &lt;-<span class="st"> </span><span class="kw">names</span>(clima_rs_tbl) <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(metadados_rs)</a>
<a class="sourceLine" id="cb399-2" title="2"><span class="kw">names</span>(clima_rs_tbl)[var_comum]</a></code></pre></div>
<p>Vamos comparar os valores da variável <code>codigo</code> em cada tabela de dados para verificar se todos valores contidos em uma tabela também estão presentes na outra e vice-versa.</p>
<p>Para saber se algum valor da variável <code>codigo</code> da tabela <code>clima_rs_tbl</code> não está contido na tabela <code>metadados_rs</code> podemos usar o seguinte código:</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb400-1" title="1"><span class="co"># algum codigo não está presente na tabela metadados_rs</span></a>
<a class="sourceLine" id="cb400-2" title="2">clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb400-3" title="3"><span class="st">  </span><span class="kw">filter</span>(., <span class="op">!</span><span class="st"> </span>codigo <span class="op">%in%</span><span class="st"> </span>metadados_rs<span class="op">$</span>codigo ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb400-4" title="4"><span class="st">  </span><span class="kw">select</span>(., codigo)</a></code></pre></div>
<p>Não há nenhum caso.</p>
<p>Analogamente, vamos verificar se algum valor da variável <code>codigo</code> dos <code>metadados_rs</code> não está contido em <code>clima_rs_tbl</code>.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb401-1" title="1"><span class="co"># algum codigo não está presente na tabela metadados_rs</span></a>
<a class="sourceLine" id="cb401-2" title="2">metadados_rs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb401-3" title="3"><span class="st">  </span><span class="kw">filter</span>(., <span class="op">!</span><span class="st"> </span>codigo <span class="op">%in%</span><span class="st"> </span>clima_rs_tbl<span class="op">$</span>codigo )<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb401-4" title="4"><span class="st">  </span><span class="kw">select</span>(., codigo)</a></code></pre></div>
<p>Obtemos que 7 valores da variável <code>codigo</code> dos <code>metadados_rs</code> que não estão presentes na tabela <code>clima_rs_tbl</code>. Portanto, não há valores de <code>tmax</code> e <code>prec</code> para essas observações.</p>
<p>Suponha agora que desejássemos visualizar a variação espacial da precipitação (<code>prec</code>) ou da temperatura máxima do ar (<code>tmax</code>) climatológica. Precisaríamos além dessas variáveis, as coordenadas geográficas das estações meteorológicas para plotar sua localização espacial. As coordenadas <code>lon</code> e <code>lat</code> da <code>metadados_rs</code> podem ser combinadas com <code>clima_rs_tbl</code> em uma nova tabela (<code>clima_rs_comb</code>), usando a função <code>dplyr::full_join()</code>:</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb402-1" title="1">clima_rs_comb &lt;-<span class="st"> </span><span class="kw">full_join</span>(</a>
<a class="sourceLine" id="cb402-2" title="2">  <span class="dt">x =</span> clima_rs_tbl, </a>
<a class="sourceLine" id="cb402-3" title="3">  <span class="dt">y =</span> metadados_rs,</a>
<a class="sourceLine" id="cb402-4" title="4">  <span class="dt">by =</span> <span class="st">&quot;codigo&quot;</span>)</a>
<a class="sourceLine" id="cb402-5" title="5">clima_rs_comb</a></code></pre></div>
<p>Da inspeção das últimas linhas de <code>clima_rs_comb</code> verificamos que o resultado é uma tabela que contém todos valores da variável <code>codigo</code> das duas tabelas. Os valores das variáveis <code>prec</code> e <code>tmax</code>, para as observações da variável <code>codigo</code> sem valores ( na <code>metadados_rs</code>) são preenchidos com <code>NA</code>.</p>
<p>Se a combinação de interesse for nas observações em comum entre as tabelas, usaríamos:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb403-1" title="1">clima_rs_intersec &lt;-<span class="st"> </span><span class="kw">inner_join</span>(</a>
<a class="sourceLine" id="cb403-2" title="2">  <span class="dt">x =</span> metadados_rs, </a>
<a class="sourceLine" id="cb403-3" title="3">  <span class="dt">y =</span> clima_rs_tbl,</a>
<a class="sourceLine" id="cb403-4" title="4">  <span class="dt">by =</span> <span class="st">&quot;codigo&quot;</span></a>
<a class="sourceLine" id="cb403-5" title="5">)</a>
<a class="sourceLine" id="cb403-6" title="6">clima_rs_intersec</a></code></pre></div>
<p>Para obter uma tabela com as observações diferentes entre as duas tabelas, usamos:</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb404-1" title="1">clima_rs_disj &lt;-<span class="st"> </span><span class="kw">anti_join</span>(</a>
<a class="sourceLine" id="cb404-2" title="2">  <span class="dt">x =</span> metadados_rs, </a>
<a class="sourceLine" id="cb404-3" title="3">  <span class="dt">y =</span> clima_rs_tbl,</a>
<a class="sourceLine" id="cb404-4" title="4">  <span class="dt">by =</span> <span class="st">&quot;codigo&quot;</span></a>
<a class="sourceLine" id="cb404-5" title="5">)</a>
<a class="sourceLine" id="cb404-6" title="6">clima_rs_disj</a></code></pre></div>
<p>O exemplo abaixo demonstram os resultados das funções <code>dplyr::left_join()</code> e <code>dplyr::right_join()</code> para um versão reduzida dos dados <code>clima_rs_tbl</code>.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb405-1" title="1">clima_rs_tbl_mini &lt;-<span class="st"> </span>clima_rs_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb405-2" title="2"><span class="st">  </span><span class="kw">slice</span>(., <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb405-3" title="3">clima_rs_tbl_mini</a>
<a class="sourceLine" id="cb405-4" title="4"><span class="co"># combina os dados baseado nas observações dos dados à esquerda (x)</span></a>
<a class="sourceLine" id="cb405-5" title="5"><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb405-6" title="6">  <span class="dt">x =</span> clima_rs_tbl_mini, </a>
<a class="sourceLine" id="cb405-7" title="7">  <span class="dt">y =</span>metadados_rs, </a>
<a class="sourceLine" id="cb405-8" title="8">  <span class="dt">by =</span> <span class="st">&quot;codigo&quot;</span></a>
<a class="sourceLine" id="cb405-9" title="9">)</a>
<a class="sourceLine" id="cb405-10" title="10"><span class="co"># combina os dados baseado nas observações dos dados à direita (y)</span></a>
<a class="sourceLine" id="cb405-11" title="11"><span class="kw">right_join</span>(</a>
<a class="sourceLine" id="cb405-12" title="12">  <span class="dt">x =</span> clima_rs_tbl_mini, </a>
<a class="sourceLine" id="cb405-13" title="13">  <span class="dt">y =</span> metadados_rs, </a>
<a class="sourceLine" id="cb405-14" title="14">  <span class="dt">by =</span> <span class="st">&quot;codigo&quot;</span></a>
<a class="sourceLine" id="cb405-15" title="15">)</a></code></pre></div>
</div>
</div>
<div id="exercícios-4" class="section level2">
<h2><span class="header-section-number">10.5</span> Exercícios</h2>
<p><strong>Pacotes necessários</strong></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb406-1" title="1">pcks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;rio&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>, <span class="st">&quot;lubridate&quot;</span>)</a>
<a class="sourceLine" id="cb406-2" title="2">easypackages<span class="op">::</span><span class="kw">libraries</span>(pcks)</a></code></pre></div>
<p><strong>Dados</strong></p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb407-1" title="1">arq_temp &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.RData&quot;</span>)</a>
<a class="sourceLine" id="cb407-2" title="2"><span class="kw">download.file</span>(</a>
<a class="sourceLine" id="cb407-3" title="3">  <span class="st">&quot;https://github.com/lhmet/adar-ufsm/blob/master/data/dados-lista-exerc4-cap9.RData?raw=true&quot;</span>,</a>
<a class="sourceLine" id="cb407-4" title="4">  <span class="dt">destfile =</span> arq_temp</a>
<a class="sourceLine" id="cb407-5" title="5">)</a>
<a class="sourceLine" id="cb407-6" title="6"><span class="co"># nome dos dados carregados para os exercícios</span></a>
<a class="sourceLine" id="cb407-7" title="7"><span class="kw">print</span>(<span class="kw">load</span>(arq_temp))</a></code></pre></div>
<ol style="list-style-type: decimal">
<li>Converta os dados de anomalias padronizadas do índice de oscilação sul armazenados no <em>data frame</em> <code>soi</code> (dado abaixo) para o formato "arrumado" e em ordem cronológica. Os nomes das variáveis na tabela de dados arrumado deve estar sempre em letras minúsculas (Converta se for necessário usando a função <code>tolower(names(soi_arrumado))</code>).</li>
</ol>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb408-1" title="1">soi </a></code></pre></div>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb409-1" title="1">soi_arrumado &lt;-<span class="st"> </span><span class="kw">gather</span>(<span class="dt">data =</span> soi, </a>
<a class="sourceLine" id="cb409-2" title="2">                       <span class="dt">key =</span> <span class="st">&quot;mes&quot;</span>, </a>
<a class="sourceLine" id="cb409-3" title="3">                       <span class="dt">value =</span> <span class="st">&quot;soi&quot;</span>,</a>
<a class="sourceLine" id="cb409-4" title="4">                       <span class="op">-</span>YEAR) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb409-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">mes =</span> <span class="kw">as.integer</span>(mes)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb409-6" title="6"><span class="st">  </span><span class="kw">arrange</span>(YEAR, mes) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb409-7" title="7"><span class="st">  </span><span class="kw">setNames</span>(., <span class="kw">tolower</span>(<span class="kw">names</span>(.)))</a>
<a class="sourceLine" id="cb409-8" title="8">soi_arrumado</a></code></pre></div>
<p>A estrutura esperada dos dados arrumados é mostrada abaixo:</p>
<ol start="2" style="list-style-type: decimal">
<li>Os dados de precipitação diária abaixo são uma pequena amostra dos dados usados na questão 4 da lista do Capítulo 8. Converta o <em>tibble</em> fornecido abaixo para o "formato arrumado". No data frame arrumado, transforme as datas obtidas (na classe de caractere) para classe <em>date</em> usando a função <code>as.Date()</code>.</li>
</ol>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb410-1" title="1">precd_ncdf</a></code></pre></div>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb411-1" title="1">precd_arrum &lt;-<span class="st"> </span><span class="kw">gather</span>(precd_ncdf,</a>
<a class="sourceLine" id="cb411-2" title="2">                      <span class="dt">key =</span>  date, </a>
<a class="sourceLine" id="cb411-3" title="3">                      <span class="dt">value =</span> prec,</a>
<a class="sourceLine" id="cb411-4" title="4">                      <span class="op">-</span><span class="kw">c</span>(x, y)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb411-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb411-6" title="6">    <span class="dt">date =</span> <span class="kw">gsub</span>(</a>
<a class="sourceLine" id="cb411-7" title="7">      <span class="dt">pattern =</span> <span class="st">&quot;X&quot;</span>, </a>
<a class="sourceLine" id="cb411-8" title="8">      <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb411-9" title="9">      <span class="dt">x =</span> date</a>
<a class="sourceLine" id="cb411-10" title="10">      ),</a>
<a class="sourceLine" id="cb411-11" title="11">    <span class="dt">date =</span> <span class="kw">as.Date</span>(date, <span class="st">&quot;%Y.%m.%d&quot;</span>)</a>
<a class="sourceLine" id="cb411-12" title="12">  )</a>
<a class="sourceLine" id="cb411-13" title="13">precd_arrum</a></code></pre></div>
<p>A estrutura esperada do <em>tibble</em> resultante é mostrada abaixo:</p>
<ol start="3" style="list-style-type: decimal">
<li>Coloque os dados de poluição (<em>tibble</em> <code>poluentes</code>) no formato "arrumado".</li>
</ol>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb412-1" title="1">poluentes</a></code></pre></div>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb413-1" title="1">poluentes_arrum &lt;-<span class="st"> </span>poluentes <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb413-2" title="2"><span class="st">  </span><span class="kw">spread</span>(., poluente, duracao)</a>
<a class="sourceLine" id="cb413-3" title="3">poluentes_arrum</a></code></pre></div>
<p>A estrutura esperada do <em>tibble</em> resultante é mostrada abaixo:</p>
<ol start="4" style="list-style-type: decimal">
<li>Coloque os dados meteorológicos diários da estação meteorológica de Santa Maria no formato arrumado. Deixe os dados ordenados cronologicamente.</li>
</ol>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb414-1" title="1">dados_sm</a></code></pre></div>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb415-1" title="1">dados_sm_arrum &lt;-<span class="st"> </span>dados_sm <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb415-2" title="2"><span class="st">  </span><span class="kw">gather</span>(., </a>
<a class="sourceLine" id="cb415-3" title="3">         <span class="dt">key =</span> day, </a>
<a class="sourceLine" id="cb415-4" title="4">         <span class="dt">value =</span> valor, </a>
<a class="sourceLine" id="cb415-5" title="5">         d1<span class="op">:</span>d31</a>
<a class="sourceLine" id="cb415-6" title="6">         ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb415-7" title="7"><span class="st">  </span><span class="kw">spread</span>(., </a>
<a class="sourceLine" id="cb415-8" title="8">         element, </a>
<a class="sourceLine" id="cb415-9" title="9">         valor</a>
<a class="sourceLine" id="cb415-10" title="10">         ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb415-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(.,</a>
<a class="sourceLine" id="cb415-12" title="12">         <span class="dt">day =</span> <span class="kw">as.integer</span>(<span class="kw">str_replace_all</span>(day, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb415-13" title="13">         ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb415-14" title="14"><span class="st">  </span><span class="kw">arrange</span>(year, month, day)</a></code></pre></div>
<p>A estrutura esperada do <em>tibble</em> resultante é mostrada abaixo:</p>
<hr />
<ol start="5" style="list-style-type: decimal">
<li><p>Com os dados obtidos na questão 4:</p>
<ol style="list-style-type: lower-alpha">
<li>junte as colunas <code>year</code>, <code>month</code> e <code>day</code> em uma única coluna denominada <code>date</code> de forma que a classe dessa nova coluna seja <code>date</code>.</li>
</ol></li>
</ol>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb416-1" title="1">dados_sm_arrum_u &lt;-<span class="st"> </span>dados_sm_arrum <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb416-2" title="2"><span class="st">  </span><span class="kw">unite</span>(., </a>
<a class="sourceLine" id="cb416-3" title="3">        <span class="dt">col =</span> date, </a>
<a class="sourceLine" id="cb416-4" title="4">        <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;day&quot;</span>),</a>
<a class="sourceLine" id="cb416-5" title="5">        <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span></a>
<a class="sourceLine" id="cb416-6" title="6">        ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb416-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> <span class="kw">as.Date</span>(date))</a></code></pre></div>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb417-1" title="1"><span class="kw">glimpse</span>(dados_sm_arrum_u)</a></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Filtre os dados obtidos em <strong>(a)</strong> de forma a descobrir as datas em que as observações de <code>tmax</code> ou <code>tmin</code> são faltantes. Mostre o <em>tibble</em> filtrado com as datas e explique o porquê de seus valores.</li>
</ol>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb418-1" title="1">dados_sm_arrum_u <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb418-2" title="2"><span class="st">  </span><span class="kw">filter</span>(., <span class="kw">is.na</span>(tmax) <span class="op">|</span><span class="st"> </span><span class="kw">is.na</span>(tmin))</a></code></pre></div>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb419-1" title="1"><span class="co"># As datas faltantes de tmax e tmin também são NA, pq </span></a>
<a class="sourceLine" id="cb419-2" title="2"><span class="co"># são datas inválidas ou inexistentes.</span></a>
<a class="sourceLine" id="cb419-3" title="3"><span class="co"># O que pode ser mostrado com :</span></a>
<a class="sourceLine" id="cb419-4" title="4">dados_sm_arrum <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb419-5" title="5"><span class="st">  </span><span class="kw">filter</span>(., <span class="kw">is.na</span>(tmax) <span class="op">|</span><span class="st"> </span><span class="kw">is.na</span>(tmin)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb419-6" title="6"><span class="st">  </span><span class="kw">select</span>(., year, month, day)</a></code></pre></div>
<hr />
<ol start="6" style="list-style-type: decimal">
<li>A amostra de dados abaixo possui medidas a cada 6 horas de uma estação meteorológica de superfície. Reestruture os dados no formato "arrumado" e as informações de data e horário agregadas em uma única variável da classe <em>POSIXct</em>.</li>
</ol>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb420-1" title="1">dados_zorra</a></code></pre></div>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb421-1" title="1"><span class="co"># solucao</span></a>
<a class="sourceLine" id="cb421-2" title="2">res &lt;-<span class="st"> </span>dados_zorra <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb421-3" title="3"><span class="st">  </span><span class="kw">gather</span>(., <span class="dt">key =</span> variavel, <span class="dt">value =</span> valor, <span class="op">-</span>date) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb421-4" title="4"><span class="st">  </span><span class="kw">separate</span>(</a>
<a class="sourceLine" id="cb421-5" title="5">    .,</a>
<a class="sourceLine" id="cb421-6" title="6">    <span class="dt">col =</span> variavel,</a>
<a class="sourceLine" id="cb421-7" title="7">    <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;varname&quot;</span>, <span class="st">&quot;hora&quot;</span>)</a>
<a class="sourceLine" id="cb421-8" title="8">    <span class="co">#sep = &quot;\\.&quot;</span></a>
<a class="sourceLine" id="cb421-9" title="9">    ) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#.$hora %&gt;% unique()</span></a>
<a class="sourceLine" id="cb421-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(.,</a>
<a class="sourceLine" id="cb421-11" title="11">         <span class="dt">hora =</span> <span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb421-12" title="12">           <span class="kw">nchar</span>(hora) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb421-13" title="13">           <span class="kw">as.numeric</span>(hora)<span class="op">/</span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb421-14" title="14">           <span class="kw">as.numeric</span>(hora)),</a>
<a class="sourceLine" id="cb421-15" title="15">         <span class="dt">hora =</span> <span class="kw">paste0</span>(hora,<span class="st">&quot;:&quot;</span>, <span class="st">&quot;00:00&quot;</span>),</a>
<a class="sourceLine" id="cb421-16" title="16">         <span class="dt">date =</span> <span class="kw">as.Date</span>(date, <span class="st">&quot;%d-%m-%Y&quot;</span>)</a>
<a class="sourceLine" id="cb421-17" title="17">         ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb421-18" title="18"><span class="st">  </span><span class="kw">unite</span>(., <span class="dt">col =</span> date, date, hora, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb421-19" title="19"><span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">date =</span> <span class="kw">as.POSIXct</span>(date)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb421-20" title="20"><span class="st">  </span><span class="kw">spread</span>(., varname, valor)</a>
<a class="sourceLine" id="cb421-21" title="21">res</a></code></pre></div>
<p>A estrutura esperada do <em>tibble</em> resultante é mostrada abaixo:</p>
<hr />
<ol start="7" style="list-style-type: decimal">
<li>Faça uma junção da tabela de dados de informações das estações de poluição (<code>etacoes</code>, dada abaixo) com os períodos de duração de poluição crítica (<code>poluentes</code>). A tabela resultante deve conter somente estações que tenham coordenadas espaciais e medidas de poluentes válidas.</li>
</ol>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb422-1" title="1">estacoes</a></code></pre></div>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb423-1" title="1">res7 &lt;-<span class="st"> </span><span class="kw">inner_join</span>(</a>
<a class="sourceLine" id="cb423-2" title="2">  <span class="dt">x =</span> estacoes, </a>
<a class="sourceLine" id="cb423-3" title="3">  <span class="dt">y =</span> poluentes, </a>
<a class="sourceLine" id="cb423-4" title="4">  <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span> =<span class="st"> &quot;estacao&quot;</span>)</a>
<a class="sourceLine" id="cb423-5" title="5">)</a></code></pre></div>
<p>Estrutura da tabela resultante:</p>
<hr />
<ol start="8" style="list-style-type: decimal">
<li>Combine as 2 tabelas abaixo de forma que:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>a tabela resultante contenha todas as datas compreendidas pelas duas tabelas (e em ordem cronológica) e as observações de umidade do solo (<code>theta</code>) sejam preenchidas com <code>NA</code>.</li>
</ol>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb424-1" title="1"><span class="co"># datas completas</span></a>
<a class="sourceLine" id="cb424-2" title="2">datas_comp</a>
<a class="sourceLine" id="cb424-3" title="3"><span class="co"># datas das observações de theta</span></a>
<a class="sourceLine" id="cb424-4" title="4">datas_obs</a></code></pre></div>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb425-1" title="1">res8a &lt;-<span class="st"> </span><span class="kw">full_join</span>(</a>
<a class="sourceLine" id="cb425-2" title="2">  <span class="dt">x =</span> datas_obs,</a>
<a class="sourceLine" id="cb425-3" title="3">  <span class="dt">y =</span> datas_comp,</a>
<a class="sourceLine" id="cb425-4" title="4">  <span class="dt">by =</span> <span class="st">&quot;date&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb425-5" title="5"><span class="st">  </span><span class="kw">arrange</span>(date)</a>
<a class="sourceLine" id="cb425-6" title="6">res8a</a></code></pre></div>
<p>Estrutura da tabela de dados resultante:</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>a tabela resultante contenha exatamente as datas da tabela <code>data_comp</code> (em ordem cronológica) e as observações de umidade do solo (<code>theta</code>) sejam preenchidas com <code>NA</code>.</li>
</ol>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb426-1" title="1">res8b &lt;-<span class="st"> </span><span class="kw">right_join</span>(</a>
<a class="sourceLine" id="cb426-2" title="2">  <span class="dt">x =</span> datas_obs,</a>
<a class="sourceLine" id="cb426-3" title="3">  <span class="dt">y =</span> datas_comp,</a>
<a class="sourceLine" id="cb426-4" title="4">  <span class="dt">by =</span> <span class="st">&quot;date&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb426-5" title="5"><span class="st">  </span><span class="kw">arrange</span>(date)</a></code></pre></div>
<p>Estrutura da tabela de dados resultante:</p>
<hr />
<p>Utilize os dados horários de estações meteorológicas automáticas (EMA) do RS (<code>dados_rs_08_16</code>) para solução das questões a seguir.</p>
<ol start="10" style="list-style-type: decimal">
<li>Determinar a data inicial, final e o período de dados (em anos) de cada estação (identificada pela variável <code>site</code>).</li>
</ol>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb427-1" title="1">ini_fim &lt;-<span class="st"> </span>dados_rs_<span class="dv">08</span>_<span class="dv">16</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb427-2" title="2"><span class="st">  </span><span class="kw">select</span>(site, date) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb427-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(site) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb427-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb427-5" title="5">    <span class="dt">inicio =</span> <span class="kw">min</span>(date),</a>
<a class="sourceLine" id="cb427-6" title="6">    <span class="dt">fim =</span> <span class="kw">max</span>(date),</a>
<a class="sourceLine" id="cb427-7" title="7">    <span class="dt">periodo_err =</span> <span class="kw">time_length</span>(</a>
<a class="sourceLine" id="cb427-8" title="8">      fim <span class="op">-</span><span class="st"> </span>inicio, <span class="dt">unit =</span> <span class="st">&quot;year&quot;</span></a>
<a class="sourceLine" id="cb427-9" title="9">      )</a>
<a class="sourceLine" id="cb427-10" title="10">    ) <span class="co">#%&gt;% glimpse()</span></a>
<a class="sourceLine" id="cb427-11" title="11"><span class="co">#glimpse(ini_fim)</span></a>
<a class="sourceLine" id="cb427-12" title="12"></a>
<a class="sourceLine" id="cb427-13" title="13">periodo &lt;-<span class="st"> </span>dados_rs_<span class="dv">08</span>_<span class="dv">16</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb427-14" title="14"><span class="st">  </span><span class="kw">select</span>(site, date) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb427-15" title="15"><span class="st">  </span><span class="kw">group_by</span>(site, <span class="dt">year =</span> <span class="kw">year</span>(date)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb427-16" title="16"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb427-17" title="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ndays =</span> <span class="kw">ifelse</span>(year <span class="op">%%</span><span class="st"> </span><span class="dv">4</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">366</span>, <span class="dv">365</span>),</a>
<a class="sourceLine" id="cb427-18" title="18">         <span class="dt">n =</span> n<span class="op">/</span><span class="dv">24</span>,</a>
<a class="sourceLine" id="cb427-19" title="19">         <span class="dt">periodo =</span> n<span class="op">/</span>ndays) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb427-20" title="20"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb427-21" title="21"><span class="st">  </span><span class="kw">group_by</span>(site) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb427-22" title="22"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">periodo =</span> <span class="kw">sum</span>(periodo))</a>
<a class="sourceLine" id="cb427-23" title="23"><span class="co">#glimpse(periodo)</span></a>
<a class="sourceLine" id="cb427-24" title="24"></a>
<a class="sourceLine" id="cb427-25" title="25">per_ini_fim &lt;-<span class="st"> </span><span class="kw">full_join</span>(periodo, ini_fim, <span class="dt">by =</span> <span class="st">&quot;site&quot;</span>)</a></code></pre></div>
<p>Estrutura da tabela de dados resultante:</p>
<ol start="11" style="list-style-type: decimal">
<li>Determine a porcentagem de dados válidos (ou seja, não faltantes) de cada variável para cada EMA. Aproxime os valores para números inteiros.</li>
</ol>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb428-1" title="1">perc_valid &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb428-2" title="2">  <span class="co">#if(all(is.na(x))) return(0)</span></a>
<a class="sourceLine" id="cb428-3" title="3">  <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(x))<span class="op">/</span><span class="kw">length</span>(x) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb428-4" title="4">} </a>
<a class="sourceLine" id="cb428-5" title="5">validos &lt;-<span class="st"> </span>dados_rs_<span class="dv">08</span>_<span class="dv">16</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb428-6" title="6"><span class="st">  </span><span class="kw">group_by</span>(site) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb428-7" title="7"><span class="st">  </span><span class="kw">summarise_at</span>(., <span class="kw">vars</span>(tair<span class="op">:</span>ws), perc_valid) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb428-8" title="8"><span class="st">  </span><span class="kw">mutate_at</span>(., <span class="kw">vars</span>(tair<span class="op">:</span>ws), as.integer)</a></code></pre></div>
<p>Estrutura da tabela de dados resultante:</p>
<ol start="12" style="list-style-type: decimal">
<li>Adicione uma variável indicativa da porcentagem média de observações válidas de todas variáveis. Ordene esta tabela em ordem decrescente da disponibilidade média de observações.</li>
</ol>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb429-1" title="1">disp &lt;-<span class="st"> </span>validos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb429-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">disp_med =</span> <span class="kw">rowMeans</span>(.[,<span class="op">-</span><span class="dv">1</span>])) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb429-3" title="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(disp_med))</a></code></pre></div>
<p>Estrutura da tabela de dados resultante:</p>
<ol start="13" style="list-style-type: decimal">
<li>Para a EMA de Santa Maria (ver <code>info_emas_rs_08_16</code>) obtenha o ciclo diurno médio da temperatura do ar e a porcentagem de dados válidos usados para compor a <code>tair</code> média de cada hora.</li>
</ol>
<blockquote>
<p>Dica: Para extrair as horas das datas use a função <code>lubridate::hour(date)</code>.</p>
</blockquote>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" title="1">id_sm &lt;-<span class="st"> </span>info_emas_rs_<span class="dv">08</span>_<span class="dv">16</span><span class="op">$</span>site[info_emas_rs_<span class="dv">08</span>_<span class="dv">16</span><span class="op">$</span>name <span class="op">==</span><span class="st"> &quot;SANTA MARIA&quot;</span>]</a>
<a class="sourceLine" id="cb430-2" title="2"></a>
<a class="sourceLine" id="cb430-3" title="3">sm_tar_ciclo_medio &lt;-<span class="st"> </span>dados_rs_<span class="dv">08</span>_<span class="dv">16</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb430-4" title="4"><span class="st">  </span><span class="kw">select</span>(site, date, tair) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb430-5" title="5"><span class="st">  </span><span class="kw">filter</span>(site <span class="op">==</span><span class="st"> </span>id_sm) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb430-6" title="6"><span class="st">  </span><span class="kw">group_by</span>(<span class="dt">hour =</span> <span class="kw">hour</span>(date)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb430-7" title="7"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">tair_med =</span> <span class="kw">mean</span>(tair, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb430-8" title="8">            <span class="dt">tair_disp =</span> <span class="kw">perc_valid</span>(tair)) <span class="co">#%&gt;% glimpse()</span></a></code></pre></div>
<p>Estrutura da tabela de dados resultante:</p>
<ol start="14" style="list-style-type: decimal">
<li>Com os dados de temperatura do ar (<code>tair</code>) da EMA de Santa Maria selecione somente os dias observações válidas nas 24 horas. Obtenha a partir destes dados a frequência de ocorrência da temperatura mínima para cada horário do dia. Apresente a tabela de resultados em ordem decrescente da frequência de ocorrência.</li>
</ol>
<blockquote>
<p>Dica: para obter o dia a partir da data e hora (coluna <code>date</code> do tipo <code>POSIXct</code>) use <code>lubridate::floor_date(date, unit = "day")</code>.</p>
</blockquote>
<p>Estrutura da tabela de dados resultante:</p>
<!-- 

Controle de qualidade e validação de dados

# pacote útil para controle de qualidade e validação de dados
https://github.com/data-cleaning/validate
https://github.com/data-cleaning/validatetools 

# pacote de verificação de qualidade de dados para R
https://github.com/guhjy/doctr/blob/master/vignettes/vignette.Rmd

# simple functions for examining and cleaning dirty data
https://github.com/sfirke/janitor

# dataPreparation
https://cran.r-project.org/web/packages/dataPreparation/vignettes/dataPreparation.html
-->
<!--
# dados meteorológicos gradeados
https://eliocamp.github.io/codigo-r/en/2019/04/ecmwfr-global-warming/
-->
<!--chapter:end:10-manipulacao-dados.Rmd-->
</div>
</div>
<div id="data-vis" class="section level1">
<h1><span class="header-section-number">11</span> Visualização de dados</h1>
<!-- 
earthdatascience.org/courses/earth-analytics/lidar-raster-data-r/ggmap-basemap/ 
-->
<blockquote>
<p>"Uma imagem vale mais que mil palavras"</p>
</blockquote>
<p>é uma expressão popular atribuída ao filósofo chinês <a href="https://en.wikipedia.org/wiki/Confucius">Confúcio</a> utilizada para transmitir a idéia do poder da comunicação através das imagens.</p>
<p>Gráficos são uma forma efetiva de olhar os seus dados e servem para apresentar informações.</p>
<p>Figura @ref(fig:tidy-workflow)</p>
<p>Neste capítulo veremos como produzir gráficos usando o pacote ggplot2 que baseia-se na <a href="http://amzn.to/2ef1eWp">gramática de gráficos</a>.</p>
<!-- 
Citando @Tufte2001 e @Wilkinson2005. 
-->
<div id="pré-requisitos-4" class="section level2">
<h2><span class="header-section-number">11.1</span> Pré-requisitos</h2>
<p>O pacote <strong>ggplot2</strong> faz parte do <strong>tidyverse</strong>, mas além dele precisaremos de outros pacotes com funcionalidades que complementam o <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb431-1" title="1">pacotes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;openair&quot;</span>, <span class="st">&quot;lubridate&quot;</span>,</a>
<a class="sourceLine" id="cb431-2" title="2">             <span class="st">&quot;scales&quot;</span>, <span class="st">&quot;rio&quot;</span>, </a>
<a class="sourceLine" id="cb431-3" title="3">             <span class="st">&quot;tidyverse&quot;</span>, </a>
<a class="sourceLine" id="cb431-4" title="4">             <span class="st">&quot;ggrepel&quot;</span>, <span class="st">&quot;ggthemes&quot;</span>,</a>
<a class="sourceLine" id="cb431-5" title="5">             <span class="st">&quot;viridis&quot;</span>)</a>
<a class="sourceLine" id="cb431-6" title="6">easypackages<span class="op">::</span><span class="kw">libraries</span>(pacotes)</a></code></pre></div>
<div id="dados-1" class="section level3">
<h3><span class="header-section-number">11.1.1</span> Dados</h3>
</div>
</div>
<div id="ggplot2" class="section level2">
<h2><span class="header-section-number">11.2</span> <em>ggplot2</em></h2>
<!--chapter:end:11-visualizacao-dados.Rmd-->
</div>
</div>
<div id="referências" class="section level1">
<h1><span class="header-section-number">12</span> Referências</h1>
<div id="refs">
<div id="ref-Dasu-Johnson">
<p>Dasu, Tamraparni, and Theodore Johnson. 2003. “Data Quality.” In <em>Exploratory Data Mining and Data Cleaning</em>, edited by Walter A. Shewhart and Samuel S. Wilks, 99–137. Wiley-Blackwell. <a href="https://doi.org/10.1002/0471448354.ch4">https://doi.org/10.1002/0471448354.ch4</a>.</p>
</div>
<div id="ref-Gillespie2017">
<p>Gillespie, Colin, and Robin Lovelace. 2017. <em>Efficient R Programming: A Practical Guide to Smarter Programming</em>. 1st ed. O’Reilly Media, Inc.</p>
</div>
<div id="ref-Hijmans2017">
<p>Hijmans, Robert J. 2017. <em>Raster: Geographic Data Analysis and Modeling</em>. <a href="https://CRAN.R-project.org/package=raster">https://CRAN.R-project.org/package=raster</a>.</p>
</div>
<div id="ref-Pierce2017">
<p>Pierce, David. 2017. <em>Ncdf4: Interface to Unidata netCDF (Version 4 or Earlier) Format Data Files</em>. <a href="https://CRAN.R-project.org/package=ncdf4">https://CRAN.R-project.org/package=ncdf4</a>.</p>
</div>
<div id="ref-R-base">
<p>R Core Team. 2020. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.</p>
</div>
<div id="ref-Wickham2014">
<p>Wickham, H. 2014. “Tidy Data.” <em>Journal of Statistical Software, Articles</em> 59 (10): 1–23. <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.</p>
</div>
<div id="ref-Wickham-stringr">
<p>Wickham, Hadley. 2018. <em>Stringr: Simple, Consistent Wrappers for Common String Operations</em>. <a href="https://CRAN.R-project.org/package=stringr">https://CRAN.R-project.org/package=stringr</a>.</p>
</div>
<div id="ref-Wickham-dplyr">
<p>Wickham, H., R. Francois, L. Henry, and K. Müller. 2017. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.</p>
</div>
<div id="ref-Wickham2017">
<p>Wickham, H., and G. Grolemund. 2017. <em>R for Data Science</em>. O’Reilly Media. <a href="http://r4ds.had.co.nz/">http://r4ds.had.co.nz/</a>.</p>
</div>
</div>
<!--chapter:end:12-references.Rmd-->
</div>
<div id="appendix-appendix" class="section level1 unnumbered">
<h1>(APPENDIX) Appendix</h1>
</div>
<div id="oper-mat" class="section level1">
<h1><span class="header-section-number">13</span> Operações adicionais com matrizes</h1>
<p>Há outras formas de se construir uma matriz além daquela usando a função <code>matrix()</code>. Há também diveras operações matriciais que podem ser realizadas no <img src="images/logo_r.png" width="20">. Aqui apresentam-se esse conteúdo complementar sobre matrizes.</p>
<div id="função-dim" class="section level2">
<h2><span class="header-section-number">13.1</span> Função <code>dim()</code></h2>
<p>Podemos converter um vetor atômico em uma arranjo de <code>n</code> dimensões através do atributo da dimensão de um objeto. Este atributo pode ser alterado pela função <code>dim()</code>. Para fazer isso, definimos o atributo <code>dim</code> (de dimensão) com um vetor numérico com os tamanhos para cada dimensão.
O R reorganizará os elementos do vetor de acordo com as dimensões.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb432-1" title="1">v &lt;-<span class="st"> </span>vetor &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span></a>
<a class="sourceLine" id="cb432-2" title="2"><span class="kw">length</span>(v)</a>
<a class="sourceLine" id="cb432-3" title="3"><span class="kw">attributes</span>(v)</a>
<a class="sourceLine" id="cb432-4" title="4"><span class="kw">typeof</span>(v)</a>
<a class="sourceLine" id="cb432-5" title="5"><span class="co"># conversão de vetor para matriz</span></a>
<a class="sourceLine" id="cb432-6" title="6"><span class="kw">dim</span>(v) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>) <span class="co"># 1a dimensão: linhas , 2a dimensão: colunas</span></a>
<a class="sourceLine" id="cb432-7" title="7"><span class="co"># v é vector?</span></a>
<a class="sourceLine" id="cb432-8" title="8"><span class="kw">is.vector</span>(v)</a>
<a class="sourceLine" id="cb432-9" title="9"><span class="co"># v é matrix?</span></a>
<a class="sourceLine" id="cb432-10" title="10"><span class="kw">is.matrix</span>(v)</a>
<a class="sourceLine" id="cb432-11" title="11"><span class="co"># classe de vetor</span></a>
<a class="sourceLine" id="cb432-12" title="12"><span class="kw">class</span>(v)</a>
<a class="sourceLine" id="cb432-13" title="13"><span class="kw">attributes</span>(v)</a>
<a class="sourceLine" id="cb432-14" title="14">v</a>
<a class="sourceLine" id="cb432-15" title="15"><span class="co"># invertendo as dimensões</span></a>
<a class="sourceLine" id="cb432-16" title="16"><span class="kw">dim</span>(v) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb432-17" title="17">v</a></code></pre></div>
<p>O R usa o primeiro elemento de <code>dim()</code> para o número de linhas e o segundo para o número de colunas. De forma geral, em operações que usam linhas e colunas, as linhas vem sempre em primeiro lugar.</p>
<p>Note como os valores de <code>v</code> foram distribuídos na matriz com 3 linhas e 4 colunas. O R sempre preenche a matriz ao longo das colunas.</p>
<p>Para mais controle na forma como R reorganiza os dados em linhas e colunas, podemos utilizar a função <code>matrix()</code> ou <code>array()</code>. Elas fazem a mesma coisa que a <code>dim()</code> porém com argumentos mais versáteis para estruturar uma <code>matrix</code>.</p>
</div>
<div id="atribuição-por-indexação" class="section level2">
<h2><span class="header-section-number">13.2</span> Atribuição por indexação</h2>
<p>Uma matriz <code>mat</code> poderia ser criada especificando os valores de cada elemento :</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb433-1" title="1"><span class="co"># criando a matriz gerada com dim</span></a>
<a class="sourceLine" id="cb433-2" title="2">mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb433-3" title="3">mat</a>
<a class="sourceLine" id="cb433-4" title="4">mat[<span class="dv">1</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb433-5" title="5">mat[<span class="dv">2</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb433-6" title="6">mat[<span class="dv">3</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb433-7" title="7">mat[<span class="dv">1</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb433-8" title="8">mat[<span class="dv">2</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb433-9" title="9">mat[<span class="dv">3</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb433-10" title="10">mat[<span class="dv">1</span>, <span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb433-11" title="11">mat[<span class="dv">2</span>, <span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">8</span></a>
<a class="sourceLine" id="cb433-12" title="12">mat[<span class="dv">3</span>, <span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">9</span></a>
<a class="sourceLine" id="cb433-13" title="13">mat[<span class="dv">1</span>, <span class="dv">4</span>] &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb433-14" title="14">mat[<span class="dv">2</span>, <span class="dv">4</span>] &lt;-<span class="st"> </span><span class="dv">11</span></a>
<a class="sourceLine" id="cb433-15" title="15">mat[<span class="dv">3</span>, <span class="dv">4</span>] &lt;-<span class="st"> </span><span class="dv">12</span></a>
<a class="sourceLine" id="cb433-16" title="16">mat</a></code></pre></div>
<p>No exemplo a seguir os dados do vetor aparecem distribuídos ao longo das linhas e não das colunas como no caso acima. Nós definimos isso com o argumento <strong><code>byrow = TRUE</code></strong> da função <code>matrix()</code>:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" title="1">vetor &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span></a>
<a class="sourceLine" id="cb434-2" title="2">mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(vetor, <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb434-3" title="3">mat</a></code></pre></div>
</div>
<div id="operações-matriciais" class="section level2">
<h2><span class="header-section-number">13.3</span> Operações matriciais</h2>
<div id="multiplicação-matricial" class="section level3">
<h3><span class="header-section-number">13.3.1</span> Multiplicação matricial</h3>
<p>Operações algébricas, incluindo a multiplicação <code>*</code>, atuam elemento a elemento sobre matrizes. Mas se a intenção é fazer uma multiplicação matricial (Figura @ref(fig:fig-multiplicacao-mat)) usamos o operador (<code>%*%</code>).</p>
<div class="figure" style="text-align: center">
<img src="images/multilicacaoMatricial.png" alt="Multiplicação matricial." width="50%" />
<p class="caption">
(#fig:fig-multiplicacao-mat)Multiplicação matricial.
</p>
</div>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb435-1" title="1"><span class="co"># multiplicação de duas matrizes</span></a>
<a class="sourceLine" id="cb435-2" title="2">A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">5</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb435-3" title="3">A</a>
<a class="sourceLine" id="cb435-4" title="4">B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb435-5" title="5">B</a>
<a class="sourceLine" id="cb435-6" title="6">A <span class="op">*</span><span class="st"> </span>B <span class="co"># erro pela diferença nas dims entre as matrizes</span></a>
<a class="sourceLine" id="cb435-7" title="7">prod_mat &lt;-<span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>B</a>
<a class="sourceLine" id="cb435-8" title="8">prod_mat</a>
<a class="sourceLine" id="cb435-9" title="9"><span class="co"># multiplicação de uma matriz por um escalar</span></a>
<a class="sourceLine" id="cb435-10" title="10">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb435-11" title="11">m</a>
<a class="sourceLine" id="cb435-12" title="12">m <span class="op">*</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
</div>
<div id="adição-matricial" class="section level3">
<h3><span class="header-section-number">13.3.2</span> Adição matricial</h3>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb436-1" title="1">m</a>
<a class="sourceLine" id="cb436-2" title="2">m <span class="op">+</span><span class="st"> </span>m</a></code></pre></div>
</div>
<div id="produto-escalar" class="section level3">
<h3><span class="header-section-number">13.3.3</span> Produto escalar</h3>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb437-1" title="1">u &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb437-2" title="2">v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">13</span>)</a>
<a class="sourceLine" id="cb437-3" title="3">u <span class="op">*</span><span class="st"> </span>v</a>
<a class="sourceLine" id="cb437-4" title="4"><span class="co"># produto escalar = u.v = 1*5 + 2*12 + 3*13</span></a>
<a class="sourceLine" id="cb437-5" title="5"><span class="kw">crossprod</span>(u, v)</a></code></pre></div>
</div>
<div id="determinante" class="section level3">
<h3><span class="header-section-number">13.3.4</span> Determinante</h3>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" title="1"><span class="co"># matriz exemplo</span></a>
<a class="sourceLine" id="cb438-2" title="2">mat_ex &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">-7</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">-9</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb438-3" title="3"><span class="kw">det</span>(mat_ex)</a></code></pre></div>
</div>
<div id="solução-de-sistemas-lineares" class="section level3">
<h3><span class="header-section-number">13.3.5</span> Solução de sistemas lineares</h3>
<p><span class="math display">\[
\left\{\begin{matrix}
x_1 + x_2 = 2
\\ 
-x_1 + x_2 = 4
\end{matrix}\right.
\]</span></p>
<p>Qual os valores de <span class="math inline">\(x_1\)</span> e <span class="math inline">\(x_2\)</span>?</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb439-1" title="1"><span class="co"># matrizes do sistema linear</span></a>
<a class="sourceLine" id="cb439-2" title="2">coefs &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb439-3" title="3">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb439-4" title="4">x &lt;-<span class="st"> </span><span class="kw">solve</span>(coefs, y)</a>
<a class="sourceLine" id="cb439-5" title="5">x</a></code></pre></div>
</div>
<div id="produto-cartesiano" class="section level3">
<h3><span class="header-section-number">13.3.6</span> Produto cartesiano</h3>
<p>O produto cartesiano de dois conjuntos A e B é representado por <span class="math inline">\(A \times B\)</span>. O resultado é o conjunto de todos pares ordenados (a, b) tal que <span class="math inline">\(a \belong b\)</span>.</p>
<!--chapter:end:AppendixA.Rmd-->
</div>
</div>
</div>
<div id="funções-nativas-do-r-para-importar-e-exportar-dados" class="section level1">
<h1><span class="header-section-number">14</span> Funções nativas do R para importar e exportar dados</h1>
<div id="amostras-pequenas-de-dados" class="section level2">
<h2><span class="header-section-number">14.1</span> Amostras pequenas de dados</h2>
<div id="scan" class="section level3">
<h3><span class="header-section-number">14.1.1</span> scan()</h3>
<p>A função <code>scan()</code> também pode ler dados de arquivos, mas a sua saída é um vetor, ou seja ela não mantém a estrutura dos dados contidos no arquivo.</p>
<p>Vamos baixar um arquivo de dados da internet para ilustrar o uso da <code>scan()</code>.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" title="1"><span class="co"># download dados de exemplo</span></a>
<a class="sourceLine" id="cb440-2" title="2">aq_url &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/lhmet/adar-ufsm/master/data/airquality.txt&quot;</span></a>
<a class="sourceLine" id="cb440-3" title="3"><span class="co"># arquivo temporário, você pode substituir tempfile() por um caminho de seu computador, p.ex. &quot;~/Downloads&quot;</span></a>
<a class="sourceLine" id="cb440-4" title="4">(aq_dest_file &lt;-<span class="st"> </span><span class="kw">tempfile</span>())</a>
<a class="sourceLine" id="cb440-5" title="5"><span class="kw">download.file</span>(aq_url, <span class="dt">destfile =</span> aq_dest_file)</a></code></pre></div>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb441-1" title="1"><span class="co"># Exemplo: vetor</span></a>
<a class="sourceLine" id="cb441-2" title="2">vetor_aq &lt;-<span class="st"> </span><span class="kw">scan</span>(aq_dest_file)</a>
<a class="sourceLine" id="cb441-3" title="3"><span class="co"># parte inicial dos dados</span></a>
<a class="sourceLine" id="cb441-4" title="4"><span class="kw">head</span>(vetor_aq, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb441-5" title="5"><span class="co"># parte final</span></a>
<a class="sourceLine" id="cb441-6" title="6"><span class="kw">tail</span>(vetor_aq, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb441-7" title="7"><span class="co"># dados são importados como vetor</span></a>
<a class="sourceLine" id="cb441-8" title="8"><span class="kw">is.vector</span>(vetor_aq)</a>
<a class="sourceLine" id="cb441-9" title="9"><span class="kw">mode</span>(vetor_aq)</a></code></pre></div>
</div>
<div id="readline" class="section level3">
<h3><span class="header-section-number">14.1.2</span> readline()</h3>
<p>Para ler apenas uma linha de dados a partir do teclado como <code>character</code> usamos a função <strong><code>readline()</code></strong>:</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" title="1">sentenca &lt;-<span class="st"> </span><span class="kw">readline</span>(<span class="dt">prompt =</span> <span class="st">&quot;digite alguma coisa e tecle enter para continuar: &quot;</span>)</a>
<a class="sourceLine" id="cb442-2" title="2">sentenca</a></code></pre></div>
<p>Esta função pode ser utilizada como uma forma de controlar um <em>looping</em>. Esse exemplo ilustra o uso da função <code>lapply()</code> para execução de laços ou <em>loopings</em> ao longo de um vetor de índices. Essa função será vista futuramente no curso.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb443-1" title="1"><span class="co"># para reprodutibilidade</span></a>
<a class="sourceLine" id="cb443-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb443-3" title="3"><span class="co"># looping ao longo da sequência de 1 a 5</span></a>
<a class="sourceLine" id="cb443-4" title="4">l &lt;-<span class="st"> </span><span class="kw">sapply</span>(</a>
<a class="sourceLine" id="cb443-5" title="5">  <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb443-6" title="6">  <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb443-7" title="7">    <span class="co"># cria vetor com números aleatórios com distribuição uniforme</span></a>
<a class="sourceLine" id="cb443-8" title="8">    x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb443-9" title="9">    <span class="co"># anomalia acumulada</span></a>
<a class="sourceLine" id="cb443-10" title="10">    y &lt;-<span class="st"> </span><span class="kw">cumsum</span>(x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))</a>
<a class="sourceLine" id="cb443-11" title="11">    <span class="kw">plot</span>(y, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>)</a>
<a class="sourceLine" id="cb443-12" title="12">    <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb443-13" title="13">    <span class="co"># leitura de linha, só após teclar enter vai gerar próximo gráfico</span></a>
<a class="sourceLine" id="cb443-14" title="14">    <span class="kw">readline</span>(<span class="dt">prompt =</span> <span class="st">&quot;tecle &lt;enter&gt; para continuar: &quot;</span>)</a>
<a class="sourceLine" id="cb443-15" title="15">  }</a>
<a class="sourceLine" id="cb443-16" title="16">)</a>
<a class="sourceLine" id="cb443-17" title="17">l</a></code></pre></div>
</div>
<div id="impressão-na-tela" class="section level3">
<h3><span class="header-section-number">14.1.3</span> Impressão na tela</h3>
<p>No modo interativo do R podemos imprimir os valores de um objeto na tela digitando o nome do objeto.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" title="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb444-2" title="2">y &lt;-<span class="st"> </span>x <span class="op">^</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb444-3" title="3">y</a>
<a class="sourceLine" id="cb444-4" title="4"><span class="co"># ou</span></a>
<a class="sourceLine" id="cb444-5" title="5"><span class="kw">print</span>(y)</a></code></pre></div>
<p>Entretanto isso não é possível quando precisamos mostrar o valor de uma variável dentro do corpo de uma função ou dentro de um laço (<em>looping</em>). Nesse caso podemos usar a função <code>print()</code>:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" title="1"><span class="co"># dentro de uma função</span></a>
<a class="sourceLine" id="cb445-2" title="2"><span class="co"># digitando o nome do objeto não imprimi na tela</span></a>
<a class="sourceLine" id="cb445-3" title="3">fcubo &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb445-4" title="4">  classe &lt;-<span class="st"> </span><span class="kw">class</span>(x)</a>
<a class="sourceLine" id="cb445-5" title="5">  <span class="co"># intenção de mostrar objeto de entrada</span></a>
<a class="sourceLine" id="cb445-6" title="6">  classe</a>
<a class="sourceLine" id="cb445-7" title="7">  x <span class="op">^</span><span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb445-8" title="8">}</a>
<a class="sourceLine" id="cb445-9" title="9"><span class="kw">fcubo</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb445-10" title="10"><span class="co"># adicionando print</span></a>
<a class="sourceLine" id="cb445-11" title="11">cubo &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb445-12" title="12">  <span class="co"># mostra objeto de entrada</span></a>
<a class="sourceLine" id="cb445-13" title="13">  classe &lt;-<span class="st"> </span><span class="kw">class</span>(x)</a>
<a class="sourceLine" id="cb445-14" title="14">  <span class="kw">print</span>(classe)</a>
<a class="sourceLine" id="cb445-15" title="15">  x <span class="op">^</span><span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb445-16" title="16">}</a>
<a class="sourceLine" id="cb445-17" title="17"><span class="kw">fcubo</span>(<span class="op">-</span><span class="dv">3</span>) <span class="co"># não imprime classe do objeto de entrada</span></a>
<a class="sourceLine" id="cb445-18" title="18"><span class="kw">cubo</span>(<span class="op">-</span><span class="dv">3</span>) <span class="co"># imprime classe do objeto de entrada</span></a></code></pre></div>
<div id="cat-ao-invés-de-print" class="section level4">
<h4><span class="header-section-number">14.1.3.1</span> <code>cat()</code> ao invés de <code>print()</code></h4>
<p>É melhor usar a função <code>cat()</code> ao invés da função <code>print()</code>, já que a <code>print()</code> permite a impressão de apenas um único objeto enquanto a <code>cat()</code> não. Compare os resultados das duas funções:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" title="1"><span class="kw">print</span>(<span class="st">&quot;abc&quot;</span>)</a>
<a class="sourceLine" id="cb446-2" title="2"><span class="kw">cat</span>(<span class="st">&quot;abc</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="co"># \n indica quebra de linha</span></a>
<a class="sourceLine" id="cb446-3" title="3">x</a>
<a class="sourceLine" id="cb446-4" title="4"><span class="kw">cat</span>(<span class="st">&quot;os elementos de x são: &quot;</span>, x, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb446-5" title="5"><span class="kw">cat</span>(<span class="st">&quot;os elementos de x são: &quot;</span>, x, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb446-6" title="6"><span class="kw">cat</span>(<span class="st">&quot;os elementos de x são: &quot;</span>, x, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb446-7" title="7">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">8</span>, <span class="dv">88</span>)</a>
<a class="sourceLine" id="cb446-8" title="8"><span class="kw">cat</span>(k, <span class="dt">sep =</span> <span class="kw">c</span>(<span class="st">&quot;.&quot;</span>, <span class="st">&quot;___&quot;</span>, <span class="st">&quot; ---&gt; &quot;</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>))</a></code></pre></div>
</div>
</div>
<div id="textconnection" class="section level3">
<h3><span class="header-section-number">14.1.4</span> textConnection()</h3>
<p>Imagine que você tivesse recebido essa amostra de dados por e-mail:</p>
<pre><code>dates      cidade temperatura chuva
2013-01-01 SM          13     3
2013-01-01 SS          30    10
2013-01-01 CV          22    12</code></pre>
<p>Para converter essa pequena amostra de dados em um <em>dataframe</em> nós podemos selecionar, copiar e colar o texto no primeiro argumento da função <code>textConnection</code>, e então usar a função <code>read.table</code>.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb448-1" title="1">texto &lt;-<span class="st"> &quot;       dates      cidade temperatura chuva</span></a>
<a class="sourceLine" id="cb448-2" title="2"><span class="st">    2013-01-01 SM          31     3</span></a>
<a class="sourceLine" id="cb448-3" title="3"><span class="st">    2013-01-01 SS          35    10</span></a>
<a class="sourceLine" id="cb448-4" title="4"><span class="st">    2013-01-01 CV          21    14&quot;</span></a>
<a class="sourceLine" id="cb448-5" title="5"><span class="co"># conexão de texto</span></a>
<a class="sourceLine" id="cb448-6" title="6">tc &lt;-<span class="st"> </span><span class="kw">textConnection</span>(<span class="dt">object =</span> texto)</a>
<a class="sourceLine" id="cb448-7" title="7">tc</a>
<a class="sourceLine" id="cb448-8" title="8">x &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file =</span> tc, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb448-9" title="9">x</a></code></pre></div>
</div>
</div>
<div id="exportando-e-recuperando-objetos-do-r-no-formato-textual" class="section level2">
<h2><span class="header-section-number">14.2</span> Exportando e recuperando objetos do R no formato textual</h2>
<div id="dput-dget-dump-e-source." class="section level3">
<h3><span class="header-section-number">14.2.1</span> <code>dput()</code>, <code>dget</code>, <code>dump</code> e <code>source</code>.</h3>
<p>Uma função útil para compartilhar dados com alguém que precisa reproduzi-los é a função <code>dput()</code> (que pode ser traduzido como "despejar"). Ela escreve uma representação textual de um objeto R que pode ser escrita em um arquivo. Para recriar o objeto basta usar a função <code>dget()</code>.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb449-1" title="1">x</a>
<a class="sourceLine" id="cb449-2" title="2"><span class="co"># representação textual do objeto x</span></a>
<a class="sourceLine" id="cb449-3" title="3"><span class="kw">dput</span>(x)</a>
<a class="sourceLine" id="cb449-4" title="4"><span class="co"># salva representação textual de x em um arquivo temporário, você pode substituir tempfile() por um caminho de seu computador, p.ex. &quot;~/Downloads&quot;</span></a>
<a class="sourceLine" id="cb449-5" title="5">(aq_dest_file &lt;-<span class="st"> </span><span class="kw">tempfile</span>())</a>
<a class="sourceLine" id="cb449-6" title="6">(x_dest_file &lt;-<span class="st"> </span><span class="kw">tempfile</span>())</a>
<a class="sourceLine" id="cb449-7" title="7"><span class="kw">dput</span>(x, <span class="dt">file =</span> x_dest_file)</a>
<a class="sourceLine" id="cb449-8" title="8"><span class="co"># recuperando x a partir do arquivo</span></a>
<a class="sourceLine" id="cb449-9" title="9">y &lt;-<span class="st"> </span><span class="kw">dget</span>(x_dest_file)</a>
<a class="sourceLine" id="cb449-10" title="10"><span class="co"># alterar valores de y</span></a>
<a class="sourceLine" id="cb449-11" title="11">y &lt;-<span class="st"> </span>y[, <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>] <span class="op">-</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb449-12" title="12">y</a>
<a class="sourceLine" id="cb449-13" title="13"><span class="co"># verificar existência de x e y</span></a>
<a class="sourceLine" id="cb449-14" title="14"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb449-15" title="15"><span class="co"># listando variáveis que começam com x ou y</span></a>
<a class="sourceLine" id="cb449-16" title="16"><span class="kw">ls</span>(<span class="dt">pattern =</span> <span class="st">&quot;^[xy]&quot;</span>)</a>
<a class="sourceLine" id="cb449-17" title="17"><span class="co"># salvando mais de um objeto em um arquivo</span></a>
<a class="sourceLine" id="cb449-18" title="18">(xy_dest_file &lt;-<span class="st"> </span><span class="kw">tempfile</span>())</a>
<a class="sourceLine" id="cb449-19" title="19"><span class="kw">dump</span>(<span class="kw">ls</span>(<span class="dt">pattern =</span> <span class="st">&quot;^[xy]&quot;</span>), <span class="dt">file =</span> xy_dest_file)</a>
<a class="sourceLine" id="cb449-20" title="20"><span class="co"># vamos apagar x e y do espaco de trabalho</span></a>
<a class="sourceLine" id="cb449-21" title="21"><span class="kw">rm</span>(x, y)</a>
<a class="sourceLine" id="cb449-22" title="22"><span class="co"># x e y não existem mais</span></a>
<a class="sourceLine" id="cb449-23" title="23"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb449-24" title="24"><span class="co"># recuperando os objetos x e y salvos em xy.R</span></a>
<a class="sourceLine" id="cb449-25" title="25"><span class="kw">source</span>(xy_dest_file)</a>
<a class="sourceLine" id="cb449-26" title="26"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb449-27" title="27">x</a>
<a class="sourceLine" id="cb449-28" title="28">y</a></code></pre></div>
<p>Portanto diferente da escrita dos dados em si para um arquivo texto as funções <code>dump()</code> e <code>dput()</code> armazenam os <strong>dados</strong> e os <strong>metadados</strong>, assim outro usuário não precisa especificá-los novamente. Assim o usuário que recebe a saída do <code>dput()</code> em um arquivo, pode recriar os dados pelo comando <code>dget("nomedoarquivo")</code>.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb450-1" title="1"><span class="co"># representação textual de um data.frame</span></a>
<a class="sourceLine" id="cb450-2" title="2">dados3est &lt;-<span class="st"> </span><span class="kw">structure</span>(</a>
<a class="sourceLine" id="cb450-3" title="3">  <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb450-4" title="4">    <span class="dt">dates =</span> <span class="kw">c</span>(<span class="st">&quot;2013-01-01&quot;</span>, <span class="st">&quot;2013-01-01&quot;</span>, <span class="st">&quot;2013-01-01&quot;</span>),</a>
<a class="sourceLine" id="cb450-5" title="5">    <span class="dt">cidade =</span> <span class="kw">c</span>(<span class="st">&quot;SM&quot;</span>, <span class="st">&quot;SS&quot;</span>, <span class="st">&quot;CV&quot;</span>),</a>
<a class="sourceLine" id="cb450-6" title="6">    <span class="dt">temperatura =</span> <span class="kw">c</span>(31L, 35L, 21L),</a>
<a class="sourceLine" id="cb450-7" title="7">    <span class="dt">chuva =</span> <span class="kw">c</span>(3L, 10L, 14L)</a>
<a class="sourceLine" id="cb450-8" title="8">  ),</a>
<a class="sourceLine" id="cb450-9" title="9">  <span class="dt">.Names =</span> <span class="kw">c</span>(<span class="st">&quot;dates&quot;</span>, <span class="st">&quot;cidade&quot;</span>, <span class="st">&quot;temperatura&quot;</span>, <span class="st">&quot;chuva&quot;</span>),</a>
<a class="sourceLine" id="cb450-10" title="10">  <span class="dt">class =</span> <span class="st">&quot;data.frame&quot;</span>,</a>
<a class="sourceLine" id="cb450-11" title="11">  <span class="dt">row.names =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="op">-</span>3L)</a>
<a class="sourceLine" id="cb450-12" title="12">)</a>
<a class="sourceLine" id="cb450-13" title="13">dados3est</a></code></pre></div>
<p><strong>Vantagens:</strong></p>
<ul>
<li>armazena os <strong>dados e os metadados</strong></li>
<li>recuperação rápida e fácil dos dados</li>
</ul>
<p><strong>Desvantagens:</strong></p>
<ul>
<li>armazenamento de dados nesse formato não é muito eficiente em termos de espaço em disco</li>
<li>pouca legibilidade dos dados</li>
</ul>
<p>Esse procedimento é geralmente recomendado para fornecer pequenas amostras de dados (e-mails por exemplo)</p>
</div>
</div>
<div id="dados-de-pacotes-do-r" class="section level2">
<h2><span class="header-section-number">14.3</span> Dados de pacotes do R</h2>
<p>O <code>R</code> possui diversos conjuntos de dados internos que são automaticamente carregados quando iniciado. Esses dados são usados nos exemplos do <code>help()</code> de diversas funções para ilustrar o uso e a aplicação delas. Esses dados podem ser carregados com a função <code>data()</code>.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" title="1"><span class="co"># lista de dados disponíveis</span></a>
<a class="sourceLine" id="cb451-2" title="2"><span class="kw">data</span>()</a>
<a class="sourceLine" id="cb451-3" title="3"><span class="co"># Annual Precipitation in US Cities, p/ mais informações &quot;?precip&quot;</span></a>
<a class="sourceLine" id="cb451-4" title="4"><span class="kw">data</span>(precip)</a>
<a class="sourceLine" id="cb451-5" title="5"><span class="co"># primeiros 30 elementos dos dados precip</span></a>
<a class="sourceLine" id="cb451-6" title="6"><span class="kw">head</span>(precip, <span class="dt">n =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb451-7" title="7"><span class="co"># New York Air Quality Measurements, , p/ mais informações &quot;?airquality&quot;</span></a>
<a class="sourceLine" id="cb451-8" title="8"><span class="kw">data</span>(airquality)</a>
<a class="sourceLine" id="cb451-9" title="9"><span class="co"># primeiras linhas dos dados</span></a>
<a class="sourceLine" id="cb451-10" title="10"><span class="kw">head</span>(airquality, <span class="dt">n =</span> <span class="dv">10</span>)</a></code></pre></div>
</div>
<div id="readtable" class="section level2">
<h2><span class="header-section-number">14.4</span> Leitura de arquivos texto com funções da base do R</h2>
<p>A função nativa do <img src="images/logo_r.png" width="20"> mais usada para leitura de dados de um arquivo texto é a <code>read.table()</code>. Os dados lidos são armazenados em um dataframe.</p>
<p>Essa função possui diversos parâmetros para especificar a importação de acordo com as peculiaridades do formato de dados do arquivo.</p>
<p>O valor <em>default</em> do parâmetro <code>sep</code> é um ou mais caracteres de <code>espaço</code> e <code>tabs</code>. Devido as diversas opções de separadores existem outras funções envelopes da <code>read.table()</code>, com a diferença no separador, por exemplo as funções: <code>read.csv(), read.csv2(), read.delim()</code> que chamam a <code>read.table()</code>, dentro corpo da função, com o argumento <code>sep</code> definido como <code>,</code>, <code>;</code> e <code>\t</code>, respectivamente. Para detalhes sobre essas funções o <em>help</em> de cada uma. Uma vez que essas funções aceitam qualquer argumento da <code>read.table()</code> elas são mais convenientes que usar a <code>read.table()</code> e configurar os argumentos apropriados manualmente.</p>
<p>Alguns argumentos da função <code>read.table()</code> são:</p>
<ul>
<li><code>file</code> nome do arquivo</li>
<li><code>header</code> lógico (TRUE ou FALSE) indicando se o arquivo tem ou não linha de cabeçalho</li>
<li><code>sep</code> um caractere indicando como as colunas são separadas</li>
<li><code>colClasses</code>, um vetor caractere indicando as classes de cada coluna no conjunto de dados</li>
<li><code>nrows</code>, número de linhas no conjunto de dados</li>
<li><code>comment.char</code>, um caractere indicando o caractere usado como comentário (para ignorar essas linhas)</li>
<li><code>skip</code>, o número de linhas que devem ser “puladas” desde o início do arquivo</li>
<li><code>stringsAsFactors</code>, lógico, as variáveis do tipo <code>character</code> devem ser codificadas como <code>factor</code>?</li>
</ul>
<p>Esse último argumento pode ser definido também através da configuração global de opções no R pelo comando: <code>options(stringsAsFactors=FALSE)</code>.</p>
<p>Quando se faz a leitura de dados com <code>read.table("nome_do_arquivo")</code> o R automaticamente:</p>
<ul>
<li>pula linhas que começam com ‘#’</li>
<li>descobre quantas linhas tem o arquivo e quanta memória precisa ser alocada</li>
<li>descobre qual o tipo de variável em cada coluna</li>
</ul>
<p>Vamos ver alguns exemplos de leitura de dados hidrometeorológicos no formato texto amplamente usados em aplicações da Meteorologia.</p>
<div id="dados-hidrometeorológicos-brasileiros" class="section level3">
<h3><span class="header-section-number">14.4.1</span> Dados hidrometeorológicos brasileiros</h3>
<div id="hidroweb-ana" class="section level4">
<h4><span class="header-section-number">14.4.1.1</span> <a href="http://hidroweb.ana.gov.br/">hidroweb-ANA</a></h4>
<p>O sistema hidroweb é o maior base de dados hidrológicos brasileira. No trecho de código a seguir baixamos um arquivo de dados de precipitação obtidos no sistema hidroweb que foi salvo no site do livro.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb452-1" title="1"><span class="co"># arquivo de exemplo disponível no GitHub</span></a>
<a class="sourceLine" id="cb452-2" title="2">hidroweb_url_file &lt;-<span class="st"> &quot;https://raw.github.com/lhmet/adar-ufsm/master/data/CHUVAS.TXT&quot;</span></a>
<a class="sourceLine" id="cb452-3" title="3"><span class="co">#arquivo temporário, você pode substituir tempfile() por um caminho de seu computador, p.ex. &quot;~/Downloads/CHUVAS.TXT&quot;</span></a>
<a class="sourceLine" id="cb452-4" title="4">hidroweb_dest_file &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb452-5" title="5"><span class="kw">download.file</span>(</a>
<a class="sourceLine" id="cb452-6" title="6">  <span class="dt">url =</span> hidroweb_url_file, </a>
<a class="sourceLine" id="cb452-7" title="7">  <span class="dt">destfile =</span> hidroweb_dest_file</a>
<a class="sourceLine" id="cb452-8" title="8">)</a></code></pre></div>
<p>Antes de importar os dados você precisa visualizar o arquivo para extrair as informações básicas necessárias para sua importação. Você pode abri-lo em um editor de texto.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" title="1"><span class="co"># caracteres não devem tratados como fatores</span></a>
<a class="sourceLine" id="cb453-2" title="2"><span class="kw">options</span>(<span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb453-3" title="3"><span class="co"># leitura de dados da ANA</span></a>
<a class="sourceLine" id="cb453-4" title="4">dprec &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="dt">file =</span> hidroweb_url_file, </a>
<a class="sourceLine" id="cb453-5" title="5">                   <span class="dt">skip =</span> <span class="dv">15</span>, </a>
<a class="sourceLine" id="cb453-6" title="6">                   <span class="dt">head =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb453-7" title="7">                   <span class="dt">fill =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb453-8" title="8"><span class="co"># primeiras linhas</span></a>
<a class="sourceLine" id="cb453-9" title="9"><span class="kw">head</span>(dprec)</a>
<a class="sourceLine" id="cb453-10" title="10"><span class="co"># últimas linhas</span></a>
<a class="sourceLine" id="cb453-11" title="11"><span class="kw">tail</span>(dprec)</a>
<a class="sourceLine" id="cb453-12" title="12"> <span class="co"># corrigindo nome da primeira coluna</span></a>
<a class="sourceLine" id="cb453-13" title="13"> <span class="kw">names</span>(dprec)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;EstacaoCodigo&quot;</span></a>
<a class="sourceLine" id="cb453-14" title="14"> <span class="co"># removendo última coluna que só tem NAs</span></a>
<a class="sourceLine" id="cb453-15" title="15"> dprec &lt;-<span class="st"> </span>dprec[ , <span class="op">-</span><span class="kw">ncol</span>(dprec)]</a>
<a class="sourceLine" id="cb453-16" title="16">  <span class="co"># estrutura dos dados</span></a>
<a class="sourceLine" id="cb453-17" title="17">  <span class="kw">str</span>(dprec)</a>
<a class="sourceLine" id="cb453-18" title="18"><span class="co"># Fazendo a mesma leitura com read.table</span></a>
<a class="sourceLine" id="cb453-19" title="19">dprec2 &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file =</span> hidroweb_url_file, </a>
<a class="sourceLine" id="cb453-20" title="20">                   <span class="dt">skip =</span> <span class="dv">15</span>, </a>
<a class="sourceLine" id="cb453-21" title="21">                   <span class="dt">head =</span> T, </a>
<a class="sourceLine" id="cb453-22" title="22">                   <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb453-23" title="23">                   <span class="dt">fill =</span> T,</a>
<a class="sourceLine" id="cb453-24" title="24">                   <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>,</a>
<a class="sourceLine" id="cb453-25" title="25">                   <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb453-26" title="26"><span class="kw">head</span>(dprec2)</a></code></pre></div>
</div>
<div id="bdmep-inmet" class="section level4">
<h4><span class="header-section-number">14.4.1.2</span> <a href="http://www.inmet.gov.br/portal/index.php?r=bdmep/bdmep">BDMEP-INMET</a></h4>
<p>O Banco de Dados Meteorológicos para Ensino e Pesquisa do INMET é uma das principais fonte de dados climáticos brasileiros. Abaixo veremos como importar um arquivo de dados diários de uma estação meteorológica convencional. Os dados foram obtidos no BDMEP e salvos no site do livro.</p>
<p>No trecho de código a seguir baixamos o arquivo de dados da estação 83004.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" title="1"><span class="co"># arquivo de exemplo disponível no GitHub</span></a>
<a class="sourceLine" id="cb454-2" title="2">bdmep_url_file &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/lhmet/adar-ufsm/master/data/83004.txt&quot;</span></a>
<a class="sourceLine" id="cb454-3" title="3"><span class="co">#arquivo temporário, você pode substituir tempfile() por um caminho de seu computador, p.ex. &quot;~/Downloads/CHUVAS.TXT&quot;</span></a>
<a class="sourceLine" id="cb454-4" title="4">bdmep_dest_file &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb454-5" title="5"><span class="kw">download.file</span>(</a>
<a class="sourceLine" id="cb454-6" title="6">  <span class="dt">url =</span> bdmep_url_file, </a>
<a class="sourceLine" id="cb454-7" title="7">  <span class="dt">destfile =</span> bdmep_dest_file</a>
<a class="sourceLine" id="cb454-8" title="8">)</a></code></pre></div>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" title="1">x &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="dt">file =</span> bdmep_dest_file, </a>
<a class="sourceLine" id="cb455-2" title="2">               <span class="dt">header =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb455-3" title="3">               <span class="dt">skip =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb455-4" title="4">               <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb455-5" title="5">               <span class="dt">na.strings =</span> <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb455-6" title="6">               )</a>
<a class="sourceLine" id="cb455-7" title="7"><span class="kw">head</span>(x)</a>
<a class="sourceLine" id="cb455-8" title="8"><span class="kw">str</span>(x)</a></code></pre></div>
<p>Os dados lidos não incluíram a linha de cabeçalho com os nomes das variáveis. Nós pulamos essa linha porque o nome das variáveis está de acordo como número de colunas do arquivo. Então se tentarmos ler um arquivo de dados que contém linhas com número de registros diferentes ocorrerá um erro pois os dados não são tabulares.</p>
<p>Outro aspecto nos dados lidos é que aparecem vários <code>&lt;NA&gt;</code>, que é o símbolo para dados do tipo <code>character</code> faltantes. A razão dos terem sido interpretados dessa forma deve-se a um caractere (<code>&lt;/pre&gt;</code>) encontrado na última linha do arquivo.</p>
<p>Para que os dados numéricos não sejam interpretados como caractere nós poderíamos executar a função <code>read.table(..., nrows = 5878)</code>, que ignoraria a última linha do arquivo e os dados seriam interpretados como <code>numeric</code>.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb456-1" title="1">x1 &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="dt">file=</span>bdmep_dest_file, </a>
<a class="sourceLine" id="cb456-2" title="2">               <span class="dt">header =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb456-3" title="3">               <span class="dt">skip =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb456-4" title="4">               <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb456-5" title="5">               <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</a>
<a class="sourceLine" id="cb456-6" title="6">               <span class="dt">na.strings =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb456-7" title="7">               <span class="dt">nrows =</span> <span class="dv">5878</span> </a>
<a class="sourceLine" id="cb456-8" title="8">)</a>
<a class="sourceLine" id="cb456-9" title="9"><span class="kw">head</span>(x1)</a>
<a class="sourceLine" id="cb456-10" title="10"><span class="kw">str</span>(x1)</a></code></pre></div>
<p>Outra alternativa seria converter as colunas de interesse (todas exceto as de 1 a 3) para <code>numeric</code> através da função <code>as.numeric()</code> usando a função <code>apply</code> ao longo das colunas:</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" title="1"><span class="co"># corrigindo classe dos dados</span></a>
<a class="sourceLine" id="cb457-2" title="2"><span class="co"># convertendo de character para numeric</span></a>
<a class="sourceLine" id="cb457-3" title="3">x[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)] &lt;-<span class="st"> </span><span class="kw">apply</span>(x[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)], <span class="dv">2</span>, as.numeric)</a>
<a class="sourceLine" id="cb457-4" title="4"><span class="kw">str</span>(x)</a>
<a class="sourceLine" id="cb457-5" title="5"><span class="co"># razão dos avisos</span></a>
<a class="sourceLine" id="cb457-6" title="6"><span class="co">#as.numeric(&quot;NA&quot;)</span></a></code></pre></div>
<p>Mas e o nome das variáveis? Nós ignoramos a linha de cabeçalho por que nos dados do INMET ocorre uma variável denominada <code>VelocidadeVentoInsolacao</code>. Essa <em>string</em> deveria ser separada em duas. Vamos fazer essa adequação aos dados.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb458-1" title="1"><span class="co"># lendo somente o nome das variaveis</span></a>
<a class="sourceLine" id="cb458-2" title="2">vnames &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="dt">file=</span>bdmep_dest_file, </a>
<a class="sourceLine" id="cb458-3" title="3">                    <span class="dt">header =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb458-4" title="4">                    <span class="dt">skip =</span> <span class="dv">15</span>,</a>
<a class="sourceLine" id="cb458-5" title="5">                    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb458-6" title="6">                    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</a>
<a class="sourceLine" id="cb458-7" title="7">                    <span class="dt">na.strings =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb458-8" title="8">                    <span class="dt">nrows =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb458-9" title="9"><span class="co"># convertendo de dataframe para vetor</span></a>
<a class="sourceLine" id="cb458-10" title="10">vnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">t</span>(vnames))</a>
<a class="sourceLine" id="cb458-11" title="11">vnames</a>
<a class="sourceLine" id="cb458-12" title="12"><span class="co"># número de variáveis é diferente do número de colunas do arquivo</span></a>
<a class="sourceLine" id="cb458-13" title="13"><span class="kw">length</span>(vnames) <span class="op">==</span><span class="st"> </span><span class="kw">ncol</span>(x)</a>
<a class="sourceLine" id="cb458-14" title="14"><span class="co"># corrigindo nomes das variaveis</span></a>
<a class="sourceLine" id="cb458-15" title="15"><span class="co">#   substitui &quot;VelocidadeVentoInsolacao&quot; por &quot;VelocidadeVento&quot;</span></a>
<a class="sourceLine" id="cb458-16" title="16">vnames[<span class="dv">13</span>] &lt;-<span class="st"> &quot;VelocidadeVento&quot;</span></a>
<a class="sourceLine" id="cb458-17" title="17"><span class="co"># acresenta na 14a posição dos nomes a variável &quot;insolacao&quot; e</span></a>
<a class="sourceLine" id="cb458-18" title="18"><span class="co"># desloca os elementos orginais do vetor </span></a>
<a class="sourceLine" id="cb458-19" title="19">vnames &lt;-<span class="st"> </span><span class="kw">c</span>(vnames[<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>], <span class="st">&quot;insolacao&quot;</span>, vnames[<span class="dv">14</span><span class="op">:</span><span class="kw">length</span>(vnames)])</a>
<a class="sourceLine" id="cb458-20" title="20"><span class="kw">length</span>(vnames)</a>
<a class="sourceLine" id="cb458-21" title="21"><span class="kw">ncol</span>(x)</a>
<a class="sourceLine" id="cb458-22" title="22"><span class="kw">names</span>(x) &lt;-<span class="st"> </span>vnames</a>
<a class="sourceLine" id="cb458-23" title="23"><span class="kw">head</span>(x)</a></code></pre></div>
<p>Finalmente vamos escrever os dados do INMET corretamente organizados.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" title="1">bdmep_dest_file_clean &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;83004_clean.txt&quot;</span>)</a>
<a class="sourceLine" id="cb459-2" title="2"><span class="kw">write.csv2</span>(x,</a>
<a class="sourceLine" id="cb459-3" title="3">           <span class="dt">file =</span> bdmep_dest_file_clean, </a>
<a class="sourceLine" id="cb459-4" title="4">           <span class="dt">na =</span> <span class="st">&quot;-9999&quot;</span>,</a>
<a class="sourceLine" id="cb459-5" title="5">           <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
</div>
<div id="arquivos-formatados-com-largura-fixa" class="section level3">
<h3><span class="header-section-number">14.4.2</span> Arquivos formatados com largura fixa</h3>
<p>Alguns arquivos texto com dados tabulares podem não conter separadores (para p.ex. economizar espaço de disco). Outros arquivos podem ser formatados usando largura fixa para reservar o espaço de cada variável, o que aumenta a legibilidade dos dados em editor de texto.</p>
<p>Nesses casos a função <code>read.fwf()</code> é conveniente. Vamos usar como exemplo o arquivo de dados do Índice de Oscilação Sul (SOI) obtido no site do <a href="http://www.cpc.ncep.noaa.gov">National Weather Service - Climate Prediction Center (NWS-CPC)</a>.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb460-1" title="1"><span class="co"># link para os dados do SOI</span></a>
<a class="sourceLine" id="cb460-2" title="2">noaa_url_file &lt;-<span class="st"> &quot;http://www.cpc.ncep.noaa.gov/data/indices/soi&quot;</span></a></code></pre></div>
<p>Abrindo o link dos dados no navegador para visualização dos dados.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb461-1" title="1"><span class="kw">browseURL</span>(<span class="dt">url =</span> noaa_url_file)</a></code></pre></div>
<p>Leitura dos dados:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" title="1"><span class="co">#soi &lt;- read.fwf(file = link,                           # nome do arquivo ou link</span></a>
<a class="sourceLine" id="cb462-2" title="2">soi &lt;-<span class="st"> </span><span class="kw">read.fwf</span>(<span class="dt">file =</span> noaa_url_file,                       <span class="co"># sem internet, usar esse arquivo</span></a>
<a class="sourceLine" id="cb462-3" title="3">                <span class="dt">skip =</span> <span class="dv">4</span>,                               <span class="co"># pula 4 linhas</span></a>
<a class="sourceLine" id="cb462-4" title="4">                <span class="dt">header =</span> <span class="ot">FALSE</span>,                             <span class="co"># sem cabeçalho</span></a>
<a class="sourceLine" id="cb462-5" title="5">                <span class="dt">nrows =</span> <span class="dv">70</span>,                             <span class="co"># num. de linhas</span></a>
<a class="sourceLine" id="cb462-6" title="6">                <span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="kw">rep</span>(<span class="dv">6</span>,<span class="dv">12</span>)),                <span class="co"># largura dos campos das variáveis</span></a>
<a class="sourceLine" id="cb462-7" title="7">                <span class="dt">na.strings =</span> <span class="st">&quot;-999.9&quot;</span>,                  <span class="co"># string para dados faltantes</span></a>
<a class="sourceLine" id="cb462-8" title="8">                <span class="dt">col.names =</span> <span class="kw">scan</span>(noaa_url_file,             <span class="co"># varredura do arquivo</span></a>
<a class="sourceLine" id="cb462-9" title="9">                <span class="co">#col.names = scan(link,             # varredura do arquivo</span></a>
<a class="sourceLine" id="cb462-10" title="10">                                 <span class="dt">what =</span> <span class="st">&quot;character&quot;</span>,    <span class="co"># tipo dos dados a serem lidos</span></a>
<a class="sourceLine" id="cb462-11" title="11">                                 <span class="dt">skip =</span> <span class="dv">3</span>,              <span class="co"># pula 3 linhas</span></a>
<a class="sourceLine" id="cb462-12" title="12">                                 <span class="dt">nmax =</span> <span class="dv">13</span>)             <span class="co"># num. max de registros a serem lidos</span></a>
<a class="sourceLine" id="cb462-13" title="13">                )</a>
<a class="sourceLine" id="cb462-14" title="14"><span class="kw">head</span>(soi)</a></code></pre></div>
<p>Vamos alterar a estrutura dos dados: ao invés dos dados serem distribuídos ao longo das colunas, vamos estruturá-los como série temporal, ou seja cada valor mensal corresponderá a uma linha.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb463-1" title="1"><span class="co"># converte a matriz de dados para um vetor (em sequencia cronológica)</span></a>
<a class="sourceLine" id="cb463-2" title="2">soi_v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">t</span>(soi[, <span class="dv">-1</span>]))</a>
<a class="sourceLine" id="cb463-3" title="3"><span class="co"># criando um dataframe com valores de SOI, mes e ano</span></a>
<a class="sourceLine" id="cb463-4" title="4">soi_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ano =</span> <span class="kw">rep</span>(soi<span class="op">$</span>YEAR, <span class="dt">each =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb463-5" title="5">                     <span class="dt">mes =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">length</span>(soi[,<span class="dv">1</span>])),</a>
<a class="sourceLine" id="cb463-6" title="6">                     <span class="dt">soi =</span> soi_v)</a>
<a class="sourceLine" id="cb463-7" title="7"><span class="co"># escrevendo dados SOI em um arquivo CSV</span></a>
<a class="sourceLine" id="cb463-8" title="8">soi_csv_file &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;SOI.csv&quot;</span>)</a>
<a class="sourceLine" id="cb463-9" title="9"><span class="kw">write.csv</span>(<span class="dt">x =</span> soi_df, </a>
<a class="sourceLine" id="cb463-10" title="10">          <span class="dt">file =</span> soi_csv_file, </a>
<a class="sourceLine" id="cb463-11" title="11">          <span class="dt">na =</span> <span class="st">&quot;-999.9&quot;</span>, </a>
<a class="sourceLine" id="cb463-12" title="12">          <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Vamos ler os dados reestruturados que foram salvos no formato <a href="http://en.wikipedia.org/wiki/Comma-separated_values">csv</a> usando uma função que permite a escolha do arquivo de forma iterativa.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" title="1"><span class="co"># leitura de dados com escolha interativa do arquivo</span></a>
<a class="sourceLine" id="cb464-2" title="2">soi.df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="kw">file.choose</span>(),</a>
<a class="sourceLine" id="cb464-3" title="3">                   <span class="co"># file.choose só é válido em sistema *unix</span></a>
<a class="sourceLine" id="cb464-4" title="4">                   <span class="co"># no windows é choose.file()</span></a>
<a class="sourceLine" id="cb464-5" title="5">                   <span class="dt">header =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb464-6" title="6">                   <span class="dt">na.strings =</span> <span class="st">&quot;-999.9&quot;</span>)</a></code></pre></div>
<p>Navegue até o diretório do arquivo <code>SOI.csv</code> e clique duas vezes sobre ele.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb465-1" title="1">soi.df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> soi_csv_file,</a>
<a class="sourceLine" id="cb465-2" title="2">                   <span class="dt">header =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb465-3" title="3">                   <span class="dt">na.strings =</span> <span class="st">&quot;-999.9&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb466-1" title="1"><span class="kw">head</span>(soi.df)</a>
<a class="sourceLine" id="cb466-2" title="2"><span class="kw">str</span>(soi.df)</a></code></pre></div>
<p>A função <code>read.fortran()</code> é uma função similar à <code>read.fwf()</code> e permite usar especificações de colunas no estilo <a href="http://en.wikipedia.org/wiki/Fortran">Fortran</a>.</p>
<!--chapter:end:AppendixB.Rmd-->
</div>
</div>
</div>
<div id="r-markdown" class="section level1">
<h1><span class="header-section-number">15</span> R Markdown</h1>
<p><a href="http://rmarkdown.rstudio.com/">R Markdown</a> é uma ferramenta de <a href="https://pt.wikipedia.org/wiki/Programa%C3%A7%C3%A3o_liter%C3%A1ria">programação literária</a> que combina uma sintaxe de formatação de texto simples (o <a href="http://daringfireball.net/projects/markdown/">Markdown</a>) com trechos de códigos <a href="http://www.r-project.org">R</a> em um documento final em formatos HTML, PDF ou Word. Esta peculiaridade do R Markdown faz dele um elemento chave para pesquisa reproduzível<a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a> e colaborativa.</p>
<!-- documento dinâmico reprodutível  = texto (descrição e interpretação dos resultados) + código (linguagem computacional)  -->
<p>O R Markdown está disponível no RStudio e sua implementação é baseada nos pacotes <a href="http://yihui.name/knitr/">knitr</a> e <a href="http://pandoc.org/">pandoc</a>. A extensão de um arquivo R Markdown é <code>.Rmd</code>. Um texto R Markdown pode ser facilmente criado no RStudio a partir de um <em>template</em> em <em><code>File ▶ New File ▶ R Markdown</code></em>. Ao clicar no ícone <code>Knit HTML</code> ou digitar o atalho <code>Ctr+Shift+K</code> é gerado o documento HTML do arquivo <code>.Rmd</code> correspondente.</p>
<p>Os documentos HTML gerados com R Markdown podem ser prontamente disponibilizados na internet por meio do <a href="https://rpubs.com/">Rpubs</a><a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a>, <a href="https://github.com">Github</a><a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a> e <a href="https://app.netlify.com/drop">netlify</a><a href="#fn32" class="footnote-ref" id="fnref32"><sup>32</sup></a>.</p>
<!-- 

-->
<div id="como-usar-o-r-markdown" class="section level2">
<h2><span class="header-section-number">15.1</span> Como usar o <em>R Markdown</em></h2>
<p>A ideia básica é que o texto seja intercalado com blocos ou trechos de código que são identificados de uma forma particular. A estrutura básica de um <em>chunk</em> é:</p>
<p>Por exemplo, para mostrar a expressão usada para instalar os pacotes <code>rmarkdown</code> e <code>gcookbook</code>, digitamos o seguinte trecho no corpo do texto do arquivo <code>.Rmd</code> criado no RStudio.</p>
<pre><code>```{r}
install.packages(c(&#39;rmarkdown&#39;, &#39;gcookbook&#39;))
```                                              </code></pre>
<p>O texto acima aparecerá da seguinte forma no documento <code>html</code>:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb468-1" title="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&#39;rmarkdown&#39;</span>, <span class="st">&#39;gcookbook&#39;</span>))</a></code></pre></div>
<p>Os trechos de código (<em>chuncks</em>) são avaliados pelo R na ordem em que eles aparecem. Os objetos criados criados em um <em>chunck</em> permanecem disponíveis no ambiente para uso em <em>chuncks</em> posteriores. O código no <em>chunck</em> é destacado de forma diferente do texto. Os resultados (tabelas, gráficos e outros objetos) gerados pelo código de um <em>chunck</em> também são incorporados no documento.</p>
<p>Nesse documento mostramos os principais elementos do <strong><em>Markdown</em></strong> e como construir os <strong><em>chunks</em></strong>.</p>
<div id="opções-do-chunk" class="section level3">
<h3><span class="header-section-number">15.1.1</span> Opções do <strong>chunk</strong></h3>
<p>Cada <em>chunk</em> possui parâmetros que permitem definir opções de execução para aquele <em>chunck</em>. Para o chunck de exemplo abaixo, as principais são as seguintes:</p>
<pre><code>```{r letras-ufsm, eval=TRUE, echo = TRUE, message = TRUE, results = &#39;hide&#39;}
letters
## letras em maiúsculo
LETRAS &lt;- toupper(letters)
LETRAS
x &lt;- LETRAS[LETRAS %in% c(&#39;U&#39;, &#39;F&#39;, &#39;S&#39;, &#39;M&#39;)]
x
```</code></pre>
<ul>
<li><code>letras-ufsm</code> identificador do <em>chunk</em> (opcional) que permite encontrar ele mais fácil se ocorrer algum erro durante a geração do documento.</li>
<li><code>eval = TRUE</code> opção para executar o <em>chunk</em> quando compilar o documento (valor <em>default</em>: TRUE).<br />
</li>
<li><code>message = TRUE</code> mostra as mensagens de erro (<em>default</em> TRUE).<br />
</li>
<li><code>results = 'hide'</code> permite ocultar as saídas da avaliação do código do chunk (<em>default</em> ‘hold’, ou seja mantém os resultados).</li>
</ul>
<p>O resto das opções são mostradas ao pressionar a tecla <code>tab</code> com o mouse posicionado dentro dos colchetes da linha do <strong>chunk</strong>. Para uma lista completa os parâmetros do <em>chunck</em> consulte <a href="http://yihui.name/knitr/options/" class="uri">http://yihui.name/knitr/options/</a>.</p>
</div>
<div id="saídas-dos-chunks" class="section level3">
<h3><span class="header-section-number">15.1.2</span> Saídas dos <strong>chunks</strong></h3>
<p>Os resultados dos <em>chuncks</em> podem ser mostrados na forma de figuras, tabelas e textos.</p>
<pre><code>```{r, warning=FALSE, message=FALSE,comment=&#39;&#39;}
# carregando a pacote &#39;ggplot2&#39; para gráficos elegante
library(ggplot2)
# pacote que contém conjunto de dados de temperatura
library(gcookbook)
# Mostrando as primeiras linhas da tabela &#39;climate&#39; que pertenece ao pacote
head(climate)
# Usando a função qplot() para plotar a série de temperatura global
qplot(x = Year, y = Anomaly1y, data = climate) + geom_smooth()
# Usando apenas a função plot()
plot(x = climate$Year, y = climate$Anomaly1)
# regressão linear
reg &lt;- lm(Anomaly1y ~ Year, data = climate)
# extraindo o coeficiente angular (°C/ano) da reta
# convertendo para °C/100 anos
tendencia &lt;- coef(reg)[2] * 100
```</code></pre>
<p>O resultado do chunck acima será:</p>
<pre><code>#&gt;     Source Year Anomaly1y Anomaly5y Anomaly10y Unc10y
#&gt; 1 Berkeley 1800        NA        NA     -0.435  0.505
#&gt; 2 Berkeley 1801        NA        NA     -0.453  0.493
#&gt; 3 Berkeley 1802        NA        NA     -0.460  0.486
#&gt; 4 Berkeley 1803        NA        NA     -0.493  0.489
#&gt; 5 Berkeley 1804        NA        NA     -0.536  0.483
#&gt; 6 Berkeley 1805        NA        NA     -0.541  0.475
#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;
#&gt; Warning: Removed 207 rows containing non-finite values (stat_smooth).
#&gt; Warning: Removed 207 rows containing missing values (geom_point).</code></pre>
<p><img src="images/chunck4-1.png" width="672" /><img src="images/chunck4-2.png" width="672" /></p>
<pre><code>#&gt;      Year 
#&gt; 0.5929518</code></pre>
<p>Podemos fazer outro <em>chunk</em> para mostrar as tabelas.</p>
<pre><code>#&gt; ```{r}
#&gt; # pacote com a função kable para saída de tabelas
#&gt; library(knitr)
#&gt; # Aplicando a função &#39;summary()&#39; ao dataframe airquality.
#&gt; s &lt;- summary(airquality)
#&gt; # Convertendo o formato da saída das tabelas
#&gt; kable(s, caption = &#39;Tabela 1: Resumo estatístico dos de qualidade do ar&#39;)
#&gt; ```</code></pre>
<table>
<caption>(#tab:chunck6)Tabela 1: Resumo estatístico dos dados de ‘qualidade do ar’ de NY</caption>
<thead>
<tr class="header">
<th></th>
<th align="center">Ozone</th>
<th align="center">Solar.R</th>
<th align="center">Wind</th>
<th align="center">Temp</th>
<th align="center">Month</th>
<th align="center">Day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td align="center">Min. : 1.00</td>
<td align="center">Min. : 7.0</td>
<td align="center">Min. : 1.700</td>
<td align="center">Min. :56.00</td>
<td align="center">Min. :5.000</td>
<td align="center">Min. : 1.0</td>
</tr>
<tr class="even">
<td></td>
<td align="center">1st Qu.: 18.00</td>
<td align="center">1st Qu.:115.8</td>
<td align="center">1st Qu.: 7.400</td>
<td align="center">1st Qu.:72.00</td>
<td align="center">1st Qu.:6.000</td>
<td align="center">1st Qu.: 8.0</td>
</tr>
<tr class="odd">
<td></td>
<td align="center">Median : 31.50</td>
<td align="center">Median :205.0</td>
<td align="center">Median : 9.700</td>
<td align="center">Median :79.00</td>
<td align="center">Median :7.000</td>
<td align="center">Median :16.0</td>
</tr>
<tr class="even">
<td></td>
<td align="center">Mean : 42.13</td>
<td align="center">Mean :185.9</td>
<td align="center">Mean : 9.958</td>
<td align="center">Mean :77.88</td>
<td align="center">Mean :6.993</td>
<td align="center">Mean :15.8</td>
</tr>
<tr class="odd">
<td></td>
<td align="center">3rd Qu.: 63.25</td>
<td align="center">3rd Qu.:258.8</td>
<td align="center">3rd Qu.:11.500</td>
<td align="center">3rd Qu.:85.00</td>
<td align="center">3rd Qu.:8.000</td>
<td align="center">3rd Qu.:23.0</td>
</tr>
<tr class="even">
<td></td>
<td align="center">Max. :168.00</td>
<td align="center">Max. :334.0</td>
<td align="center">Max. :20.700</td>
<td align="center">Max. :97.00</td>
<td align="center">Max. :9.000</td>
<td align="center">Max. :31.0</td>
</tr>
<tr class="odd">
<td></td>
<td align="center">NA’s :37</td>
<td align="center">NA’s :7</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="códigos-r-dentro-de-linhas" class="section level3">
<h3><span class="header-section-number">15.1.3</span> Códigos R dentro de linhas</h3>
<p>Podemos usar o R em expressões dentro de uma linha de texto, para mostrar o valor de uma variável ou efetuar um cálculo. Por exemplo, para obtermos o valor resultante de 2 + 2 escrevemos `<code>r 2 + 2</code>` e o R colocará o resultado naquela posição do texto.</p>
<p>Por exemplo, a sentença:</p>
<ul>
<li>A tendência da temperatura do ar média global é de `<code> r round(tendencia, 2)</code>` °C/100 anos.</li>
</ul>
<p>ficará</p>
<ul>
<li>A tendência da temperatura do ar média global é de 0.59 °C/100 anos.</li>
</ul>
</div>
</div>
<div id="markdown" class="section level2">
<h2><span class="header-section-number">15.2</span> Markdown</h2>
<div id="cabeçalhos" class="section level3">
<h3><span class="header-section-number">15.2.1</span> Cabeçalhos</h3>
<p><strong>Cabeçalhos</strong> (ou <em>headers</em> em inglês) são definidos para construção do índice de seções ou capítulos do documento (<em>table of content, TOC</em>) que são ‘lincados’ às seções.</p>
<pre><code> # Seção - nível 1
 ## Subseção - nível 2 
 ### Subsubseção - nível 3
 e assim por diante
 ...</code></pre>
</div>
<div id="parágrafos" class="section level3">
<h3><span class="header-section-number">15.2.2</span> Parágrafos</h3>
<p>Um parágrafo é uma ou mais linhas de texto, seguido de uma ou mais linha em branco.</p>
<p><strong>Novas linhas são tratadas como espaços</strong>, para que possa organizar seus parágrafos como você gosta.</p>
<p>Se você precisar de uma quebra de linha, insira <strong>dois ou mais espaços no final de uma linha</strong>.</p>
</div>
<div id="listas-1" class="section level3">
<h3><span class="header-section-number">15.2.3</span> Listas</h3>
<p>Para produzir uma lista são usados os símbolos: <code>+</code> , <code>*</code> , <code>-</code>.
Uma lista suporta vários níveis de subitens. Os subitens devem separados por quatro espaços ou um <em>tab</em>.</p>
<pre><code> * um
     - subitem
 * dois
     - subitem
         - subsubitem
 * três</code></pre>
<ul>
<li>um
<ul>
<li>subitem</li>
</ul></li>
<li>dois
<ul>
<li>subitem
<ul>
<li>subsubitem</li>
</ul></li>
</ul></li>
<li>três</li>
</ul>
</div>
<div id="linhas-horizontais" class="section level3">
<h3><span class="header-section-number">15.2.4</span> Linhas horizontais</h3>
<p>Para inserir uma linha horizontal pode-se usar:</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode md"><code class="sourceCode markdown"><a class="sourceLine" id="cb476-1" title="1"> </a>
<a class="sourceLine" id="cb476-2" title="2"> * * *</a>
<a class="sourceLine" id="cb476-3" title="3"> </a>
<a class="sourceLine" id="cb476-4" title="4"> ou</a>
<a class="sourceLine" id="cb476-5" title="5"> </a>
<a class="sourceLine" id="cb476-6" title="6"> - - -</a>
<a class="sourceLine" id="cb476-7" title="7"> </a></code></pre></div>
<p>Ambos serão impressos como:</p>
<hr />
<p>É importante notar a quebra de linha entre cada linha de caracteres.</p>
</div>
<div id="citações-diretas" class="section level3">
<h3><span class="header-section-number">15.2.5</span> Citações diretas</h3>
<p>Para fazer citações diretas é só acrescentar um <code>&gt;</code> antes do texto da citação. Por exemplo:</p>
<p>&gt; É eRReando que se aprende R. (Jônatan Tatsch).</p>
<p>será impresso no HTML assim:</p>
<blockquote>
<p>É eRReando que se aprende R. (Jônatan Tatsch).</p>
</blockquote>
</div>
<div id="tabelas" class="section level3">
<h3><span class="header-section-number">15.2.6</span> Tabelas</h3>
<p>As tabelas devem ter uma linha para cada fila, com alinhamento definido pela posição relativa a linha pontilhada dos nomes das colunas. A descrição da tabela precisa ter o formato <code>Table:</code> ou apenas <code>:</code>, a posição definida é acima da tabela.</p>
<pre><code>  direita     esquerda   Centro    Default
  -------     ------   ---------   -------
       12     12          12           12
      123     123         123         123
        1     1            1            1
  Table:  Tabela 1. Demonstração da sintaxe para uma tabela.</code></pre>
<table>
<caption>Tabela 1. Demonstração da sintaxe para uma tabela.</caption>
<thead>
<tr class="header">
<th>direita</th>
<th>esquerda</th>
<th align="center">Centro</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>12</td>
<td>12</td>
<td align="center">12</td>
<td>12</td>
</tr>
<tr class="even">
<td>123</td>
<td>123</td>
<td align="center">123</td>
<td>123</td>
</tr>
<tr class="odd">
<td>1</td>
<td>1</td>
<td align="center">1</td>
<td>1</td>
</tr>
</tbody>
</table>
<pre><code>#&gt; : Amostra de tabela com grades.
#&gt;                                
#&gt; +---------------+---------------+--------------------+
#&gt; | Variável1     | Variável2     | descrição          |
#&gt; +===============+===============+====================+
#&gt; | 1             |  1.34         | - Observação 1     |
#&gt; |               |               | - Observação 2     |
#&gt; +---------------+---------------+--------------------+
#&gt; | 2             |  2.10         | - Observação 2     |
#&gt; |               |               | - Linha 2          |
#&gt; +---------------+---------------+--------------------+</code></pre>
<table style="width:74%;">
<caption>Amostra de tabela com grades.</caption>
<colgroup>
<col width="22%" />
<col width="22%" />
<col width="29%" />
</colgroup>
<thead>
<tr class="header">
<th>Variável1</th>
<th>Variável2</th>
<th>descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1.34</td>
<td><ul>
<li>Observação 1</li>
<li>Linha 1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>2.10</td>
<td><ul>
<li>Observação 2</li>
<li>Linha 2</li>
</ul></td>
</tr>
</tbody>
</table>
<p>Um recurso para construir tabelas em Markdown é o <a href="http://www.tablesgenerator.com/markdown_tables">gerador de tabelas</a> que permite montar a tabela e criar o código para você colá-lo no seu documento <code>.Rmd</code>.</p>
</div>
<div id="ênfase-de-texto" class="section level3">
<h3><span class="header-section-number">15.2.7</span> Ênfase de texto</h3>
<p>Para destacar texto usa-se geralmente as palavras em <em>itálico</em> (<code>_itálico_</code> ou <code>*itálico*</code>) ou em <strong>negrito</strong> (<code>__negrito__</code> ou <code>**negrito**</code>).</p>
<p>Um texto sobrescrito 2<sup>10</sup> é escrito <code>2^10^</code> e o subscrito (H<sub>2</sub>O) da forma <code>H~2~O</code>.</p>
</div>
<div id="hyperlinks" class="section level3">
<h3><span class="header-section-number">15.2.8</span> Hyperlinks</h3>
<p>Para incluir link de um site é só colocar o endereço web entre <code>&lt; &gt;</code>. Por exemplo, o texto:</p>
<pre><code>&lt;https://lhmet.github.io/adar-ebook/calculadora.html&gt; </code></pre>
<p>será mostrado como</p>
<p><a href="https://lhmet.github.io/adar-ebook/calculadora.html" class="uri">https://lhmet.github.io/adar-ebook/calculadora.html</a></p>
<p>Podemos associar um link a uma sentença, conforme sintaxe abaixo.</p>
<pre><code>O _R Markdown_  possui ampla documentação, veja o [cartão de referência](http://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf) e o [site oficial](http://rmarkdown.rstudio.com/)&quot;.</code></pre>
<p>que resultará em</p>
<p>O <em>R Markdown</em> possui ampla documentação, veja o <a href="http://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf">cartão de referência</a> e o <a href="http://rmarkdown.rstudio.com/">site oficial</a>.</p>
</div>
<div id="figuras" class="section level3">
<h3><span class="header-section-number">15.2.9</span> Figuras</h3>
<p>Para a inserir figuras o procedimento é quase o mesmo de um link, só que precedido pelo símbolo <code>!</code>.</p>
<p>Vamos criar um link para o endereço da imagem:</p>
<pre><code>[Cachoeira do Abade](http://upload.wikimedia.org/wikipedia/commons/c/c5/Cachoeira_do_Abade_AGO_2008.jpg)</code></pre>
<p><a href="http://upload.wikimedia.org/wikipedia/commons/c/c5/Cachoeira_do_Abade_AGO_2008.jpg">Cachoeira do Abade</a></p>
<p>Ao acrescentarmos o símbolo <code>!</code> no início, obtemos a imagem no documento.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode md"><code class="sourceCode markdown"><a class="sourceLine" id="cb482-1" title="1"><span class="al">![Cachoeira do Abade](http://upload.wikimedia.org/wikipedia/commons/c/c5/Cachoeira_do_Abade_AGO_2008.jpg)</span></a></code></pre></div>
<div class="figure">
<img src="http://upload.wikimedia.org/wikipedia/commons/c/c5/Cachoeira_do_Abade_AGO_2008.jpg" alt="Figura 1. Cachoeira do Abade" />
<p class="caption">Figura 1. Cachoeira do Abade</p>
</div>
<p>O procedimento para inserir figuras do seu computador é o mesmo, só altera-se o endereço pelo caminho até o arquivo.</p>
</div>
<div id="expressões-matemáticas" class="section level3">
<h3><span class="header-section-number">15.2.10</span> Expressões matemáticas</h3>
<p>Nossa área de estudo geralmente requer análises baseadas em equações. Para inserir expressões matemáticas no <em>R Markdown</em> é da mesma forma usada em <a href="http://pt.wikipedia.org/wiki/LaTeX">Latex</a>.</p>
<p>Para expressões dentro de uma linha as equações são escritas entre os símbolos <code>$ $</code>, por exemplo, <span class="math inline">\(y=f(x)\)</span> foi gerada com <code>$y=f(x)$</code>.
Mas se a equação for muito complexa é melhor colocá-la sozinha entre parágrafos de texto, duplicando o mesmo símbolo <code>$$ $$</code>, exemplo:</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode tex"><code class="sourceCode latex"><a class="sourceLine" id="cb483-1" title="1"> <span class="ss">$$</span><span class="sc">\psi</span><span class="ss"> = </span><span class="sc">\psi</span><span class="ss">_e </span><span class="sc">\left</span><span class="ss">(</span><span class="sc">\dfrac</span><span class="ss">{</span><span class="sc">\theta</span><span class="ss">}{</span><span class="sc">\theta</span><span class="ss">_s}</span><span class="sc">\right</span><span class="ss">)^{-b}$$</span></a>
<a class="sourceLine" id="cb483-2" title="2"> </a></code></pre></div>
<p>produz:</p>
<p><span class="math display">\[\psi = \psi_e \left(\dfrac{\theta}{\theta_s}\right)^{-b}\]</span></p>
<hr />
<p>Há também um <a href="http://www.codecogs.com/latex/eqneditor.php?lang=pt-br">Editor online de equações</a> que fornece uma interface para escrever a equação e o código gerado pode ser colado no seu documento.</p>
</div>
</div>
<div id="aparência" class="section level2">
<h2><span class="header-section-number">15.3</span> Aparência</h2>
<p>A aparência e formato do documento final impresso é definido por parâmetros definidos no cabeçalho, mais conhecido como <strong>YAML</strong> documento. Veja no exemplo abaixo, onde são definidos parâmetros para o formato de saída do arquivo (<code>output: html_document</code>), a inclusão de índice (<code>toc = TRUE</code>), opções para figuras (<code>fig_width: 7</code>, <code>fig_height: 6</code>, <code>fig_caption: true</code>), a opção para realce da sintaxe do código R (<code>highlight: tango</code>), o tema do <code>html</code> (<code>theme: united</code>). Para mais informações consulte <a href="http://rmarkdown.rstudio.com/markdown_document_format.html" class="uri">http://rmarkdown.rstudio.com/markdown_document_format.html</a>.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb484-1" title="1">    <span class="op">---</span></a>
<a class="sourceLine" id="cb484-2" title="2">    title: <span class="st">&quot;Meu novo projeto&quot;</span></a>
<a class="sourceLine" id="cb484-3" title="3">    author: Nome Sobrenome</a>
<a class="sourceLine" id="cb484-4" title="4">    output:</a>
<a class="sourceLine" id="cb484-5" title="5">         html_document:</a>
<a class="sourceLine" id="cb484-6" title="6">            theme: united [default, cerulean, journal, flatly, readable, spacelab, united, cosmo]</a>
<a class="sourceLine" id="cb484-7" title="7">            highlight: tango [default, tango, pygments, kate, monochrome, espresso, zenburn, haddock, textmate]</a>
<a class="sourceLine" id="cb484-8" title="8">            number_sections: true</a>
<a class="sourceLine" id="cb484-9" title="9">            toc: true</a>
<a class="sourceLine" id="cb484-10" title="10">            fig_width: <span class="dv">7</span></a>
<a class="sourceLine" id="cb484-11" title="11">            fig_height: <span class="dv">6</span></a>
<a class="sourceLine" id="cb484-12" title="12">            fig_caption: true</a>
<a class="sourceLine" id="cb484-13" title="13">    <span class="op">---</span></a></code></pre></div>
</div>
<div id="referências-para-aprender-mais-sobre-o-r-markdown" class="section level2">
<h2><span class="header-section-number">15.4</span> Referências para aprender mais sobre o R Markdown</h2>
<ul>
<li><a href="http://rmarkdown.rstudio.com/">Documentos dinâmicos no R</a></li>
<li><a href="http://kbroman.org/knitr_knutshell/">Tutorial mínimo sobre R Markdown</a></li>
<li><a href="https://github.com/yihui/knitr/releases/download/doc/knitr-manual.pdf">Manual do knitr</a></li>
<li><a href="http://daringfireball.net/projects/markdown/">Principal referência para Markdown</a></li>
<li><a href="ftp://ftp.ams.org/pub/tex/doc/amsmath/short-math-guide.pdf">Guia rápido expressões matemáticas</a></li>
<li><a href="http://rstudio-pubs-static.s3.amazonaws.com/18858_0c289c260a574ea08c0f10b944abc883.html">Notação matemática</a></li>
<li><a href="http://elevatorlady.ca/doc/refcard/expressions.html">Cartão de referência para expressões matemáticas-latex</a></li>
<li><a href="http://meta.math.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference">latex-mathjax</a></li>
<li><a href="http://www.calvin.edu/~rpruim/courses/m343/F12/RStudio/LatexExamples.html">latex em R Markdown</a></li>
<li><a href="https://cran.r-project.org/web/packages/knitcitations/index.html">Citações e referências bibliográficas</a></li>
</ul>
<p><br/></p>
<!--chapter:end:AppendixC.Rmd-->
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>ao baixar e seguir o processo normal de instalação no seu computador, você não verá nenhum software instalado quando você tiver terminado.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Procure escolher um nome curto para o seu usuário e que o identifique melhor.<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>O RStudio Cloud será usado para você realizar atividades práticas no RStudio diretamente no seu navegador (sem ter que instalar ou configurar nada).<a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>A versão mais atual no período de elaboração deste texto
foi a R 4.0.0.<a href="#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>Usando <a href="https://cloud.r-project.org" class="uri">https://cloud.r-project.org</a> automaticamente redireciona
para o espelho da CRAN mais próximo. A lista de espelhos atual encontra-se em <a href="https://cran.r-project.org/mirrors.html" class="uri">https://cran.r-project.org/mirrors.html</a>.<a href="#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>A execução destes comandos requer privilégios de <a href="https://pt.wikipedia.org/wiki/Superusu%C3%A1rio">superusuário</a>. Caso não
tenha, consulte o administrador do sistema.<a href="#fnref6" class="footnote-back">↩</a></p></li>
<li id="fn7"><p>Chave pública de autenticação é um meio alternativo de se logar
em um servidor ao invés de digitar uma senha. É uma forma mais segura e
flexível, mas mais difícil de ser configurada. Esse meio alternativo de fazer login é importante se o computador está visível na internet. Para saber mais
veja <a href="http://the.earth.li/~sgtatham/putty/0.55/htmldoc/Chapter8.html">aqui</a>.<a href="#fnref7" class="footnote-back">↩</a></p></li>
<li id="fn8"><p>Por ser atualizado automaticamente pelo sistema, às vezes o usuário nem percebe que a versão do R mudou.<a href="#fnref8" class="footnote-back">↩</a></p></li>
<li id="fn9"><p>Diretórios precedidos por “.” no Linux são diretórios ocultos. O diretório <code>/home/usuario/.R</code> é um diretório oculto, para visualizá-lo no Ubuntu, na interface gráfica do sistema, acesse <em>View &gt; Show Hidden Files</em> (ou <em>Visualizar &gt; Mostrar arquivos ocultos</em>). No terminal utilize <code>ls -a</code> para listar os arquivos ocultos.<a href="#fnref9" class="footnote-back">↩</a></p></li>
<li id="fn10"><p>Se seu sistema for 32 bit, você pode usar <a href="https://rstudio.com/products/rstudio/older-versions/">versões antigas do rstudio</a><a href="#fnref10" class="footnote-back">↩</a></p></li>
<li id="fn11"><p>digite <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>t</kbd> para abrir um terminal no Linux Ubuntu<a href="#fnref11" class="footnote-back">↩</a></p></li>
<li id="fn12"><p>Shell é um programa que roda outros programas, sendo popularmente chamado de "linha de comando", "console" ou "terminal".<a href="#fnref12" class="footnote-back">↩</a></p></li>
<li id="fn13"><p>Sugere-se salvar o projeto numa subpasta nomeado <strong>github</strong> localizado na pasta com o material do curso de ADAR ;)<a href="#fnref13" class="footnote-back">↩</a></p></li>
<li id="fn14"><p>Para fazer isso, você pode usar um editor de texto qualquer (p.ex.: <a href="https://help.gnome.org/users/gedit/stable/index.html.pt_BR">gedit</a> no SO Linux, ou <a href="https://pt.wikipedia.org/wiki/Bloco_de_Notas">Notepad</a> no SO Windows).<a href="#fnref14" class="footnote-back">↩</a></p></li>
<li id="fn15"><p>Você pode notar que este arquivo tem o mesmo nome do <code>arqentrada</code>, exceto que a sua extensão foi alterada para <code>.Rout</code>.<a href="#fnref15" class="footnote-back">↩</a></p></li>
<li id="fn16"><p>Valores não numéricos também podem ser encontrados por aí, como por exemplo "—", "na", "N/A", "None", " ".<a href="#fnref16" class="footnote-back">↩</a></p></li>
<li id="fn17"><p>Uma variável é um nome que podemos usar para nos referirmos a um local específico na memória do computador, onde nós armazenamos dados enquanto nosso programa está rodando.<a href="#fnref17" class="footnote-back">↩</a></p></li>
<li id="fn18"><p>A saída da <code>ls()</code> é a lista de variáveis ou objetos criadas na sessão do R atual. Ela também é mostrada no painel <em>Environment</em> do RStudio.<a href="#fnref18" class="footnote-back">↩</a></p></li>
<li id="fn19"><p>Diferente de outras linguagens de programação no R, um <strong>escalar</strong> é um vetor com um elemento. Então, vetores são o menor tipo de dados no R.<a href="#fnref19" class="footnote-back">↩</a></p></li>
<li id="fn20"><p>Lista é um tipo de vetor chamado <code>list</code> que é capaz de armazenar dados de diferentes tipos (heterogêneos), o que será visto na seção @ref(listas).<a href="#fnref20" class="footnote-back">↩</a></p></li>
<li id="fn21"><p>Em comparação a função <code>print()</code>, a função <code>cat()</code> tem a vantagem de concatenar os dados fornecidos em seus argumentos, fazendo a coerção deles para caracteres se necessário. Isso faz dela uma função bastante útil para imprimir mensagens e avisos dentro de funções.<a href="#fnref21" class="footnote-back">↩</a></p></li>
<li id="fn22"><p>Operadores relacionais será visto na seção @ref(oper-vect).<a href="#fnref22" class="footnote-back">↩</a></p></li>
<li id="fn23"><p>Nós conheceremos mais detalhes sobre o <code>NULL</code> na sessão @ref(dados-nulos).<a href="#fnref23" class="footnote-back">↩</a></p></li>
<li id="fn24"><p>Também conhecidos como <strong>normais climatológicas</strong> de precipitação de um local.<a href="#fnref24" class="footnote-back">↩</a></p></li>
<li id="fn25"><p>faz parte da coleção de pacotes <img src="images/logo_r.png" width="20"> para ciência de dados chamada <strong>tidyverse</strong>.<a href="#fnref25" class="footnote-back">↩</a></p></li>
<li id="fn26"><p>Isso significa que os resultados nos códigos abaixo não se alteram se removermos essa conversão.<a href="#fnref26" class="footnote-back">↩</a></p></li>
<li id="fn27"><p>Mede a tendência média dos valores previstos (ou simulados) em serem maiores (superestimativa) ou menores (subestiva) que os observados. O valor ótimo é 0, menores valores indicam melhor desempenho. Valores positivos indicam tendência de superestimativa e negativos de subestimativa.<a href="#fnref27" class="footnote-back">↩</a></p></li>
<li id="fn28"><p>NSE é uma estatística normalizada que que determina a magnitude relativa da variância residual (ruído) comparada a variância dos dados medidos (informação). NSE varia de -Inf a 1. Essencialmente, quanto mais próximo a 1, melhor o modelo.<a href="#fnref28" class="footnote-back">↩</a></p></li>
<li id="fn29"><p>Pesquisa reproduzível é o conceito de divulgar documentos científicos incluindo os dados e os códigos utilizados (além do texto e dos gráficos) para que qualquer pessoa possa reproduzir os resultados e assim aperfeiçoar ou construir novos resultados a partir deles.<a href="#fnref29" class="footnote-back">↩</a></p></li>
<li id="fn30"><p>No RStudio, após gerar o documento HTML clicando em knit, clique em <em>Publish</em> no canto superior direito da aba Viewer e siga os passos apresentados.<a href="#fnref30" class="footnote-back">↩</a></p></li>
<li id="fn31"><p>para publicar no GitHub você precisa criar seu arquivo HTML dentro de um projeto do RStudio usando o <a href="https://git-scm.com/book/pt-br/v2/Come%C3%A7ando-Sobre-Controle-de-Vers%C3%A3o">git</a> como sistema de versão de controle. Ao gerar o arquivo HTML, na aba <em>Git</em> do painel <em>Environmet</em>, <em>Commit</em> o arquivo gerado e depois <em>Push</em>. O arquivo HTML no GitHub pode ser visualizado <a href="https://rawgit.com/nomedousuario/nomedorepositorio/master/nomedoarquivo.html" class="uri">https://rawgit.com/nomedousuario/nomedorepositorio/master/nomedoarquivo.html</a>.<a href="#fnref31" class="footnote-back">↩</a></p></li>
<li id="fn32"><p>Para publicar seu documento HTML no <a href="https://app.netlify.com/drop">netlify</a> coloque-o em uma pasta qualquer, renomeie seu <code>arquivo.html</code> para <code>index.html</code> e arraste a pasta para área pontilhada indicada no site.<a href="#fnref32" class="footnote-back">↩</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
